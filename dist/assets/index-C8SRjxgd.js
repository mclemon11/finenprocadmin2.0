function nT(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function rT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ry={exports:{}},Tc={},Cy={exports:{}},le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var so=Symbol.for("react.element"),sT=Symbol.for("react.portal"),iT=Symbol.for("react.fragment"),aT=Symbol.for("react.strict_mode"),oT=Symbol.for("react.profiler"),lT=Symbol.for("react.provider"),cT=Symbol.for("react.context"),uT=Symbol.for("react.forward_ref"),dT=Symbol.for("react.suspense"),hT=Symbol.for("react.memo"),fT=Symbol.for("react.lazy"),qm=Symbol.iterator;function pT(t){return t===null||typeof t!="object"?null:(t=qm&&t[qm]||t["@@iterator"],typeof t=="function"?t:null)}var Py={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ky=Object.assign,jy={};function gi(t,e,n){this.props=t,this.context=e,this.refs=jy,this.updater=n||Py}gi.prototype.isReactComponent={};gi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};gi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function by(){}by.prototype=gi.prototype;function Bh(t,e,n){this.props=t,this.context=e,this.refs=jy,this.updater=n||Py}var $h=Bh.prototype=new by;$h.constructor=Bh;ky($h,gi.prototype);$h.isPureReactComponent=!0;var Hm=Array.isArray,Oy=Object.prototype.hasOwnProperty,Wh={current:null},Dy={key:!0,ref:!0,__self:!0,__source:!0};function Vy(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)Oy.call(e,r)&&!Dy.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:so,type:t,key:i,ref:a,props:s,_owner:Wh.current}}function mT(t,e){return{$$typeof:so,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function qh(t){return typeof t=="object"&&t!==null&&t.$$typeof===so}function gT(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Gm=/\/+/g;function Du(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gT(""+t.key):e.toString(36)}function pl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case so:case sT:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+Du(a,0):r,Hm(s)?(n="",t!=null&&(n=t.replace(Gm,"$&/")+"/"),pl(s,e,n,"",function(d){return d})):s!=null&&(qh(s)&&(s=mT(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Gm,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",Hm(t))for(var c=0;c<t.length;c++){i=t[c];var u=r+Du(i,c);a+=pl(i,e,n,u,s)}else if(u=pT(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=r+Du(i,c++),a+=pl(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Wo(t,e,n){if(t==null)return t;var r=[],s=0;return pl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function vT(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var xt={current:null},ml={transition:null},yT={ReactCurrentDispatcher:xt,ReactCurrentBatchConfig:ml,ReactCurrentOwner:Wh};function Ly(){throw Error("act(...) is not supported in production builds of React.")}le.Children={map:Wo,forEach:function(t,e,n){Wo(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Wo(t,function(){e++}),e},toArray:function(t){return Wo(t,function(e){return e})||[]},only:function(t){if(!qh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};le.Component=gi;le.Fragment=iT;le.Profiler=oT;le.PureComponent=Bh;le.StrictMode=aT;le.Suspense=dT;le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yT;le.act=Ly;le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=ky({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Wh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)Oy.call(e,u)&&!Dy.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:so,type:t.type,key:s,ref:i,props:r,_owner:a}};le.createContext=function(t){return t={$$typeof:cT,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:lT,_context:t},t.Consumer=t};le.createElement=Vy;le.createFactory=function(t){var e=Vy.bind(null,t);return e.type=t,e};le.createRef=function(){return{current:null}};le.forwardRef=function(t){return{$$typeof:uT,render:t}};le.isValidElement=qh;le.lazy=function(t){return{$$typeof:fT,_payload:{_status:-1,_result:t},_init:vT}};le.memo=function(t,e){return{$$typeof:hT,type:t,compare:e===void 0?null:e}};le.startTransition=function(t){var e=ml.transition;ml.transition={};try{t()}finally{ml.transition=e}};le.unstable_act=Ly;le.useCallback=function(t,e){return xt.current.useCallback(t,e)};le.useContext=function(t){return xt.current.useContext(t)};le.useDebugValue=function(){};le.useDeferredValue=function(t){return xt.current.useDeferredValue(t)};le.useEffect=function(t,e){return xt.current.useEffect(t,e)};le.useId=function(){return xt.current.useId()};le.useImperativeHandle=function(t,e,n){return xt.current.useImperativeHandle(t,e,n)};le.useInsertionEffect=function(t,e){return xt.current.useInsertionEffect(t,e)};le.useLayoutEffect=function(t,e){return xt.current.useLayoutEffect(t,e)};le.useMemo=function(t,e){return xt.current.useMemo(t,e)};le.useReducer=function(t,e,n){return xt.current.useReducer(t,e,n)};le.useRef=function(t){return xt.current.useRef(t)};le.useState=function(t){return xt.current.useState(t)};le.useSyncExternalStore=function(t,e,n){return xt.current.useSyncExternalStore(t,e,n)};le.useTransition=function(){return xt.current.useTransition()};le.version="18.3.1";Cy.exports=le;var b=Cy.exports;const Hh=rT(b),_T=nT({__proto__:null,default:Hh},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wT=b,ET=Symbol.for("react.element"),IT=Symbol.for("react.fragment"),TT=Object.prototype.hasOwnProperty,xT=wT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,NT={key:!0,ref:!0,__self:!0,__source:!0};function My(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)TT.call(e,r)&&!NT.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:ET,type:t,key:i,ref:a,props:s,_owner:xT.current}}Tc.Fragment=IT;Tc.jsx=My;Tc.jsxs=My;Ry.exports=Tc;var o=Ry.exports,Fy={exports:{}},Ut={},Uy={exports:{}},zy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,Y){var L=B.length;B.push(Y);e:for(;0<L;){var ie=L-1>>>1,oe=B[ie];if(0<s(oe,Y))B[ie]=Y,B[L]=oe,L=ie;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var Y=B[0],L=B.pop();if(L!==Y){B[0]=L;e:for(var ie=0,oe=B.length,pe=oe>>>1;ie<pe;){var Me=2*(ie+1)-1,Ge=B[Me],kt=Me+1,Te=B[kt];if(0>s(Ge,L))kt<oe&&0>s(Te,Ge)?(B[ie]=Te,B[kt]=L,ie=kt):(B[ie]=Ge,B[Me]=L,ie=Me);else if(kt<oe&&0>s(Te,L))B[ie]=Te,B[kt]=L,ie=kt;else break e}}return Y}function s(B,Y){var L=B.sortIndex-Y.sortIndex;return L!==0?L:B.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var u=[],d=[],f=1,p=null,m=3,E=!1,y=!1,x=!1,N=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(B){for(var Y=n(d);Y!==null;){if(Y.callback===null)r(d);else if(Y.startTime<=B)r(d),Y.sortIndex=Y.expirationTime,e(u,Y);else break;Y=n(d)}}function k(B){if(x=!1,T(B),!y)if(n(u)!==null)y=!0,ne(O);else{var Y=n(d);Y!==null&&ve(k,Y.startTime-B)}}function O(B,Y){y=!1,x&&(x=!1,I(v),v=-1),E=!0;var L=m;try{for(T(Y),p=n(u);p!==null&&(!(p.expirationTime>Y)||B&&!C());){var ie=p.callback;if(typeof ie=="function"){p.callback=null,m=p.priorityLevel;var oe=ie(p.expirationTime<=Y);Y=t.unstable_now(),typeof oe=="function"?p.callback=oe:p===n(u)&&r(u),T(Y)}else r(u);p=n(u)}if(p!==null)var pe=!0;else{var Me=n(d);Me!==null&&ve(k,Me.startTime-Y),pe=!1}return pe}finally{p=null,m=L,E=!1}}var D=!1,_=null,v=-1,A=5,P=-1;function C(){return!(t.unstable_now()-P<A)}function j(){if(_!==null){var B=t.unstable_now();P=B;var Y=!0;try{Y=_(!0,B)}finally{Y?S():(D=!1,_=null)}}else D=!1}var S;if(typeof w=="function")S=function(){w(j)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,G=U.port2;U.port1.onmessage=j,S=function(){G.postMessage(null)}}else S=function(){N(j,0)};function ne(B){_=B,D||(D=!0,S())}function ve(B,Y){v=N(function(){B(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){y||E||(y=!0,ne(O))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(B){switch(m){case 1:case 2:case 3:var Y=3;break;default:Y=m}var L=m;m=Y;try{return B()}finally{m=L}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,Y){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var L=m;m=B;try{return Y()}finally{m=L}},t.unstable_scheduleCallback=function(B,Y,L){var ie=t.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?ie+L:ie):L=ie,B){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=L+oe,B={id:f++,callback:Y,priorityLevel:B,startTime:L,expirationTime:oe,sortIndex:-1},L>ie?(B.sortIndex=L,e(d,B),n(u)===null&&B===n(d)&&(x?(I(v),v=-1):x=!0,ve(k,L-ie))):(B.sortIndex=oe,e(u,B),y||E||(y=!0,ne(O))),B},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(B){var Y=m;return function(){var L=m;m=Y;try{return B.apply(this,arguments)}finally{m=L}}}})(zy);Uy.exports=zy;var ST=Uy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AT=b,Ft=ST;function $(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var By=new Set,xa={};function gs(t,e){ei(t,e),ei(t+"Capture",e)}function ei(t,e){for(xa[t]=e,t=0;t<e.length;t++)By.add(e[t])}var Vn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ed=Object.prototype.hasOwnProperty,RT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Km={},Qm={};function CT(t){return Ed.call(Qm,t)?!0:Ed.call(Km,t)?!1:RT.test(t)?Qm[t]=!0:(Km[t]=!0,!1)}function PT(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function kT(t,e,n,r){if(e===null||typeof e>"u"||PT(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Nt(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var st={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){st[t]=new Nt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];st[e]=new Nt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){st[t]=new Nt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){st[t]=new Nt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){st[t]=new Nt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){st[t]=new Nt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){st[t]=new Nt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){st[t]=new Nt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){st[t]=new Nt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gh=/[\-:]([a-z])/g;function Kh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gh,Kh);st[e]=new Nt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gh,Kh);st[e]=new Nt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gh,Kh);st[e]=new Nt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){st[t]=new Nt(t,1,!1,t.toLowerCase(),null,!1,!1)});st.xlinkHref=new Nt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){st[t]=new Nt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Qh(t,e,n,r){var s=st.hasOwnProperty(e)?st[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(kT(e,n,s,r)&&(n=null),r||s===null?CT(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var qn=AT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qo=Symbol.for("react.element"),Ps=Symbol.for("react.portal"),ks=Symbol.for("react.fragment"),Yh=Symbol.for("react.strict_mode"),Id=Symbol.for("react.profiler"),$y=Symbol.for("react.provider"),Wy=Symbol.for("react.context"),Xh=Symbol.for("react.forward_ref"),Td=Symbol.for("react.suspense"),xd=Symbol.for("react.suspense_list"),Jh=Symbol.for("react.memo"),tr=Symbol.for("react.lazy"),qy=Symbol.for("react.offscreen"),Ym=Symbol.iterator;function $i(t){return t===null||typeof t!="object"?null:(t=Ym&&t[Ym]||t["@@iterator"],typeof t=="function"?t:null)}var be=Object.assign,Vu;function Zi(t){if(Vu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Vu=e&&e[1]||""}return`
`+Vu+t}var Lu=!1;function Mu(t,e){if(!t||Lu)return"";Lu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,c=i.length-1;1<=a&&0<=c&&s[a]!==i[c];)c--;for(;1<=a&&0<=c;a--,c--)if(s[a]!==i[c]){if(a!==1||c!==1)do if(a--,c--,0>c||s[a]!==i[c]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=c);break}}}finally{Lu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Zi(t):""}function jT(t){switch(t.tag){case 5:return Zi(t.type);case 16:return Zi("Lazy");case 13:return Zi("Suspense");case 19:return Zi("SuspenseList");case 0:case 2:case 15:return t=Mu(t.type,!1),t;case 11:return t=Mu(t.type.render,!1),t;case 1:return t=Mu(t.type,!0),t;default:return""}}function Nd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ks:return"Fragment";case Ps:return"Portal";case Id:return"Profiler";case Yh:return"StrictMode";case Td:return"Suspense";case xd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Wy:return(t.displayName||"Context")+".Consumer";case $y:return(t._context.displayName||"Context")+".Provider";case Xh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Jh:return e=t.displayName||null,e!==null?e:Nd(t.type)||"Memo";case tr:e=t._payload,t=t._init;try{return Nd(t(e))}catch{}}return null}function bT(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Nd(e);case 8:return e===Yh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Hy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function OT(t){var e=Hy(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ho(t){t._valueTracker||(t._valueTracker=OT(t))}function Gy(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Hy(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Dl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Sd(t,e){var n=e.checked;return be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Xm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Sr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ky(t,e){e=e.checked,e!=null&&Qh(t,"checked",e,!1)}function Ad(t,e){Ky(t,e);var n=Sr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Rd(t,e.type,n):e.hasOwnProperty("defaultValue")&&Rd(t,e.type,Sr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Jm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Rd(t,e,n){(e!=="number"||Dl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ea=Array.isArray;function $s(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Sr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Cd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return be({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Zm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error($(92));if(ea(n)){if(1<n.length)throw Error($(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Sr(n)}}function Qy(t,e){var n=Sr(e.value),r=Sr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function eg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Yy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Yy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Go,Xy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Go=Go||document.createElement("div"),Go.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Go.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Na(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var la={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},DT=["Webkit","ms","Moz","O"];Object.keys(la).forEach(function(t){DT.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),la[e]=la[t]})});function Jy(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||la.hasOwnProperty(t)&&la[t]?(""+e).trim():e+"px"}function Zy(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Jy(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var VT=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kd(t,e){if(e){if(VT[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function jd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bd=null;function Zh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Od=null,Ws=null,qs=null;function tg(t){if(t=oo(t)){if(typeof Od!="function")throw Error($(280));var e=t.stateNode;e&&(e=Rc(e),Od(t.stateNode,t.type,e))}}function e_(t){Ws?qs?qs.push(t):qs=[t]:Ws=t}function t_(){if(Ws){var t=Ws,e=qs;if(qs=Ws=null,tg(t),e)for(t=0;t<e.length;t++)tg(e[t])}}function n_(t,e){return t(e)}function r_(){}var Fu=!1;function s_(t,e,n){if(Fu)return t(e,n);Fu=!0;try{return n_(t,e,n)}finally{Fu=!1,(Ws!==null||qs!==null)&&(r_(),t_())}}function Sa(t,e){var n=t.stateNode;if(n===null)return null;var r=Rc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error($(231,e,typeof n));return n}var Dd=!1;if(Vn)try{var Wi={};Object.defineProperty(Wi,"passive",{get:function(){Dd=!0}}),window.addEventListener("test",Wi,Wi),window.removeEventListener("test",Wi,Wi)}catch{Dd=!1}function LT(t,e,n,r,s,i,a,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var ca=!1,Vl=null,Ll=!1,Vd=null,MT={onError:function(t){ca=!0,Vl=t}};function FT(t,e,n,r,s,i,a,c,u){ca=!1,Vl=null,LT.apply(MT,arguments)}function UT(t,e,n,r,s,i,a,c,u){if(FT.apply(this,arguments),ca){if(ca){var d=Vl;ca=!1,Vl=null}else throw Error($(198));Ll||(Ll=!0,Vd=d)}}function vs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function i_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ng(t){if(vs(t)!==t)throw Error($(188))}function zT(t){var e=t.alternate;if(!e){if(e=vs(t),e===null)throw Error($(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return ng(s),t;if(i===r)return ng(s),e;i=i.sibling}throw Error($(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,c=s.child;c;){if(c===n){a=!0,n=s,r=i;break}if(c===r){a=!0,r=s,n=i;break}c=c.sibling}if(!a){for(c=i.child;c;){if(c===n){a=!0,n=i,r=s;break}if(c===r){a=!0,r=i,n=s;break}c=c.sibling}if(!a)throw Error($(189))}}if(n.alternate!==r)throw Error($(190))}if(n.tag!==3)throw Error($(188));return n.stateNode.current===n?t:e}function a_(t){return t=zT(t),t!==null?o_(t):null}function o_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=o_(t);if(e!==null)return e;t=t.sibling}return null}var l_=Ft.unstable_scheduleCallback,rg=Ft.unstable_cancelCallback,BT=Ft.unstable_shouldYield,$T=Ft.unstable_requestPaint,Ue=Ft.unstable_now,WT=Ft.unstable_getCurrentPriorityLevel,ef=Ft.unstable_ImmediatePriority,c_=Ft.unstable_UserBlockingPriority,Ml=Ft.unstable_NormalPriority,qT=Ft.unstable_LowPriority,u_=Ft.unstable_IdlePriority,xc=null,pn=null;function HT(t){if(pn&&typeof pn.onCommitFiberRoot=="function")try{pn.onCommitFiberRoot(xc,t,void 0,(t.current.flags&128)===128)}catch{}}var sn=Math.clz32?Math.clz32:QT,GT=Math.log,KT=Math.LN2;function QT(t){return t>>>=0,t===0?32:31-(GT(t)/KT|0)|0}var Ko=64,Qo=4194304;function ta(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Fl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var c=a&~s;c!==0?r=ta(c):(i&=a,i!==0&&(r=ta(i)))}else a=n&~s,a!==0?r=ta(a):i!==0&&(r=ta(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-sn(e),s=1<<n,r|=t[n],e&=~s;return r}function YT(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function XT(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-sn(i),c=1<<a,u=s[a];u===-1?(!(c&n)||c&r)&&(s[a]=YT(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function Ld(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function d_(){var t=Ko;return Ko<<=1,!(Ko&4194240)&&(Ko=64),t}function Uu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function io(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-sn(e),t[e]=n}function JT(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-sn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function tf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-sn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var _e=0;function h_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var f_,nf,p_,m_,g_,Md=!1,Yo=[],pr=null,mr=null,gr=null,Aa=new Map,Ra=new Map,rr=[],ZT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sg(t,e){switch(t){case"focusin":case"focusout":pr=null;break;case"dragenter":case"dragleave":mr=null;break;case"mouseover":case"mouseout":gr=null;break;case"pointerover":case"pointerout":Aa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ra.delete(e.pointerId)}}function qi(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=oo(e),e!==null&&nf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function ex(t,e,n,r,s){switch(e){case"focusin":return pr=qi(pr,t,e,n,r,s),!0;case"dragenter":return mr=qi(mr,t,e,n,r,s),!0;case"mouseover":return gr=qi(gr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Aa.set(i,qi(Aa.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ra.set(i,qi(Ra.get(i)||null,t,e,n,r,s)),!0}return!1}function v_(t){var e=Qr(t.target);if(e!==null){var n=vs(e);if(n!==null){if(e=n.tag,e===13){if(e=i_(n),e!==null){t.blockedOn=e,g_(t.priority,function(){p_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function gl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Fd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);bd=r,n.target.dispatchEvent(r),bd=null}else return e=oo(n),e!==null&&nf(e),t.blockedOn=n,!1;e.shift()}return!0}function ig(t,e,n){gl(t)&&n.delete(e)}function tx(){Md=!1,pr!==null&&gl(pr)&&(pr=null),mr!==null&&gl(mr)&&(mr=null),gr!==null&&gl(gr)&&(gr=null),Aa.forEach(ig),Ra.forEach(ig)}function Hi(t,e){t.blockedOn===e&&(t.blockedOn=null,Md||(Md=!0,Ft.unstable_scheduleCallback(Ft.unstable_NormalPriority,tx)))}function Ca(t){function e(s){return Hi(s,t)}if(0<Yo.length){Hi(Yo[0],t);for(var n=1;n<Yo.length;n++){var r=Yo[n];r.blockedOn===t&&(r.blockedOn=null)}}for(pr!==null&&Hi(pr,t),mr!==null&&Hi(mr,t),gr!==null&&Hi(gr,t),Aa.forEach(e),Ra.forEach(e),n=0;n<rr.length;n++)r=rr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<rr.length&&(n=rr[0],n.blockedOn===null);)v_(n),n.blockedOn===null&&rr.shift()}var Hs=qn.ReactCurrentBatchConfig,Ul=!0;function nx(t,e,n,r){var s=_e,i=Hs.transition;Hs.transition=null;try{_e=1,rf(t,e,n,r)}finally{_e=s,Hs.transition=i}}function rx(t,e,n,r){var s=_e,i=Hs.transition;Hs.transition=null;try{_e=4,rf(t,e,n,r)}finally{_e=s,Hs.transition=i}}function rf(t,e,n,r){if(Ul){var s=Fd(t,e,n,r);if(s===null)Yu(t,e,r,zl,n),sg(t,r);else if(ex(s,t,e,n,r))r.stopPropagation();else if(sg(t,r),e&4&&-1<ZT.indexOf(t)){for(;s!==null;){var i=oo(s);if(i!==null&&f_(i),i=Fd(t,e,n,r),i===null&&Yu(t,e,r,zl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Yu(t,e,r,null,n)}}var zl=null;function Fd(t,e,n,r){if(zl=null,t=Zh(r),t=Qr(t),t!==null)if(e=vs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=i_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return zl=t,null}function y_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(WT()){case ef:return 1;case c_:return 4;case Ml:case qT:return 16;case u_:return 536870912;default:return 16}default:return 16}}var ur=null,sf=null,vl=null;function __(){if(vl)return vl;var t,e=sf,n=e.length,r,s="value"in ur?ur.value:ur.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return vl=s.slice(t,1<r?1-r:void 0)}function yl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Xo(){return!0}function ag(){return!1}function zt(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Xo:ag,this.isPropagationStopped=ag,this}return be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Xo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Xo)},persist:function(){},isPersistent:Xo}),e}var vi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},af=zt(vi),ao=be({},vi,{view:0,detail:0}),sx=zt(ao),zu,Bu,Gi,Nc=be({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:of,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Gi&&(Gi&&t.type==="mousemove"?(zu=t.screenX-Gi.screenX,Bu=t.screenY-Gi.screenY):Bu=zu=0,Gi=t),zu)},movementY:function(t){return"movementY"in t?t.movementY:Bu}}),og=zt(Nc),ix=be({},Nc,{dataTransfer:0}),ax=zt(ix),ox=be({},ao,{relatedTarget:0}),$u=zt(ox),lx=be({},vi,{animationName:0,elapsedTime:0,pseudoElement:0}),cx=zt(lx),ux=be({},vi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),dx=zt(ux),hx=be({},vi,{data:0}),lg=zt(hx),fx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},px={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gx(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=mx[t])?!!e[t]:!1}function of(){return gx}var vx=be({},ao,{key:function(t){if(t.key){var e=fx[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=yl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?px[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:of,charCode:function(t){return t.type==="keypress"?yl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?yl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yx=zt(vx),_x=be({},Nc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cg=zt(_x),wx=be({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:of}),Ex=zt(wx),Ix=be({},vi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tx=zt(Ix),xx=be({},Nc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Nx=zt(xx),Sx=[9,13,27,32],lf=Vn&&"CompositionEvent"in window,ua=null;Vn&&"documentMode"in document&&(ua=document.documentMode);var Ax=Vn&&"TextEvent"in window&&!ua,w_=Vn&&(!lf||ua&&8<ua&&11>=ua),ug=" ",dg=!1;function E_(t,e){switch(t){case"keyup":return Sx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function I_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var js=!1;function Rx(t,e){switch(t){case"compositionend":return I_(e);case"keypress":return e.which!==32?null:(dg=!0,ug);case"textInput":return t=e.data,t===ug&&dg?null:t;default:return null}}function Cx(t,e){if(js)return t==="compositionend"||!lf&&E_(t,e)?(t=__(),vl=sf=ur=null,js=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return w_&&e.locale!=="ko"?null:e.data;default:return null}}var Px={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Px[t.type]:e==="textarea"}function T_(t,e,n,r){e_(r),e=Bl(e,"onChange"),0<e.length&&(n=new af("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var da=null,Pa=null;function kx(t){O_(t,0)}function Sc(t){var e=Ds(t);if(Gy(e))return t}function jx(t,e){if(t==="change")return e}var x_=!1;if(Vn){var Wu;if(Vn){var qu="oninput"in document;if(!qu){var fg=document.createElement("div");fg.setAttribute("oninput","return;"),qu=typeof fg.oninput=="function"}Wu=qu}else Wu=!1;x_=Wu&&(!document.documentMode||9<document.documentMode)}function pg(){da&&(da.detachEvent("onpropertychange",N_),Pa=da=null)}function N_(t){if(t.propertyName==="value"&&Sc(Pa)){var e=[];T_(e,Pa,t,Zh(t)),s_(kx,e)}}function bx(t,e,n){t==="focusin"?(pg(),da=e,Pa=n,da.attachEvent("onpropertychange",N_)):t==="focusout"&&pg()}function Ox(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Sc(Pa)}function Dx(t,e){if(t==="click")return Sc(e)}function Vx(t,e){if(t==="input"||t==="change")return Sc(e)}function Lx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var cn=typeof Object.is=="function"?Object.is:Lx;function ka(t,e){if(cn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ed.call(e,s)||!cn(t[s],e[s]))return!1}return!0}function mg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function gg(t,e){var n=mg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=mg(n)}}function S_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?S_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function A_(){for(var t=window,e=Dl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Dl(t.document)}return e}function cf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Mx(t){var e=A_(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&S_(n.ownerDocument.documentElement,n)){if(r!==null&&cf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=gg(n,i);var a=gg(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Fx=Vn&&"documentMode"in document&&11>=document.documentMode,bs=null,Ud=null,ha=null,zd=!1;function vg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;zd||bs==null||bs!==Dl(r)||(r=bs,"selectionStart"in r&&cf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ha&&ka(ha,r)||(ha=r,r=Bl(Ud,"onSelect"),0<r.length&&(e=new af("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=bs)))}function Jo(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Os={animationend:Jo("Animation","AnimationEnd"),animationiteration:Jo("Animation","AnimationIteration"),animationstart:Jo("Animation","AnimationStart"),transitionend:Jo("Transition","TransitionEnd")},Hu={},R_={};Vn&&(R_=document.createElement("div").style,"AnimationEvent"in window||(delete Os.animationend.animation,delete Os.animationiteration.animation,delete Os.animationstart.animation),"TransitionEvent"in window||delete Os.transitionend.transition);function Ac(t){if(Hu[t])return Hu[t];if(!Os[t])return t;var e=Os[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in R_)return Hu[t]=e[n];return t}var C_=Ac("animationend"),P_=Ac("animationiteration"),k_=Ac("animationstart"),j_=Ac("transitionend"),b_=new Map,yg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jr(t,e){b_.set(t,e),gs(e,[t])}for(var Gu=0;Gu<yg.length;Gu++){var Ku=yg[Gu],Ux=Ku.toLowerCase(),zx=Ku[0].toUpperCase()+Ku.slice(1);jr(Ux,"on"+zx)}jr(C_,"onAnimationEnd");jr(P_,"onAnimationIteration");jr(k_,"onAnimationStart");jr("dblclick","onDoubleClick");jr("focusin","onFocus");jr("focusout","onBlur");jr(j_,"onTransitionEnd");ei("onMouseEnter",["mouseout","mouseover"]);ei("onMouseLeave",["mouseout","mouseover"]);ei("onPointerEnter",["pointerout","pointerover"]);ei("onPointerLeave",["pointerout","pointerover"]);gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gs("onBeforeInput",["compositionend","keypress","textInput","paste"]);gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var na="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bx=new Set("cancel close invalid load scroll toggle".split(" ").concat(na));function _g(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,UT(r,e,void 0,t),t.currentTarget=null}function O_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var c=r[a],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;_g(s,c,d),i=u}else for(a=0;a<r.length;a++){if(c=r[a],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;_g(s,c,d),i=u}}}if(Ll)throw t=Vd,Ll=!1,Vd=null,t}function Se(t,e){var n=e[Hd];n===void 0&&(n=e[Hd]=new Set);var r=t+"__bubble";n.has(r)||(D_(e,t,2,!1),n.add(r))}function Qu(t,e,n){var r=0;e&&(r|=4),D_(n,t,r,e)}var Zo="_reactListening"+Math.random().toString(36).slice(2);function ja(t){if(!t[Zo]){t[Zo]=!0,By.forEach(function(n){n!=="selectionchange"&&(Bx.has(n)||Qu(n,!1,t),Qu(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Zo]||(e[Zo]=!0,Qu("selectionchange",!1,e))}}function D_(t,e,n,r){switch(y_(e)){case 1:var s=nx;break;case 4:s=rx;break;default:s=rf}n=s.bind(null,e,n,t),s=void 0,!Dd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Yu(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;c!==null;){if(a=Qr(c),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}c=c.parentNode}}r=r.return}s_(function(){var d=i,f=Zh(n),p=[];e:{var m=b_.get(t);if(m!==void 0){var E=af,y=t;switch(t){case"keypress":if(yl(n)===0)break e;case"keydown":case"keyup":E=yx;break;case"focusin":y="focus",E=$u;break;case"focusout":y="blur",E=$u;break;case"beforeblur":case"afterblur":E=$u;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=og;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=ax;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=Ex;break;case C_:case P_:case k_:E=cx;break;case j_:E=Tx;break;case"scroll":E=sx;break;case"wheel":E=Nx;break;case"copy":case"cut":case"paste":E=dx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=cg}var x=(e&4)!==0,N=!x&&t==="scroll",I=x?m!==null?m+"Capture":null:m;x=[];for(var w=d,T;w!==null;){T=w;var k=T.stateNode;if(T.tag===5&&k!==null&&(T=k,I!==null&&(k=Sa(w,I),k!=null&&x.push(ba(w,k,T)))),N)break;w=w.return}0<x.length&&(m=new E(m,y,null,n,f),p.push({event:m,listeners:x}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",m&&n!==bd&&(y=n.relatedTarget||n.fromElement)&&(Qr(y)||y[Ln]))break e;if((E||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,E?(y=n.relatedTarget||n.toElement,E=d,y=y?Qr(y):null,y!==null&&(N=vs(y),y!==N||y.tag!==5&&y.tag!==6)&&(y=null)):(E=null,y=d),E!==y)){if(x=og,k="onMouseLeave",I="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(x=cg,k="onPointerLeave",I="onPointerEnter",w="pointer"),N=E==null?m:Ds(E),T=y==null?m:Ds(y),m=new x(k,w+"leave",E,n,f),m.target=N,m.relatedTarget=T,k=null,Qr(f)===d&&(x=new x(I,w+"enter",y,n,f),x.target=T,x.relatedTarget=N,k=x),N=k,E&&y)t:{for(x=E,I=y,w=0,T=x;T;T=As(T))w++;for(T=0,k=I;k;k=As(k))T++;for(;0<w-T;)x=As(x),w--;for(;0<T-w;)I=As(I),T--;for(;w--;){if(x===I||I!==null&&x===I.alternate)break t;x=As(x),I=As(I)}x=null}else x=null;E!==null&&wg(p,m,E,x,!1),y!==null&&N!==null&&wg(p,N,y,x,!0)}}e:{if(m=d?Ds(d):window,E=m.nodeName&&m.nodeName.toLowerCase(),E==="select"||E==="input"&&m.type==="file")var O=jx;else if(hg(m))if(x_)O=Vx;else{O=Ox;var D=bx}else(E=m.nodeName)&&E.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=Dx);if(O&&(O=O(t,d))){T_(p,O,n,f);break e}D&&D(t,m,d),t==="focusout"&&(D=m._wrapperState)&&D.controlled&&m.type==="number"&&Rd(m,"number",m.value)}switch(D=d?Ds(d):window,t){case"focusin":(hg(D)||D.contentEditable==="true")&&(bs=D,Ud=d,ha=null);break;case"focusout":ha=Ud=bs=null;break;case"mousedown":zd=!0;break;case"contextmenu":case"mouseup":case"dragend":zd=!1,vg(p,n,f);break;case"selectionchange":if(Fx)break;case"keydown":case"keyup":vg(p,n,f)}var _;if(lf)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else js?E_(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(w_&&n.locale!=="ko"&&(js||v!=="onCompositionStart"?v==="onCompositionEnd"&&js&&(_=__()):(ur=f,sf="value"in ur?ur.value:ur.textContent,js=!0)),D=Bl(d,v),0<D.length&&(v=new lg(v,t,null,n,f),p.push({event:v,listeners:D}),_?v.data=_:(_=I_(n),_!==null&&(v.data=_)))),(_=Ax?Rx(t,n):Cx(t,n))&&(d=Bl(d,"onBeforeInput"),0<d.length&&(f=new lg("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=_))}O_(p,e)})}function ba(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Bl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Sa(t,n),i!=null&&r.unshift(ba(t,i,s)),i=Sa(t,e),i!=null&&r.push(ba(t,i,s))),t=t.return}return r}function As(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function wg(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=Sa(n,i),u!=null&&a.unshift(ba(n,u,c))):s||(u=Sa(n,i),u!=null&&a.push(ba(n,u,c)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var $x=/\r\n?/g,Wx=/\u0000|\uFFFD/g;function Eg(t){return(typeof t=="string"?t:""+t).replace($x,`
`).replace(Wx,"")}function el(t,e,n){if(e=Eg(e),Eg(t)!==e&&n)throw Error($(425))}function $l(){}var Bd=null,$d=null;function Wd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var qd=typeof setTimeout=="function"?setTimeout:void 0,qx=typeof clearTimeout=="function"?clearTimeout:void 0,Ig=typeof Promise=="function"?Promise:void 0,Hx=typeof queueMicrotask=="function"?queueMicrotask:typeof Ig<"u"?function(t){return Ig.resolve(null).then(t).catch(Gx)}:qd;function Gx(t){setTimeout(function(){throw t})}function Xu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ca(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ca(e)}function vr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Tg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var yi=Math.random().toString(36).slice(2),fn="__reactFiber$"+yi,Oa="__reactProps$"+yi,Ln="__reactContainer$"+yi,Hd="__reactEvents$"+yi,Kx="__reactListeners$"+yi,Qx="__reactHandles$"+yi;function Qr(t){var e=t[fn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ln]||n[fn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Tg(t);t!==null;){if(n=t[fn])return n;t=Tg(t)}return e}t=n,n=t.parentNode}return null}function oo(t){return t=t[fn]||t[Ln],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ds(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error($(33))}function Rc(t){return t[Oa]||null}var Gd=[],Vs=-1;function br(t){return{current:t}}function Ae(t){0>Vs||(t.current=Gd[Vs],Gd[Vs]=null,Vs--)}function xe(t,e){Vs++,Gd[Vs]=t.current,t.current=e}var Ar={},vt=br(Ar),Rt=br(!1),ss=Ar;function ti(t,e){var n=t.type.contextTypes;if(!n)return Ar;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ct(t){return t=t.childContextTypes,t!=null}function Wl(){Ae(Rt),Ae(vt)}function xg(t,e,n){if(vt.current!==Ar)throw Error($(168));xe(vt,e),xe(Rt,n)}function V_(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error($(108,bT(t)||"Unknown",s));return be({},n,r)}function ql(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ar,ss=vt.current,xe(vt,t),xe(Rt,Rt.current),!0}function Ng(t,e,n){var r=t.stateNode;if(!r)throw Error($(169));n?(t=V_(t,e,ss),r.__reactInternalMemoizedMergedChildContext=t,Ae(Rt),Ae(vt),xe(vt,t)):Ae(Rt),xe(Rt,n)}var An=null,Cc=!1,Ju=!1;function L_(t){An===null?An=[t]:An.push(t)}function Yx(t){Cc=!0,L_(t)}function Or(){if(!Ju&&An!==null){Ju=!0;var t=0,e=_e;try{var n=An;for(_e=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}An=null,Cc=!1}catch(s){throw An!==null&&(An=An.slice(t+1)),l_(ef,Or),s}finally{_e=e,Ju=!1}}return null}var Ls=[],Ms=0,Hl=null,Gl=0,$t=[],Wt=0,is=null,Cn=1,Pn="";function Hr(t,e){Ls[Ms++]=Gl,Ls[Ms++]=Hl,Hl=t,Gl=e}function M_(t,e,n){$t[Wt++]=Cn,$t[Wt++]=Pn,$t[Wt++]=is,is=t;var r=Cn;t=Pn;var s=32-sn(r)-1;r&=~(1<<s),n+=1;var i=32-sn(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Cn=1<<32-sn(e)+s|n<<s|r,Pn=i+t}else Cn=1<<i|n<<s|r,Pn=t}function uf(t){t.return!==null&&(Hr(t,1),M_(t,1,0))}function df(t){for(;t===Hl;)Hl=Ls[--Ms],Ls[Ms]=null,Gl=Ls[--Ms],Ls[Ms]=null;for(;t===is;)is=$t[--Wt],$t[Wt]=null,Pn=$t[--Wt],$t[Wt]=null,Cn=$t[--Wt],$t[Wt]=null}var Vt=null,Ot=null,Re=!1,tn=null;function F_(t,e){var n=qt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Sg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Vt=t,Ot=vr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Vt=t,Ot=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=is!==null?{id:Cn,overflow:Pn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=qt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Vt=t,Ot=null,!0):!1;default:return!1}}function Kd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Qd(t){if(Re){var e=Ot;if(e){var n=e;if(!Sg(t,e)){if(Kd(t))throw Error($(418));e=vr(n.nextSibling);var r=Vt;e&&Sg(t,e)?F_(r,n):(t.flags=t.flags&-4097|2,Re=!1,Vt=t)}}else{if(Kd(t))throw Error($(418));t.flags=t.flags&-4097|2,Re=!1,Vt=t}}}function Ag(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Vt=t}function tl(t){if(t!==Vt)return!1;if(!Re)return Ag(t),Re=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Wd(t.type,t.memoizedProps)),e&&(e=Ot)){if(Kd(t))throw U_(),Error($(418));for(;e;)F_(t,e),e=vr(e.nextSibling)}if(Ag(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error($(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ot=vr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ot=null}}else Ot=Vt?vr(t.stateNode.nextSibling):null;return!0}function U_(){for(var t=Ot;t;)t=vr(t.nextSibling)}function ni(){Ot=Vt=null,Re=!1}function hf(t){tn===null?tn=[t]:tn.push(t)}var Xx=qn.ReactCurrentBatchConfig;function Ki(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error($(309));var r=n.stateNode}if(!r)throw Error($(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var c=s.refs;a===null?delete c[i]:c[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error($(284));if(!n._owner)throw Error($(290,t))}return t}function nl(t,e){throw t=Object.prototype.toString.call(e),Error($(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Rg(t){var e=t._init;return e(t._payload)}function z_(t){function e(I,w){if(t){var T=I.deletions;T===null?(I.deletions=[w],I.flags|=16):T.push(w)}}function n(I,w){if(!t)return null;for(;w!==null;)e(I,w),w=w.sibling;return null}function r(I,w){for(I=new Map;w!==null;)w.key!==null?I.set(w.key,w):I.set(w.index,w),w=w.sibling;return I}function s(I,w){return I=Er(I,w),I.index=0,I.sibling=null,I}function i(I,w,T){return I.index=T,t?(T=I.alternate,T!==null?(T=T.index,T<w?(I.flags|=2,w):T):(I.flags|=2,w)):(I.flags|=1048576,w)}function a(I){return t&&I.alternate===null&&(I.flags|=2),I}function c(I,w,T,k){return w===null||w.tag!==6?(w=id(T,I.mode,k),w.return=I,w):(w=s(w,T),w.return=I,w)}function u(I,w,T,k){var O=T.type;return O===ks?f(I,w,T.props.children,k,T.key):w!==null&&(w.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===tr&&Rg(O)===w.type)?(k=s(w,T.props),k.ref=Ki(I,w,T),k.return=I,k):(k=Nl(T.type,T.key,T.props,null,I.mode,k),k.ref=Ki(I,w,T),k.return=I,k)}function d(I,w,T,k){return w===null||w.tag!==4||w.stateNode.containerInfo!==T.containerInfo||w.stateNode.implementation!==T.implementation?(w=ad(T,I.mode,k),w.return=I,w):(w=s(w,T.children||[]),w.return=I,w)}function f(I,w,T,k,O){return w===null||w.tag!==7?(w=ts(T,I.mode,k,O),w.return=I,w):(w=s(w,T),w.return=I,w)}function p(I,w,T){if(typeof w=="string"&&w!==""||typeof w=="number")return w=id(""+w,I.mode,T),w.return=I,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case qo:return T=Nl(w.type,w.key,w.props,null,I.mode,T),T.ref=Ki(I,null,w),T.return=I,T;case Ps:return w=ad(w,I.mode,T),w.return=I,w;case tr:var k=w._init;return p(I,k(w._payload),T)}if(ea(w)||$i(w))return w=ts(w,I.mode,T,null),w.return=I,w;nl(I,w)}return null}function m(I,w,T,k){var O=w!==null?w.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return O!==null?null:c(I,w,""+T,k);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case qo:return T.key===O?u(I,w,T,k):null;case Ps:return T.key===O?d(I,w,T,k):null;case tr:return O=T._init,m(I,w,O(T._payload),k)}if(ea(T)||$i(T))return O!==null?null:f(I,w,T,k,null);nl(I,T)}return null}function E(I,w,T,k,O){if(typeof k=="string"&&k!==""||typeof k=="number")return I=I.get(T)||null,c(w,I,""+k,O);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case qo:return I=I.get(k.key===null?T:k.key)||null,u(w,I,k,O);case Ps:return I=I.get(k.key===null?T:k.key)||null,d(w,I,k,O);case tr:var D=k._init;return E(I,w,T,D(k._payload),O)}if(ea(k)||$i(k))return I=I.get(T)||null,f(w,I,k,O,null);nl(w,k)}return null}function y(I,w,T,k){for(var O=null,D=null,_=w,v=w=0,A=null;_!==null&&v<T.length;v++){_.index>v?(A=_,_=null):A=_.sibling;var P=m(I,_,T[v],k);if(P===null){_===null&&(_=A);break}t&&_&&P.alternate===null&&e(I,_),w=i(P,w,v),D===null?O=P:D.sibling=P,D=P,_=A}if(v===T.length)return n(I,_),Re&&Hr(I,v),O;if(_===null){for(;v<T.length;v++)_=p(I,T[v],k),_!==null&&(w=i(_,w,v),D===null?O=_:D.sibling=_,D=_);return Re&&Hr(I,v),O}for(_=r(I,_);v<T.length;v++)A=E(_,I,v,T[v],k),A!==null&&(t&&A.alternate!==null&&_.delete(A.key===null?v:A.key),w=i(A,w,v),D===null?O=A:D.sibling=A,D=A);return t&&_.forEach(function(C){return e(I,C)}),Re&&Hr(I,v),O}function x(I,w,T,k){var O=$i(T);if(typeof O!="function")throw Error($(150));if(T=O.call(T),T==null)throw Error($(151));for(var D=O=null,_=w,v=w=0,A=null,P=T.next();_!==null&&!P.done;v++,P=T.next()){_.index>v?(A=_,_=null):A=_.sibling;var C=m(I,_,P.value,k);if(C===null){_===null&&(_=A);break}t&&_&&C.alternate===null&&e(I,_),w=i(C,w,v),D===null?O=C:D.sibling=C,D=C,_=A}if(P.done)return n(I,_),Re&&Hr(I,v),O;if(_===null){for(;!P.done;v++,P=T.next())P=p(I,P.value,k),P!==null&&(w=i(P,w,v),D===null?O=P:D.sibling=P,D=P);return Re&&Hr(I,v),O}for(_=r(I,_);!P.done;v++,P=T.next())P=E(_,I,v,P.value,k),P!==null&&(t&&P.alternate!==null&&_.delete(P.key===null?v:P.key),w=i(P,w,v),D===null?O=P:D.sibling=P,D=P);return t&&_.forEach(function(j){return e(I,j)}),Re&&Hr(I,v),O}function N(I,w,T,k){if(typeof T=="object"&&T!==null&&T.type===ks&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case qo:e:{for(var O=T.key,D=w;D!==null;){if(D.key===O){if(O=T.type,O===ks){if(D.tag===7){n(I,D.sibling),w=s(D,T.props.children),w.return=I,I=w;break e}}else if(D.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===tr&&Rg(O)===D.type){n(I,D.sibling),w=s(D,T.props),w.ref=Ki(I,D,T),w.return=I,I=w;break e}n(I,D);break}else e(I,D);D=D.sibling}T.type===ks?(w=ts(T.props.children,I.mode,k,T.key),w.return=I,I=w):(k=Nl(T.type,T.key,T.props,null,I.mode,k),k.ref=Ki(I,w,T),k.return=I,I=k)}return a(I);case Ps:e:{for(D=T.key;w!==null;){if(w.key===D)if(w.tag===4&&w.stateNode.containerInfo===T.containerInfo&&w.stateNode.implementation===T.implementation){n(I,w.sibling),w=s(w,T.children||[]),w.return=I,I=w;break e}else{n(I,w);break}else e(I,w);w=w.sibling}w=ad(T,I.mode,k),w.return=I,I=w}return a(I);case tr:return D=T._init,N(I,w,D(T._payload),k)}if(ea(T))return y(I,w,T,k);if($i(T))return x(I,w,T,k);nl(I,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,w!==null&&w.tag===6?(n(I,w.sibling),w=s(w,T),w.return=I,I=w):(n(I,w),w=id(T,I.mode,k),w.return=I,I=w),a(I)):n(I,w)}return N}var ri=z_(!0),B_=z_(!1),Kl=br(null),Ql=null,Fs=null,ff=null;function pf(){ff=Fs=Ql=null}function mf(t){var e=Kl.current;Ae(Kl),t._currentValue=e}function Yd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Gs(t,e){Ql=t,ff=Fs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(At=!0),t.firstContext=null)}function Gt(t){var e=t._currentValue;if(ff!==t)if(t={context:t,memoizedValue:e,next:null},Fs===null){if(Ql===null)throw Error($(308));Fs=t,Ql.dependencies={lanes:0,firstContext:t}}else Fs=Fs.next=t;return e}var Yr=null;function gf(t){Yr===null?Yr=[t]:Yr.push(t)}function $_(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,gf(e)):(n.next=s.next,s.next=n),e.interleaved=n,Mn(t,r)}function Mn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var nr=!1;function vf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function W_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function On(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function yr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,fe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Mn(t,n)}return s=r.interleaved,s===null?(e.next=e,gf(r)):(e.next=s.next,s.next=e),r.interleaved=e,Mn(t,n)}function _l(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,tf(t,n)}}function Cg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Yl(t,e,n,r){var s=t.updateQueue;nr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,a===null?i=d:a.next=d,a=u;var f=t.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==a&&(c===null?f.firstBaseUpdate=d:c.next=d,f.lastBaseUpdate=u))}if(i!==null){var p=s.baseState;a=0,f=d=u=null,c=i;do{var m=c.lane,E=c.eventTime;if((r&m)===m){f!==null&&(f=f.next={eventTime:E,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var y=t,x=c;switch(m=e,E=n,x.tag){case 1:if(y=x.payload,typeof y=="function"){p=y.call(E,p,m);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,m=typeof y=="function"?y.call(E,p,m):y,m==null)break e;p=be({},p,m);break e;case 2:nr=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[c]:m.push(c))}else E={eventTime:E,lane:m,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(d=f=E,u=p):f=f.next=E,a|=m;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;m=c,c=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(f===null&&(u=p),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);os|=a,t.lanes=a,t.memoizedState=p}}function Pg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error($(191,s));s.call(r)}}}var lo={},mn=br(lo),Da=br(lo),Va=br(lo);function Xr(t){if(t===lo)throw Error($(174));return t}function yf(t,e){switch(xe(Va,e),xe(Da,t),xe(mn,lo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Pd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Pd(e,t)}Ae(mn),xe(mn,e)}function si(){Ae(mn),Ae(Da),Ae(Va)}function q_(t){Xr(Va.current);var e=Xr(mn.current),n=Pd(e,t.type);e!==n&&(xe(Da,t),xe(mn,n))}function _f(t){Da.current===t&&(Ae(mn),Ae(Da))}var Pe=br(0);function Xl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Zu=[];function wf(){for(var t=0;t<Zu.length;t++)Zu[t]._workInProgressVersionPrimary=null;Zu.length=0}var wl=qn.ReactCurrentDispatcher,ed=qn.ReactCurrentBatchConfig,as=0,ke=null,We=null,Qe=null,Jl=!1,fa=!1,La=0,Jx=0;function ut(){throw Error($(321))}function Ef(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!cn(t[n],e[n]))return!1;return!0}function If(t,e,n,r,s,i){if(as=i,ke=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,wl.current=t===null||t.memoizedState===null?nN:rN,t=n(r,s),fa){i=0;do{if(fa=!1,La=0,25<=i)throw Error($(301));i+=1,Qe=We=null,e.updateQueue=null,wl.current=sN,t=n(r,s)}while(fa)}if(wl.current=Zl,e=We!==null&&We.next!==null,as=0,Qe=We=ke=null,Jl=!1,e)throw Error($(300));return t}function Tf(){var t=La!==0;return La=0,t}function hn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qe===null?ke.memoizedState=Qe=t:Qe=Qe.next=t,Qe}function Kt(){if(We===null){var t=ke.alternate;t=t!==null?t.memoizedState:null}else t=We.next;var e=Qe===null?ke.memoizedState:Qe.next;if(e!==null)Qe=e,We=t;else{if(t===null)throw Error($(310));We=t,t={memoizedState:We.memoizedState,baseState:We.baseState,baseQueue:We.baseQueue,queue:We.queue,next:null},Qe===null?ke.memoizedState=Qe=t:Qe=Qe.next=t}return Qe}function Ma(t,e){return typeof e=="function"?e(t):e}function td(t){var e=Kt(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=We,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=a=null,u=null,d=i;do{var f=d.lane;if((as&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=p,a=r):u=u.next=p,ke.lanes|=f,os|=f}d=d.next}while(d!==null&&d!==i);u===null?a=r:u.next=c,cn(r,e.memoizedState)||(At=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,ke.lanes|=i,os|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function nd(t){var e=Kt(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);cn(i,e.memoizedState)||(At=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function H_(){}function G_(t,e){var n=ke,r=Kt(),s=e(),i=!cn(r.memoizedState,s);if(i&&(r.memoizedState=s,At=!0),r=r.queue,xf(Y_.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Qe!==null&&Qe.memoizedState.tag&1){if(n.flags|=2048,Fa(9,Q_.bind(null,n,r,s,e),void 0,null),Xe===null)throw Error($(349));as&30||K_(n,e,s)}return s}function K_(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ke.updateQueue,e===null?(e={lastEffect:null,stores:null},ke.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Q_(t,e,n,r){e.value=n,e.getSnapshot=r,X_(e)&&J_(t)}function Y_(t,e,n){return n(function(){X_(e)&&J_(t)})}function X_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!cn(t,n)}catch{return!0}}function J_(t){var e=Mn(t,1);e!==null&&an(e,t,1,-1)}function kg(t){var e=hn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:t},e.queue=t,t=t.dispatch=tN.bind(null,ke,t),[e.memoizedState,t]}function Fa(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ke.updateQueue,e===null?(e={lastEffect:null,stores:null},ke.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Z_(){return Kt().memoizedState}function El(t,e,n,r){var s=hn();ke.flags|=t,s.memoizedState=Fa(1|e,n,void 0,r===void 0?null:r)}function Pc(t,e,n,r){var s=Kt();r=r===void 0?null:r;var i=void 0;if(We!==null){var a=We.memoizedState;if(i=a.destroy,r!==null&&Ef(r,a.deps)){s.memoizedState=Fa(e,n,i,r);return}}ke.flags|=t,s.memoizedState=Fa(1|e,n,i,r)}function jg(t,e){return El(8390656,8,t,e)}function xf(t,e){return Pc(2048,8,t,e)}function ew(t,e){return Pc(4,2,t,e)}function tw(t,e){return Pc(4,4,t,e)}function nw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function rw(t,e,n){return n=n!=null?n.concat([t]):null,Pc(4,4,nw.bind(null,e,t),n)}function Nf(){}function sw(t,e){var n=Kt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ef(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function iw(t,e){var n=Kt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ef(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function aw(t,e,n){return as&21?(cn(n,e)||(n=d_(),ke.lanes|=n,os|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,At=!0),t.memoizedState=n)}function Zx(t,e){var n=_e;_e=n!==0&&4>n?n:4,t(!0);var r=ed.transition;ed.transition={};try{t(!1),e()}finally{_e=n,ed.transition=r}}function ow(){return Kt().memoizedState}function eN(t,e,n){var r=wr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},lw(t))cw(e,n);else if(n=$_(t,e,n,r),n!==null){var s=Tt();an(n,t,r,s),uw(n,e,r)}}function tN(t,e,n){var r=wr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(lw(t))cw(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,c=i(a,n);if(s.hasEagerState=!0,s.eagerState=c,cn(c,a)){var u=e.interleaved;u===null?(s.next=s,gf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=$_(t,e,s,r),n!==null&&(s=Tt(),an(n,t,r,s),uw(n,e,r))}}function lw(t){var e=t.alternate;return t===ke||e!==null&&e===ke}function cw(t,e){fa=Jl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function uw(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,tf(t,n)}}var Zl={readContext:Gt,useCallback:ut,useContext:ut,useEffect:ut,useImperativeHandle:ut,useInsertionEffect:ut,useLayoutEffect:ut,useMemo:ut,useReducer:ut,useRef:ut,useState:ut,useDebugValue:ut,useDeferredValue:ut,useTransition:ut,useMutableSource:ut,useSyncExternalStore:ut,useId:ut,unstable_isNewReconciler:!1},nN={readContext:Gt,useCallback:function(t,e){return hn().memoizedState=[t,e===void 0?null:e],t},useContext:Gt,useEffect:jg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,El(4194308,4,nw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return El(4194308,4,t,e)},useInsertionEffect:function(t,e){return El(4,2,t,e)},useMemo:function(t,e){var n=hn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=hn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=eN.bind(null,ke,t),[r.memoizedState,t]},useRef:function(t){var e=hn();return t={current:t},e.memoizedState=t},useState:kg,useDebugValue:Nf,useDeferredValue:function(t){return hn().memoizedState=t},useTransition:function(){var t=kg(!1),e=t[0];return t=Zx.bind(null,t[1]),hn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ke,s=hn();if(Re){if(n===void 0)throw Error($(407));n=n()}else{if(n=e(),Xe===null)throw Error($(349));as&30||K_(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,jg(Y_.bind(null,r,i,t),[t]),r.flags|=2048,Fa(9,Q_.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=hn(),e=Xe.identifierPrefix;if(Re){var n=Pn,r=Cn;n=(r&~(1<<32-sn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=La++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Jx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},rN={readContext:Gt,useCallback:sw,useContext:Gt,useEffect:xf,useImperativeHandle:rw,useInsertionEffect:ew,useLayoutEffect:tw,useMemo:iw,useReducer:td,useRef:Z_,useState:function(){return td(Ma)},useDebugValue:Nf,useDeferredValue:function(t){var e=Kt();return aw(e,We.memoizedState,t)},useTransition:function(){var t=td(Ma)[0],e=Kt().memoizedState;return[t,e]},useMutableSource:H_,useSyncExternalStore:G_,useId:ow,unstable_isNewReconciler:!1},sN={readContext:Gt,useCallback:sw,useContext:Gt,useEffect:xf,useImperativeHandle:rw,useInsertionEffect:ew,useLayoutEffect:tw,useMemo:iw,useReducer:nd,useRef:Z_,useState:function(){return nd(Ma)},useDebugValue:Nf,useDeferredValue:function(t){var e=Kt();return We===null?e.memoizedState=t:aw(e,We.memoizedState,t)},useTransition:function(){var t=nd(Ma)[0],e=Kt().memoizedState;return[t,e]},useMutableSource:H_,useSyncExternalStore:G_,useId:ow,unstable_isNewReconciler:!1};function Zt(t,e){if(t&&t.defaultProps){e=be({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Xd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:be({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var kc={isMounted:function(t){return(t=t._reactInternals)?vs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Tt(),s=wr(t),i=On(r,s);i.payload=e,n!=null&&(i.callback=n),e=yr(t,i,s),e!==null&&(an(e,t,s,r),_l(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Tt(),s=wr(t),i=On(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=yr(t,i,s),e!==null&&(an(e,t,s,r),_l(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Tt(),r=wr(t),s=On(n,r);s.tag=2,e!=null&&(s.callback=e),e=yr(t,s,r),e!==null&&(an(e,t,r,n),_l(e,t,r))}};function bg(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!ka(n,r)||!ka(s,i):!0}function dw(t,e,n){var r=!1,s=Ar,i=e.contextType;return typeof i=="object"&&i!==null?i=Gt(i):(s=Ct(e)?ss:vt.current,r=e.contextTypes,i=(r=r!=null)?ti(t,s):Ar),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=kc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Og(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&kc.enqueueReplaceState(e,e.state,null)}function Jd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},vf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Gt(i):(i=Ct(e)?ss:vt.current,s.context=ti(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Xd(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&kc.enqueueReplaceState(s,s.state,null),Yl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ii(t,e){try{var n="",r=e;do n+=jT(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function rd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Zd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var iN=typeof WeakMap=="function"?WeakMap:Map;function hw(t,e,n){n=On(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){tc||(tc=!0,ch=r),Zd(t,e)},n}function fw(t,e,n){n=On(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Zd(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Zd(t,e),typeof r!="function"&&(_r===null?_r=new Set([this]):_r.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Dg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new iN;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=_N.bind(null,t,e,n),e.then(t,t))}function Vg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Lg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=On(-1,1),e.tag=2,yr(n,e,1))),n.lanes|=1),t)}var aN=qn.ReactCurrentOwner,At=!1;function Et(t,e,n,r){e.child=t===null?B_(e,null,n,r):ri(e,t.child,n,r)}function Mg(t,e,n,r,s){n=n.render;var i=e.ref;return Gs(e,s),r=If(t,e,n,r,i,s),n=Tf(),t!==null&&!At?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Fn(t,e,s)):(Re&&n&&uf(e),e.flags|=1,Et(t,e,r,s),e.child)}function Fg(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!bf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,pw(t,e,i,r,s)):(t=Nl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:ka,n(a,r)&&t.ref===e.ref)return Fn(t,e,s)}return e.flags|=1,t=Er(i,r),t.ref=e.ref,t.return=e,e.child=t}function pw(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(ka(i,r)&&t.ref===e.ref)if(At=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(At=!0);else return e.lanes=t.lanes,Fn(t,e,s)}return eh(t,e,n,r,s)}function mw(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xe(zs,bt),bt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,xe(zs,bt),bt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,xe(zs,bt),bt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,xe(zs,bt),bt|=r;return Et(t,e,s,n),e.child}function gw(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function eh(t,e,n,r,s){var i=Ct(n)?ss:vt.current;return i=ti(e,i),Gs(e,s),n=If(t,e,n,r,i,s),r=Tf(),t!==null&&!At?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Fn(t,e,s)):(Re&&r&&uf(e),e.flags|=1,Et(t,e,n,s),e.child)}function Ug(t,e,n,r,s){if(Ct(n)){var i=!0;ql(e)}else i=!1;if(Gs(e,s),e.stateNode===null)Il(t,e),dw(e,n,r),Jd(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,c=e.memoizedProps;a.props=c;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=Gt(d):(d=Ct(n)?ss:vt.current,d=ti(e,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==r||u!==d)&&Og(e,a,r,d),nr=!1;var m=e.memoizedState;a.state=m,Yl(e,r,a,s),u=e.memoizedState,c!==r||m!==u||Rt.current||nr?(typeof f=="function"&&(Xd(e,n,f,r),u=e.memoizedState),(c=nr||bg(e,n,c,r,m,u,d))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=d,r=c):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,W_(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:Zt(e.type,c),a.props=d,p=e.pendingProps,m=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Gt(u):(u=Ct(n)?ss:vt.current,u=ti(e,u));var E=n.getDerivedStateFromProps;(f=typeof E=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==p||m!==u)&&Og(e,a,r,u),nr=!1,m=e.memoizedState,a.state=m,Yl(e,r,a,s);var y=e.memoizedState;c!==p||m!==y||Rt.current||nr?(typeof E=="function"&&(Xd(e,n,E,r),y=e.memoizedState),(d=nr||bg(e,n,d,r,m,y,u)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,y,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,y,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),a.props=r,a.state=y,a.context=u,r=d):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return th(t,e,n,r,i,s)}function th(t,e,n,r,s,i){gw(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&Ng(e,n,!1),Fn(t,e,i);r=e.stateNode,aN.current=e;var c=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=ri(e,t.child,null,i),e.child=ri(e,null,c,i)):Et(t,e,c,i),e.memoizedState=r.state,s&&Ng(e,n,!0),e.child}function vw(t){var e=t.stateNode;e.pendingContext?xg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&xg(t,e.context,!1),yf(t,e.containerInfo)}function zg(t,e,n,r,s){return ni(),hf(s),e.flags|=256,Et(t,e,n,r),e.child}var nh={dehydrated:null,treeContext:null,retryLane:0};function rh(t){return{baseLanes:t,cachePool:null,transitions:null}}function yw(t,e,n){var r=e.pendingProps,s=Pe.current,i=!1,a=(e.flags&128)!==0,c;if((c=a)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),xe(Pe,s&1),t===null)return Qd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Oc(a,r,0,null),t=ts(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=rh(n),e.memoizedState=nh,t):Sf(e,a));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return oN(t,e,a,r,c,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Er(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Er(c,i):(i=ts(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?rh(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=nh,r}return i=t.child,t=i.sibling,r=Er(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Sf(t,e){return e=Oc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function rl(t,e,n,r){return r!==null&&hf(r),ri(e,t.child,null,n),t=Sf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function oN(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=rd(Error($(422))),rl(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Oc({mode:"visible",children:r.children},s,0,null),i=ts(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ri(e,t.child,null,a),e.child.memoizedState=rh(a),e.memoizedState=nh,i);if(!(e.mode&1))return rl(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error($(419)),r=rd(i,r,void 0),rl(t,e,a,r)}if(c=(a&t.childLanes)!==0,At||c){if(r=Xe,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Mn(t,s),an(r,t,s,-1))}return jf(),r=rd(Error($(421))),rl(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=wN.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ot=vr(s.nextSibling),Vt=e,Re=!0,tn=null,t!==null&&($t[Wt++]=Cn,$t[Wt++]=Pn,$t[Wt++]=is,Cn=t.id,Pn=t.overflow,is=e),e=Sf(e,r.children),e.flags|=4096,e)}function Bg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Yd(t.return,e,n)}function sd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function _w(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Et(t,e,r.children,n),r=Pe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Bg(t,n,e);else if(t.tag===19)Bg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(xe(Pe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Xl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),sd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Xl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}sd(e,!0,n,null,i);break;case"together":sd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Il(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Fn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),os|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error($(153));if(e.child!==null){for(t=e.child,n=Er(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Er(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function lN(t,e,n){switch(e.tag){case 3:vw(e),ni();break;case 5:q_(e);break;case 1:Ct(e.type)&&ql(e);break;case 4:yf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;xe(Kl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(xe(Pe,Pe.current&1),e.flags|=128,null):n&e.child.childLanes?yw(t,e,n):(xe(Pe,Pe.current&1),t=Fn(t,e,n),t!==null?t.sibling:null);xe(Pe,Pe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return _w(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),xe(Pe,Pe.current),r)break;return null;case 22:case 23:return e.lanes=0,mw(t,e,n)}return Fn(t,e,n)}var ww,sh,Ew,Iw;ww=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};sh=function(){};Ew=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Xr(mn.current);var i=null;switch(n){case"input":s=Sd(t,s),r=Sd(t,r),i=[];break;case"select":s=be({},s,{value:void 0}),r=be({},r,{value:void 0}),i=[];break;case"textarea":s=Cd(t,s),r=Cd(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=$l)}kd(n,r);var a;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(xa.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(a in c)!c.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&c[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(xa.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Se("scroll",t),i||c===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Iw=function(t,e,n,r){n!==r&&(e.flags|=4)};function Qi(t,e){if(!Re)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function dt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function cN(t,e,n){var r=e.pendingProps;switch(df(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dt(e),null;case 1:return Ct(e.type)&&Wl(),dt(e),null;case 3:return r=e.stateNode,si(),Ae(Rt),Ae(vt),wf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(tl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,tn!==null&&(hh(tn),tn=null))),sh(t,e),dt(e),null;case 5:_f(e);var s=Xr(Va.current);if(n=e.type,t!==null&&e.stateNode!=null)Ew(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error($(166));return dt(e),null}if(t=Xr(mn.current),tl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[fn]=e,r[Oa]=i,t=(e.mode&1)!==0,n){case"dialog":Se("cancel",r),Se("close",r);break;case"iframe":case"object":case"embed":Se("load",r);break;case"video":case"audio":for(s=0;s<na.length;s++)Se(na[s],r);break;case"source":Se("error",r);break;case"img":case"image":case"link":Se("error",r),Se("load",r);break;case"details":Se("toggle",r);break;case"input":Xm(r,i),Se("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Se("invalid",r);break;case"textarea":Zm(r,i),Se("invalid",r)}kd(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var c=i[a];a==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&el(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&el(r.textContent,c,t),s=["children",""+c]):xa.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&Se("scroll",r)}switch(n){case"input":Ho(r),Jm(r,i,!0);break;case"textarea":Ho(r),eg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=$l)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Yy(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[fn]=e,t[Oa]=r,ww(t,e,!1,!1),e.stateNode=t;e:{switch(a=jd(n,r),n){case"dialog":Se("cancel",t),Se("close",t),s=r;break;case"iframe":case"object":case"embed":Se("load",t),s=r;break;case"video":case"audio":for(s=0;s<na.length;s++)Se(na[s],t);s=r;break;case"source":Se("error",t),s=r;break;case"img":case"image":case"link":Se("error",t),Se("load",t),s=r;break;case"details":Se("toggle",t),s=r;break;case"input":Xm(t,r),s=Sd(t,r),Se("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=be({},r,{value:void 0}),Se("invalid",t);break;case"textarea":Zm(t,r),s=Cd(t,r),Se("invalid",t);break;default:s=r}kd(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?Zy(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Xy(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Na(t,u):typeof u=="number"&&Na(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(xa.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Se("scroll",t):u!=null&&Qh(t,i,u,a))}switch(n){case"input":Ho(t),Jm(t,r,!1);break;case"textarea":Ho(t),eg(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Sr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?$s(t,!!r.multiple,i,!1):r.defaultValue!=null&&$s(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=$l)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return dt(e),null;case 6:if(t&&e.stateNode!=null)Iw(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error($(166));if(n=Xr(Va.current),Xr(mn.current),tl(e)){if(r=e.stateNode,n=e.memoizedProps,r[fn]=e,(i=r.nodeValue!==n)&&(t=Vt,t!==null))switch(t.tag){case 3:el(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&el(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[fn]=e,e.stateNode=r}return dt(e),null;case 13:if(Ae(Pe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Re&&Ot!==null&&e.mode&1&&!(e.flags&128))U_(),ni(),e.flags|=98560,i=!1;else if(i=tl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error($(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));i[fn]=e}else ni(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;dt(e),i=!1}else tn!==null&&(hh(tn),tn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Pe.current&1?qe===0&&(qe=3):jf())),e.updateQueue!==null&&(e.flags|=4),dt(e),null);case 4:return si(),sh(t,e),t===null&&ja(e.stateNode.containerInfo),dt(e),null;case 10:return mf(e.type._context),dt(e),null;case 17:return Ct(e.type)&&Wl(),dt(e),null;case 19:if(Ae(Pe),i=e.memoizedState,i===null)return dt(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Qi(i,!1);else{if(qe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Xl(t),a!==null){for(e.flags|=128,Qi(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return xe(Pe,Pe.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ue()>ai&&(e.flags|=128,r=!0,Qi(i,!1),e.lanes=4194304)}else{if(!r)if(t=Xl(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Qi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Re)return dt(e),null}else 2*Ue()-i.renderingStartTime>ai&&n!==1073741824&&(e.flags|=128,r=!0,Qi(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ue(),e.sibling=null,n=Pe.current,xe(Pe,r?n&1|2:n&1),e):(dt(e),null);case 22:case 23:return kf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?bt&1073741824&&(dt(e),e.subtreeFlags&6&&(e.flags|=8192)):dt(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function uN(t,e){switch(df(e),e.tag){case 1:return Ct(e.type)&&Wl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return si(),Ae(Rt),Ae(vt),wf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _f(e),null;case 13:if(Ae(Pe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error($(340));ni()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ae(Pe),null;case 4:return si(),null;case 10:return mf(e.type._context),null;case 22:case 23:return kf(),null;case 24:return null;default:return null}}var sl=!1,pt=!1,dN=typeof WeakSet=="function"?WeakSet:Set,K=null;function Us(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Le(t,e,r)}else n.current=null}function ih(t,e,n){try{n()}catch(r){Le(t,e,r)}}var $g=!1;function hN(t,e){if(Bd=Ul,t=A_(),cf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,c=-1,u=-1,d=0,f=0,p=t,m=null;t:for(;;){for(var E;p!==n||s!==0&&p.nodeType!==3||(c=a+s),p!==i||r!==0&&p.nodeType!==3||(u=a+r),p.nodeType===3&&(a+=p.nodeValue.length),(E=p.firstChild)!==null;)m=p,p=E;for(;;){if(p===t)break t;if(m===n&&++d===s&&(c=a),m===i&&++f===r&&(u=a),(E=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=E}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for($d={focusedElem:t,selectionRange:n},Ul=!1,K=e;K!==null;)if(e=K,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,K=t;else for(;K!==null;){e=K;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,N=y.memoizedState,I=e.stateNode,w=I.getSnapshotBeforeUpdate(e.elementType===e.type?x:Zt(e.type,x),N);I.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(k){Le(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,K=t;break}K=e.return}return y=$g,$g=!1,y}function pa(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&ih(e,n,i)}s=s.next}while(s!==r)}}function jc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ah(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Tw(t){var e=t.alternate;e!==null&&(t.alternate=null,Tw(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[fn],delete e[Oa],delete e[Hd],delete e[Kx],delete e[Qx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function xw(t){return t.tag===5||t.tag===3||t.tag===4}function Wg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||xw(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function oh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=$l));else if(r!==4&&(t=t.child,t!==null))for(oh(t,e,n),t=t.sibling;t!==null;)oh(t,e,n),t=t.sibling}function lh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(lh(t,e,n),t=t.sibling;t!==null;)lh(t,e,n),t=t.sibling}var Ze=null,en=!1;function Jn(t,e,n){for(n=n.child;n!==null;)Nw(t,e,n),n=n.sibling}function Nw(t,e,n){if(pn&&typeof pn.onCommitFiberUnmount=="function")try{pn.onCommitFiberUnmount(xc,n)}catch{}switch(n.tag){case 5:pt||Us(n,e);case 6:var r=Ze,s=en;Ze=null,Jn(t,e,n),Ze=r,en=s,Ze!==null&&(en?(t=Ze,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ze.removeChild(n.stateNode));break;case 18:Ze!==null&&(en?(t=Ze,n=n.stateNode,t.nodeType===8?Xu(t.parentNode,n):t.nodeType===1&&Xu(t,n),Ca(t)):Xu(Ze,n.stateNode));break;case 4:r=Ze,s=en,Ze=n.stateNode.containerInfo,en=!0,Jn(t,e,n),Ze=r,en=s;break;case 0:case 11:case 14:case 15:if(!pt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&ih(n,e,a),s=s.next}while(s!==r)}Jn(t,e,n);break;case 1:if(!pt&&(Us(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Le(n,e,c)}Jn(t,e,n);break;case 21:Jn(t,e,n);break;case 22:n.mode&1?(pt=(r=pt)||n.memoizedState!==null,Jn(t,e,n),pt=r):Jn(t,e,n);break;default:Jn(t,e,n)}}function qg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new dN),e.forEach(function(r){var s=EN.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Jt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,c=a;e:for(;c!==null;){switch(c.tag){case 5:Ze=c.stateNode,en=!1;break e;case 3:Ze=c.stateNode.containerInfo,en=!0;break e;case 4:Ze=c.stateNode.containerInfo,en=!0;break e}c=c.return}if(Ze===null)throw Error($(160));Nw(i,a,s),Ze=null,en=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Le(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Sw(e,t),e=e.sibling}function Sw(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Jt(e,t),dn(t),r&4){try{pa(3,t,t.return),jc(3,t)}catch(x){Le(t,t.return,x)}try{pa(5,t,t.return)}catch(x){Le(t,t.return,x)}}break;case 1:Jt(e,t),dn(t),r&512&&n!==null&&Us(n,n.return);break;case 5:if(Jt(e,t),dn(t),r&512&&n!==null&&Us(n,n.return),t.flags&32){var s=t.stateNode;try{Na(s,"")}catch(x){Le(t,t.return,x)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&Ky(s,i),jd(c,a);var d=jd(c,i);for(a=0;a<u.length;a+=2){var f=u[a],p=u[a+1];f==="style"?Zy(s,p):f==="dangerouslySetInnerHTML"?Xy(s,p):f==="children"?Na(s,p):Qh(s,f,p,d)}switch(c){case"input":Ad(s,i);break;case"textarea":Qy(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var E=i.value;E!=null?$s(s,!!i.multiple,E,!1):m!==!!i.multiple&&(i.defaultValue!=null?$s(s,!!i.multiple,i.defaultValue,!0):$s(s,!!i.multiple,i.multiple?[]:"",!1))}s[Oa]=i}catch(x){Le(t,t.return,x)}}break;case 6:if(Jt(e,t),dn(t),r&4){if(t.stateNode===null)throw Error($(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(x){Le(t,t.return,x)}}break;case 3:if(Jt(e,t),dn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ca(e.containerInfo)}catch(x){Le(t,t.return,x)}break;case 4:Jt(e,t),dn(t);break;case 13:Jt(e,t),dn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Cf=Ue())),r&4&&qg(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(pt=(d=pt)||f,Jt(e,t),pt=d):Jt(e,t),dn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(K=t,f=t.child;f!==null;){for(p=K=f;K!==null;){switch(m=K,E=m.child,m.tag){case 0:case 11:case 14:case 15:pa(4,m,m.return);break;case 1:Us(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){Le(r,n,x)}}break;case 5:Us(m,m.return);break;case 22:if(m.memoizedState!==null){Gg(p);continue}}E!==null?(E.return=m,K=E):Gg(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=p.stateNode,u=p.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=Jy("display",a))}catch(x){Le(t,t.return,x)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(x){Le(t,t.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Jt(e,t),dn(t),r&4&&qg(t);break;case 21:break;default:Jt(e,t),dn(t)}}function dn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(xw(n)){var r=n;break e}n=n.return}throw Error($(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Na(s,""),r.flags&=-33);var i=Wg(t);lh(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,c=Wg(t);oh(t,c,a);break;default:throw Error($(161))}}catch(u){Le(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function fN(t,e,n){K=t,Aw(t)}function Aw(t,e,n){for(var r=(t.mode&1)!==0;K!==null;){var s=K,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||sl;if(!a){var c=s.alternate,u=c!==null&&c.memoizedState!==null||pt;c=sl;var d=pt;if(sl=a,(pt=u)&&!d)for(K=s;K!==null;)a=K,u=a.child,a.tag===22&&a.memoizedState!==null?Kg(s):u!==null?(u.return=a,K=u):Kg(s);for(;i!==null;)K=i,Aw(i),i=i.sibling;K=s,sl=c,pt=d}Hg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,K=i):Hg(t)}}function Hg(t){for(;K!==null;){var e=K;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:pt||jc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!pt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Zt(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Pg(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Pg(e,a,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&Ca(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}pt||e.flags&512&&ah(e)}catch(m){Le(e,e.return,m)}}if(e===t){K=null;break}if(n=e.sibling,n!==null){n.return=e.return,K=n;break}K=e.return}}function Gg(t){for(;K!==null;){var e=K;if(e===t){K=null;break}var n=e.sibling;if(n!==null){n.return=e.return,K=n;break}K=e.return}}function Kg(t){for(;K!==null;){var e=K;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{jc(4,e)}catch(u){Le(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Le(e,s,u)}}var i=e.return;try{ah(e)}catch(u){Le(e,i,u)}break;case 5:var a=e.return;try{ah(e)}catch(u){Le(e,a,u)}}}catch(u){Le(e,e.return,u)}if(e===t){K=null;break}var c=e.sibling;if(c!==null){c.return=e.return,K=c;break}K=e.return}}var pN=Math.ceil,ec=qn.ReactCurrentDispatcher,Af=qn.ReactCurrentOwner,Ht=qn.ReactCurrentBatchConfig,fe=0,Xe=null,Be=null,nt=0,bt=0,zs=br(0),qe=0,Ua=null,os=0,bc=0,Rf=0,ma=null,St=null,Cf=0,ai=1/0,Sn=null,tc=!1,ch=null,_r=null,il=!1,dr=null,nc=0,ga=0,uh=null,Tl=-1,xl=0;function Tt(){return fe&6?Ue():Tl!==-1?Tl:Tl=Ue()}function wr(t){return t.mode&1?fe&2&&nt!==0?nt&-nt:Xx.transition!==null?(xl===0&&(xl=d_()),xl):(t=_e,t!==0||(t=window.event,t=t===void 0?16:y_(t.type)),t):1}function an(t,e,n,r){if(50<ga)throw ga=0,uh=null,Error($(185));io(t,n,r),(!(fe&2)||t!==Xe)&&(t===Xe&&(!(fe&2)&&(bc|=n),qe===4&&sr(t,nt)),Pt(t,r),n===1&&fe===0&&!(e.mode&1)&&(ai=Ue()+500,Cc&&Or()))}function Pt(t,e){var n=t.callbackNode;XT(t,e);var r=Fl(t,t===Xe?nt:0);if(r===0)n!==null&&rg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&rg(n),e===1)t.tag===0?Yx(Qg.bind(null,t)):L_(Qg.bind(null,t)),Hx(function(){!(fe&6)&&Or()}),n=null;else{switch(h_(r)){case 1:n=ef;break;case 4:n=c_;break;case 16:n=Ml;break;case 536870912:n=u_;break;default:n=Ml}n=Dw(n,Rw.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Rw(t,e){if(Tl=-1,xl=0,fe&6)throw Error($(327));var n=t.callbackNode;if(Ks()&&t.callbackNode!==n)return null;var r=Fl(t,t===Xe?nt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=rc(t,r);else{e=r;var s=fe;fe|=2;var i=Pw();(Xe!==t||nt!==e)&&(Sn=null,ai=Ue()+500,es(t,e));do try{vN();break}catch(c){Cw(t,c)}while(!0);pf(),ec.current=i,fe=s,Be!==null?e=0:(Xe=null,nt=0,e=qe)}if(e!==0){if(e===2&&(s=Ld(t),s!==0&&(r=s,e=dh(t,s))),e===1)throw n=Ua,es(t,0),sr(t,r),Pt(t,Ue()),n;if(e===6)sr(t,r);else{if(s=t.current.alternate,!(r&30)&&!mN(s)&&(e=rc(t,r),e===2&&(i=Ld(t),i!==0&&(r=i,e=dh(t,i))),e===1))throw n=Ua,es(t,0),sr(t,r),Pt(t,Ue()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error($(345));case 2:Gr(t,St,Sn);break;case 3:if(sr(t,r),(r&130023424)===r&&(e=Cf+500-Ue(),10<e)){if(Fl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Tt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=qd(Gr.bind(null,t,St,Sn),e);break}Gr(t,St,Sn);break;case 4:if(sr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-sn(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=Ue()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*pN(r/1960))-r,10<r){t.timeoutHandle=qd(Gr.bind(null,t,St,Sn),r);break}Gr(t,St,Sn);break;case 5:Gr(t,St,Sn);break;default:throw Error($(329))}}}return Pt(t,Ue()),t.callbackNode===n?Rw.bind(null,t):null}function dh(t,e){var n=ma;return t.current.memoizedState.isDehydrated&&(es(t,e).flags|=256),t=rc(t,e),t!==2&&(e=St,St=n,e!==null&&hh(e)),t}function hh(t){St===null?St=t:St.push.apply(St,t)}function mN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!cn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function sr(t,e){for(e&=~Rf,e&=~bc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-sn(e),r=1<<n;t[n]=-1,e&=~r}}function Qg(t){if(fe&6)throw Error($(327));Ks();var e=Fl(t,0);if(!(e&1))return Pt(t,Ue()),null;var n=rc(t,e);if(t.tag!==0&&n===2){var r=Ld(t);r!==0&&(e=r,n=dh(t,r))}if(n===1)throw n=Ua,es(t,0),sr(t,e),Pt(t,Ue()),n;if(n===6)throw Error($(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Gr(t,St,Sn),Pt(t,Ue()),null}function Pf(t,e){var n=fe;fe|=1;try{return t(e)}finally{fe=n,fe===0&&(ai=Ue()+500,Cc&&Or())}}function ls(t){dr!==null&&dr.tag===0&&!(fe&6)&&Ks();var e=fe;fe|=1;var n=Ht.transition,r=_e;try{if(Ht.transition=null,_e=1,t)return t()}finally{_e=r,Ht.transition=n,fe=e,!(fe&6)&&Or()}}function kf(){bt=zs.current,Ae(zs)}function es(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,qx(n)),Be!==null)for(n=Be.return;n!==null;){var r=n;switch(df(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Wl();break;case 3:si(),Ae(Rt),Ae(vt),wf();break;case 5:_f(r);break;case 4:si();break;case 13:Ae(Pe);break;case 19:Ae(Pe);break;case 10:mf(r.type._context);break;case 22:case 23:kf()}n=n.return}if(Xe=t,Be=t=Er(t.current,null),nt=bt=e,qe=0,Ua=null,Rf=bc=os=0,St=ma=null,Yr!==null){for(e=0;e<Yr.length;e++)if(n=Yr[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}Yr=null}return t}function Cw(t,e){do{var n=Be;try{if(pf(),wl.current=Zl,Jl){for(var r=ke.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Jl=!1}if(as=0,Qe=We=ke=null,fa=!1,La=0,Af.current=null,n===null||n.return===null){qe=1,Ua=e,Be=null;break}e:{var i=t,a=n.return,c=n,u=e;if(e=nt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=c,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var E=Vg(a);if(E!==null){E.flags&=-257,Lg(E,a,c,i,e),E.mode&1&&Dg(i,d,e),e=E,u=d;var y=e.updateQueue;if(y===null){var x=new Set;x.add(u),e.updateQueue=x}else y.add(u);break e}else{if(!(e&1)){Dg(i,d,e),jf();break e}u=Error($(426))}}else if(Re&&c.mode&1){var N=Vg(a);if(N!==null){!(N.flags&65536)&&(N.flags|=256),Lg(N,a,c,i,e),hf(ii(u,c));break e}}i=u=ii(u,c),qe!==4&&(qe=2),ma===null?ma=[i]:ma.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var I=hw(i,u,e);Cg(i,I);break e;case 1:c=u;var w=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(_r===null||!_r.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=fw(i,c,e);Cg(i,k);break e}}i=i.return}while(i!==null)}jw(n)}catch(O){e=O,Be===n&&n!==null&&(Be=n=n.return);continue}break}while(!0)}function Pw(){var t=ec.current;return ec.current=Zl,t===null?Zl:t}function jf(){(qe===0||qe===3||qe===2)&&(qe=4),Xe===null||!(os&268435455)&&!(bc&268435455)||sr(Xe,nt)}function rc(t,e){var n=fe;fe|=2;var r=Pw();(Xe!==t||nt!==e)&&(Sn=null,es(t,e));do try{gN();break}catch(s){Cw(t,s)}while(!0);if(pf(),fe=n,ec.current=r,Be!==null)throw Error($(261));return Xe=null,nt=0,qe}function gN(){for(;Be!==null;)kw(Be)}function vN(){for(;Be!==null&&!BT();)kw(Be)}function kw(t){var e=Ow(t.alternate,t,bt);t.memoizedProps=t.pendingProps,e===null?jw(t):Be=e,Af.current=null}function jw(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=uN(n,e),n!==null){n.flags&=32767,Be=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qe=6,Be=null;return}}else if(n=cN(n,e,bt),n!==null){Be=n;return}if(e=e.sibling,e!==null){Be=e;return}Be=e=t}while(e!==null);qe===0&&(qe=5)}function Gr(t,e,n){var r=_e,s=Ht.transition;try{Ht.transition=null,_e=1,yN(t,e,n,r)}finally{Ht.transition=s,_e=r}return null}function yN(t,e,n,r){do Ks();while(dr!==null);if(fe&6)throw Error($(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error($(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(JT(t,i),t===Xe&&(Be=Xe=null,nt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||il||(il=!0,Dw(Ml,function(){return Ks(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ht.transition,Ht.transition=null;var a=_e;_e=1;var c=fe;fe|=4,Af.current=null,hN(t,n),Sw(n,t),Mx($d),Ul=!!Bd,$d=Bd=null,t.current=n,fN(n),$T(),fe=c,_e=a,Ht.transition=i}else t.current=n;if(il&&(il=!1,dr=t,nc=s),i=t.pendingLanes,i===0&&(_r=null),HT(n.stateNode),Pt(t,Ue()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(tc)throw tc=!1,t=ch,ch=null,t;return nc&1&&t.tag!==0&&Ks(),i=t.pendingLanes,i&1?t===uh?ga++:(ga=0,uh=t):ga=0,Or(),null}function Ks(){if(dr!==null){var t=h_(nc),e=Ht.transition,n=_e;try{if(Ht.transition=null,_e=16>t?16:t,dr===null)var r=!1;else{if(t=dr,dr=null,nc=0,fe&6)throw Error($(331));var s=fe;for(fe|=4,K=t.current;K!==null;){var i=K,a=i.child;if(K.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(K=d;K!==null;){var f=K;switch(f.tag){case 0:case 11:case 15:pa(8,f,i)}var p=f.child;if(p!==null)p.return=f,K=p;else for(;K!==null;){f=K;var m=f.sibling,E=f.return;if(Tw(f),f===d){K=null;break}if(m!==null){m.return=E,K=m;break}K=E}}}var y=i.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var N=x.sibling;x.sibling=null,x=N}while(x!==null)}}K=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,K=a;else e:for(;K!==null;){if(i=K,i.flags&2048)switch(i.tag){case 0:case 11:case 15:pa(9,i,i.return)}var I=i.sibling;if(I!==null){I.return=i.return,K=I;break e}K=i.return}}var w=t.current;for(K=w;K!==null;){a=K;var T=a.child;if(a.subtreeFlags&2064&&T!==null)T.return=a,K=T;else e:for(a=w;K!==null;){if(c=K,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:jc(9,c)}}catch(O){Le(c,c.return,O)}if(c===a){K=null;break e}var k=c.sibling;if(k!==null){k.return=c.return,K=k;break e}K=c.return}}if(fe=s,Or(),pn&&typeof pn.onPostCommitFiberRoot=="function")try{pn.onPostCommitFiberRoot(xc,t)}catch{}r=!0}return r}finally{_e=n,Ht.transition=e}}return!1}function Yg(t,e,n){e=ii(n,e),e=hw(t,e,1),t=yr(t,e,1),e=Tt(),t!==null&&(io(t,1,e),Pt(t,e))}function Le(t,e,n){if(t.tag===3)Yg(t,t,n);else for(;e!==null;){if(e.tag===3){Yg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(_r===null||!_r.has(r))){t=ii(n,t),t=fw(e,t,1),e=yr(e,t,1),t=Tt(),e!==null&&(io(e,1,t),Pt(e,t));break}}e=e.return}}function _N(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Tt(),t.pingedLanes|=t.suspendedLanes&n,Xe===t&&(nt&n)===n&&(qe===4||qe===3&&(nt&130023424)===nt&&500>Ue()-Cf?es(t,0):Rf|=n),Pt(t,e)}function bw(t,e){e===0&&(t.mode&1?(e=Qo,Qo<<=1,!(Qo&130023424)&&(Qo=4194304)):e=1);var n=Tt();t=Mn(t,e),t!==null&&(io(t,e,n),Pt(t,n))}function wN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),bw(t,n)}function EN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(e),bw(t,n)}var Ow;Ow=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Rt.current)At=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return At=!1,lN(t,e,n);At=!!(t.flags&131072)}else At=!1,Re&&e.flags&1048576&&M_(e,Gl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Il(t,e),t=e.pendingProps;var s=ti(e,vt.current);Gs(e,n),s=If(null,e,r,t,s,n);var i=Tf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ct(r)?(i=!0,ql(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,vf(e),s.updater=kc,e.stateNode=s,s._reactInternals=e,Jd(e,r,t,n),e=th(null,e,r,!0,i,n)):(e.tag=0,Re&&i&&uf(e),Et(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Il(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=TN(r),t=Zt(r,t),s){case 0:e=eh(null,e,r,t,n);break e;case 1:e=Ug(null,e,r,t,n);break e;case 11:e=Mg(null,e,r,t,n);break e;case 14:e=Fg(null,e,r,Zt(r.type,t),n);break e}throw Error($(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zt(r,s),eh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zt(r,s),Ug(t,e,r,s,n);case 3:e:{if(vw(e),t===null)throw Error($(387));r=e.pendingProps,i=e.memoizedState,s=i.element,W_(t,e),Yl(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ii(Error($(423)),e),e=zg(t,e,r,n,s);break e}else if(r!==s){s=ii(Error($(424)),e),e=zg(t,e,r,n,s);break e}else for(Ot=vr(e.stateNode.containerInfo.firstChild),Vt=e,Re=!0,tn=null,n=B_(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ni(),r===s){e=Fn(t,e,n);break e}Et(t,e,r,n)}e=e.child}return e;case 5:return q_(e),t===null&&Qd(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Wd(r,s)?a=null:i!==null&&Wd(r,i)&&(e.flags|=32),gw(t,e),Et(t,e,a,n),e.child;case 6:return t===null&&Qd(e),null;case 13:return yw(t,e,n);case 4:return yf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ri(e,null,r,n):Et(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zt(r,s),Mg(t,e,r,s,n);case 7:return Et(t,e,e.pendingProps,n),e.child;case 8:return Et(t,e,e.pendingProps.children,n),e.child;case 12:return Et(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,xe(Kl,r._currentValue),r._currentValue=a,i!==null)if(cn(i.value,a)){if(i.children===s.children&&!Rt.current){e=Fn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){a=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=On(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Yd(i.return,n,e),c.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error($(341));a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Yd(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Et(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Gs(e,n),s=Gt(s),r=r(s),e.flags|=1,Et(t,e,r,n),e.child;case 14:return r=e.type,s=Zt(r,e.pendingProps),s=Zt(r.type,s),Fg(t,e,r,s,n);case 15:return pw(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zt(r,s),Il(t,e),e.tag=1,Ct(r)?(t=!0,ql(e)):t=!1,Gs(e,n),dw(e,r,s),Jd(e,r,s,n),th(null,e,r,!0,t,n);case 19:return _w(t,e,n);case 22:return mw(t,e,n)}throw Error($(156,e.tag))};function Dw(t,e){return l_(t,e)}function IN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qt(t,e,n,r){return new IN(t,e,n,r)}function bf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function TN(t){if(typeof t=="function")return bf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Xh)return 11;if(t===Jh)return 14}return 2}function Er(t,e){var n=t.alternate;return n===null?(n=qt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Nl(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")bf(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ks:return ts(n.children,s,i,e);case Yh:a=8,s|=8;break;case Id:return t=qt(12,n,e,s|2),t.elementType=Id,t.lanes=i,t;case Td:return t=qt(13,n,e,s),t.elementType=Td,t.lanes=i,t;case xd:return t=qt(19,n,e,s),t.elementType=xd,t.lanes=i,t;case qy:return Oc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $y:a=10;break e;case Wy:a=9;break e;case Xh:a=11;break e;case Jh:a=14;break e;case tr:a=16,r=null;break e}throw Error($(130,t==null?t:typeof t,""))}return e=qt(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ts(t,e,n,r){return t=qt(7,t,r,e),t.lanes=n,t}function Oc(t,e,n,r){return t=qt(22,t,r,e),t.elementType=qy,t.lanes=n,t.stateNode={isHidden:!1},t}function id(t,e,n){return t=qt(6,t,null,e),t.lanes=n,t}function ad(t,e,n){return e=qt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function xN(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Uu(0),this.expirationTimes=Uu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Uu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Of(t,e,n,r,s,i,a,c,u){return t=new xN(t,e,n,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=qt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vf(i),t}function NN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ps,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Vw(t){if(!t)return Ar;t=t._reactInternals;e:{if(vs(t)!==t||t.tag!==1)throw Error($(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ct(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(t.tag===1){var n=t.type;if(Ct(n))return V_(t,n,e)}return e}function Lw(t,e,n,r,s,i,a,c,u){return t=Of(n,r,!0,t,s,i,a,c,u),t.context=Vw(null),n=t.current,r=Tt(),s=wr(n),i=On(r,s),i.callback=e??null,yr(n,i,s),t.current.lanes=s,io(t,s,r),Pt(t,r),t}function Dc(t,e,n,r){var s=e.current,i=Tt(),a=wr(s);return n=Vw(n),e.context===null?e.context=n:e.pendingContext=n,e=On(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=yr(s,e,a),t!==null&&(an(t,s,a,i),_l(t,s,a)),a}function sc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Xg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Df(t,e){Xg(t,e),(t=t.alternate)&&Xg(t,e)}function SN(){return null}var Mw=typeof reportError=="function"?reportError:function(t){console.error(t)};function Vf(t){this._internalRoot=t}Vc.prototype.render=Vf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error($(409));Dc(t,e,null,null)};Vc.prototype.unmount=Vf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ls(function(){Dc(null,t,null,null)}),e[Ln]=null}};function Vc(t){this._internalRoot=t}Vc.prototype.unstable_scheduleHydration=function(t){if(t){var e=m_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<rr.length&&e!==0&&e<rr[n].priority;n++);rr.splice(n,0,t),n===0&&v_(t)}};function Lf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Lc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Jg(){}function AN(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=sc(a);i.call(d)}}var a=Lw(e,r,t,0,null,!1,!1,"",Jg);return t._reactRootContainer=a,t[Ln]=a.current,ja(t.nodeType===8?t.parentNode:t),ls(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=sc(u);c.call(d)}}var u=Of(t,0,!1,null,null,!1,!1,"",Jg);return t._reactRootContainer=u,t[Ln]=u.current,ja(t.nodeType===8?t.parentNode:t),ls(function(){Dc(e,u,n,r)}),u}function Mc(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var c=s;s=function(){var u=sc(a);c.call(u)}}Dc(e,a,t,s)}else a=AN(n,e,t,s,r);return sc(a)}f_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ta(e.pendingLanes);n!==0&&(tf(e,n|1),Pt(e,Ue()),!(fe&6)&&(ai=Ue()+500,Or()))}break;case 13:ls(function(){var r=Mn(t,1);if(r!==null){var s=Tt();an(r,t,1,s)}}),Df(t,1)}};nf=function(t){if(t.tag===13){var e=Mn(t,134217728);if(e!==null){var n=Tt();an(e,t,134217728,n)}Df(t,134217728)}};p_=function(t){if(t.tag===13){var e=wr(t),n=Mn(t,e);if(n!==null){var r=Tt();an(n,t,e,r)}Df(t,e)}};m_=function(){return _e};g_=function(t,e){var n=_e;try{return _e=t,e()}finally{_e=n}};Od=function(t,e,n){switch(e){case"input":if(Ad(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Rc(r);if(!s)throw Error($(90));Gy(r),Ad(r,s)}}}break;case"textarea":Qy(t,n);break;case"select":e=n.value,e!=null&&$s(t,!!n.multiple,e,!1)}};n_=Pf;r_=ls;var RN={usingClientEntryPoint:!1,Events:[oo,Ds,Rc,e_,t_,Pf]},Yi={findFiberByHostInstance:Qr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},CN={bundleType:Yi.bundleType,version:Yi.version,rendererPackageName:Yi.rendererPackageName,rendererConfig:Yi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=a_(t),t===null?null:t.stateNode},findFiberByHostInstance:Yi.findFiberByHostInstance||SN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{xc=al.inject(CN),pn=al}catch{}}Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RN;Ut.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lf(e))throw Error($(200));return NN(t,e,null,n)};Ut.createRoot=function(t,e){if(!Lf(t))throw Error($(299));var n=!1,r="",s=Mw;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Of(t,1,!1,null,null,n,!1,r,s),t[Ln]=e.current,ja(t.nodeType===8?t.parentNode:t),new Vf(e)};Ut.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error($(188)):(t=Object.keys(t).join(","),Error($(268,t)));return t=a_(e),t=t===null?null:t.stateNode,t};Ut.flushSync=function(t){return ls(t)};Ut.hydrate=function(t,e,n){if(!Lc(e))throw Error($(200));return Mc(null,t,e,!0,n)};Ut.hydrateRoot=function(t,e,n){if(!Lf(t))throw Error($(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=Mw;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=Lw(e,null,t,1,n??null,s,!1,i,a),t[Ln]=e.current,ja(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Vc(e)};Ut.render=function(t,e,n){if(!Lc(e))throw Error($(200));return Mc(null,t,e,!1,n)};Ut.unmountComponentAtNode=function(t){if(!Lc(t))throw Error($(40));return t._reactRootContainer?(ls(function(){Mc(null,null,t,!1,function(){t._reactRootContainer=null,t[Ln]=null})}),!0):!1};Ut.unstable_batchedUpdates=Pf;Ut.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Lc(n))throw Error($(200));if(t==null||t._reactInternals===void 0)throw Error($(38));return Mc(t,e,n,!1,r)};Ut.version="18.3.1-next-f1338f8080-20240426";function Fw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Fw)}catch(t){console.error(t)}}Fw(),Fy.exports=Ut;var Uw=Fy.exports,zw,Zg=Uw;zw=Zg.createRoot,Zg.hydrateRoot;/**
 * @remix-run/router v1.15.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function za(){return za=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},za.apply(this,arguments)}var hr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(hr||(hr={}));const ev="popstate";function PN(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:a,hash:c}=r.location;return fh("",{pathname:i,search:a,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:ic(s)}return jN(e,n,null,t)}function je(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Bw(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function kN(){return Math.random().toString(36).substr(2,8)}function tv(t,e){return{usr:t.state,key:t.key,idx:e}}function fh(t,e,n,r){return n===void 0&&(n=null),za({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?_i(e):e,{state:n,key:e&&e.key||r||kN()})}function ic(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function _i(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function jN(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,c=hr.Pop,u=null,d=f();d==null&&(d=0,a.replaceState(za({},a.state,{idx:d}),""));function f(){return(a.state||{idx:null}).idx}function p(){c=hr.Pop;let N=f(),I=N==null?null:N-d;d=N,u&&u({action:c,location:x.location,delta:I})}function m(N,I){c=hr.Push;let w=fh(x.location,N,I);d=f()+1;let T=tv(w,d),k=x.createHref(w);try{a.pushState(T,"",k)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(k)}i&&u&&u({action:c,location:x.location,delta:1})}function E(N,I){c=hr.Replace;let w=fh(x.location,N,I);d=f();let T=tv(w,d),k=x.createHref(w);a.replaceState(T,"",k),i&&u&&u({action:c,location:x.location,delta:0})}function y(N){let I=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof N=="string"?N:ic(N);return w=w.replace(/ $/,"%20"),je(I,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,I)}let x={get action(){return c},get location(){return t(s,a)},listen(N){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(ev,p),u=N,()=>{s.removeEventListener(ev,p),u=null}},createHref(N){return e(s,N)},createURL:y,encodeLocation(N){let I=y(N);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:m,replace:E,go(N){return a.go(N)}};return x}var nv;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(nv||(nv={}));function bN(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?_i(e):e,s=oi(r.pathname||"/",n);if(s==null)return null;let i=$w(t);ON(i);let a=null;for(let c=0;a==null&&c<i.length;++c){let u=qN(s);a=$N(i[c],u)}return a}function $w(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,a,c)=>{let u={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith("/")&&(je(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=Ir([r,u.relativePath]),f=n.concat(u);i.children&&i.children.length>0&&(je(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),$w(i.children,e,f,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:zN(d,i.index),routesMeta:f})};return t.forEach((i,a)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))s(i,a);else for(let u of Ww(i.path))s(i,a,u)}),e}function Ww(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=Ww(r.join("/")),c=[];return c.push(...a.map(u=>u===""?i:[i,u].join("/"))),s&&c.push(...a),c.map(u=>t.startsWith("/")&&u===""?"/":u)}function ON(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:BN(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const DN=/^:[\w-]+$/,VN=3,LN=2,MN=1,FN=10,UN=-2,rv=t=>t==="*";function zN(t,e){let n=t.split("/"),r=n.length;return n.some(rv)&&(r+=UN),e&&(r+=LN),n.filter(s=>!rv(s)).reduce((s,i)=>s+(DN.test(i)?VN:i===""?MN:FN),r)}function BN(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function $N(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let a=0;a<n.length;++a){let c=n[a],u=a===n.length-1,d=s==="/"?e:e.slice(s.length)||"/",f=ph({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d);if(!f)return null;Object.assign(r,f.params);let p=c.route;i.push({params:r,pathname:Ir([s,f.pathname]),pathnameBase:QN(Ir([s,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(s=Ir([s,f.pathnameBase]))}return i}function ph(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=WN(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:r.reduce((d,f,p)=>{let{paramName:m,isOptional:E}=f;if(m==="*"){let x=c[p]||"";a=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const y=c[p];return E&&!y?d[m]=void 0:d[m]=(y||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:a,pattern:t}}function WN(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Bw(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function qN(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Bw(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function oi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function HN(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?_i(t):t;return{pathname:n?n.startsWith("/")?n:GN(n,e):e,search:YN(r),hash:XN(s)}}function GN(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function od(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function KN(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Mf(t,e){let n=KN(t);return e?n.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Ff(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=_i(t):(s=za({},t),je(!s.pathname||!s.pathname.includes("?"),od("?","pathname","search",s)),je(!s.pathname||!s.pathname.includes("#"),od("#","pathname","hash",s)),je(!s.search||!s.search.includes("#"),od("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,c;if(a==null)c=n;else{let p=e.length-1;if(!r&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),p-=1;s.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=HN(s,c),d=a&&a!=="/"&&a.endsWith("/"),f=(i||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||f)&&(u.pathname+="/"),u}const Ir=t=>t.join("/").replace(/\/\/+/g,"/"),QN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),YN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,XN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function JN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const qw=["post","put","patch","delete"];new Set(qw);const ZN=["get",...qw];new Set(ZN);/**
 * React Router v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ba(){return Ba=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ba.apply(this,arguments)}const Fc=b.createContext(null),Hw=b.createContext(null),Hn=b.createContext(null),Uc=b.createContext(null),Dr=b.createContext({outlet:null,matches:[],isDataRoute:!1}),Gw=b.createContext(null);function eS(t,e){let{relative:n}=e===void 0?{}:e;wi()||je(!1);let{basename:r,navigator:s}=b.useContext(Hn),{hash:i,pathname:a,search:c}=zc(t,{relative:n}),u=a;return r!=="/"&&(u=a==="/"?r:Ir([r,a])),s.createHref({pathname:u,search:c,hash:i})}function wi(){return b.useContext(Uc)!=null}function ys(){return wi()||je(!1),b.useContext(Uc).location}function Kw(t){b.useContext(Hn).static||b.useLayoutEffect(t)}function Gn(){let{isDataRoute:t}=b.useContext(Dr);return t?fS():tS()}function tS(){wi()||je(!1);let t=b.useContext(Fc),{basename:e,future:n,navigator:r}=b.useContext(Hn),{matches:s}=b.useContext(Dr),{pathname:i}=ys(),a=JSON.stringify(Mf(s,n.v7_relativeSplatPath)),c=b.useRef(!1);return Kw(()=>{c.current=!0}),b.useCallback(function(d,f){if(f===void 0&&(f={}),!c.current)return;if(typeof d=="number"){r.go(d);return}let p=Ff(d,JSON.parse(a),i,f.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Ir([e,p.pathname])),(f.replace?r.replace:r.push)(p,f.state,f)},[e,r,a,i,t])}function zc(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=b.useContext(Hn),{matches:s}=b.useContext(Dr),{pathname:i}=ys(),a=JSON.stringify(Mf(s,r.v7_relativeSplatPath));return b.useMemo(()=>Ff(t,JSON.parse(a),i,n==="path"),[t,a,i,n])}function nS(t,e){return rS(t,e)}function rS(t,e,n,r){wi()||je(!1);let{navigator:s}=b.useContext(Hn),{matches:i}=b.useContext(Dr),a=i[i.length-1],c=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let d=ys(),f;if(e){var p;let N=typeof e=="string"?_i(e):e;u==="/"||(p=N.pathname)!=null&&p.startsWith(u)||je(!1),f=N}else f=d;let m=f.pathname||"/",E=m;if(u!=="/"){let N=u.replace(/^\//,"").split("/");E="/"+m.replace(/^\//,"").split("/").slice(N.length).join("/")}let y=bN(t,{pathname:E}),x=lS(y&&y.map(N=>Object.assign({},N,{params:Object.assign({},c,N.params),pathname:Ir([u,s.encodeLocation?s.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?u:Ir([u,s.encodeLocation?s.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),i,n,r);return e&&x?b.createElement(Uc.Provider,{value:{location:Ba({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:hr.Pop}},x):x}function sS(){let t=hS(),e=JN(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),n?b.createElement("pre",{style:s},n):null,null)}const iS=b.createElement(sS,null);class aS extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?b.createElement(Dr.Provider,{value:this.props.routeContext},b.createElement(Gw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function oS(t){let{routeContext:e,match:n,children:r}=t,s=b.useContext(Fc);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),b.createElement(Dr.Provider,{value:e},r)}function lS(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if((i=n)!=null&&i.errors)t=n.matches;else return null}let a=t,c=(s=n)==null?void 0:s.errors;if(c!=null){let f=a.findIndex(p=>p.route.id&&(c==null?void 0:c[p.route.id]));f>=0||je(!1),a=a.slice(0,Math.min(a.length,f+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let f=0;f<a.length;f++){let p=a[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=f),p.route.id){let{loaderData:m,errors:E}=n,y=p.route.loader&&m[p.route.id]===void 0&&(!E||E[p.route.id]===void 0);if(p.route.lazy||y){u=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,p,m)=>{let E,y=!1,x=null,N=null;n&&(E=c&&p.route.id?c[p.route.id]:void 0,x=p.route.errorElement||iS,u&&(d<0&&m===0?(pS("route-fallback"),y=!0,N=null):d===m&&(y=!0,N=p.route.hydrateFallbackElement||null)));let I=e.concat(a.slice(0,m+1)),w=()=>{let T;return E?T=x:y?T=N:p.route.Component?T=b.createElement(p.route.Component,null):p.route.element?T=p.route.element:T=f,b.createElement(oS,{match:p,routeContext:{outlet:f,matches:I,isDataRoute:n!=null},children:T})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?b.createElement(aS,{location:n.location,revalidation:n.revalidation,component:x,error:E,children:w(),routeContext:{outlet:null,matches:I,isDataRoute:!0}}):w()},null)}var Qw=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Qw||{}),Yw=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Yw||{});function cS(t){let e=b.useContext(Fc);return e||je(!1),e}function uS(t){let e=b.useContext(Hw);return e||je(!1),e}function dS(t){let e=b.useContext(Dr);return e||je(!1),e}function Xw(t){let e=dS(),n=e.matches[e.matches.length-1];return n.route.id||je(!1),n.route.id}function hS(){var t;let e=b.useContext(Gw),n=uS(),r=Xw();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function fS(){let{router:t}=cS(Qw.UseNavigateStable),e=Xw(Yw.UseNavigateStable),n=b.useRef(!1);return Kw(()=>{n.current=!0}),b.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Ba({fromRouteId:e},i)))},[t,e])}const sv={};function pS(t,e,n){sv[t]||(sv[t]=!0)}function Zn(t){let{to:e,replace:n,state:r,relative:s}=t;wi()||je(!1);let{future:i,static:a}=b.useContext(Hn),{matches:c}=b.useContext(Dr),{pathname:u}=ys(),d=Gn(),f=Ff(e,Mf(c,i.v7_relativeSplatPath),u,s==="path"),p=JSON.stringify(f);return b.useEffect(()=>d(JSON.parse(p),{replace:n,state:r,relative:s}),[d,p,s,n,r]),null}function Bt(t){je(!1)}function mS(t){let{basename:e="/",children:n=null,location:r,navigationType:s=hr.Pop,navigator:i,static:a=!1,future:c}=t;wi()&&je(!1);let u=e.replace(/^\/*/,"/"),d=b.useMemo(()=>({basename:u,navigator:i,static:a,future:Ba({v7_relativeSplatPath:!1},c)}),[u,c,i,a]);typeof r=="string"&&(r=_i(r));let{pathname:f="/",search:p="",hash:m="",state:E=null,key:y="default"}=r,x=b.useMemo(()=>{let N=oi(f,u);return N==null?null:{location:{pathname:N,search:p,hash:m,state:E,key:y},navigationType:s}},[u,f,p,m,E,y,s]);return x==null?null:b.createElement(Hn.Provider,{value:d},b.createElement(Uc.Provider,{children:n,value:x}))}function gS(t){let{children:e,location:n}=t;return nS(mh(e),n)}new Promise(()=>{});function mh(t,e){e===void 0&&(e=[]);let n=[];return b.Children.forEach(t,(r,s)=>{if(!b.isValidElement(r))return;let i=[...e,s];if(r.type===b.Fragment){n.push.apply(n,mh(r.props.children,i));return}r.type!==Bt&&je(!1),!r.props.index||!r.props.children||je(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=mh(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ac(){return ac=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ac.apply(this,arguments)}function Jw(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function vS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function yS(t,e){return t.button===0&&(!e||e==="_self")&&!vS(t)}function gh(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function _S(t,e){let n=gh(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const wS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],ES=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],IS="6";try{window.__reactRouterVersion=IS}catch{}const TS=b.createContext({isTransitioning:!1}),xS="startTransition",iv=_T[xS];function NS(t){let{basename:e,children:n,future:r,window:s}=t,i=b.useRef();i.current==null&&(i.current=PN({window:s,v5Compat:!0}));let a=i.current,[c,u]=b.useState({action:a.action,location:a.location}),{v7_startTransition:d}=r||{},f=b.useCallback(p=>{d&&iv?iv(()=>u(p)):u(p)},[u,d]);return b.useLayoutEffect(()=>a.listen(f),[a,f]),b.createElement(mS,{basename:e,children:n,location:c.location,navigationType:c.action,navigator:a,future:r})}const SS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",AS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$a=b.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:a,state:c,target:u,to:d,preventScrollReset:f,unstable_viewTransition:p}=e,m=Jw(e,wS),{basename:E}=b.useContext(Hn),y,x=!1;if(typeof d=="string"&&AS.test(d)&&(y=d,SS))try{let T=new URL(window.location.href),k=d.startsWith("//")?new URL(T.protocol+d):new URL(d),O=oi(k.pathname,E);k.origin===T.origin&&O!=null?d=O+k.search+k.hash:x=!0}catch{}let N=eS(d,{relative:s}),I=PS(d,{replace:a,state:c,target:u,preventScrollReset:f,relative:s,unstable_viewTransition:p});function w(T){r&&r(T),T.defaultPrevented||I(T)}return b.createElement("a",ac({},m,{href:y||N,onClick:x||i?r:w,ref:n,target:u}))}),RS=b.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:a=!1,style:c,to:u,unstable_viewTransition:d,children:f}=e,p=Jw(e,ES),m=zc(u,{relative:p.relative}),E=ys(),y=b.useContext(Hw),{navigator:x,basename:N}=b.useContext(Hn),I=y!=null&&kS(m)&&d===!0,w=x.encodeLocation?x.encodeLocation(m).pathname:m.pathname,T=E.pathname,k=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;s||(T=T.toLowerCase(),k=k?k.toLowerCase():null,w=w.toLowerCase()),k&&N&&(k=oi(k,N)||k);const O=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let D=T===w||!a&&T.startsWith(w)&&T.charAt(O)==="/",_=k!=null&&(k===w||!a&&k.startsWith(w)&&k.charAt(w.length)==="/"),v={isActive:D,isPending:_,isTransitioning:I},A=D?r:void 0,P;typeof i=="function"?P=i(v):P=[i,D?"active":null,_?"pending":null,I?"transitioning":null].filter(Boolean).join(" ");let C=typeof c=="function"?c(v):c;return b.createElement($a,ac({},p,{"aria-current":A,className:P,ref:n,style:C,to:u,unstable_viewTransition:d}),typeof f=="function"?f(v):f)});var vh;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(vh||(vh={}));var av;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(av||(av={}));function CS(t){let e=b.useContext(Fc);return e||je(!1),e}function PS(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:a,unstable_viewTransition:c}=e===void 0?{}:e,u=Gn(),d=ys(),f=zc(t,{relative:a});return b.useCallback(p=>{if(yS(p,n)){p.preventDefault();let m=r!==void 0?r:ic(d)===ic(f);u(t,{replace:m,state:s,preventScrollReset:i,relative:a,unstable_viewTransition:c})}},[d,u,f,r,s,n,t,i,a,c])}function Uf(t){let e=b.useRef(gh(t)),n=b.useRef(!1),r=ys(),s=b.useMemo(()=>_S(r.search,n.current?null:e.current),[r.search]),i=Gn(),a=b.useCallback((c,u)=>{const d=gh(typeof c=="function"?c(s):c);n.current=!0,i("?"+d,u)},[i,s]);return[s,a]}function kS(t,e){e===void 0&&(e={});let n=b.useContext(TS);n==null&&je(!1);let{basename:r}=CS(vh.useViewTransitionState),s=zc(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=oi(n.currentLocation.pathname,r)||n.currentLocation.pathname,a=oi(n.nextLocation.pathname,r)||n.nextLocation.pathname;return ph(s.pathname,a)!=null||ph(s.pathname,i)!=null}var ov={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},jS=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],c=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},eE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,c=a?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,p=(i&3)<<4|c>>4;let m=(c&15)<<2|d>>6,E=d&63;u||(E=64,a||(m=64)),r.push(n[f],n[p],n[m],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Zw(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):jS(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||d==null||p==null)throw new bS;const m=i<<2|c>>4;if(r.push(m),d!==64){const E=c<<4&240|d>>2;if(r.push(E),p!==64){const y=d<<6&192|p;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class bS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const OS=function(t){const e=Zw(t);return eE.encodeByteArray(e,!0)},oc=function(t){return OS(t).replace(/\./g,"")},tE=function(t){try{return eE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VS=()=>DS().__FIREBASE_DEFAULTS__,LS=()=>{if(typeof process>"u"||typeof ov>"u")return;const t=ov.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},MS=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&tE(t[1]);return e&&JSON.parse(e)},Bc=()=>{try{return VS()||LS()||MS()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},nE=t=>{var e,n;return(n=(e=Bc())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},rE=t=>{const e=nE(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},sE=()=>{var t;return(t=Bc())===null||t===void 0?void 0:t.config},iE=t=>{var e;return(e=Bc())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[oc(JSON.stringify(n)),oc(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function US(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(yt())}function zS(){var t;const e=(t=Bc())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function $S(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function WS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function qS(){const t=yt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function HS(){return!zS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function GS(){try{return typeof indexedDB=="object"}catch{return!1}}function KS(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS="FirebaseError";class In extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=QS,Object.setPrototypeOf(this,In.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,co.prototype.create)}}class co{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?YS(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new In(s,c,r)}}function YS(t,e){return t.replace(XS,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const XS=/\{\$([^}]+)}/g;function JS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Wa(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(lv(i)&&lv(a)){if(!Wa(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function lv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ra(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function sa(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function ZS(t,e){const n=new eA(t,e);return n.subscribe.bind(n)}class eA{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");tA(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=ld),s.error===void 0&&(s.error=ld),s.complete===void 0&&(s.complete=ld);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tA(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function ld(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oe(t){return t&&t._delegate?t._delegate:t}class Rr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new FS;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sA(e))try{this.getOrInitializeService({instanceIdentifier:Kr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Kr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Kr){return this.instances.has(e)}getOptions(e=Kr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:rA(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Kr){return this.component?this.component.multipleInstances?e:Kr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function rA(t){return t===Kr?void 0:t}function sA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new nA(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ue;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ue||(ue={}));const aA={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},oA=ue.INFO,lA={[ue.DEBUG]:"log",[ue.VERBOSE]:"log",[ue.INFO]:"info",[ue.WARN]:"warn",[ue.ERROR]:"error"},cA=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=lA[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class zf{constructor(e){this.name=e,this._logLevel=oA,this._logHandler=cA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?aA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ue.DEBUG,...e),this._logHandler(this,ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ue.VERBOSE,...e),this._logHandler(this,ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ue.INFO,...e),this._logHandler(this,ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ue.WARN,...e),this._logHandler(this,ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ue.ERROR,...e),this._logHandler(this,ue.ERROR,...e)}}const uA=(t,e)=>e.some(n=>t instanceof n);let cv,uv;function dA(){return cv||(cv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function hA(){return uv||(uv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const oE=new WeakMap,yh=new WeakMap,lE=new WeakMap,cd=new WeakMap,Bf=new WeakMap;function fA(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Tr(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&oE.set(n,t)}).catch(()=>{}),Bf.set(e,t),e}function pA(t){if(yh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});yh.set(t,e)}let _h={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return yh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||lE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Tr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function mA(t){_h=t(_h)}function gA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ud(this),e,...n);return lE.set(r,e.sort?e.sort():[e]),Tr(r)}:hA().includes(t)?function(...e){return t.apply(ud(this),e),Tr(oE.get(this))}:function(...e){return Tr(t.apply(ud(this),e))}}function vA(t){return typeof t=="function"?gA(t):(t instanceof IDBTransaction&&pA(t),uA(t,dA())?new Proxy(t,_h):t)}function Tr(t){if(t instanceof IDBRequest)return fA(t);if(cd.has(t))return cd.get(t);const e=vA(t);return e!==t&&(cd.set(t,e),Bf.set(e,t)),e}const ud=t=>Bf.get(t);function yA(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),c=Tr(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Tr(a.result),u.oldVersion,u.newVersion,Tr(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const _A=["get","getKey","getAll","getAllKeys","count"],wA=["put","add","delete","clear"],dd=new Map;function dv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(dd.get(e))return dd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=wA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||_A.includes(n)))return;const i=async function(a,...c){const u=this.transaction(a,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),s&&u.done]))[0]};return dd.set(e,i),i}mA(t=>({...t,get:(e,n,r)=>dv(e,n)||t.get(e,n,r),has:(e,n)=>!!dv(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(IA(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function IA(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const wh="@firebase/app",hv="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Un=new zf("@firebase/app"),TA="@firebase/app-compat",xA="@firebase/analytics-compat",NA="@firebase/analytics",SA="@firebase/app-check-compat",AA="@firebase/app-check",RA="@firebase/auth",CA="@firebase/auth-compat",PA="@firebase/database",kA="@firebase/data-connect",jA="@firebase/database-compat",bA="@firebase/functions",OA="@firebase/functions-compat",DA="@firebase/installations",VA="@firebase/installations-compat",LA="@firebase/messaging",MA="@firebase/messaging-compat",FA="@firebase/performance",UA="@firebase/performance-compat",zA="@firebase/remote-config",BA="@firebase/remote-config-compat",$A="@firebase/storage",WA="@firebase/storage-compat",qA="@firebase/firestore",HA="@firebase/vertexai-preview",GA="@firebase/firestore-compat",KA="firebase",QA="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eh="[DEFAULT]",YA={[wh]:"fire-core",[TA]:"fire-core-compat",[NA]:"fire-analytics",[xA]:"fire-analytics-compat",[AA]:"fire-app-check",[SA]:"fire-app-check-compat",[RA]:"fire-auth",[CA]:"fire-auth-compat",[PA]:"fire-rtdb",[kA]:"fire-data-connect",[jA]:"fire-rtdb-compat",[bA]:"fire-fn",[OA]:"fire-fn-compat",[DA]:"fire-iid",[VA]:"fire-iid-compat",[LA]:"fire-fcm",[MA]:"fire-fcm-compat",[FA]:"fire-perf",[UA]:"fire-perf-compat",[zA]:"fire-rc",[BA]:"fire-rc-compat",[$A]:"fire-gcs",[WA]:"fire-gcs-compat",[qA]:"fire-fst",[GA]:"fire-fst-compat",[HA]:"fire-vertex","fire-js":"fire-js",[KA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa=new Map,XA=new Map,Ih=new Map;function fv(t,e){try{t.container.addComponent(e)}catch(n){Un.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function cs(t){const e=t.name;if(Ih.has(e))return Un.debug(`There were multiple attempts to register component ${e}.`),!1;Ih.set(e,t);for(const n of qa.values())fv(n,t);for(const n of XA.values())fv(n,t);return!0}function $c(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function nn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xr=new co("app","Firebase",JA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Rr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _s=QA;function $f(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Eh,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw xr.create("bad-app-name",{appName:String(s)});if(n||(n=sE()),!n)throw xr.create("no-options");const i=qa.get(s);if(i){if(Wa(n,i.options)&&Wa(r,i.config))return i;throw xr.create("duplicate-app",{appName:s})}const a=new iA(s);for(const u of Ih.values())a.addComponent(u);const c=new ZA(n,r,a);return qa.set(s,c),c}function Wc(t=Eh){const e=qa.get(t);if(!e&&t===Eh&&sE())return $f();if(!e)throw xr.create("no-app",{appName:t});return e}function cE(){return Array.from(qa.values())}function gn(t,e,n){var r;let s=(r=YA[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const c=[`Unable to register library "${s}" with version "${e}":`];i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Un.warn(c.join(" "));return}cs(new Rr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eR="firebase-heartbeat-database",tR=1,Ha="firebase-heartbeat-store";let hd=null;function uE(){return hd||(hd=yA(eR,tR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ha)}catch(n){console.warn(n)}}}}).catch(t=>{throw xr.create("idb-open",{originalErrorMessage:t.message})})),hd}async function nR(t){try{const n=(await uE()).transaction(Ha),r=await n.objectStore(Ha).get(dE(t));return await n.done,r}catch(e){if(e instanceof In)Un.warn(e.message);else{const n=xr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Un.warn(n.message)}}}async function pv(t,e){try{const r=(await uE()).transaction(Ha,"readwrite");await r.objectStore(Ha).put(e,dE(t)),await r.done}catch(n){if(n instanceof In)Un.warn(n.message);else{const r=xr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Un.warn(r.message)}}}function dE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=1024,sR=30*24*60*60*1e3;class iR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new oR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=mv();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const c=new Date(a.date).valueOf();return Date.now()-c<=sR}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Un.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=mv(),{heartbeatsToSend:r,unsentEntries:s}=aR(this._heartbeatsCache.heartbeats),i=oc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Un.warn(n),""}}}function mv(){return new Date().toISOString().substring(0,10)}function aR(t,e=rR){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),gv(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),gv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class oR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return GS()?KS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await nR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return pv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return pv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function gv(t){return oc(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lR(t){cs(new Rr("platform-logger",e=>new EA(e),"PRIVATE")),cs(new Rr("heartbeat",e=>new iR(e),"PRIVATE")),gn(wh,hv,t),gn(wh,hv,"esm2017"),gn("fire-js","")}lR("");function Wf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function hE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const cR=hE,fE=new co("auth","Firebase",hE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc=new zf("@firebase/auth");function uR(t,...e){lc.logLevel<=ue.WARN&&lc.warn(`Auth (${_s}): ${t}`,...e)}function Sl(t,...e){lc.logLevel<=ue.ERROR&&lc.error(`Auth (${_s}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(t,...e){throw Hf(t,...e)}function on(t,...e){return Hf(t,...e)}function qf(t,e,n){const r=Object.assign(Object.assign({},cR()),{[e]:n});return new co("auth","Firebase",r).create(e,{appName:t.name})}function Dn(t){return qf(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function dR(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Qt(t,"argument-error"),qf(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Hf(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return fE.create(t,...e)}function ee(t,e,...n){if(!t)throw Hf(e,...n)}function kn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Sl(e),new Error(e)}function zn(t,e){t||kn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Th(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function hR(){return vv()==="http:"||vv()==="https:"}function vv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(hR()||$S()||"connection"in navigator)?navigator.onLine:!0}function pR(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(e,n){this.shortDelay=e,this.longDelay=n,zn(n>e,"Short delay should be less than long delay!"),this.isMobile=US()||WS()}get(){return fR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gf(t,e){zn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;kn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;kn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;kn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gR=new ho(3e4,6e4);function Vr(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Lr(t,e,n,r,s={}){return mE(t,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=uo(Object.assign({key:t.config.apiKey},a)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return BS()||(d.referrerPolicy="no-referrer"),pE.fetch()(gE(t,t.config.apiHost,n,c),d)})}async function mE(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},mR),e);try{const s=new yR(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw ol(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw ol(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw ol(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw ol(t,"user-disabled",a);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw qf(t,f,d);Qt(t,f)}}catch(s){if(s instanceof In)throw s;Qt(t,"network-request-failed",{message:String(s)})}}async function fo(t,e,n,r,s={}){const i=await Lr(t,e,n,r,s);return"mfaPendingCredential"in i&&Qt(t,"multi-factor-auth-required",{_serverResponse:i}),i}function gE(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Gf(t.config,s):`${t.config.apiScheme}://${s}`}function vR(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class yR{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(on(this.auth,"network-request-failed")),gR.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ol(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=on(t,e,r);return s.customData._tokenResponse=n,s}function yv(t){return t!==void 0&&t.enterprise!==void 0}class _R{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return vR(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function wR(t,e){return Lr(t,"GET","/v2/recaptchaConfig",Vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ER(t,e){return Lr(t,"POST","/v1/accounts:delete",e)}async function vE(t,e){return Lr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function va(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function IR(t,e=!1){const n=Oe(t),r=await n.getIdToken(e),s=Kf(r);ee(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:va(fd(s.auth_time)),issuedAtTime:va(fd(s.iat)),expirationTime:va(fd(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function fd(t){return Number(t)*1e3}function Kf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Sl("JWT malformed, contained fewer than 3 sections"),null;try{const s=tE(n);return s?JSON.parse(s):(Sl("Failed to decode base64 JWT payload"),null)}catch(s){return Sl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function _v(t){const e=Kf(t);return ee(e,"internal-error"),ee(typeof e.exp<"u","internal-error"),ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ga(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof In&&TR(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function TR({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=va(this.lastLoginAt),this.creationTime=va(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cc(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Ga(t,vE(n,{idToken:r}));ee(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?yE(i.providerUserInfo):[],c=SR(t.providerData,a),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(c!=null&&c.length),f=u?d:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new xh(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(t,p)}async function NR(t){const e=Oe(t);await cc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function SR(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function yE(t){return t.map(e=>{var{providerId:n}=e,r=Wf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AR(t,e){const n=await mE(t,{},async()=>{const r=uo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=gE(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",pE.fetch()(a,{method:"POST",headers:c,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function RR(t,e){return Lr(t,"POST","/v2/accounts:revokeToken",Vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ee(e.idToken,"internal-error"),ee(typeof e.idToken<"u","internal-error"),ee(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):_v(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ee(e.length!==0,"internal-error");const n=_v(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await AR(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,a=new Qs;return r&&(ee(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(ee(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(ee(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qs,this.toJSON())}_performRefresh(){return kn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(t,e){ee(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class jn{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Wf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new xR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new xh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Ga(this,this.stsTokenManager.getToken(this.auth,e));return ee(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return IR(this,e)}reload(){return NR(this)}_assign(e){this!==e&&(ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new jn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await cc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(nn(this.auth.app))return Promise.reject(Dn(this.auth));const e=await this.getIdToken();return await Ga(this,ER(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,a,c,u,d,f;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(s=n.email)!==null&&s!==void 0?s:void 0,E=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,y=(a=n.photoURL)!==null&&a!==void 0?a:void 0,x=(c=n.tenantId)!==null&&c!==void 0?c:void 0,N=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,I=(d=n.createdAt)!==null&&d!==void 0?d:void 0,w=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:T,emailVerified:k,isAnonymous:O,providerData:D,stsTokenManager:_}=n;ee(T&&_,e,"internal-error");const v=Qs.fromJSON(this.name,_);ee(typeof T=="string",e,"internal-error"),er(p,e.name),er(m,e.name),ee(typeof k=="boolean",e,"internal-error"),ee(typeof O=="boolean",e,"internal-error"),er(E,e.name),er(y,e.name),er(x,e.name),er(N,e.name),er(I,e.name),er(w,e.name);const A=new jn({uid:T,auth:e,email:m,emailVerified:k,displayName:p,isAnonymous:O,photoURL:y,phoneNumber:E,tenantId:x,stsTokenManager:v,createdAt:I,lastLoginAt:w});return D&&Array.isArray(D)&&(A.providerData=D.map(P=>Object.assign({},P))),N&&(A._redirectEventId=N),A}static async _fromIdTokenResponse(e,n,r=!1){const s=new Qs;s.updateFromServerResponse(n);const i=new jn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await cc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ee(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?yE(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new Qs;c.updateFromIdToken(r);const u=new jn({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new xh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv=new Map;function bn(t){zn(t instanceof Function,"Expected a class definition");let e=wv.get(t);return e?(zn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,wv.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}_E.type="NONE";const Ev=_E;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Al(t,e,n){return`firebase:${t}:${e}:${n}`}class Ys{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Al(this.userKey,s.apiKey,i),this.fullPersistenceKey=Al("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?jn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ys(bn(Ev),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||bn(Ev);const a=Al(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const f=await d._get(a);if(f){const p=jn._fromJSON(e,f);d!==i&&(c=p),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Ys(i,e,r):(i=u[0],c&&await i._set(a,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(a)}catch{}})),new Ys(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(TE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(wE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(NE(e))return"Blackberry";if(SE(e))return"Webos";if(EE(e))return"Safari";if((e.includes("chrome/")||IE(e))&&!e.includes("edge/"))return"Chrome";if(xE(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function wE(t=yt()){return/firefox\//i.test(t)}function EE(t=yt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function IE(t=yt()){return/crios\//i.test(t)}function TE(t=yt()){return/iemobile/i.test(t)}function xE(t=yt()){return/android/i.test(t)}function NE(t=yt()){return/blackberry/i.test(t)}function SE(t=yt()){return/webos/i.test(t)}function Qf(t=yt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function CR(t=yt()){var e;return Qf(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function PR(){return qS()&&document.documentMode===10}function AE(t=yt()){return Qf(t)||xE(t)||SE(t)||NE(t)||/windows phone/i.test(t)||TE(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RE(t,e=[]){let n;switch(t){case"Browser":n=Iv(yt());break;case"Worker":n=`${Iv(yt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${_s}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((a,c)=>{try{const u=e(i);a(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jR(t,e={}){return Lr(t,"GET","/v2/passwordPolicy",Vr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR=6;class OR{constructor(e){var n,r,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:bR,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,a,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(a=u.containsNumericCharacter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Tv(this),this.idTokenSubscription=new Tv(this),this.beforeStateQueue=new kR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=bn(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Ys.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await vE(this,{idToken:e}),r=await jn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(nn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,c=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===c)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await cc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=pR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(nn(this.app))return Promise.reject(Dn(this));const n=e?Oe(e):null;return n&&ee(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return nn(this.app)?Promise.reject(Dn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return nn(this.app)?Promise.reject(Dn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await jR(this),n=new OR(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new co("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await RR(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&bn(e)||this._popupRedirectResolver;ee(n,this,"argument-error"),this.redirectPersistenceManager=await Ys.create(this,[bn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ee(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{a=!0,u()}}else{const u=e.addObserver(n);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=RE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&uR(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Mr(t){return Oe(t)}class Tv{constructor(e){this.auth=e,this.observer=null,this.addObserver=ZS(n=>this.observer=n)}get next(){return ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function VR(t){qc=t}function CE(t){return qc.loadJS(t)}function LR(){return qc.recaptchaEnterpriseScript}function MR(){return qc.gapiScript}function FR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const UR="recaptcha-enterprise",zR="NO_RECAPTCHA";class BR{constructor(e){this.type=UR,this.auth=Mr(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,c)=>{wR(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new _R(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,a(d.siteKey)}}).catch(u=>{c(u)})})}function s(i,a,c){const u=window.grecaptcha;yv(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{a(d)}).catch(()=>{a(zR)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,a)=>{r(this.auth).then(c=>{if(!n&&yv(window.grecaptcha))s(c,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=LR();u.length!==0&&(u+=c),CE(u).then(()=>{s(c,i,a)}).catch(d=>{a(d)})}}).catch(c=>{a(c)})})}}async function xv(t,e,n,r=!1){const s=new BR(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:i}):Object.assign(a,{captchaResponse:i}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Nh(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await xv(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await xv(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $R(t,e){const n=$c(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Wa(i,e??{}))return s;Qt(s,"already-initialized")}return n.initialize({options:e})}function WR(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(bn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function qR(t,e,n){const r=Mr(t);ee(r._canInitEmulator,r,"emulator-config-failed"),ee(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=PE(e),{host:a,port:c}=HR(e),u=c===null?"":`:${c}`;r.config.emulator={url:`${i}//${a}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),GR()}function PE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function HR(t){const e=PE(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Nv(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Nv(a)}}}function Nv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function GR(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return kn("not implemented")}_getIdTokenResponse(e){return kn("not implemented")}_linkToIdToken(e,n){return kn("not implemented")}_getReauthenticationResolver(e){return kn("not implemented")}}async function KR(t,e){return Lr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QR(t,e){return fo(t,"POST","/v1/accounts:signInWithPassword",Vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YR(t,e){return fo(t,"POST","/v1/accounts:signInWithEmailLink",Vr(t,e))}async function XR(t,e){return fo(t,"POST","/v1/accounts:signInWithEmailLink",Vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka extends Yf{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Ka(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ka(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nh(e,n,"signInWithPassword",QR);case"emailLink":return YR(e,{email:this._email,oobCode:this._password});default:Qt(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nh(e,r,"signUpPassword",KR);case"emailLink":return XR(e,{idToken:n,email:this._email,oobCode:this._password});default:Qt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xs(t,e){return fo(t,"POST","/v1/accounts:signInWithIdp",Vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR="http://localhost";class us extends Yf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new us(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Qt("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Wf(n,["providerId","signInMethod"]);if(!r||!s)return null;const a=new us(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Xs(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Xs(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Xs(e,n)}buildRequest(){const e={requestUri:JR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=uo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZR(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function eC(t){const e=ra(sa(t)).link,n=e?ra(sa(e)).deep_link_id:null,r=ra(sa(t)).deep_link_id;return(r?ra(sa(r)).link:null)||r||n||e||t}class Xf{constructor(e){var n,r,s,i,a,c;const u=ra(sa(e)),d=(n=u.apiKey)!==null&&n!==void 0?n:null,f=(r=u.oobCode)!==null&&r!==void 0?r:null,p=ZR((s=u.mode)!==null&&s!==void 0?s:null);ee(d&&f&&p,"argument-error"),this.apiKey=d,this.operation=p,this.code=f,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(a=u.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(c=u.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){const n=eC(e);try{return new Xf(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(){this.providerId=Ei.PROVIDER_ID}static credential(e,n){return Ka._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Xf.parseLink(n);return ee(r,"argument-error"),Ka._fromEmailAndCode(e,r.code,r.tenantId)}}Ei.PROVIDER_ID="password";Ei.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ei.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po extends Jf{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir extends po{constructor(){super("facebook.com")}static credential(e){return us._fromParams({providerId:ir.PROVIDER_ID,signInMethod:ir.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ir.credentialFromTaggedObject(e)}static credentialFromError(e){return ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ir.credential(e.oauthAccessToken)}catch{return null}}}ir.FACEBOOK_SIGN_IN_METHOD="facebook.com";ir.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn extends po{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return us._fromParams({providerId:Rn.PROVIDER_ID,signInMethod:Rn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Rn.credentialFromTaggedObject(e)}static credentialFromError(e){return Rn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Rn.credential(n,r)}catch{return null}}}Rn.GOOGLE_SIGN_IN_METHOD="google.com";Rn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar extends po{constructor(){super("github.com")}static credential(e){return us._fromParams({providerId:ar.PROVIDER_ID,signInMethod:ar.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ar.credentialFromTaggedObject(e)}static credentialFromError(e){return ar.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ar.credential(e.oauthAccessToken)}catch{return null}}}ar.GITHUB_SIGN_IN_METHOD="github.com";ar.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or extends po{constructor(){super("twitter.com")}static credential(e,n){return us._fromParams({providerId:or.PROVIDER_ID,signInMethod:or.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return or.credentialFromTaggedObject(e)}static credentialFromError(e){return or.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return or.credential(n,r)}catch{return null}}}or.TWITTER_SIGN_IN_METHOD="twitter.com";or.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tC(t,e){return fo(t,"POST","/v1/accounts:signUp",Vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await jn._fromIdTokenResponse(e,r,s),a=Sv(r);return new ds({user:i,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Sv(r);return new ds({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Sv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc extends In{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,uc.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new uc(e,n,r,s)}}function kE(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?uc._fromErrorAndOperation(t,i,e,r):i})}async function nC(t,e,n=!1){const r=await Ga(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ds._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rC(t,e,n=!1){const{auth:r}=t;if(nn(r.app))return Promise.reject(Dn(r));const s="reauthenticate";try{const i=await Ga(t,kE(r,s,e,t),n);ee(i.idToken,r,"internal-error");const a=Kf(i.idToken);ee(a,r,"internal-error");const{sub:c}=a;return ee(t.uid===c,r,"user-mismatch"),ds._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Qt(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jE(t,e,n=!1){if(nn(t.app))return Promise.reject(Dn(t));const r="signIn",s=await kE(t,r,e),i=await ds._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function sC(t,e){return jE(Mr(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bE(t){const e=Mr(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function iC(t,e,n){if(nn(t.app))return Promise.reject(Dn(t));const r=Mr(t),a=await Nh(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",tC).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&bE(t),u}),c=await ds._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(c.user),c}function aC(t,e,n){return nn(t.app)?Promise.reject(Dn(t)):sC(Oe(t),Ei.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&bE(t),r})}function oC(t,e,n,r){return Oe(t).onIdTokenChanged(e,n,r)}function lC(t,e,n){return Oe(t).beforeAuthStateChanged(e,n)}function cC(t,e,n,r){return Oe(t).onAuthStateChanged(e,n,r)}function ns(t){return Oe(t).signOut()}async function uC(t){return Oe(t).delete()}const dc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(dc,"1"),this.storage.removeItem(dc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=1e3,hC=10;class DE extends OE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=AE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);PR()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,hC):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},dC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}DE.type="LOCAL";const fC=DE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE extends OE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}VE.type="SESSION";const LE=VE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Hc(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async d=>d(n.origin,i)),u=await pC(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zf(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,u)=>{const d=Zf("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(m.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(){return window}function gC(t){vn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(){return typeof vn().WorkerGlobalScope<"u"&&typeof vn().importScripts=="function"}async function vC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function yC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function _C(){return ME()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FE="firebaseLocalStorageDb",wC=1,hc="firebaseLocalStorage",UE="fbase_key";class mo{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Gc(t,e){return t.transaction([hc],e?"readwrite":"readonly").objectStore(hc)}function EC(){const t=indexedDB.deleteDatabase(FE);return new mo(t).toPromise()}function Sh(){const t=indexedDB.open(FE,wC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(hc,{keyPath:UE})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(hc)?e(r):(r.close(),await EC(),e(await Sh()))})})}async function Av(t,e,n){const r=Gc(t,!0).put({[UE]:e,value:n});return new mo(r).toPromise()}async function IC(t,e){const n=Gc(t,!1).get(e),r=await new mo(n).toPromise();return r===void 0?null:r.value}function Rv(t,e){const n=Gc(t,!0).delete(e);return new mo(n).toPromise()}const TC=800,xC=3;class zE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>xC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ME()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hc._getInstance(_C()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await vC(),!this.activeServiceWorker)return;this.sender=new mC(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||yC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sh();return await Av(e,dc,"1"),await Rv(e,dc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Av(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>IC(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Rv(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Gc(s,!1).getAll();return new mo(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),TC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}zE.type="LOCAL";const NC=zE;new ho(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(t,e){return e?bn(e):(ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep extends Yf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Xs(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Xs(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Xs(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function SC(t){return jE(t.auth,new ep(t),t.bypassAuthState)}function AC(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),rC(n,new ep(t),t.bypassAuthState)}async function RC(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),nC(n,new ep(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return SC;case"linkViaPopup":case"linkViaRedirect":return RC;case"reauthViaPopup":case"reauthViaRedirect":return AC;default:Qt(this.auth,"internal-error")}}resolve(e){zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC=new ho(2e3,1e4);async function PC(t,e,n){if(nn(t.app))return Promise.reject(on(t,"operation-not-supported-in-this-environment"));const r=Mr(t);dR(t,e,Jf);const s=BE(r,n);return new Jr(r,"signInViaPopup",e,s).executeNotNull()}class Jr extends $E{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Jr.currentPopupAction&&Jr.currentPopupAction.cancel(),Jr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ee(e,this.auth,"internal-error"),e}async onExecution(){zn(this.filter.length===1,"Popup operations only handle one event");const e=Zf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(on(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(on(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Jr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(on(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,CC.get())};e()}}Jr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC="pendingRedirect",Rl=new Map;class jC extends $E{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Rl.get(this.auth._key());if(!e){try{const r=await bC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Rl.set(this.auth._key(),e)}return this.bypassAuthState||Rl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function bC(t,e){const n=VC(e),r=DC(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function OC(t,e){Rl.set(t._key(),e)}function DC(t){return bn(t._redirectPersistence)}function VC(t){return Al(kC,t.config.apiKey,t.name)}async function LC(t,e,n=!1){if(nn(t.app))return Promise.reject(Dn(t));const r=Mr(t),s=BE(r,e),a=await new jC(r,s,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC=10*60*1e3;class FC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!UC(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!WE(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(on(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=MC&&this.cachedEventUids.clear(),this.cachedEventUids.has(Cv(e))}saveEventToCache(e){this.cachedEventUids.add(Cv(e)),this.lastProcessedEventTime=Date.now()}}function Cv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function WE({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function UC(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zC(t,e={}){return Lr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$C=/^https?/;async function WC(t){if(t.config.emulator)return;const{authorizedDomains:e}=await zC(t);for(const n of e)try{if(qC(n))return}catch{}Qt(t,"unauthorized-domain")}function qC(t){const e=Th(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!$C.test(n))return!1;if(BC.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC=new ho(3e4,6e4);function Pv(){const t=vn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function GC(t){return new Promise((e,n)=>{var r,s,i;function a(){Pv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Pv(),n(on(t,"network-request-failed"))},timeout:HC.get()})}if(!((s=(r=vn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=vn().gapi)===null||i===void 0)&&i.load)a();else{const c=FR("iframefcb");return vn()[c]=()=>{gapi.load?a():n(on(t,"network-request-failed"))},CE(`${MR()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw Cl=null,e})}let Cl=null;function KC(t){return Cl=Cl||GC(t),Cl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC=new ho(5e3,15e3),YC="__/auth/iframe",XC="emulator/auth/iframe",JC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ZC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function eP(t){const e=t.config;ee(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Gf(e,XC):`https://${t.config.authDomain}/${YC}`,r={apiKey:e.apiKey,appName:t.name,v:_s},s=ZC.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${uo(r).slice(1)}`}async function tP(t){const e=await KC(t),n=vn().gapi;return ee(n,t,"internal-error"),e.open({where:document.body,url:eP(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:JC,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=on(t,"network-request-failed"),c=vn().setTimeout(()=>{i(a)},QC.get());function u(){vn().clearTimeout(c),s(r)}r.ping(u).then(u,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},rP=500,sP=600,iP="_blank",aP="http://localhost";class kv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function oP(t,e,n,r=rP,s=sP){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},nP),{width:r.toString(),height:s.toString(),top:i,left:a}),d=yt().toLowerCase();n&&(c=IE(d)?iP:n),wE(d)&&(e=e||aP,u.scrollbars="yes");const f=Object.entries(u).reduce((m,[E,y])=>`${m}${E}=${y},`,"");if(CR(d)&&c!=="_self")return lP(e||"",c),new kv(null);const p=window.open(e||"",c,f);ee(p,t,"popup-blocked");try{p.focus()}catch{}return new kv(p)}function lP(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cP="__/auth/handler",uP="emulator/auth/handler",dP=encodeURIComponent("fac");async function jv(t,e,n,r,s,i){ee(t.config.authDomain,t,"auth-domain-config-required"),ee(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:_s,eventId:s};if(e instanceof Jf){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",JS(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof po){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),d=u?`#${dP}=${encodeURIComponent(u)}`:"";return`${hP(t)}?${uo(c).slice(1)}${d}`}function hP({config:t}){return t.emulator?Gf(t,uP):`https://${t.authDomain}/${cP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pd="webStorageSupport";class fP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=LE,this._completeRedirectFn=LC,this._overrideRedirectResult=OC}async _openPopup(e,n,r,s){var i;zn((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await jv(e,n,r,Th(),s);return oP(e,a,Zf())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await jv(e,n,r,Th(),s);return gC(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(zn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await tP(e),r=new FC(e);return n.register("authEvent",s=>(ee(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(pd,{type:pd},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[pd];a!==void 0&&n(!!a),Qt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=WC(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return AE()||EE()||Qf()}}const pP=fP;var bv="@firebase/auth",Ov="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gP(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function vP(t){cs(new Rr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;ee(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:RE(t)},d=new DR(r,s,i,u);return WR(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),cs(new Rr("auth-internal",e=>{const n=Mr(e.getProvider("auth").getImmediate());return(r=>new mP(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),gn(bv,Ov,gP(t)),gn(bv,Ov,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP=5*60,_P=iE("authIdTokenMaxAge")||yP;let Dv=null;const wP=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>_P)return;const s=n==null?void 0:n.token;Dv!==s&&(Dv=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function qE(t=Wc()){const e=$c(t,"auth");if(e.isInitialized())return e.getImmediate();const n=$R(t,{popupRedirectResolver:pP,persistence:[NC,fC,LE]}),r=iE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=wP(i.toString());lC(n,a,()=>a(n.currentUser)),oC(n,c=>a(c))}}const s=nE("auth");return s&&qR(n,`http://${s}`),n}function EP(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}VR({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=on("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",EP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});vP("Browser");var Vv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var rs,HE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,v){function A(){}A.prototype=v.prototype,_.D=v.prototype,_.prototype=new A,_.prototype.constructor=_,_.C=function(P,C,j){for(var S=Array(arguments.length-2),U=2;U<arguments.length;U++)S[U-2]=arguments[U];return v.prototype[C].apply(P,S)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(_,v,A){A||(A=0);var P=Array(16);if(typeof v=="string")for(var C=0;16>C;++C)P[C]=v.charCodeAt(A++)|v.charCodeAt(A++)<<8|v.charCodeAt(A++)<<16|v.charCodeAt(A++)<<24;else for(C=0;16>C;++C)P[C]=v[A++]|v[A++]<<8|v[A++]<<16|v[A++]<<24;v=_.g[0],A=_.g[1],C=_.g[2];var j=_.g[3],S=v+(j^A&(C^j))+P[0]+3614090360&4294967295;v=A+(S<<7&4294967295|S>>>25),S=j+(C^v&(A^C))+P[1]+3905402710&4294967295,j=v+(S<<12&4294967295|S>>>20),S=C+(A^j&(v^A))+P[2]+606105819&4294967295,C=j+(S<<17&4294967295|S>>>15),S=A+(v^C&(j^v))+P[3]+3250441966&4294967295,A=C+(S<<22&4294967295|S>>>10),S=v+(j^A&(C^j))+P[4]+4118548399&4294967295,v=A+(S<<7&4294967295|S>>>25),S=j+(C^v&(A^C))+P[5]+1200080426&4294967295,j=v+(S<<12&4294967295|S>>>20),S=C+(A^j&(v^A))+P[6]+2821735955&4294967295,C=j+(S<<17&4294967295|S>>>15),S=A+(v^C&(j^v))+P[7]+4249261313&4294967295,A=C+(S<<22&4294967295|S>>>10),S=v+(j^A&(C^j))+P[8]+1770035416&4294967295,v=A+(S<<7&4294967295|S>>>25),S=j+(C^v&(A^C))+P[9]+2336552879&4294967295,j=v+(S<<12&4294967295|S>>>20),S=C+(A^j&(v^A))+P[10]+4294925233&4294967295,C=j+(S<<17&4294967295|S>>>15),S=A+(v^C&(j^v))+P[11]+2304563134&4294967295,A=C+(S<<22&4294967295|S>>>10),S=v+(j^A&(C^j))+P[12]+1804603682&4294967295,v=A+(S<<7&4294967295|S>>>25),S=j+(C^v&(A^C))+P[13]+4254626195&4294967295,j=v+(S<<12&4294967295|S>>>20),S=C+(A^j&(v^A))+P[14]+2792965006&4294967295,C=j+(S<<17&4294967295|S>>>15),S=A+(v^C&(j^v))+P[15]+1236535329&4294967295,A=C+(S<<22&4294967295|S>>>10),S=v+(C^j&(A^C))+P[1]+4129170786&4294967295,v=A+(S<<5&4294967295|S>>>27),S=j+(A^C&(v^A))+P[6]+3225465664&4294967295,j=v+(S<<9&4294967295|S>>>23),S=C+(v^A&(j^v))+P[11]+643717713&4294967295,C=j+(S<<14&4294967295|S>>>18),S=A+(j^v&(C^j))+P[0]+3921069994&4294967295,A=C+(S<<20&4294967295|S>>>12),S=v+(C^j&(A^C))+P[5]+3593408605&4294967295,v=A+(S<<5&4294967295|S>>>27),S=j+(A^C&(v^A))+P[10]+38016083&4294967295,j=v+(S<<9&4294967295|S>>>23),S=C+(v^A&(j^v))+P[15]+3634488961&4294967295,C=j+(S<<14&4294967295|S>>>18),S=A+(j^v&(C^j))+P[4]+3889429448&4294967295,A=C+(S<<20&4294967295|S>>>12),S=v+(C^j&(A^C))+P[9]+568446438&4294967295,v=A+(S<<5&4294967295|S>>>27),S=j+(A^C&(v^A))+P[14]+3275163606&4294967295,j=v+(S<<9&4294967295|S>>>23),S=C+(v^A&(j^v))+P[3]+4107603335&4294967295,C=j+(S<<14&4294967295|S>>>18),S=A+(j^v&(C^j))+P[8]+1163531501&4294967295,A=C+(S<<20&4294967295|S>>>12),S=v+(C^j&(A^C))+P[13]+2850285829&4294967295,v=A+(S<<5&4294967295|S>>>27),S=j+(A^C&(v^A))+P[2]+4243563512&4294967295,j=v+(S<<9&4294967295|S>>>23),S=C+(v^A&(j^v))+P[7]+1735328473&4294967295,C=j+(S<<14&4294967295|S>>>18),S=A+(j^v&(C^j))+P[12]+2368359562&4294967295,A=C+(S<<20&4294967295|S>>>12),S=v+(A^C^j)+P[5]+4294588738&4294967295,v=A+(S<<4&4294967295|S>>>28),S=j+(v^A^C)+P[8]+2272392833&4294967295,j=v+(S<<11&4294967295|S>>>21),S=C+(j^v^A)+P[11]+1839030562&4294967295,C=j+(S<<16&4294967295|S>>>16),S=A+(C^j^v)+P[14]+4259657740&4294967295,A=C+(S<<23&4294967295|S>>>9),S=v+(A^C^j)+P[1]+2763975236&4294967295,v=A+(S<<4&4294967295|S>>>28),S=j+(v^A^C)+P[4]+1272893353&4294967295,j=v+(S<<11&4294967295|S>>>21),S=C+(j^v^A)+P[7]+4139469664&4294967295,C=j+(S<<16&4294967295|S>>>16),S=A+(C^j^v)+P[10]+3200236656&4294967295,A=C+(S<<23&4294967295|S>>>9),S=v+(A^C^j)+P[13]+681279174&4294967295,v=A+(S<<4&4294967295|S>>>28),S=j+(v^A^C)+P[0]+3936430074&4294967295,j=v+(S<<11&4294967295|S>>>21),S=C+(j^v^A)+P[3]+3572445317&4294967295,C=j+(S<<16&4294967295|S>>>16),S=A+(C^j^v)+P[6]+76029189&4294967295,A=C+(S<<23&4294967295|S>>>9),S=v+(A^C^j)+P[9]+3654602809&4294967295,v=A+(S<<4&4294967295|S>>>28),S=j+(v^A^C)+P[12]+3873151461&4294967295,j=v+(S<<11&4294967295|S>>>21),S=C+(j^v^A)+P[15]+530742520&4294967295,C=j+(S<<16&4294967295|S>>>16),S=A+(C^j^v)+P[2]+3299628645&4294967295,A=C+(S<<23&4294967295|S>>>9),S=v+(C^(A|~j))+P[0]+4096336452&4294967295,v=A+(S<<6&4294967295|S>>>26),S=j+(A^(v|~C))+P[7]+1126891415&4294967295,j=v+(S<<10&4294967295|S>>>22),S=C+(v^(j|~A))+P[14]+2878612391&4294967295,C=j+(S<<15&4294967295|S>>>17),S=A+(j^(C|~v))+P[5]+4237533241&4294967295,A=C+(S<<21&4294967295|S>>>11),S=v+(C^(A|~j))+P[12]+1700485571&4294967295,v=A+(S<<6&4294967295|S>>>26),S=j+(A^(v|~C))+P[3]+2399980690&4294967295,j=v+(S<<10&4294967295|S>>>22),S=C+(v^(j|~A))+P[10]+4293915773&4294967295,C=j+(S<<15&4294967295|S>>>17),S=A+(j^(C|~v))+P[1]+2240044497&4294967295,A=C+(S<<21&4294967295|S>>>11),S=v+(C^(A|~j))+P[8]+1873313359&4294967295,v=A+(S<<6&4294967295|S>>>26),S=j+(A^(v|~C))+P[15]+4264355552&4294967295,j=v+(S<<10&4294967295|S>>>22),S=C+(v^(j|~A))+P[6]+2734768916&4294967295,C=j+(S<<15&4294967295|S>>>17),S=A+(j^(C|~v))+P[13]+1309151649&4294967295,A=C+(S<<21&4294967295|S>>>11),S=v+(C^(A|~j))+P[4]+4149444226&4294967295,v=A+(S<<6&4294967295|S>>>26),S=j+(A^(v|~C))+P[11]+3174756917&4294967295,j=v+(S<<10&4294967295|S>>>22),S=C+(v^(j|~A))+P[2]+718787259&4294967295,C=j+(S<<15&4294967295|S>>>17),S=A+(j^(C|~v))+P[9]+3951481745&4294967295,_.g[0]=_.g[0]+v&4294967295,_.g[1]=_.g[1]+(C+(S<<21&4294967295|S>>>11))&4294967295,_.g[2]=_.g[2]+C&4294967295,_.g[3]=_.g[3]+j&4294967295}r.prototype.u=function(_,v){v===void 0&&(v=_.length);for(var A=v-this.blockSize,P=this.B,C=this.h,j=0;j<v;){if(C==0)for(;j<=A;)s(this,_,j),j+=this.blockSize;if(typeof _=="string"){for(;j<v;)if(P[C++]=_.charCodeAt(j++),C==this.blockSize){s(this,P),C=0;break}}else for(;j<v;)if(P[C++]=_[j++],C==this.blockSize){s(this,P),C=0;break}}this.h=C,this.o+=v},r.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var v=1;v<_.length-8;++v)_[v]=0;var A=8*this.o;for(v=_.length-8;v<_.length;++v)_[v]=A&255,A/=256;for(this.u(_),_=Array(16),v=A=0;4>v;++v)for(var P=0;32>P;P+=8)_[A++]=this.g[v]>>>P&255;return _};function i(_,v){var A=c;return Object.prototype.hasOwnProperty.call(A,_)?A[_]:A[_]=v(_)}function a(_,v){this.h=v;for(var A=[],P=!0,C=_.length-1;0<=C;C--){var j=_[C]|0;P&&j==v||(A[C]=j,P=!1)}this.g=A}var c={};function u(_){return-128<=_&&128>_?i(_,function(v){return new a([v|0],0>v?-1:0)}):new a([_|0],0>_?-1:0)}function d(_){if(isNaN(_)||!isFinite(_))return p;if(0>_)return N(d(-_));for(var v=[],A=1,P=0;_>=A;P++)v[P]=_/A|0,A*=4294967296;return new a(v,0)}function f(_,v){if(_.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(_.charAt(0)=="-")return N(f(_.substring(1),v));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=d(Math.pow(v,8)),P=p,C=0;C<_.length;C+=8){var j=Math.min(8,_.length-C),S=parseInt(_.substring(C,C+j),v);8>j?(j=d(Math.pow(v,j)),P=P.j(j).add(d(S))):(P=P.j(A),P=P.add(d(S)))}return P}var p=u(0),m=u(1),E=u(16777216);t=a.prototype,t.m=function(){if(x(this))return-N(this).m();for(var _=0,v=1,A=0;A<this.g.length;A++){var P=this.i(A);_+=(0<=P?P:4294967296+P)*v,v*=4294967296}return _},t.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(y(this))return"0";if(x(this))return"-"+N(this).toString(_);for(var v=d(Math.pow(_,6)),A=this,P="";;){var C=k(A,v).g;A=I(A,C.j(v));var j=((0<A.g.length?A.g[0]:A.h)>>>0).toString(_);if(A=C,y(A))return j+P;for(;6>j.length;)j="0"+j;P=j+P}},t.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function y(_){if(_.h!=0)return!1;for(var v=0;v<_.g.length;v++)if(_.g[v]!=0)return!1;return!0}function x(_){return _.h==-1}t.l=function(_){return _=I(this,_),x(_)?-1:y(_)?0:1};function N(_){for(var v=_.g.length,A=[],P=0;P<v;P++)A[P]=~_.g[P];return new a(A,~_.h).add(m)}t.abs=function(){return x(this)?N(this):this},t.add=function(_){for(var v=Math.max(this.g.length,_.g.length),A=[],P=0,C=0;C<=v;C++){var j=P+(this.i(C)&65535)+(_.i(C)&65535),S=(j>>>16)+(this.i(C)>>>16)+(_.i(C)>>>16);P=S>>>16,j&=65535,S&=65535,A[C]=S<<16|j}return new a(A,A[A.length-1]&-2147483648?-1:0)};function I(_,v){return _.add(N(v))}t.j=function(_){if(y(this)||y(_))return p;if(x(this))return x(_)?N(this).j(N(_)):N(N(this).j(_));if(x(_))return N(this.j(N(_)));if(0>this.l(E)&&0>_.l(E))return d(this.m()*_.m());for(var v=this.g.length+_.g.length,A=[],P=0;P<2*v;P++)A[P]=0;for(P=0;P<this.g.length;P++)for(var C=0;C<_.g.length;C++){var j=this.i(P)>>>16,S=this.i(P)&65535,U=_.i(C)>>>16,G=_.i(C)&65535;A[2*P+2*C]+=S*G,w(A,2*P+2*C),A[2*P+2*C+1]+=j*G,w(A,2*P+2*C+1),A[2*P+2*C+1]+=S*U,w(A,2*P+2*C+1),A[2*P+2*C+2]+=j*U,w(A,2*P+2*C+2)}for(P=0;P<v;P++)A[P]=A[2*P+1]<<16|A[2*P];for(P=v;P<2*v;P++)A[P]=0;return new a(A,0)};function w(_,v){for(;(_[v]&65535)!=_[v];)_[v+1]+=_[v]>>>16,_[v]&=65535,v++}function T(_,v){this.g=_,this.h=v}function k(_,v){if(y(v))throw Error("division by zero");if(y(_))return new T(p,p);if(x(_))return v=k(N(_),v),new T(N(v.g),N(v.h));if(x(v))return v=k(_,N(v)),new T(N(v.g),v.h);if(30<_.g.length){if(x(_)||x(v))throw Error("slowDivide_ only works with positive integers.");for(var A=m,P=v;0>=P.l(_);)A=O(A),P=O(P);var C=D(A,1),j=D(P,1);for(P=D(P,2),A=D(A,2);!y(P);){var S=j.add(P);0>=S.l(_)&&(C=C.add(A),j=S),P=D(P,1),A=D(A,1)}return v=I(_,C.j(v)),new T(C,v)}for(C=p;0<=_.l(v);){for(A=Math.max(1,Math.floor(_.m()/v.m())),P=Math.ceil(Math.log(A)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),j=d(A),S=j.j(v);x(S)||0<S.l(_);)A-=P,j=d(A),S=j.j(v);y(j)&&(j=m),C=C.add(j),_=I(_,S)}return new T(C,_)}t.A=function(_){return k(this,_).h},t.and=function(_){for(var v=Math.max(this.g.length,_.g.length),A=[],P=0;P<v;P++)A[P]=this.i(P)&_.i(P);return new a(A,this.h&_.h)},t.or=function(_){for(var v=Math.max(this.g.length,_.g.length),A=[],P=0;P<v;P++)A[P]=this.i(P)|_.i(P);return new a(A,this.h|_.h)},t.xor=function(_){for(var v=Math.max(this.g.length,_.g.length),A=[],P=0;P<v;P++)A[P]=this.i(P)^_.i(P);return new a(A,this.h^_.h)};function O(_){for(var v=_.g.length+1,A=[],P=0;P<v;P++)A[P]=_.i(P)<<1|_.i(P-1)>>>31;return new a(A,_.h)}function D(_,v){var A=v>>5;v%=32;for(var P=_.g.length-A,C=[],j=0;j<P;j++)C[j]=0<v?_.i(j+A)>>>v|_.i(j+A+1)<<32-v:_.i(j+A);return new a(C,_.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,HE=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=f,rs=a}).apply(typeof Vv<"u"?Vv:typeof self<"u"?self:typeof window<"u"?window:{});var ll=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var GE,ia,KE,Pl,Ah,QE,YE,XE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,g){return l==Array.prototype||l==Object.prototype||(l[h]=g.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof ll=="object"&&ll];for(var h=0;h<l.length;++h){var g=l[h];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(l,h){if(h)e:{var g=r;l=l.split(".");for(var R=0;R<l.length-1;R++){var V=l[R];if(!(V in g))break e;g=g[V]}l=l[l.length-1],R=g[l],h=h(R),h!=R&&h!=null&&e(g,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var g=0,R=!1,V={next:function(){if(!R&&g<l.length){var M=g++;return{value:h(M,l[M]),done:!1}}return R=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function f(l,h,g){return l.call.apply(l.bind,arguments)}function p(l,h,g){if(!l)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,R),l.apply(h,V)}}return function(){return l.apply(h,arguments)}}function m(l,h,g){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,m.apply(null,arguments)}function E(l,h){var g=Array.prototype.slice.call(arguments,1);return function(){var R=g.slice();return R.push.apply(R,arguments),l.apply(this,R)}}function y(l,h){function g(){}g.prototype=h.prototype,l.aa=h.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(R,V,M){for(var q=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)q[Ie-2]=arguments[Ie];return h.prototype[V].apply(R,q)}}function x(l){const h=l.length;if(0<h){const g=Array(h);for(let R=0;R<h;R++)g[R]=l[R];return g}return[]}function N(l,h){for(let g=1;g<arguments.length;g++){const R=arguments[g];if(u(R)){const V=l.length||0,M=R.length||0;l.length=V+M;for(let q=0;q<M;q++)l[V+q]=R[q]}else l.push(R)}}class I{constructor(h,g){this.i=h,this.j=g,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function w(l){return/^[\s\xa0]*$/.test(l)}function T(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function k(l){return k[" "](l),l}k[" "]=function(){};var O=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function D(l,h,g){for(const R in l)h.call(g,l[R],R,l)}function _(l,h){for(const g in l)h.call(void 0,l[g],g,l)}function v(l){const h={};for(const g in l)h[g]=l[g];return h}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(l,h){let g,R;for(let V=1;V<arguments.length;V++){R=arguments[V];for(g in R)l[g]=R[g];for(let M=0;M<A.length;M++)g=A[M],Object.prototype.hasOwnProperty.call(R,g)&&(l[g]=R[g])}}function C(l){var h=1;l=l.split(":");const g=[];for(;0<h&&l.length;)g.push(l.shift()),h--;return l.length&&g.push(l.join(":")),g}function j(l){c.setTimeout(()=>{throw l},0)}function S(){var l=Y;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class U{constructor(){this.h=this.g=null}add(h,g){const R=G.get();R.set(h,g),this.h?this.h.next=R:this.g=R,this.h=R}}var G=new I(()=>new ne,l=>l.reset());class ne{constructor(){this.next=this.g=this.h=null}set(h,g){this.h=h,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ve,B=!1,Y=new U,L=()=>{const l=c.Promise.resolve(void 0);ve=()=>{l.then(ie)}};var ie=()=>{for(var l;l=S();){try{l.h.call(l.g)}catch(g){j(g)}var h=G;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}B=!1};function oe(){this.s=this.s,this.C=this.C}oe.prototype.s=!1,oe.prototype.ma=function(){this.s||(this.s=!0,this.N())},oe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function pe(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}pe.prototype.h=function(){this.defaultPrevented=!0};var Me=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};c.addEventListener("test",g,h),c.removeEventListener("test",g,h)}catch{}return l}();function Ge(l,h){if(pe.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,R=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(O){e:{try{k(h.nodeName);var V=!0;break e}catch{}V=!1}V||(h=null)}}else g=="mouseover"?h=l.fromElement:g=="mouseout"&&(h=l.toElement);this.relatedTarget=h,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:kt[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Ge.aa.h.call(this)}}y(Ge,pe);var kt={2:"touch",3:"pen",4:"mouse"};Ge.prototype.h=function(){Ge.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Te="closure_listenable_"+(1e6*Math.random()|0),at=0;function No(l,h,g,R,V){this.listener=l,this.proxy=null,this.src=h,this.type=g,this.capture=!!R,this.ha=V,this.key=++at,this.da=this.fa=!1}function So(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Ao(l){this.src=l,this.g={},this.h=0}Ao.prototype.add=function(l,h,g,R,V){var M=l.toString();l=this.g[M],l||(l=this.g[M]=[],this.h++);var q=fu(l,h,R,V);return-1<q?(h=l[q],g||(h.fa=!1)):(h=new No(h,this.src,M,!!R,V),h.fa=g,l.push(h)),h};function hu(l,h){var g=h.type;if(g in l.g){var R=l.g[g],V=Array.prototype.indexOf.call(R,h,void 0),M;(M=0<=V)&&Array.prototype.splice.call(R,V,1),M&&(So(h),l.g[g].length==0&&(delete l.g[g],l.h--))}}function fu(l,h,g,R){for(var V=0;V<l.length;++V){var M=l[V];if(!M.da&&M.listener==h&&M.capture==!!g&&M.ha==R)return V}return-1}var pu="closure_lm_"+(1e6*Math.random()|0),mu={};function Hp(l,h,g,R,V){if(Array.isArray(h)){for(var M=0;M<h.length;M++)Hp(l,h[M],g,R,V);return null}return g=Qp(g),l&&l[Te]?l.K(h,g,d(R)?!!R.capture:!1,V):A0(l,h,g,!1,R,V)}function A0(l,h,g,R,V,M){if(!h)throw Error("Invalid event type");var q=d(V)?!!V.capture:!!V,Ie=vu(l);if(Ie||(l[pu]=Ie=new Ao(l)),g=Ie.add(h,g,R,q,M),g.proxy)return g;if(R=R0(),g.proxy=R,R.src=l,R.listener=g,l.addEventListener)Me||(V=q),V===void 0&&(V=!1),l.addEventListener(h.toString(),R,V);else if(l.attachEvent)l.attachEvent(Kp(h.toString()),R);else if(l.addListener&&l.removeListener)l.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return g}function R0(){function l(g){return h.call(l.src,l.listener,g)}const h=C0;return l}function Gp(l,h,g,R,V){if(Array.isArray(h))for(var M=0;M<h.length;M++)Gp(l,h[M],g,R,V);else R=d(R)?!!R.capture:!!R,g=Qp(g),l&&l[Te]?(l=l.i,h=String(h).toString(),h in l.g&&(M=l.g[h],g=fu(M,g,R,V),-1<g&&(So(M[g]),Array.prototype.splice.call(M,g,1),M.length==0&&(delete l.g[h],l.h--)))):l&&(l=vu(l))&&(h=l.g[h.toString()],l=-1,h&&(l=fu(h,g,R,V)),(g=-1<l?h[l]:null)&&gu(g))}function gu(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[Te])hu(h.i,l);else{var g=l.type,R=l.proxy;h.removeEventListener?h.removeEventListener(g,R,l.capture):h.detachEvent?h.detachEvent(Kp(g),R):h.addListener&&h.removeListener&&h.removeListener(R),(g=vu(h))?(hu(g,l),g.h==0&&(g.src=null,h[pu]=null)):So(l)}}}function Kp(l){return l in mu?mu[l]:mu[l]="on"+l}function C0(l,h){if(l.da)l=!0;else{h=new Ge(h,this);var g=l.listener,R=l.ha||l.src;l.fa&&gu(l),l=g.call(R,h)}return l}function vu(l){return l=l[pu],l instanceof Ao?l:null}var yu="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qp(l){return typeof l=="function"?l:(l[yu]||(l[yu]=function(h){return l.handleEvent(h)}),l[yu])}function ot(){oe.call(this),this.i=new Ao(this),this.M=this,this.F=null}y(ot,oe),ot.prototype[Te]=!0,ot.prototype.removeEventListener=function(l,h,g,R){Gp(this,l,h,g,R)};function _t(l,h){var g,R=l.F;if(R)for(g=[];R;R=R.F)g.push(R);if(l=l.M,R=h.type||h,typeof h=="string")h=new pe(h,l);else if(h instanceof pe)h.target=h.target||l;else{var V=h;h=new pe(R,l),P(h,V)}if(V=!0,g)for(var M=g.length-1;0<=M;M--){var q=h.g=g[M];V=Ro(q,R,!0,h)&&V}if(q=h.g=l,V=Ro(q,R,!0,h)&&V,V=Ro(q,R,!1,h)&&V,g)for(M=0;M<g.length;M++)q=h.g=g[M],V=Ro(q,R,!1,h)&&V}ot.prototype.N=function(){if(ot.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var g=l.g[h],R=0;R<g.length;R++)So(g[R]);delete l.g[h],l.h--}}this.F=null},ot.prototype.K=function(l,h,g,R){return this.i.add(String(l),h,!1,g,R)},ot.prototype.L=function(l,h,g,R){return this.i.add(String(l),h,!0,g,R)};function Ro(l,h,g,R){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var V=!0,M=0;M<h.length;++M){var q=h[M];if(q&&!q.da&&q.capture==g){var Ie=q.listener,Je=q.ha||q.src;q.fa&&hu(l.i,q),V=Ie.call(Je,R)!==!1&&V}}return V&&!R.defaultPrevented}function Yp(l,h,g){if(typeof l=="function")g&&(l=m(l,g));else if(l&&typeof l.handleEvent=="function")l=m(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(l,h||0)}function Xp(l){l.g=Yp(()=>{l.g=null,l.i&&(l.i=!1,Xp(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class P0 extends oe{constructor(h,g){super(),this.m=h,this.l=g,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Xp(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pi(l){oe.call(this),this.h=l,this.g={}}y(Pi,oe);var Jp=[];function Zp(l){D(l.g,function(h,g){this.g.hasOwnProperty(g)&&gu(h)},l),l.g={}}Pi.prototype.N=function(){Pi.aa.N.call(this),Zp(this)},Pi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _u=c.JSON.stringify,k0=c.JSON.parse,j0=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function wu(){}wu.prototype.h=null;function em(l){return l.h||(l.h=l.i())}function tm(){}var ki={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Eu(){pe.call(this,"d")}y(Eu,pe);function Iu(){pe.call(this,"c")}y(Iu,pe);var zr={},nm=null;function Co(){return nm=nm||new ot}zr.La="serverreachability";function rm(l){pe.call(this,zr.La,l)}y(rm,pe);function ji(l){const h=Co();_t(h,new rm(h))}zr.STAT_EVENT="statevent";function sm(l,h){pe.call(this,zr.STAT_EVENT,l),this.stat=h}y(sm,pe);function wt(l){const h=Co();_t(h,new sm(h,l))}zr.Ma="timingevent";function im(l,h){pe.call(this,zr.Ma,l),this.size=h}y(im,pe);function bi(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},h)}function Oi(){this.g=!0}Oi.prototype.xa=function(){this.g=!1};function b0(l,h,g,R,V,M){l.info(function(){if(l.g)if(M)for(var q="",Ie=M.split("&"),Je=0;Je<Ie.length;Je++){var me=Ie[Je].split("=");if(1<me.length){var lt=me[0];me=me[1];var ct=lt.split("_");q=2<=ct.length&&ct[1]=="type"?q+(lt+"="+me+"&"):q+(lt+"=redacted&")}}else q=null;else q=M;return"XMLHTTP REQ ("+R+") [attempt "+V+"]: "+h+`
`+g+`
`+q})}function O0(l,h,g,R,V,M,q){l.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+V+"]: "+h+`
`+g+`
`+M+" "+q})}function Ts(l,h,g,R){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+V0(l,g)+(R?" "+R:"")})}function D0(l,h){l.info(function(){return"TIMEOUT: "+h})}Oi.prototype.info=function(){};function V0(l,h){if(!l.g)return h;if(!h)return null;try{var g=JSON.parse(h);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var R=g[l];if(!(2>R.length)){var V=R[1];if(Array.isArray(V)&&!(1>V.length)){var M=V[0];if(M!="noop"&&M!="stop"&&M!="close")for(var q=1;q<V.length;q++)V[q]=""}}}}return _u(g)}catch{return h}}var Po={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},am={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Tu;function ko(){}y(ko,wu),ko.prototype.g=function(){return new XMLHttpRequest},ko.prototype.i=function(){return{}},Tu=new ko;function Qn(l,h,g,R){this.j=l,this.i=h,this.l=g,this.R=R||1,this.U=new Pi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new om}function om(){this.i=null,this.g="",this.h=!1}var lm={},xu={};function Nu(l,h,g){l.L=1,l.v=Do(xn(h)),l.m=g,l.P=!0,cm(l,null)}function cm(l,h){l.F=Date.now(),jo(l),l.A=xn(l.v);var g=l.A,R=l.R;Array.isArray(R)||(R=[String(R)]),Tm(g.i,"t",R),l.C=0,g=l.j.J,l.h=new om,l.g=zm(l.j,g?h:null,!l.m),0<l.O&&(l.M=new P0(m(l.Y,l,l.g),l.O)),h=l.U,g=l.g,R=l.ca;var V="readystatechange";Array.isArray(V)||(V&&(Jp[0]=V.toString()),V=Jp);for(var M=0;M<V.length;M++){var q=Hp(g,V[M],R||h.handleEvent,!1,h.h||h);if(!q)break;h.g[q.key]=q}h=l.H?v(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),ji(),b0(l.i,l.u,l.A,l.l,l.R,l.m)}Qn.prototype.ca=function(l){l=l.target;const h=this.M;h&&Nn(l)==3?h.j():this.Y(l)},Qn.prototype.Y=function(l){try{if(l==this.g)e:{const ct=Nn(this.g);var h=this.g.Ba();const Ss=this.g.Z();if(!(3>ct)&&(ct!=3||this.g&&(this.h.h||this.g.oa()||Pm(this.g)))){this.J||ct!=4||h==7||(h==8||0>=Ss?ji(3):ji(2)),Su(this);var g=this.g.Z();this.X=g;t:if(um(this)){var R=Pm(this.g);l="";var V=R.length,M=Nn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Br(this),Di(this);var q="";break t}this.h.i=new c.TextDecoder}for(h=0;h<V;h++)this.h.h=!0,l+=this.h.i.decode(R[h],{stream:!(M&&h==V-1)});R.length=0,this.h.g+=l,this.C=0,q=this.h.g}else q=this.g.oa();if(this.o=g==200,O0(this.i,this.u,this.A,this.l,this.R,ct,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Ie,Je=this.g;if((Ie=Je.g?Je.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Ie)){var me=Ie;break t}}me=null}if(g=me)Ts(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Au(this,g);else{this.o=!1,this.s=3,wt(12),Br(this),Di(this);break e}}if(this.P){g=!0;let Xt;for(;!this.J&&this.C<q.length;)if(Xt=L0(this,q),Xt==xu){ct==4&&(this.s=4,wt(14),g=!1),Ts(this.i,this.l,null,"[Incomplete Response]");break}else if(Xt==lm){this.s=4,wt(15),Ts(this.i,this.l,q,"[Invalid Chunk]"),g=!1;break}else Ts(this.i,this.l,Xt,null),Au(this,Xt);if(um(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ct!=4||q.length!=0||this.h.h||(this.s=1,wt(16),g=!1),this.o=this.o&&g,!g)Ts(this.i,this.l,q,"[Invalid Chunked Response]"),Br(this),Di(this);else if(0<q.length&&!this.W){this.W=!0;var lt=this.j;lt.g==this&&lt.ba&&!lt.M&&(lt.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),bu(lt),lt.M=!0,wt(11))}}else Ts(this.i,this.l,q,null),Au(this,q);ct==4&&Br(this),this.o&&!this.J&&(ct==4?Lm(this.j,this):(this.o=!1,jo(this)))}else eT(this.g),g==400&&0<q.indexOf("Unknown SID")?(this.s=3,wt(12)):(this.s=0,wt(13)),Br(this),Di(this)}}}catch{}finally{}};function um(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function L0(l,h){var g=l.C,R=h.indexOf(`
`,g);return R==-1?xu:(g=Number(h.substring(g,R)),isNaN(g)?lm:(R+=1,R+g>h.length?xu:(h=h.slice(R,R+g),l.C=R+g,h)))}Qn.prototype.cancel=function(){this.J=!0,Br(this)};function jo(l){l.S=Date.now()+l.I,dm(l,l.I)}function dm(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=bi(m(l.ba,l),h)}function Su(l){l.B&&(c.clearTimeout(l.B),l.B=null)}Qn.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(D0(this.i,this.A),this.L!=2&&(ji(),wt(17)),Br(this),this.s=2,Di(this)):dm(this,this.S-l)};function Di(l){l.j.G==0||l.J||Lm(l.j,l)}function Br(l){Su(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,Zp(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Au(l,h){try{var g=l.j;if(g.G!=0&&(g.g==l||Ru(g.h,l))){if(!l.K&&Ru(g.h,l)&&g.G==3){try{var R=g.Da.g.parse(h)}catch{R=null}if(Array.isArray(R)&&R.length==3){var V=R;if(V[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)zo(g),Fo(g);else break e;ju(g),wt(18)}}else g.za=V[1],0<g.za-g.T&&37500>V[2]&&g.F&&g.v==0&&!g.C&&(g.C=bi(m(g.Za,g),6e3));if(1>=pm(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Wr(g,11)}else if((l.K||g.g==l)&&zo(g),!w(h))for(V=g.Da.g.parse(h),h=0;h<V.length;h++){let me=V[h];if(g.T=me[0],me=me[1],g.G==2)if(me[0]=="c"){g.K=me[1],g.ia=me[2];const lt=me[3];lt!=null&&(g.la=lt,g.j.info("VER="+g.la));const ct=me[4];ct!=null&&(g.Aa=ct,g.j.info("SVER="+g.Aa));const Ss=me[5];Ss!=null&&typeof Ss=="number"&&0<Ss&&(R=1.5*Ss,g.L=R,g.j.info("backChannelRequestTimeoutMs_="+R)),R=g;const Xt=l.g;if(Xt){const $o=Xt.g?Xt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($o){var M=R.h;M.g||$o.indexOf("spdy")==-1&&$o.indexOf("quic")==-1&&$o.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Cu(M,M.h),M.h=null))}if(R.D){const Ou=Xt.g?Xt.g.getResponseHeader("X-HTTP-Session-Id"):null;Ou&&(R.ya=Ou,Ne(R.I,R.D,Ou))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),R=g;var q=l;if(R.qa=Um(R,R.J?R.ia:null,R.W),q.K){mm(R.h,q);var Ie=q,Je=R.L;Je&&(Ie.I=Je),Ie.B&&(Su(Ie),jo(Ie)),R.g=q}else Dm(R);0<g.i.length&&Uo(g)}else me[0]!="stop"&&me[0]!="close"||Wr(g,7);else g.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?Wr(g,7):ku(g):me[0]!="noop"&&g.l&&g.l.ta(me),g.v=0)}}ji(4)}catch{}}var M0=class{constructor(l,h){this.g=l,this.map=h}};function hm(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function fm(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function pm(l){return l.h?1:l.g?l.g.size:0}function Ru(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Cu(l,h){l.g?l.g.add(h):l.h=h}function mm(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}hm.prototype.cancel=function(){if(this.i=gm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function gm(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const g of l.g.values())h=h.concat(g.D);return h}return x(l.i)}function F0(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],g=l.length,R=0;R<g;R++)h.push(l[R]);return h}h=[],g=0;for(R in l)h[g++]=l[R];return h}function U0(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var g=0;g<l;g++)h.push(g);return h}h=[],g=0;for(const R in l)h[g++]=R;return h}}}function vm(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var g=U0(l),R=F0(l),V=R.length,M=0;M<V;M++)h.call(void 0,R[M],g&&g[M],l)}var ym=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function z0(l,h){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var R=l[g].indexOf("="),V=null;if(0<=R){var M=l[g].substring(0,R);V=l[g].substring(R+1)}else M=l[g];h(M,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function $r(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof $r){this.h=l.h,bo(this,l.j),this.o=l.o,this.g=l.g,Oo(this,l.s),this.l=l.l;var h=l.i,g=new Mi;g.i=h.i,h.g&&(g.g=new Map(h.g),g.h=h.h),_m(this,g),this.m=l.m}else l&&(h=String(l).match(ym))?(this.h=!1,bo(this,h[1]||"",!0),this.o=Vi(h[2]||""),this.g=Vi(h[3]||"",!0),Oo(this,h[4]),this.l=Vi(h[5]||"",!0),_m(this,h[6]||"",!0),this.m=Vi(h[7]||"")):(this.h=!1,this.i=new Mi(null,this.h))}$r.prototype.toString=function(){var l=[],h=this.j;h&&l.push(Li(h,wm,!0),":");var g=this.g;return(g||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Li(h,wm,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(Li(g,g.charAt(0)=="/"?W0:$0,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",Li(g,H0)),l.join("")};function xn(l){return new $r(l)}function bo(l,h,g){l.j=g?Vi(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Oo(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function _m(l,h,g){h instanceof Mi?(l.i=h,G0(l.i,l.h)):(g||(h=Li(h,q0)),l.i=new Mi(h,l.h))}function Ne(l,h,g){l.i.set(h,g)}function Do(l){return Ne(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Vi(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Li(l,h,g){return typeof l=="string"?(l=encodeURI(l).replace(h,B0),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function B0(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var wm=/[#\/\?@]/g,$0=/[#\?:]/g,W0=/[#\?]/g,q0=/[#\?@]/g,H0=/#/g;function Mi(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Yn(l){l.g||(l.g=new Map,l.h=0,l.i&&z0(l.i,function(h,g){l.add(decodeURIComponent(h.replace(/\+/g," ")),g)}))}t=Mi.prototype,t.add=function(l,h){Yn(this),this.i=null,l=xs(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(h),this.h+=1,this};function Em(l,h){Yn(l),h=xs(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Im(l,h){return Yn(l),h=xs(l,h),l.g.has(h)}t.forEach=function(l,h){Yn(this),this.g.forEach(function(g,R){g.forEach(function(V){l.call(h,V,R,this)},this)},this)},t.na=function(){Yn(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),g=[];for(let R=0;R<h.length;R++){const V=l[R];for(let M=0;M<V.length;M++)g.push(h[R])}return g},t.V=function(l){Yn(this);let h=[];if(typeof l=="string")Im(this,l)&&(h=h.concat(this.g.get(xs(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)h=h.concat(l[g])}return h},t.set=function(l,h){return Yn(this),this.i=null,l=xs(this,l),Im(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Tm(l,h,g){Em(l,h),0<g.length&&(l.i=null,l.g.set(xs(l,h),x(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var g=0;g<h.length;g++){var R=h[g];const M=encodeURIComponent(String(R)),q=this.V(R);for(R=0;R<q.length;R++){var V=M;q[R]!==""&&(V+="="+encodeURIComponent(String(q[R]))),l.push(V)}}return this.i=l.join("&")};function xs(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function G0(l,h){h&&!l.j&&(Yn(l),l.i=null,l.g.forEach(function(g,R){var V=R.toLowerCase();R!=V&&(Em(this,R),Tm(this,V,g))},l)),l.j=h}function K0(l,h){const g=new Oi;if(c.Image){const R=new Image;R.onload=E(Xn,g,"TestLoadImage: loaded",!0,h,R),R.onerror=E(Xn,g,"TestLoadImage: error",!1,h,R),R.onabort=E(Xn,g,"TestLoadImage: abort",!1,h,R),R.ontimeout=E(Xn,g,"TestLoadImage: timeout",!1,h,R),c.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=l}else h(!1)}function Q0(l,h){const g=new Oi,R=new AbortController,V=setTimeout(()=>{R.abort(),Xn(g,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:R.signal}).then(M=>{clearTimeout(V),M.ok?Xn(g,"TestPingServer: ok",!0,h):Xn(g,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(V),Xn(g,"TestPingServer: error",!1,h)})}function Xn(l,h,g,R,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),R(g)}catch{}}function Y0(){this.g=new j0}function X0(l,h,g){const R=g||"";try{vm(l,function(V,M){let q=V;d(V)&&(q=_u(V)),h.push(R+M+"="+encodeURIComponent(q))})}catch(V){throw h.push(R+"type="+encodeURIComponent("_badmap")),V}}function Vo(l){this.l=l.Ub||null,this.j=l.eb||!1}y(Vo,wu),Vo.prototype.g=function(){return new Lo(this.l,this.j)},Vo.prototype.i=function(l){return function(){return l}}({});function Lo(l,h){ot.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(Lo,ot),t=Lo.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,Ui(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fi(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Ui(this)),this.g&&(this.readyState=3,Ui(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;xm(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function xm(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Fi(this):Ui(this),this.readyState==3&&xm(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Fi(this))},t.Qa=function(l){this.g&&(this.response=l,Fi(this))},t.ga=function(){this.g&&Fi(this)};function Fi(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Ui(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var g=h.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=h.next();return l.join(`\r
`)};function Ui(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Lo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Nm(l){let h="";return D(l,function(g,R){h+=R,h+=":",h+=g,h+=`\r
`}),h}function Pu(l,h,g){e:{for(R in g){var R=!1;break e}R=!0}R||(g=Nm(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):Ne(l,h,g))}function Ve(l){ot.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Ve,ot);var J0=/^https?$/i,Z0=["POST","PUT"];t=Ve.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,g,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Tu.g(),this.v=this.o?em(this.o):em(Tu),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(M){Sm(this,M);return}if(l=g||"",g=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var V in R)g.set(V,R[V]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const M of R.keys())g.set(M,R.get(M));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(g.keys()).find(M=>M.toLowerCase()=="content-type"),V=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Z0,h,void 0))||R||V||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,q]of g)this.g.setRequestHeader(M,q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Cm(this),this.u=!0,this.g.send(l),this.u=!1}catch(M){Sm(this,M)}};function Sm(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,Am(l),Mo(l)}function Am(l){l.A||(l.A=!0,_t(l,"complete"),_t(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,_t(this,"complete"),_t(this,"abort"),Mo(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mo(this,!0)),Ve.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Rm(this):this.bb())},t.bb=function(){Rm(this)};function Rm(l){if(l.h&&typeof a<"u"&&(!l.v[1]||Nn(l)!=4||l.Z()!=2)){if(l.u&&Nn(l)==4)Yp(l.Ea,0,l);else if(_t(l,"readystatechange"),Nn(l)==4){l.h=!1;try{const q=l.Z();e:switch(q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var g;if(!(g=h)){var R;if(R=q===0){var V=String(l.D).match(ym)[1]||null;!V&&c.self&&c.self.location&&(V=c.self.location.protocol.slice(0,-1)),R=!J0.test(V?V.toLowerCase():"")}g=R}if(g)_t(l,"complete"),_t(l,"success");else{l.m=6;try{var M=2<Nn(l)?l.g.statusText:""}catch{M=""}l.l=M+" ["+l.Z()+"]",Am(l)}}finally{Mo(l)}}}}function Mo(l,h){if(l.g){Cm(l);const g=l.g,R=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||_t(l,"ready");try{g.onreadystatechange=R}catch{}}}function Cm(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function Nn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<Nn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),k0(h)}};function Pm(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function eT(l){const h={};l=(l.g&&2<=Nn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<l.length;R++){if(w(l[R]))continue;var g=C(l[R]);const V=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const M=h[V]||[];h[V]=M,M.push(g)}_(h,function(R){return R.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function zi(l,h,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||h}function km(l){this.Aa=0,this.i=[],this.j=new Oi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=zi("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=zi("baseRetryDelayMs",5e3,l),this.cb=zi("retryDelaySeedMs",1e4,l),this.Wa=zi("forwardChannelMaxRetries",2,l),this.wa=zi("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new hm(l&&l.concurrentRequestLimit),this.Da=new Y0,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=km.prototype,t.la=8,t.G=1,t.connect=function(l,h,g,R){wt(0),this.W=l,this.H=h||{},g&&R!==void 0&&(this.H.OSID=g,this.H.OAID=R),this.F=this.X,this.I=Um(this,null,this.W),Uo(this)};function ku(l){if(jm(l),l.G==3){var h=l.U++,g=xn(l.I);if(Ne(g,"SID",l.K),Ne(g,"RID",h),Ne(g,"TYPE","terminate"),Bi(l,g),h=new Qn(l,l.j,h),h.L=2,h.v=Do(xn(g)),g=!1,c.navigator&&c.navigator.sendBeacon)try{g=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!g&&c.Image&&(new Image().src=h.v,g=!0),g||(h.g=zm(h.j,null),h.g.ea(h.v)),h.F=Date.now(),jo(h)}Fm(l)}function Fo(l){l.g&&(bu(l),l.g.cancel(),l.g=null)}function jm(l){Fo(l),l.u&&(c.clearTimeout(l.u),l.u=null),zo(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function Uo(l){if(!fm(l.h)&&!l.s){l.s=!0;var h=l.Ga;ve||L(),B||(ve(),B=!0),Y.add(h,l),l.B=0}}function tT(l,h){return pm(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=bi(m(l.Ga,l,h),Mm(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const V=new Qn(this,this.j,l);let M=this.o;if(this.S&&(M?(M=v(M),P(M,this.S)):M=this.S),this.m!==null||this.O||(V.H=M,M=null),this.P)e:{for(var h=0,g=0;g<this.i.length;g++){t:{var R=this.i[g];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(h+=R,4096<h){h=g;break e}if(h===4096||g===this.i.length-1){h=g+1;break e}}h=1e3}else h=1e3;h=Om(this,V,h),g=xn(this.I),Ne(g,"RID",l),Ne(g,"CVER",22),this.D&&Ne(g,"X-HTTP-Session-Id",this.D),Bi(this,g),M&&(this.O?h="headers="+encodeURIComponent(String(Nm(M)))+"&"+h:this.m&&Pu(g,this.m,M)),Cu(this.h,V),this.Ua&&Ne(g,"TYPE","init"),this.P?(Ne(g,"$req",h),Ne(g,"SID","null"),V.T=!0,Nu(V,g,null)):Nu(V,g,h),this.G=2}}else this.G==3&&(l?bm(this,l):this.i.length==0||fm(this.h)||bm(this))};function bm(l,h){var g;h?g=h.l:g=l.U++;const R=xn(l.I);Ne(R,"SID",l.K),Ne(R,"RID",g),Ne(R,"AID",l.T),Bi(l,R),l.m&&l.o&&Pu(R,l.m,l.o),g=new Qn(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Om(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Cu(l.h,g),Nu(g,R,h)}function Bi(l,h){l.H&&D(l.H,function(g,R){Ne(h,R,g)}),l.l&&vm({},function(g,R){Ne(h,R,g)})}function Om(l,h,g){g=Math.min(l.i.length,g);var R=l.l?m(l.l.Na,l.l,l):null;e:{var V=l.i;let M=-1;for(;;){const q=["count="+g];M==-1?0<g?(M=V[0].g,q.push("ofs="+M)):M=0:q.push("ofs="+M);let Ie=!0;for(let Je=0;Je<g;Je++){let me=V[Je].g;const lt=V[Je].map;if(me-=M,0>me)M=Math.max(0,V[Je].g-100),Ie=!1;else try{X0(lt,q,"req"+me+"_")}catch{R&&R(lt)}}if(Ie){R=q.join("&");break e}}}return l=l.i.splice(0,g),h.D=l,R}function Dm(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;ve||L(),B||(ve(),B=!0),Y.add(h,l),l.v=0}}function ju(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=bi(m(l.Fa,l),Mm(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Vm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=bi(m(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,wt(10),Fo(this),Vm(this))};function bu(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Vm(l){l.g=new Qn(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=xn(l.qa);Ne(h,"RID","rpc"),Ne(h,"SID",l.K),Ne(h,"AID",l.T),Ne(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&Ne(h,"TO",l.ja),Ne(h,"TYPE","xmlhttp"),Bi(l,h),l.m&&l.o&&Pu(h,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=Do(xn(h)),g.m=null,g.P=!0,cm(g,l)}t.Za=function(){this.C!=null&&(this.C=null,Fo(this),ju(this),wt(19))};function zo(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Lm(l,h){var g=null;if(l.g==h){zo(l),bu(l),l.g=null;var R=2}else if(Ru(l.h,h))g=h.D,mm(l.h,h),R=1;else return;if(l.G!=0){if(h.o)if(R==1){g=h.m?h.m.length:0,h=Date.now()-h.F;var V=l.B;R=Co(),_t(R,new im(R,g)),Uo(l)}else Dm(l);else if(V=h.s,V==3||V==0&&0<h.X||!(R==1&&tT(l,h)||R==2&&ju(l)))switch(g&&0<g.length&&(h=l.h,h.i=h.i.concat(g)),V){case 1:Wr(l,5);break;case 4:Wr(l,10);break;case 3:Wr(l,6);break;default:Wr(l,2)}}}function Mm(l,h){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*h}function Wr(l,h){if(l.j.info("Error code "+h),h==2){var g=m(l.fb,l),R=l.Xa;const V=!R;R=new $r(R||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||bo(R,"https"),Do(R),V?K0(R.toString(),g):Q0(R.toString(),g)}else wt(2);l.G=0,l.l&&l.l.sa(h),Fm(l),jm(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),wt(2)):(this.j.info("Failed to ping google.com"),wt(1))};function Fm(l){if(l.G=0,l.ka=[],l.l){const h=gm(l.h);(h.length!=0||l.i.length!=0)&&(N(l.ka,h),N(l.ka,l.i),l.h.i.length=0,x(l.i),l.i.length=0),l.l.ra()}}function Um(l,h,g){var R=g instanceof $r?xn(g):new $r(g);if(R.g!="")h&&(R.g=h+"."+R.g),Oo(R,R.s);else{var V=c.location;R=V.protocol,h=h?h+"."+V.hostname:V.hostname,V=+V.port;var M=new $r(null);R&&bo(M,R),h&&(M.g=h),V&&Oo(M,V),g&&(M.l=g),R=M}return g=l.D,h=l.ya,g&&h&&Ne(R,g,h),Ne(R,"VER",l.la),Bi(l,R),R}function zm(l,h,g){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new Ve(new Vo({eb:g})):new Ve(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Bm(){}t=Bm.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Bo(){}Bo.prototype.g=function(l,h){return new jt(l,h)};function jt(l,h){ot.call(this),this.g=new km(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!w(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!w(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Ns(this)}y(jt,ot),jt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},jt.prototype.close=function(){ku(this.g)},jt.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=_u(l),l=g);h.i.push(new M0(h.Ya++,l)),h.G==3&&Uo(h)},jt.prototype.N=function(){this.g.l=null,delete this.j,ku(this.g),delete this.g,jt.aa.N.call(this)};function $m(l){Eu.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const g in h){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}y($m,Eu);function Wm(){Iu.call(this),this.status=1}y(Wm,Iu);function Ns(l){this.g=l}y(Ns,Bm),Ns.prototype.ua=function(){_t(this.g,"a")},Ns.prototype.ta=function(l){_t(this.g,new $m(l))},Ns.prototype.sa=function(l){_t(this.g,new Wm)},Ns.prototype.ra=function(){_t(this.g,"b")},Bo.prototype.createWebChannel=Bo.prototype.g,jt.prototype.send=jt.prototype.o,jt.prototype.open=jt.prototype.m,jt.prototype.close=jt.prototype.close,XE=function(){return new Bo},YE=function(){return Co()},QE=zr,Ah={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Po.NO_ERROR=0,Po.TIMEOUT=8,Po.HTTP_ERROR=6,Pl=Po,am.COMPLETE="complete",KE=am,tm.EventType=ki,ki.OPEN="a",ki.CLOSE="b",ki.ERROR="c",ki.MESSAGE="d",ot.prototype.listen=ot.prototype.K,ia=tm,Ve.prototype.listenOnce=Ve.prototype.L,Ve.prototype.getLastError=Ve.prototype.Ka,Ve.prototype.getLastErrorCode=Ve.prototype.Ba,Ve.prototype.getStatus=Ve.prototype.Z,Ve.prototype.getResponseJson=Ve.prototype.Oa,Ve.prototype.getResponseText=Ve.prototype.oa,Ve.prototype.send=Ve.prototype.ea,Ve.prototype.setWithCredentials=Ve.prototype.Ha,GE=Ve}).apply(typeof ll<"u"?ll:typeof self<"u"?self:typeof window<"u"?window:{});const Lv="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ft.UNAUTHENTICATED=new ft(null),ft.GOOGLE_CREDENTIALS=new ft("google-credentials-uid"),ft.FIRST_PARTY=new ft("first-party-uid"),ft.MOCK_USER=new ft("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ii="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs=new zf("@firebase/firestore");function Xi(){return hs.logLevel}function Q(t,...e){if(hs.logLevel<=ue.DEBUG){const n=e.map(tp);hs.debug(`Firestore (${Ii}): ${t}`,...n)}}function Bn(t,...e){if(hs.logLevel<=ue.ERROR){const n=e.map(tp);hs.error(`Firestore (${Ii}): ${t}`,...n)}}function li(t,...e){if(hs.logLevel<=ue.WARN){const n=e.map(tp);hs.warn(`Firestore (${Ii}): ${t}`,...n)}}function tp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(t="Unexpected state"){const e=`FIRESTORE (${Ii}) INTERNAL ASSERTION FAILED: `+t;throw Bn(e),new Error(e)}function he(t,e){t||J()}function te(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class H extends In{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class IP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ft.UNAUTHENTICATED))}shutdown(){}}class TP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class xP{constructor(e){this.t=e,this.currentUser=ft.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){he(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new ln;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ln,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{Q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Q("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ln)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(he(typeof r.accessToken=="string"),new JE(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return he(e===null||typeof e=="string"),new ft(e)}}class NP{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=ft.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class SP{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new NP(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(ft.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class RP{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){he(this.o===void 0);const r=i=>{i.error!=null&&Q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,Q("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):Q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(he(typeof n.token=="string"),this.R=n.token,new AP(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=CP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function ge(t,e){return t<e?-1:t>e?1:0}function ci(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new H(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new H(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new H(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new H(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return He.fromMillis(Date.now())}static fromDate(e){return He.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new He(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ge(this.nanoseconds,e.nanoseconds):ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Z(e)}static min(){return new Z(new He(0,0))}static max(){return new Z(new He(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,n,r){n===void 0?n=0:n>e.length&&J(),r===void 0?r=e.length-n:r>e.length-n&&J(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Qa.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Qa?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class we extends Qa{construct(e,n,r){return new we(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new H(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new we(n)}static emptyPath(){return new we([])}}const PP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tt extends Qa{construct(e,n,r){return new tt(e,n,r)}static isValidIdentifier(e){return PP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new tt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new H(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new H(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new H(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new H(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tt(n)}static emptyPath(){return new tt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.path=e}static fromPath(e){return new X(we.fromString(e))}static fromName(e){return new X(we.fromString(e).popFirst(5))}static empty(){return new X(we.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&we.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return we.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new X(new we(e.slice()))}}function kP(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Z.fromTimestamp(r===1e9?new He(n+1,0):new He(n,r));return new Cr(s,X.empty(),e)}function jP(t){return new Cr(t.readTime,t.key,-1)}class Cr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Cr(Z.min(),X.empty(),-1)}static max(){return new Cr(Z.max(),X.empty(),-1)}}function bP(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=X.comparator(t.documentKey,e.documentKey),n!==0?n:ge(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class DP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function go(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==OP)throw t;Q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&J(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new z((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof z?n:z.resolve(n)}catch(n){return z.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):z.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):z.reject(n)}static resolve(e){return new z((n,r)=>{n(e)})}static reject(e){return new z((n,r)=>{r(e)})}static waitFor(e){return new z((n,r)=>{let s=0,i=0,a=!1;e.forEach(c=>{++s,c.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(e){let n=z.resolve(!1);for(const r of e)n=n.next(s=>s?z.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new z((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(f=>{a[d]=f,++c,c===i&&r(a)},f=>s(f))}})}static doWhile(e,n){return new z((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function VP(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function vo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}np.oe=-1;function yo(t){return t==null}function fc(t){return t===0&&1/t==-1/0}function LP(t){return typeof t=="number"&&Number.isInteger(t)&&!fc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mv(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ws(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function MP(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function eI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e,n){this.comparator=e,this.root=n||et.EMPTY}insert(e,n){return new De(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,et.BLACK,null,null))}remove(e){return new De(this.comparator,this.root.remove(e,this.comparator).copy(null,null,et.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cl(this.root,e,this.comparator,!1)}getReverseIterator(){return new cl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cl(this.root,e,this.comparator,!0)}}class cl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class et{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??et.RED,this.left=s??et.EMPTY,this.right=i??et.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new et(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return et.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return et.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw J();const e=this.left.check();if(e!==this.right.check())throw J();return e+(this.isRed()?0:1)}}et.EMPTY=null,et.RED=!0,et.BLACK=!1;et.EMPTY=new class{constructor(){this.size=0}get key(){throw J()}get value(){throw J()}get color(){throw J()}get left(){throw J()}get right(){throw J()}copy(e,n,r,s,i){return this}insert(e,n,r){return new et(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e){this.comparator=e,this.data=new De(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Fv(this.data.getIterator())}getIteratorFrom(e){return new Fv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof rt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new rt(this.comparator);return n.data=e,n}}class Fv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.fields=e,e.sort(tt.comparator)}static empty(){return new Dt([])}unionWith(e){let n=new rt(tt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Dt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ci(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new tI("Invalid base64 string: "+i):i}}(e);return new it(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new it(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}it.EMPTY_BYTE_STRING=new it("");const FP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pr(t){if(he(!!t),typeof t=="string"){let e=0;const n=FP.exec(t);if(he(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Fe(t.seconds),nanos:Fe(t.nanos)}}function Fe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function fs(t){return typeof t=="string"?it.fromBase64String(t):it.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function rp(t){const e=t.mapValue.fields.__previous_value__;return Kc(e)?rp(e):e}function Ya(t){const e=Pr(t.mapValue.fields.__local_write_time__.timestampValue);return new He(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e,n,r,s,i,a,c,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d}}class Xa{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Xa("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Xa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul={mapValue:{}};function ps(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Kc(t)?4:BP(t)?9007199254740991:zP(t)?10:11:J()}function _n(t,e){if(t===e)return!0;const n=ps(t);if(n!==ps(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ya(t).isEqual(Ya(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Pr(s.timestampValue),c=Pr(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return fs(s.bytesValue).isEqual(fs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Fe(s.geoPointValue.latitude)===Fe(i.geoPointValue.latitude)&&Fe(s.geoPointValue.longitude)===Fe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Fe(s.integerValue)===Fe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Fe(s.doubleValue),c=Fe(i.doubleValue);return a===c?fc(a)===fc(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return ci(t.arrayValue.values||[],e.arrayValue.values||[],_n);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(Mv(a)!==Mv(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!_n(a[u],c[u])))return!1;return!0}(t,e);default:return J()}}function Ja(t,e){return(t.values||[]).find(n=>_n(n,e))!==void 0}function ui(t,e){if(t===e)return 0;const n=ps(t),r=ps(e);if(n!==r)return ge(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ge(t.booleanValue,e.booleanValue);case 2:return function(i,a){const c=Fe(i.integerValue||i.doubleValue),u=Fe(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return Uv(t.timestampValue,e.timestampValue);case 4:return Uv(Ya(t),Ya(e));case 5:return ge(t.stringValue,e.stringValue);case 6:return function(i,a){const c=fs(i),u=fs(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),u=a.split("/");for(let d=0;d<c.length&&d<u.length;d++){const f=ge(c[d],u[d]);if(f!==0)return f}return ge(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const c=ge(Fe(i.latitude),Fe(a.latitude));return c!==0?c:ge(Fe(i.longitude),Fe(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return zv(t.arrayValue,e.arrayValue);case 10:return function(i,a){var c,u,d,f;const p=i.fields||{},m=a.fields||{},E=(c=p.value)===null||c===void 0?void 0:c.arrayValue,y=(u=m.value)===null||u===void 0?void 0:u.arrayValue,x=ge(((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0,((f=y==null?void 0:y.values)===null||f===void 0?void 0:f.length)||0);return x!==0?x:zv(E,y)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===ul.mapValue&&a===ul.mapValue)return 0;if(i===ul.mapValue)return 1;if(a===ul.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),d=a.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const m=ge(u[p],f[p]);if(m!==0)return m;const E=ui(c[u[p]],d[f[p]]);if(E!==0)return E}return ge(u.length,f.length)}(t.mapValue,e.mapValue);default:throw J()}}function Uv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ge(t,e);const n=Pr(t),r=Pr(e),s=ge(n.seconds,r.seconds);return s!==0?s:ge(n.nanos,r.nanos)}function zv(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=ui(n[s],r[s]);if(i)return i}return ge(n.length,r.length)}function di(t){return Rh(t)}function Rh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Pr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return fs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return X.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Rh(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Rh(n.fields[a])}`;return s+"}"}(t.mapValue):J()}function pc(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ch(t){return!!t&&"integerValue"in t}function sp(t){return!!t&&"arrayValue"in t}function Bv(t){return!!t&&"nullValue"in t}function $v(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function kl(t){return!!t&&"mapValue"in t}function zP(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function ya(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ws(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ya(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ya(t.arrayValue.values[n]);return e}return Object.assign({},t)}function BP(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.value=e}static empty(){return new It({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!kl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ya(n)}setAll(e){let n=tt.emptyPath(),r={},s=[];e.forEach((a,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}a?r[c.lastSegment()]=ya(a):s.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());kl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return _n(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];kl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ws(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new It(ya(this.value))}}function nI(t){const e=[];return ws(t.fields,(n,r)=>{const s=new tt([n]);if(kl(r)){const i=nI(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Dt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e,n,r,s,i,a,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Ye(e,0,Z.min(),Z.min(),Z.min(),It.empty(),0)}static newFoundDocument(e,n,r,s){return new Ye(e,1,n,Z.min(),r,s,0)}static newNoDocument(e,n){return new Ye(e,2,n,Z.min(),Z.min(),It.empty(),0)}static newUnknownDocument(e,n){return new Ye(e,3,n,Z.min(),Z.min(),It.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Z.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=It.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=It.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ye&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ye(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,n){this.position=e,this.inclusive=n}}function Wv(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=X.comparator(X.fromName(a.referenceValue),n.key):r=ui(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function qv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!_n(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e,n="asc"){this.field=e,this.dir=n}}function $P(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rI{}class $e extends rI{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new qP(e,n,r):n==="array-contains"?new KP(e,r):n==="in"?new QP(e,r):n==="not-in"?new YP(e,r):n==="array-contains-any"?new XP(e,r):new $e(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new HP(e,r):new GP(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ui(n,this.value)):n!==null&&ps(this.value)===ps(n)&&this.matchesComparison(ui(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class un extends rI{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new un(e,n)}matches(e){return sI(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function sI(t){return t.op==="and"}function iI(t){return WP(t)&&sI(t)}function WP(t){for(const e of t.filters)if(e instanceof un)return!1;return!0}function Ph(t){if(t instanceof $e)return t.field.canonicalString()+t.op.toString()+di(t.value);if(iI(t))return t.filters.map(e=>Ph(e)).join(",");{const e=t.filters.map(n=>Ph(n)).join(",");return`${t.op}(${e})`}}function aI(t,e){return t instanceof $e?function(r,s){return s instanceof $e&&r.op===s.op&&r.field.isEqual(s.field)&&_n(r.value,s.value)}(t,e):t instanceof un?function(r,s){return s instanceof un&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,c)=>i&&aI(a,s.filters[c]),!0):!1}(t,e):void J()}function oI(t){return t instanceof $e?function(n){return`${n.field.canonicalString()} ${n.op} ${di(n.value)}`}(t):t instanceof un?function(n){return n.op.toString()+" {"+n.getFilters().map(oI).join(" ,")+"}"}(t):"Filter"}class qP extends $e{constructor(e,n,r){super(e,n,r),this.key=X.fromName(r.referenceValue)}matches(e){const n=X.comparator(e.key,this.key);return this.matchesComparison(n)}}class HP extends $e{constructor(e,n){super(e,"in",n),this.keys=lI("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class GP extends $e{constructor(e,n){super(e,"not-in",n),this.keys=lI("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function lI(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>X.fromName(r.referenceValue))}class KP extends $e{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return sp(n)&&Ja(n.arrayValue,this.value)}}class QP extends $e{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ja(this.value.arrayValue,n)}}class YP extends $e{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ja(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Ja(this.value.arrayValue,n)}}class XP extends $e{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!sp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ja(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e,n=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.ue=null}}function Hv(t,e=null,n=[],r=[],s=null,i=null,a=null){return new JP(t,e,n,r,s,i,a)}function ip(t){const e=te(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Ph(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),yo(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>di(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>di(r)).join(",")),e.ue=n}return e.ue}function ap(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!$P(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!aI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!qv(t.startAt,e.startAt)&&qv(t.endAt,e.endAt)}function kh(t){return X.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,n=null,r=[],s=[],i=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function ZP(t,e,n,r,s,i,a,c){return new Es(t,e,n,r,s,i,a,c)}function op(t){return new Es(t)}function Gv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function lp(t){return t.collectionGroup!==null}function Js(t){const e=te(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new rt(tt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Za(i,r))}),n.has(tt.keyField().canonicalString())||e.ce.push(new Za(tt.keyField(),r))}return e.ce}function yn(t){const e=te(t);return e.le||(e.le=cI(e,Js(t))),e.le}function ek(t){const e=te(t);return e.he||(e.he=cI(e,t.explicitOrderBy)),e.he}function cI(t,e){if(t.limitType==="F")return Hv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Za(s.field,i)});const n=t.endAt?new hi(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new hi(t.startAt.position,t.startAt.inclusive):null;return Hv(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function jh(t,e){const n=t.filters.concat([e]);return new Es(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function mc(t,e,n){return new Es(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Qc(t,e){return ap(yn(t),yn(e))&&t.limitType===e.limitType}function uI(t){return`${ip(yn(t))}|lt:${t.limitType}`}function Rs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>oI(s)).join(", ")}]`),yo(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>di(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>di(s)).join(",")),`Target(${r})`}(yn(t))}; limitType=${t.limitType})`}function Yc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):X.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Js(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,c,u){const d=Wv(a,c,u);return a.inclusive?d<=0:d<0}(r.startAt,Js(r),s)||r.endAt&&!function(a,c,u){const d=Wv(a,c,u);return a.inclusive?d>=0:d>0}(r.endAt,Js(r),s))}(t,e)}function tk(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function dI(t){return(e,n)=>{let r=!1;for(const s of Js(t)){const i=nk(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function nk(t,e,n){const r=t.field.isKeyField()?X.comparator(e.key,n.key):function(i,a,c){const u=a.data.field(i),d=c.data.field(i);return u!==null&&d!==null?ui(u,d):J()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return J()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ws(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return eI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rk=new De(X.comparator);function $n(){return rk}const hI=new De(X.comparator);function aa(...t){let e=hI;for(const n of t)e=e.insert(n.key,n);return e}function fI(t){let e=hI;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Zr(){return _a()}function pI(){return _a()}function _a(){return new Ti(t=>t.toString(),(t,e)=>t.isEqual(e))}const sk=new De(X.comparator),ik=new rt(X.comparator);function ce(...t){let e=ik;for(const n of t)e=e.add(n);return e}const ak=new rt(ge);function ok(){return ak}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fc(e)?"-0":e}}function mI(t){return{integerValue:""+t}}function gI(t,e){return LP(e)?mI(e):cp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(){this._=void 0}}function lk(t,e,n){return t instanceof eo?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Kc(i)&&(i=rp(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof fi?yI(t,e):t instanceof to?_I(t,e):function(s,i){const a=vI(s,i),c=Kv(a)+Kv(s.Pe);return Ch(a)&&Ch(s.Pe)?mI(c):cp(s.serializer,c)}(t,e)}function ck(t,e,n){return t instanceof fi?yI(t,e):t instanceof to?_I(t,e):n}function vI(t,e){return t instanceof no?function(r){return Ch(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class eo extends Xc{}class fi extends Xc{constructor(e){super(),this.elements=e}}function yI(t,e){const n=wI(e);for(const r of t.elements)n.some(s=>_n(s,r))||n.push(r);return{arrayValue:{values:n}}}class to extends Xc{constructor(e){super(),this.elements=e}}function _I(t,e){let n=wI(e);for(const r of t.elements)n=n.filter(s=>!_n(s,r));return{arrayValue:{values:n}}}class no extends Xc{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Kv(t){return Fe(t.integerValue||t.doubleValue)}function wI(t){return sp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(e,n){this.field=e,this.transform=n}}function uk(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof fi&&s instanceof fi||r instanceof to&&s instanceof to?ci(r.elements,s.elements,_n):r instanceof no&&s instanceof no?_n(r.Pe,s.Pe):r instanceof eo&&s instanceof eo}(t.transform,e.transform)}class dk{constructor(e,n){this.version=e,this.transformResults=n}}class mt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new mt}static exists(e){return new mt(void 0,e)}static updateTime(e){return new mt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Jc{}function EI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new dp(t.key,mt.none()):new _o(t.key,t.data,mt.none());{const n=t.data,r=It.empty();let s=new rt(tt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Fr(t.key,r,new Dt(s.toArray()),mt.none())}}function hk(t,e,n){t instanceof _o?function(s,i,a){const c=s.value.clone(),u=Yv(s.fieldTransforms,i,a.transformResults);c.setAll(u),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):t instanceof Fr?function(s,i,a){if(!jl(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=Yv(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(II(s)),u.setAll(c),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function wa(t,e,n,r){return t instanceof _o?function(i,a,c,u){if(!jl(i.precondition,a))return c;const d=i.value.clone(),f=Xv(i.fieldTransforms,u,a);return d.setAll(f),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Fr?function(i,a,c,u){if(!jl(i.precondition,a))return c;const d=Xv(i.fieldTransforms,u,a),f=a.data;return f.setAll(II(i)),f.setAll(d),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,a,c){return jl(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,n)}function fk(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=vI(r.transform,s||null);i!=null&&(n===null&&(n=It.empty()),n.set(r.field,i))}return n||null}function Qv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ci(r,s,(i,a)=>uk(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class _o extends Jc{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Fr extends Jc{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function II(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Yv(t,e,n){const r=new Map;he(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,ck(a,c,n[s]))}return r}function Xv(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,lk(i,a,e))}return r}class dp extends Jc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class TI extends Jc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&hk(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=wa(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=wa(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=pI();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=n.has(s.key)?null:c;const u=EI(a,c);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(Z.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ce())}isEqual(e){return this.batchId===e.batchId&&ci(this.mutations,e.mutations,(n,r)=>Qv(n,r))&&ci(this.baseMutations,e.baseMutations,(n,r)=>Qv(n,r))}}class hp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){he(e.mutations.length===r.length);let s=function(){return sk}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new hp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze,de;function xI(t){switch(t){default:return J();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function NI(t){if(t===void 0)return Bn("GRPC error has no .code"),F.UNKNOWN;switch(t){case ze.OK:return F.OK;case ze.CANCELLED:return F.CANCELLED;case ze.UNKNOWN:return F.UNKNOWN;case ze.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case ze.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case ze.INTERNAL:return F.INTERNAL;case ze.UNAVAILABLE:return F.UNAVAILABLE;case ze.UNAUTHENTICATED:return F.UNAUTHENTICATED;case ze.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case ze.NOT_FOUND:return F.NOT_FOUND;case ze.ALREADY_EXISTS:return F.ALREADY_EXISTS;case ze.PERMISSION_DENIED:return F.PERMISSION_DENIED;case ze.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case ze.ABORTED:return F.ABORTED;case ze.OUT_OF_RANGE:return F.OUT_OF_RANGE;case ze.UNIMPLEMENTED:return F.UNIMPLEMENTED;case ze.DATA_LOSS:return F.DATA_LOSS;default:return J()}}(de=ze||(ze={}))[de.OK=0]="OK",de[de.CANCELLED=1]="CANCELLED",de[de.UNKNOWN=2]="UNKNOWN",de[de.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",de[de.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",de[de.NOT_FOUND=5]="NOT_FOUND",de[de.ALREADY_EXISTS=6]="ALREADY_EXISTS",de[de.PERMISSION_DENIED=7]="PERMISSION_DENIED",de[de.UNAUTHENTICATED=16]="UNAUTHENTICATED",de[de.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",de[de.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",de[de.ABORTED=10]="ABORTED",de[de.OUT_OF_RANGE=11]="OUT_OF_RANGE",de[de.UNIMPLEMENTED=12]="UNIMPLEMENTED",de[de.INTERNAL=13]="INTERNAL",de[de.UNAVAILABLE=14]="UNAVAILABLE",de[de.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yk(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k=new rs([4294967295,4294967295],0);function Jv(t){const e=yk().encode(t),n=new HE;return n.update(e),new Uint8Array(n.digest())}function Zv(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new rs([n,r],0),new rs([s,i],0)]}class fp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new oa(`Invalid padding: ${n}`);if(r<0)throw new oa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new oa(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new oa(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=rs.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(rs.fromNumber(r)));return s.compare(_k)===1&&(s=new rs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Jv(e),[r,s]=Zv(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new fp(i,s,n);return r.forEach(c=>a.insert(c)),a}insert(e){if(this.Ie===0)return;const n=Jv(e),[r,s]=Zv(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class oa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,wo.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Zc(Z.min(),s,new De(ge),$n(),ce())}}class wo{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new wo(r,n,ce(),ce(),ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class SI{constructor(e,n){this.targetId=e,this.me=n}}class AI{constructor(e,n,r=it.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class ey{constructor(){this.fe=0,this.ge=ny(),this.pe=it.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ce(),n=ce(),r=ce();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:J()}}),new wo(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=ny()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,he(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class wk{constructor(e){this.Le=e,this.Be=new Map,this.ke=$n(),this.qe=ty(),this.Qe=new De(ge)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:J()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(kh(i))if(r===0){const a=new X(i.path);this.Ue(n,a,Ye.newNoDocument(a,Z.min()))}else he(r===1);else{const a=this.Ye(n);if(a!==r){const c=this.Ze(e),u=c?this.Xe(c,e,a):1;if(u!==0){this.je(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,c;try{a=fs(r).toUint8Array()}catch(u){if(u instanceof tI)return li("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new fp(a,s,i)}catch(u){return li(u instanceof oa?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Ie===0?null:c}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const c=this.Je(a);if(c){if(i.current&&kh(c.target)){const u=new X(c.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,Ye.newNoDocument(u,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=ce();this.qe.forEach((i,a)=>{let c=!0;a.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new Zc(e,n,this.Qe,this.ke,r);return this.ke=$n(),this.qe=ty(),this.Qe=new De(ge),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new ey,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new rt(ge),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Q("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ey),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function ty(){return new De(X.comparator)}function ny(){return new De(X.comparator)}const Ek={asc:"ASCENDING",desc:"DESCENDING"},Ik={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Tk={and:"AND",or:"OR"};class xk{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function bh(t,e){return t.useProto3Json||yo(e)?e:{value:e}}function gc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function RI(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Nk(t,e){return gc(t,e.toTimestamp())}function Lt(t){return he(!!t),Z.fromTimestamp(function(n){const r=Pr(n);return new He(r.seconds,r.nanos)}(t))}function pp(t,e){return Oh(t,e).canonicalString()}function Oh(t,e){const n=function(s){return new we(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function CI(t){const e=we.fromString(t);return he(VI(e)),e}function vc(t,e){return pp(t.databaseId,e.path)}function Ea(t,e){const n=CI(e);if(n.get(1)!==t.databaseId.projectId)throw new H(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new H(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new X(kI(n))}function PI(t,e){return pp(t.databaseId,e)}function Sk(t){const e=CI(t);return e.length===4?we.emptyPath():kI(e)}function Dh(t){return new we(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function kI(t){return he(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function ry(t,e,n){return{name:vc(t,e),fields:n.value.mapValue.fields}}function Ak(t,e){return"found"in e?function(r,s){he(!!s.found),s.found.name,s.found.updateTime;const i=Ea(r,s.found.name),a=Lt(s.found.updateTime),c=s.found.createTime?Lt(s.found.createTime):Z.min(),u=new It({mapValue:{fields:s.found.fields}});return Ye.newFoundDocument(i,a,c,u)}(t,e):"missing"in e?function(r,s){he(!!s.missing),he(!!s.readTime);const i=Ea(r,s.missing),a=Lt(s.readTime);return Ye.newNoDocument(i,a)}(t,e):J()}function Rk(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:J()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(he(f===void 0||typeof f=="string"),it.fromBase64String(f||"")):(he(f===void 0||f instanceof Buffer||f instanceof Uint8Array),it.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(d){const f=d.code===void 0?F.UNKNOWN:NI(d.code);return new H(f,d.message||"")}(a);n=new AI(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ea(t,r.document.name),i=Lt(r.document.updateTime),a=r.document.createTime?Lt(r.document.createTime):Z.min(),c=new It({mapValue:{fields:r.document.fields}}),u=Ye.newFoundDocument(s,i,a,c),d=r.targetIds||[],f=r.removedTargetIds||[];n=new bl(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ea(t,r.document),i=r.readTime?Lt(r.readTime):Z.min(),a=Ye.newNoDocument(s,i),c=r.removedTargetIds||[];n=new bl([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ea(t,r.document),i=r.removedTargetIds||[];n=new bl([],i,s,null)}else{if(!("filter"in e))return J();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new vk(s,i),c=r.targetId;n=new SI(c,a)}}return n}function jI(t,e){let n;if(e instanceof _o)n={update:ry(t,e.key,e.value)};else if(e instanceof dp)n={delete:vc(t,e.key)};else if(e instanceof Fr)n={update:ry(t,e.key,e.data),updateMask:Lk(e.fieldMask)};else{if(!(e instanceof TI))return J();n={verify:vc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const c=a.transform;if(c instanceof eo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof fi)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof to)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof no)return{fieldPath:a.field.canonicalString(),increment:c.Pe};throw J()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Nk(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:J()}(t,e.precondition)),n}function Ck(t,e){return t&&t.length>0?(he(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?Lt(s.updateTime):Lt(i);return a.isEqual(Z.min())&&(a=Lt(i)),new dk(a,s.transformResults||[])}(n,e))):[]}function Pk(t,e){return{documents:[PI(t,e.path)]}}function bI(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=PI(t,s);const i=function(d){if(d.length!==0)return DI(un.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(d){if(d.length!==0)return d.map(f=>function(m){return{field:lr(m.field),direction:Ok(m.dir)}}(f))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const c=bh(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:s}}function kk(t,e,n,r){const{_t:s,parent:i}=bI(t,e),a={},c=[];let u=0;return n.forEach(d=>{const f="aggregate_"+u++;a[f]=d.alias,d.aggregateType==="count"?c.push({alias:f,count:{}}):d.aggregateType==="avg"?c.push({alias:f,avg:{field:lr(d.fieldPath)}}):d.aggregateType==="sum"&&c.push({alias:f,sum:{field:lr(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:c,structuredQuery:s.structuredQuery},parent:s.parent},ut:a,parent:i}}function jk(t){let e=Sk(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){he(r===1);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(p){const m=OI(p);return m instanceof un&&iI(m)?m.getFilters():[m]}(n.where));let a=[];n.orderBy&&(a=function(p){return p.map(m=>function(y){return new Za(Cs(y.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(m))}(n.orderBy));let c=null;n.limit&&(c=function(p){let m;return m=typeof p=="object"?p.value:p,yo(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(p){const m=!!p.before,E=p.values||[];return new hi(E,m)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const m=!p.before,E=p.values||[];return new hi(E,m)}(n.endAt)),ZP(e,s,a,i,c,"F",u,d)}function bk(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function OI(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Cs(n.unaryFilter.field);return $e.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Cs(n.unaryFilter.field);return $e.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Cs(n.unaryFilter.field);return $e.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Cs(n.unaryFilter.field);return $e.create(a,"!=",{nullValue:"NULL_VALUE"});default:return J()}}(t):t.fieldFilter!==void 0?function(n){return $e.create(Cs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return J()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return un.create(n.compositeFilter.filters.map(r=>OI(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return J()}}(n.compositeFilter.op))}(t):J()}function Ok(t){return Ek[t]}function Dk(t){return Ik[t]}function Vk(t){return Tk[t]}function lr(t){return{fieldPath:t.canonicalString()}}function Cs(t){return tt.fromServerFormat(t.fieldPath)}function DI(t){return t instanceof $e?function(n){if(n.op==="=="){if($v(n.value))return{unaryFilter:{field:lr(n.field),op:"IS_NAN"}};if(Bv(n.value))return{unaryFilter:{field:lr(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if($v(n.value))return{unaryFilter:{field:lr(n.field),op:"IS_NOT_NAN"}};if(Bv(n.value))return{unaryFilter:{field:lr(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lr(n.field),op:Dk(n.op),value:n.value}}}(t):t instanceof un?function(n){const r=n.getFilters().map(s=>DI(s));return r.length===1?r[0]:{compositeFilter:{op:Vk(n.op),filters:r}}}(t):J()}function Lk(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function VI(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e,n,r,s,i=Z.min(),a=Z.min(),c=it.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new fr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new fr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new fr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new fr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e){this.ct=e}}function Fk(t){const e=jk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?mc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(){this.un=new zk}addToCollectionParentIndex(e,n){return this.un.add(n),z.resolve()}getCollectionParents(e,n){return z.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return z.resolve()}deleteFieldIndex(e,n){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,n){return z.resolve()}getDocumentsMatchingTarget(e,n){return z.resolve(null)}getIndexType(e,n){return z.resolve(0)}getFieldIndexes(e,n){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,n){return z.resolve(Cr.min())}getMinOffsetFromCollectionGroup(e,n){return z.resolve(Cr.min())}updateCollectionGroup(e,n,r){return z.resolve()}updateIndexEntries(e,n){return z.resolve()}}class zk{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new rt(we.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new rt(we.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new pi(0)}static kn(){return new pi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(){this.changes=new Ti(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ye.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?z.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&wa(r.mutation,s,Dt.empty(),He.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ce()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ce()){const s=Zr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=aa();return i.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Zr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ce()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,c)=>{n.set(a,c)})})}computeViews(e,n,r,s){let i=$n();const a=_a(),c=function(){return _a()}();return n.forEach((u,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof Fr)?i=i.insert(d.key,d):f!==void 0?(a.set(d.key,f.mutation.getFieldMask()),wa(f.mutation,d,f.mutation.getFieldMask(),He.now())):a.set(d.key,Dt.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>a.set(d,f)),n.forEach((d,f)=>{var p;return c.set(d,new $k(f,(p=a.get(d))!==null&&p!==void 0?p:null))}),c))}recalculateAndSaveOverlays(e,n){const r=_a();let s=new De((a,c)=>a-c),i=ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const c of a)c.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let f=r.get(u)||Dt.empty();f=c.applyToLocalView(d,f),r.set(u,f);const p=(s.get(c.batchId)||ce()).add(u);s=s.insert(c.batchId,p)})}).next(()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,f=u.value,p=pI();f.forEach(m=>{if(!i.has(m)){const E=EI(n.get(m),r.get(m));E!==null&&p.set(m,E),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,p))}return z.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return X.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):lp(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):z.resolve(Zr());let c=-1,u=i;return a.next(d=>z.forEach(d,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),i.get(f)?z.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{u=u.insert(f,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,ce())).next(f=>({batchId:c,changes:fI(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new X(n)).next(r=>{let s=aa();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=aa();return this.indexManager.getCollectionParents(e,i).next(c=>z.forEach(c,u=>{const d=function(p,m){return new Es(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((p,m)=>{a=a.insert(p,m)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((u,d)=>{const f=d.getKey();a.get(f)===null&&(a=a.insert(f,Ye.newInvalidDocument(f)))});let c=aa();return a.forEach((u,d)=>{const f=i.get(u);f!==void 0&&wa(f.mutation,d,Dt.empty(),He.now()),Yc(n,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return z.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Lt(s.createTime)}}(n)),z.resolve()}getNamedQuery(e,n){return z.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:Fk(s.bundledQuery),readTime:Lt(s.readTime)}}(n)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(){this.overlays=new De(X.comparator),this.Ir=new Map}getOverlay(e,n){return z.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Zr();return z.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),z.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),z.resolve()}getOverlaysForCollection(e,n,r){const s=Zr(),i=n.length+1,a=new X(n.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return z.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new De((d,f)=>d-f);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=Zr(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const c=Zr(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>c.set(d,f)),!(c.size()>=s)););return z.resolve(c)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new mk(n,r));let i=this.Ir.get(n);i===void 0&&(i=ce(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gk{constructor(){this.sessionToken=it.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(){this.Tr=new rt(Ke.Er),this.dr=new rt(Ke.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Ke(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Ke(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new X(new we([])),r=new Ke(n,e),s=new Ke(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new X(new we([])),r=new Ke(n,e),s=new Ke(n,e+1);let i=ce();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new Ke(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ke{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return X.comparator(e.key,n.key)||ge(e.wr,n.wr)}static Ar(e,n){return ge(e.wr,n.wr)||X.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new rt(Ke.Er)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new pk(i,n,r,s);this.mutationQueue.push(a);for(const c of s)this.br=this.br.add(new Ke(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return z.resolve(a)}lookupMutationBatch(e,n){return z.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return z.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ke(n,0),s=new Ke(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const c=this.Dr(a.wr);i.push(c)}),z.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new rt(ge);return n.forEach(s=>{const i=new Ke(s,0),a=new Ke(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],c=>{r=r.add(c.wr)})}),z.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;X.isDocumentKey(i)||(i=i.child(""));const a=new Ke(new X(i),0);let c=new rt(ge);return this.br.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.wr)),!0)},a),z.resolve(this.Cr(c))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){he(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return z.forEach(n.mutations,s=>{const i=new Ke(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Ke(n,0),s=this.br.firstAfterOrEqual(r);return z.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(e){this.Mr=e,this.docs=function(){return new De(X.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return z.resolve(r?r.document.mutableCopy():Ye.newInvalidDocument(n))}getEntries(e,n){let r=$n();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ye.newInvalidDocument(s))}),z.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=$n();const a=n.path,c=new X(a.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||bP(jP(f),r)<=0||(s.has(f.key)||Yc(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return z.resolve(i)}getAllFromCollectionGroup(e,n,r,s){J()}Or(e,n){return z.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Yk(this)}getSize(e){return z.resolve(this.size)}}class Yk extends Bk{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),z.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(e){this.persistence=e,this.Nr=new Ti(n=>ip(n),ap),this.lastRemoteSnapshotVersion=Z.min(),this.highestTargetId=0,this.Lr=0,this.Br=new mp,this.targetCount=0,this.kr=pi.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),z.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new pi(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,z.resolve()}updateTargetData(e,n){return this.Kn(n),z.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),z.waitFor(i).next(()=>s)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return z.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),z.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),z.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),z.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return z.resolve(r)}containsKey(e,n){return z.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e,n){this.qr={},this.overlays={},this.Qr=new np(0),this.Kr=!1,this.Kr=!0,this.$r=new Gk,this.referenceDelegate=e(this),this.Ur=new Xk(this),this.indexManager=new Uk,this.remoteDocumentCache=function(s){return new Qk(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Mk(n),this.Gr=new qk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Hk,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new Kk(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){Q("MemoryPersistence","Starting transaction:",e);const s=new Zk(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return z.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class Zk extends DP{constructor(e){super(),this.currentSequenceNumber=e}}class gp{constructor(e){this.persistence=e,this.Jr=new mp,this.Yr=null}static Zr(e){return new gp(e)}get Xr(){if(this.Yr)return this.Yr;throw J()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),z.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),z.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.Xr,r=>{const s=X.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,Z.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return z.or([()=>z.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=ce(),s=ce();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new vp(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tj{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return HS()?8:VP(yt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new ej;return this.Xi(e,n,a).next(c=>{if(i.result=c,this.zi)return this.es(e,n,a,c.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Xi()<=ue.DEBUG&&Q("QueryEngine","SDK will not create cache indexes for query:",Rs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),z.resolve()):(Xi()<=ue.DEBUG&&Q("QueryEngine","Query:",Rs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Xi()<=ue.DEBUG&&Q("QueryEngine","The SDK decides to create cache indexes for query:",Rs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yn(n))):z.resolve())}Yi(e,n){if(Gv(n))return z.resolve(null);let r=yn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=mc(n,null,"F"),r=yn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=ce(...i);return this.Ji.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.ts(n,c);return this.ns(n,d,a,u.readTime)?this.Yi(e,mc(n,null,"F")):this.rs(e,d,n,u)}))})))}Zi(e,n,r,s){return Gv(n)||s.isEqual(Z.min())?z.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?z.resolve(null):(Xi()<=ue.DEBUG&&Q("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Rs(n)),this.rs(e,a,n,kP(s,-1)).next(c=>c))})}ts(e,n){let r=new rt(dI(e));return n.forEach((s,i)=>{Yc(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Xi()<=ue.DEBUG&&Q("QueryEngine","Using full collection scan to execute query:",Rs(n)),this.Ji.getDocumentsMatchingQuery(e,n,Cr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new De(ge),this._s=new Ti(i=>ip(i),ap),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Wk(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function rj(t,e,n,r){return new nj(t,e,n,r)}async function LI(t,e){const n=te(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],c=[];let u=ce();for(const d of s){a.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){c.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:c}))})})}function sj(t,e){const n=te(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(c,u,d,f){const p=d.batch,m=p.keys();let E=z.resolve();return m.forEach(y=>{E=E.next(()=>f.getEntry(u,y)).next(x=>{const N=d.docVersions.get(y);he(N!==null),x.version.compareTo(N)<0&&(p.applyToRemoteDocument(x,d),x.isValidDocument()&&(x.setReadTime(d.commitVersion),f.addEntry(x)))})}),E.next(()=>c.mutationQueue.removeMutationBatch(u,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=ce();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function MI(t){const e=te(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function ij(t,e){const n=te(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const c=[];e.targetChanges.forEach((f,p)=>{const m=s.get(p);if(!m)return;c.push(n.Ur.removeMatchingKeys(i,f.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(i,f.addedDocuments,p)));let E=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?E=E.withResumeToken(it.EMPTY_BYTE_STRING,Z.min()).withLastLimboFreeSnapshotVersion(Z.min()):f.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(f.resumeToken,r)),s=s.insert(p,E),function(x,N,I){return x.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(m,E,f)&&c.push(n.Ur.updateTargetData(i,E))});let u=$n(),d=ce();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),c.push(aj(i,a,e.documentUpdates).next(f=>{u=f.Ps,d=f.Is})),!r.isEqual(Z.min())){const f=n.Ur.getLastRemoteSnapshotVersion(i).next(p=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(f)}return z.waitFor(c).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.os=s,i))}function aj(t,e,n){let r=ce(),s=ce();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=$n();return n.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(Z.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):Q("LocalStore","Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{Ps:a,Is:s}})}function oj(t,e){const n=te(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function lj(t,e){const n=te(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,z.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new fr(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Vh(t,e,n){const r=te(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!vo(a))throw a;Q("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function sy(t,e,n){const r=te(t);let s=Z.min(),i=ce();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,f){const p=te(u),m=p._s.get(f);return m!==void 0?z.resolve(p.os.get(m)):p.Ur.getTargetData(d,f)}(r,a,yn(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,c.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:Z.min(),n?i:ce())).next(c=>(cj(r,tk(e),c),{documents:c,Ts:i})))}function cj(t,e,n){let r=t.us.get(e)||Z.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class iy{constructor(){this.activeTargetIds=ok()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class uj{constructor(){this.so=new iy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new iy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dl=null;function md(){return dl===null?dl=function(){return 268435456+Math.round(2147483648*Math.random())}():dl++,"0x"+dl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ht="WebChannelConnection";class pj extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const c=md(),u=this.xo(n,r.toUriEncodedString());Q("RestConnection",`Sending RPC '${n}' ${c}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,a),this.No(n,u,d,s).then(f=>(Q("RestConnection",`Received RPC '${n}' ${c}: `,f),f),f=>{throw li("RestConnection",`RPC '${n}' ${c} failed with error: `,f,"url: ",u,"request:",s),f})}Lo(n,r,s,i,a,c){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ii}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=hj[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=md();return new Promise((a,c)=>{const u=new GE;u.setWithCredentials(!0),u.listenOnce(KE.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Pl.NO_ERROR:const f=u.getResponseJson();Q(ht,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(f)),a(f);break;case Pl.TIMEOUT:Q(ht,`RPC '${e}' ${i} timed out`),c(new H(F.DEADLINE_EXCEEDED,"Request time out"));break;case Pl.HTTP_ERROR:const p=u.getStatus();if(Q(ht,`RPC '${e}' ${i} failed with status:`,p,"response text:",u.getResponseText()),p>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const E=m==null?void 0:m.error;if(E&&E.status&&E.message){const y=function(N){const I=N.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(I)>=0?I:F.UNKNOWN}(E.status);c(new H(y,E.message))}else c(new H(F.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new H(F.UNAVAILABLE,"Connection failed."));break;default:J()}}finally{Q(ht,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);Q(ht,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",d,r,15)})}Bo(e,n,r){const s=md(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=XE(),c=YE(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=i.join("");Q(ht,`Creating RPC '${e}' stream ${s}: ${f}`,u);const p=a.createWebChannel(f,u);let m=!1,E=!1;const y=new fj({Io:N=>{E?Q(ht,`Not sending because RPC '${e}' stream ${s} is closed:`,N):(m||(Q(ht,`Opening RPC '${e}' stream ${s} transport.`),p.open(),m=!0),Q(ht,`RPC '${e}' stream ${s} sending:`,N),p.send(N))},To:()=>p.close()}),x=(N,I,w)=>{N.listen(I,T=>{try{w(T)}catch(k){setTimeout(()=>{throw k},0)}})};return x(p,ia.EventType.OPEN,()=>{E||(Q(ht,`RPC '${e}' stream ${s} transport opened.`),y.yo())}),x(p,ia.EventType.CLOSE,()=>{E||(E=!0,Q(ht,`RPC '${e}' stream ${s} transport closed`),y.So())}),x(p,ia.EventType.ERROR,N=>{E||(E=!0,li(ht,`RPC '${e}' stream ${s} transport errored:`,N),y.So(new H(F.UNAVAILABLE,"The operation could not be completed")))}),x(p,ia.EventType.MESSAGE,N=>{var I;if(!E){const w=N.data[0];he(!!w);const T=w,k=T.error||((I=T[0])===null||I===void 0?void 0:I.error);if(k){Q(ht,`RPC '${e}' stream ${s} received error:`,k);const O=k.status;let D=function(A){const P=ze[A];if(P!==void 0)return NI(P)}(O),_=k.message;D===void 0&&(D=F.INTERNAL,_="Unknown error status: "+O+" with message "+k.message),E=!0,y.So(new H(D,_)),p.close()}else Q(ht,`RPC '${e}' stream ${s} received:`,w),y.bo(w)}}),x(c,QE.STAT_EVENT,N=>{N.stat===Ah.PROXY?Q(ht,`RPC '${e}' stream ${s} detected buffering proxy`):N.stat===Ah.NOPROXY&&Q(ht,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function gd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(t){return new xk(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&Q("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(e,n,r,s,i,a,c,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new yp(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===F.RESOURCE_EXHAUSTED?(Bn(n.toString()),Bn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new H(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class mj extends FI{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=Rk(this.serializer,e),r=function(i){if(!("targetChange"in i))return Z.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Z.min():a.readTime?Lt(a.readTime):Z.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Dh(this.serializer),n.addTarget=function(i,a){let c;const u=a.target;if(c=kh(u)?{documents:Pk(i,u)}:{query:bI(i,u)._t},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=RI(i,a.resumeToken);const d=bh(i,a.expectedCount);d!==null&&(c.expectedCount=d)}else if(a.snapshotVersion.compareTo(Z.min())>0){c.readTime=gc(i,a.snapshotVersion.toTimestamp());const d=bh(i,a.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const r=bk(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Dh(this.serializer),n.removeTarget=e,this.a_(n)}}class gj extends FI{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return he(!!e.streamToken),this.lastStreamToken=e.streamToken,he(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){he(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=Ck(e.writeResults,e.commitTime),r=Lt(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Dh(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>jI(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new H(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,Oh(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new H(F.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Lo(e,Oh(n,r),s,a,c,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new H(F.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class yj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Bn(n),this.D_=!1):Q("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{Is(this)&&(Q("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=te(u);d.L_.add(4),await Eo(d),d.q_.set("Unknown"),d.L_.delete(4),await tu(d)}(this))})}),this.q_=new yj(r,s)}}async function tu(t){if(Is(t))for(const e of t.B_)await e(!0)}async function Eo(t){for(const e of t.B_)await e(!1)}function UI(t,e){const n=te(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Ip(n)?Ep(n):xi(n).r_()&&wp(n,e))}function _p(t,e){const n=te(t),r=xi(n);n.N_.delete(e),r.r_()&&zI(n,e),n.N_.size===0&&(r.r_()?r.o_():Is(n)&&n.q_.set("Unknown"))}function wp(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Z.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}xi(t).A_(e)}function zI(t,e){t.Q_.xe(e),xi(t).R_(e)}function Ep(t){t.Q_=new wk({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),xi(t).start(),t.q_.v_()}function Ip(t){return Is(t)&&!xi(t).n_()&&t.N_.size>0}function Is(t){return te(t).L_.size===0}function BI(t){t.Q_=void 0}async function wj(t){t.q_.set("Online")}async function Ej(t){t.N_.forEach((e,n)=>{wp(t,e)})}async function Ij(t,e){BI(t),Ip(t)?(t.q_.M_(e),Ep(t)):t.q_.set("Unknown")}async function Tj(t,e,n){if(t.q_.set("Online"),e instanceof AI&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const c of i.targetIds)s.N_.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.N_.delete(c),s.Q_.removeTarget(c))}(t,e)}catch(r){Q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await yc(t,r)}else if(e instanceof bl?t.Q_.Ke(e):e instanceof SI?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Z.min()))try{const r=await MI(t.localStore);n.compareTo(r)>=0&&await function(i,a){const c=i.Q_.rt(a);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.N_.get(d);f&&i.N_.set(d,f.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,d)=>{const f=i.N_.get(u);if(!f)return;i.N_.set(u,f.withResumeToken(it.EMPTY_BYTE_STRING,f.snapshotVersion)),zI(i,u);const p=new fr(f.target,u,d,f.sequenceNumber);wp(i,p)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){Q("RemoteStore","Failed to raise snapshot:",r),await yc(t,r)}}async function yc(t,e,n){if(!vo(e))throw e;t.L_.add(1),await Eo(t),t.q_.set("Offline"),n||(n=()=>MI(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Q("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await tu(t)})}function $I(t,e){return e().catch(n=>yc(t,n,e))}async function nu(t){const e=te(t),n=kr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;xj(e);)try{const s=await oj(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,Nj(e,s)}catch(s){await yc(e,s)}WI(e)&&qI(e)}function xj(t){return Is(t)&&t.O_.length<10}function Nj(t,e){t.O_.push(e);const n=kr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function WI(t){return Is(t)&&!kr(t).n_()&&t.O_.length>0}function qI(t){kr(t).start()}async function Sj(t){kr(t).p_()}async function Aj(t){const e=kr(t);for(const n of t.O_)e.m_(n.mutations)}async function Rj(t,e,n){const r=t.O_.shift(),s=hp.from(r,e,n);await $I(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await nu(t)}async function Cj(t,e){e&&kr(t).V_&&await async function(r,s){if(function(a){return xI(a)&&a!==F.ABORTED}(s.code)){const i=r.O_.shift();kr(r).s_(),await $I(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await nu(r)}}(t,e),WI(t)&&qI(t)}async function oy(t,e){const n=te(t);n.asyncQueue.verifyOperationInProgress(),Q("RemoteStore","RemoteStore received new credentials");const r=Is(n);n.L_.add(3),await Eo(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await tu(n)}async function Pj(t,e){const n=te(t);e?(n.L_.delete(2),await tu(n)):e||(n.L_.add(2),await Eo(n),n.q_.set("Unknown"))}function xi(t){return t.K_||(t.K_=function(n,r,s){const i=te(n);return i.w_(),new mj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:wj.bind(null,t),Ro:Ej.bind(null,t),mo:Ij.bind(null,t),d_:Tj.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Ip(t)?Ep(t):t.q_.set("Unknown")):(await t.K_.stop(),BI(t))})),t.K_}function kr(t){return t.U_||(t.U_=function(n,r,s){const i=te(n);return i.w_(),new gj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Sj.bind(null,t),mo:Cj.bind(null,t),f_:Aj.bind(null,t),g_:Rj.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await nu(t)):(await t.U_.stop(),t.O_.length>0&&(Q("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ln,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,c=new Tp(e,n,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new H(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xp(t,e){if(Bn("AsyncQueue",`${e}: ${t}`),vo(t))return new H(F.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e){this.comparator=e?(n,r)=>e(n,r)||X.comparator(n.key,r.key):(n,r)=>X.comparator(n.key,r.key),this.keyedMap=aa(),this.sortedSet=new De(this.comparator)}static emptySet(e){return new Zs(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Zs)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Zs;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(){this.W_=new De(X.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):J():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class mi{constructor(e,n,r,s,i,a,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(c=>{a.push({type:0,doc:c})}),new mi(e,n,Zs.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class jj{constructor(){this.queries=cy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=te(n),i=s.queries;s.queries=cy(),i.forEach((a,c)=>{for(const u of c.j_)u.onError(r)})})(this,new H(F.ABORTED,"Firestore shutting down"))}}function cy(){return new Ti(t=>uI(t),Qc)}async function HI(t,e){const n=te(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new kj,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const c=xp(a,`Initialization of query '${Rs(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Np(n)}async function GI(t,e){const n=te(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function bj(t,e){const n=te(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const c of a.j_)c.X_(s)&&(r=!0);a.z_=s}}r&&Np(n)}function Oj(t,e,n){const r=te(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Np(t){t.Y_.forEach(e=>{e.next()})}var Lh,uy;(uy=Lh||(Lh={})).ea="default",uy.Cache="cache";class KI{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new mi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=mi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Lh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(e){this.key=e}}class YI{constructor(e){this.key=e}}class Dj{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ce(),this.mutatedKeys=ce(),this.Aa=dI(e),this.Ra=new Zs(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new ly,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,p)=>{const m=s.get(f),E=Yc(this.query,p)?p:null,y=!!m&&this.mutatedKeys.has(m.key),x=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let N=!1;m&&E?m.data.isEqual(E.data)?y!==x&&(r.track({type:3,doc:E}),N=!0):this.ga(m,E)||(r.track({type:2,doc:E}),N=!0,(u&&this.Aa(E,u)>0||d&&this.Aa(E,d)<0)&&(c=!0)):!m&&E?(r.track({type:0,doc:E}),N=!0):m&&!E&&(r.track({type:1,doc:m}),N=!0,(u||d)&&(c=!0)),N&&(E?(a=a.add(E),i=x?i.add(f):i.delete(f)):(a=a.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{Ra:a,fa:r,ns:c,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,p)=>function(E,y){const x=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J()}};return x(E)-x(y)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(r),s=s!=null&&s;const c=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,a.length!==0||d?{snapshot:new mi(this.query,e.Ra,i,a,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new ly,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ce(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new YI(r))}),this.da.forEach(r=>{e.has(r)||n.push(new QI(r))}),n}ba(e){this.Ta=e.Ts,this.da=ce();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return mi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class Vj{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Lj{constructor(e){this.key=e,this.va=!1}}class Mj{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Ti(c=>uI(c),Qc),this.Ma=new Map,this.xa=new Set,this.Oa=new De(X.comparator),this.Na=new Map,this.La=new mp,this.Ba={},this.ka=new Map,this.qa=pi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Fj(t,e,n=!0){const r=n0(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await XI(r,e,n,!0),s}async function Uj(t,e){const n=n0(t);await XI(n,e,!0,!1)}async function XI(t,e,n,r){const s=await lj(t.localStore,yn(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let c;return r&&(c=await zj(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&UI(t.remoteStore,s),c}async function zj(t,e,n,r,s){t.Ka=(p,m,E)=>async function(x,N,I,w){let T=N.view.ma(I);T.ns&&(T=await sy(x.localStore,N.query,!1).then(({documents:_})=>N.view.ma(_,T)));const k=w&&w.targetChanges.get(N.targetId),O=w&&w.targetMismatches.get(N.targetId)!=null,D=N.view.applyChanges(T,x.isPrimaryClient,k,O);return hy(x,N.targetId,D.wa),D.snapshot}(t,p,m,E);const i=await sy(t.localStore,e,!0),a=new Dj(e,i.Ts),c=a.ma(i.documents),u=wo.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=a.applyChanges(c,t.isPrimaryClient,u);hy(t,n,d.wa);const f=new Vj(e,n,a);return t.Fa.set(e,f),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function Bj(t,e,n){const r=te(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!Qc(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Vh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&_p(r.remoteStore,s.targetId),Mh(r,s.targetId)}).catch(go)):(Mh(r,s.targetId),await Vh(r.localStore,s.targetId,!0))}async function $j(t,e){const n=te(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),_p(n.remoteStore,r.targetId))}async function Wj(t,e,n){const r=Xj(t);try{const s=await function(a,c){const u=te(a),d=He.now(),f=c.reduce((E,y)=>E.add(y.key),ce());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",E=>{let y=$n(),x=ce();return u.cs.getEntries(E,f).next(N=>{y=N,y.forEach((I,w)=>{w.isValidDocument()||(x=x.add(I))})}).next(()=>u.localDocuments.getOverlayedDocuments(E,y)).next(N=>{p=N;const I=[];for(const w of c){const T=fk(w,p.get(w.key).overlayedDocument);T!=null&&I.push(new Fr(w.key,T,nI(T.value.mapValue),mt.exists(!0)))}return u.mutationQueue.addMutationBatch(E,d,I,c)}).next(N=>{m=N;const I=N.applyToLocalDocumentSet(p,x);return u.documentOverlayCache.saveOverlays(E,N.batchId,I)})}).then(()=>({batchId:m.batchId,changes:fI(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,c,u){let d=a.Ba[a.currentUser.toKey()];d||(d=new De(ge)),d=d.insert(c,u),a.Ba[a.currentUser.toKey()]=d}(r,s.batchId,n),await Io(r,s.changes),await nu(r.remoteStore)}catch(s){const i=xp(s,"Failed to persist write");n.reject(i)}}async function JI(t,e){const n=te(t);try{const r=await ij(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(he(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?he(a.va):s.removedDocuments.size>0&&(he(a.va),a.va=!1))}),await Io(n,r,e)}catch(r){await go(r)}}function dy(t,e,n){const r=te(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const c=a.view.Z_(e);c.snapshot&&s.push(c.snapshot)}),function(a,c){const u=te(a);u.onlineState=c;let d=!1;u.queries.forEach((f,p)=>{for(const m of p.j_)m.Z_(c)&&(d=!0)}),d&&Np(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function qj(t,e,n){const r=te(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new De(X.comparator);a=a.insert(i,Ye.newNoDocument(i,Z.min()));const c=ce().add(i),u=new Zc(Z.min(),new Map,new De(ge),a,c);await JI(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Sp(r)}else await Vh(r.localStore,e,!1).then(()=>Mh(r,e,n)).catch(go)}async function Hj(t,e){const n=te(t),r=e.batch.batchId;try{const s=await sj(n.localStore,e);e0(n,r,null),ZI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Io(n,s)}catch(s){await go(s)}}async function Gj(t,e,n){const r=te(t);try{const s=await function(a,c){const u=te(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,c).next(p=>(he(p!==null),f=p.keys(),u.mutationQueue.removeMutationBatch(d,p))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(r.localStore,e);e0(r,e,n),ZI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Io(r,s)}catch(s){await go(s)}}function ZI(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function e0(t,e,n){const r=te(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Mh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||t0(t,r)})}function t0(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(_p(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Sp(t))}function hy(t,e,n){for(const r of n)r instanceof QI?(t.La.addReference(r.key,e),Kj(t,r)):r instanceof YI?(Q("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||t0(t,r.key)):J()}function Kj(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(Q("SyncEngine","New document in limbo: "+n),t.xa.add(r),Sp(t))}function Sp(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new X(we.fromString(e)),r=t.qa.next();t.Na.set(r,new Lj(n)),t.Oa=t.Oa.insert(n,r),UI(t.remoteStore,new fr(yn(op(n.path)),r,"TargetPurposeLimboResolution",np.oe))}}async function Io(t,e,n){const r=te(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((c,u)=>{a.push(r.Ka(u,e,n).then(d=>{var f;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(d){s.push(d);const p=vp.Wi(u.targetId,d);i.push(p)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(u,d){const f=te(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>z.forEach(d,m=>z.forEach(m.$i,E=>f.persistence.referenceDelegate.addReference(p,m.targetId,E)).next(()=>z.forEach(m.Ui,E=>f.persistence.referenceDelegate.removeReference(p,m.targetId,E)))))}catch(p){if(!vo(p))throw p;Q("LocalStore","Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const E=f.os.get(m),y=E.snapshotVersion,x=E.withLastLimboFreeSnapshotVersion(y);f.os=f.os.insert(m,x)}}}(r.localStore,i))}async function Qj(t,e){const n=te(t);if(!n.currentUser.isEqual(e)){Q("SyncEngine","User change. New user:",e.toKey());const r=await LI(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(c=>{c.forEach(u=>{u.reject(new H(F.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Io(n,r.hs)}}function Yj(t,e){const n=te(t),r=n.Na.get(e);if(r&&r.va)return ce().add(r.key);{let s=ce();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const c=n.Fa.get(a);s=s.unionWith(c.view.Va)}return s}}function n0(t){const e=te(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=JI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Yj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qj.bind(null,e),e.Ca.d_=bj.bind(null,e.eventManager),e.Ca.$a=Oj.bind(null,e.eventManager),e}function Xj(t){const e=te(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Hj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Gj.bind(null,e),e}class _c{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=eu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return rj(this.persistence,new tj,e.initialUser,this.serializer)}Ga(e){return new Jk(gp.Zr,this.serializer)}Wa(e){return new uj}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_c.provider={build:()=>new _c};class Fh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>dy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Qj.bind(null,this.syncEngine),await Pj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new jj}()}createDatastore(e){const n=eu(e.databaseInfo.databaseId),r=function(i){return new pj(i)}(e.databaseInfo);return function(i,a,c,u){return new vj(i,a,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,c){return new _j(r,s,i,a,c)}(this.localStore,this.datastore,e.asyncQueue,n=>dy(this.syncEngine,n,0),function(){return ay.D()?new ay:new dj}())}createSyncEngine(e,n){return function(s,i,a,c,u,d,f){const p=new Mj(s,i,a,c,u,d);return f&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=te(s);Q("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Eo(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Fh.provider={build:()=>new Fh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Bn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new H(F.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,i){const a=te(s),c={documents:i.map(p=>vc(a.serializer,p))},u=await a.Lo("BatchGetDocuments",a.serializer.databaseId,we.emptyPath(),c,i.length),d=new Map;u.forEach(p=>{const m=Ak(a.serializer,p);d.set(m.key.toString(),m)});const f=[];return i.forEach(p=>{const m=d.get(p.toString());he(!!m),f.push(m)}),f}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new dp(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=X.fromPath(r);this.mutations.push(new TI(s,this.precondition(s)))}),await async function(r,s){const i=te(r),a={writes:s.map(c=>jI(i.serializer,c))};await i.Mo("Commit",i.serializer.databaseId,we.emptyPath(),a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw J();n=Z.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new H(F.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Z.min())?mt.exists(!1):mt.updateTime(n):mt.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Z.min()))throw new H(F.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return mt.updateTime(n)}return mt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zj{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this._u=r.maxAttempts,this.t_=new yp(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new Jj(this.datastore),n=this.cu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.lu(s)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const n=this.updateFunction(e);return!yo(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!xI(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=ft.UNAUTHENTICATED,this.clientId=ZE.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{Q("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(Q("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ln;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=xp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function vd(t,e){t.asyncQueue.verifyOperationInProgress(),Q("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await LI(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function fy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await tb(t);Q("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>oy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>oy(e.remoteStore,s)),t._onlineComponents=e}async function tb(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Q("FirestoreClient","Using user provided OfflineComponentProvider");try{await vd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===F.FAILED_PRECONDITION||s.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;li("Error using user provided cache. Falling back to memory cache: "+n),await vd(t,new _c)}}else Q("FirestoreClient","Using default OfflineComponentProvider"),await vd(t,new _c);return t._offlineComponents}async function Ap(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Q("FirestoreClient","Using user provided OnlineComponentProvider"),await fy(t,t._uninitializedComponentsProvider._online)):(Q("FirestoreClient","Using default OnlineComponentProvider"),await fy(t,new Fh))),t._onlineComponents}function nb(t){return Ap(t).then(e=>e.syncEngine)}function s0(t){return Ap(t).then(e=>e.datastore)}async function i0(t){const e=await Ap(t),n=e.eventManager;return n.onListen=Fj.bind(null,e.syncEngine),n.onUnlisten=Bj.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Uj.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=$j.bind(null,e.syncEngine),n}function rb(t,e,n={}){const r=new ln;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,d){const f=new r0({next:m=>{f.Za(),a.enqueueAndForget(()=>GI(i,p));const E=m.docs.has(c);!E&&m.fromCache?d.reject(new H(F.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&m.fromCache&&u&&u.source==="server"?d.reject(new H(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new KI(op(c.path),f,{includeMetadataChanges:!0,_a:!0});return HI(i,p)}(await i0(t),t.asyncQueue,e,n,r)),r.promise}function sb(t,e,n={}){const r=new ln;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,d){const f=new r0({next:m=>{f.Za(),a.enqueueAndForget(()=>GI(i,p)),m.fromCache&&u.source==="server"?d.reject(new H(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new KI(c,f,{includeMetadataChanges:!0,_a:!0});return HI(i,p)}(await i0(t),t.asyncQueue,e,n,r)),r.promise}function ib(t,e,n){const r=new ln;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await s0(t);r.resolve(async function(a,c,u){var d;const f=te(a),{request:p,ut:m,parent:E}=kk(f.serializer,ek(c),u);f.connection.Fo||delete p.parent;const y=(await f.Lo("RunAggregationQuery",f.serializer.databaseId,E,p,1)).filter(N=>!!N.result);he(y.length===1);const x=(d=y[0].result)===null||d===void 0?void 0:d.aggregateFields;return Object.keys(x).reduce((N,I)=>(N[m[I]]=x[I],N),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a0(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const py=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(t,e,n){if(!n)throw new H(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function ab(t,e,n,r){if(e===!0&&r===!0)throw new H(F.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function my(t){if(!X.isDocumentKey(t))throw new H(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function gy(t){if(X.isDocumentKey(t))throw new H(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ru(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":J()}function Yt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new H(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ru(t);throw new H(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function ob(t,e){if(e<=0)throw new H(F.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new H(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new H(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ab("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=a0((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new H(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new H(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new H(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class su{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new vy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new H(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new H(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new vy(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new IP;switch(r.type){case"firstParty":return new SP(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new H(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=py.get(n);r&&(Q("ComponentProvider","Removing Datastore"),py.delete(n),r.terminate())}(this),Promise.resolve()}}function lb(t,e,n,r={}){var s;const i=(t=Yt(t,su))._getSettings(),a=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&li("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),r.mockUserToken){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=ft.MOCK_USER;else{c=aE(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new H(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new ft(d)}t._authCredentials=new TP(new JE(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Kn(this.firestore,e,this._query)}}class gt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gt(this.firestore,e,this._key)}}class Nr extends Kn{constructor(e,n,r){super(e,n,op(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new gt(this.firestore,null,new X(e))}withConverter(e){return new Nr(this.firestore,e,this._path)}}function ae(t,e,...n){if(t=Oe(t),o0("collection","path",e),t instanceof su){const r=we.fromString(e,...n);return gy(r),new Nr(t,null,r)}{if(!(t instanceof gt||t instanceof Nr))throw new H(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(we.fromString(e,...n));return gy(r),new Nr(t.firestore,null,r)}}function se(t,e,...n){if(t=Oe(t),arguments.length===1&&(e=ZE.newId()),o0("doc","path",e),t instanceof su){const r=we.fromString(e,...n);return my(r),new gt(t,null,new X(r))}{if(!(t instanceof gt||t instanceof Nr))throw new H(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(we.fromString(e,...n));return my(r),new gt(t.firestore,t instanceof Nr?t.converter:null,new X(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new yp(this,"async_queue_retry"),this.Vu=()=>{const r=gd();r&&Q("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=gd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=gd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new ln;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!vo(e))throw e;Q("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),c}(r);throw Bn("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Tp.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&J()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Ur extends su{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new yy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new yy(e),this._firestoreClient=void 0,await e}}}function cb(t,e){const n=typeof t=="object"?t:Wc(),r=typeof t=="string"?t:"(default)",s=$c(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=rE("firestore");i&&lb(s,...i)}return s}function To(t){if(t._terminated)throw new H(F.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||ub(t),t._firestoreClient}function ub(t){var e,n,r;const s=t._freezeSettings(),i=function(c,u,d,f){return new UP(c,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,a0(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new eb(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class hb{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ms(it.fromBase64String(e))}catch(n){throw new H(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ms(it.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new H(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new H(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new H(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ge(this._lat,e._lat)||ge(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fb=/^__.*__$/;class pb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Fr(e,this.data,this.fieldMask,n,this.fieldTransforms):new _o(e,this.data,n,this.fieldTransforms)}}class l0{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Fr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function c0(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J()}}class iu{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new iu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return wc(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(c0(this.Cu)&&fb.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class mb{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||eu(e)}Qu(e,n,r,s=!1){return new iu({Cu:e,methodName:n,qu:r,path:tt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Si(t){const e=t._freezeSettings(),n=eu(t._databaseId);return new mb(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Pp(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);Op("Data must be an object, but it was:",a,r);const c=f0(r,a);let u,d;if(i.merge)u=new Dt(a.fieldMask),d=a.fieldTransforms;else if(i.mergeFields){const f=[];for(const p of i.mergeFields){const m=Uh(e,p,n);if(!a.contains(m))throw new H(F.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);m0(f,m)||f.push(m)}u=new Dt(f),d=a.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,d=a.fieldTransforms;return new pb(new It(c),u,d)}class au extends Ni{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof au}}function gb(t,e,n){return new iu({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class kp extends Ni{_toFieldTransform(e){return new up(e.path,new eo)}isEqual(e){return e instanceof kp}}class jp extends Ni{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=gb(this,e,!0),r=this.Ku.map(i=>Ai(i,n)),s=new fi(r);return new up(e.path,s)}isEqual(e){return e instanceof jp&&Wa(this.Ku,e.Ku)}}class bp extends Ni{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new no(e.serializer,gI(e.serializer,this.$u));return new up(e.path,n)}isEqual(e){return e instanceof bp&&this.$u===e.$u}}function u0(t,e,n,r){const s=t.Qu(1,e,n);Op("Data must be an object, but it was:",s,r);const i=[],a=It.empty();ws(r,(u,d)=>{const f=Dp(e,u,n);d=Oe(d);const p=s.Nu(f);if(d instanceof au)i.push(f);else{const m=Ai(d,p);m!=null&&(i.push(f),a.set(f,m))}});const c=new Dt(i);return new l0(a,c,s.fieldTransforms)}function d0(t,e,n,r,s,i){const a=t.Qu(1,e,n),c=[Uh(e,r,n)],u=[s];if(i.length%2!=0)throw new H(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)c.push(Uh(e,i[m])),u.push(i[m+1]);const d=[],f=It.empty();for(let m=c.length-1;m>=0;--m)if(!m0(d,c[m])){const E=c[m];let y=u[m];y=Oe(y);const x=a.Nu(E);if(y instanceof au)d.push(E);else{const N=Ai(y,x);N!=null&&(d.push(E),f.set(E,N))}}const p=new Dt(d);return new l0(f,p,a.fieldTransforms)}function h0(t,e,n,r=!1){return Ai(n,t.Qu(r?4:3,e))}function Ai(t,e){if(p0(t=Oe(t)))return Op("Unsupported field value:",e,t),f0(t,e);if(t instanceof Ni)return function(r,s){if(!c0(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const c of r){let u=Ai(c,s.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Oe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return gI(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=He.fromDate(r);return{timestampValue:gc(s.serializer,i)}}if(r instanceof He){const i=new He(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:gc(s.serializer,i)}}if(r instanceof Rp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ms)return{bytesValue:RI(s.serializer,r._byteString)};if(r instanceof gt){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:pp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Cp)return function(a,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw c.Bu("VectorValues must only contain numeric values.");return cp(c.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${ru(r)}`)}(t,e)}function f0(t,e){const n={};return eI(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ws(t,(r,s)=>{const i=Ai(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function p0(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof He||t instanceof Rp||t instanceof ms||t instanceof gt||t instanceof Ni||t instanceof Cp)}function Op(t,e,n){if(!p0(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=ru(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Uh(t,e,n){if((e=Oe(e))instanceof xo)return e._internalPath;if(typeof e=="string")return Dp(t,e);throw wc("Field path arguments must be of type string or ",t,!1,void 0,n)}const vb=new RegExp("[~\\*/\\[\\]]");function Dp(t,e,n){if(e.search(vb)>=0)throw wc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new xo(...e.split("."))._internalPath}catch{throw wc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function wc(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new H(F.INVALID_ARGUMENT,c+t+u)}function m0(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new gt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new yb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ou("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class yb extends ro{data(){return super.data()}}function ou(t,e){return typeof e=="string"?Dp(t,e):e instanceof xo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _b(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new H(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Vp{}class lu extends Vp{}function ye(t,e,...n){let r=[];e instanceof Vp&&r.push(e),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof Lp).length,c=i.filter(u=>u instanceof cu).length;if(a>1||a>0&&c>0)throw new H(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class cu extends lu{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new cu(e,n,r)}_apply(e){const n=this._parse(e);return g0(e._query,n),new Kn(e.firestore,e.converter,jh(e._query,n))}_parse(e){const n=Si(e.firestore);return function(i,a,c,u,d,f,p){let m;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new H(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){wy(p,f);const E=[];for(const y of p)E.push(_y(u,i,y));m={arrayValue:{values:E}}}else m=_y(u,i,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||wy(p,f),m=h0(c,a,p,f==="in"||f==="not-in");return $e.create(d,f,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ce(t,e,n){const r=e,s=ou("where",t);return cu._create(s,r,n)}class Lp extends Vp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Lp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:un.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const c=i.getFlattenedFilters();for(const u of c)g0(a,u),a=jh(a,u)}(e._query,n),new Kn(e.firestore,e.converter,jh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Mp extends lu{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Mp(e,n)}_apply(e){const n=function(s,i,a){if(s.startAt!==null)throw new H(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new H(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Za(i,a)}(e._query,this._field,this._direction);return new Kn(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new Es(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function wn(t,e="asc"){const n=e,r=ou("orderBy",t);return Mp._create(r,n)}class Fp extends lu{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Fp(e,n,r)}_apply(e){return new Kn(e.firestore,e.converter,mc(e._query,this._limit,this._limitType))}}function Wn(t){return ob("limit",t),Fp._create("limit",t,"F")}class Up extends lu{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Up(e,n,r)}_apply(e){const n=Eb(e,this.type,this._docOrFields,this._inclusive);return new Kn(e.firestore,e.converter,function(s,i){return new Es(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function wb(...t){return Up._create("startAfter",t,!1)}function Eb(t,e,n,r){if(n[0]=Oe(n[0]),n[0]instanceof ro)return function(i,a,c,u,d){if(!u)throw new H(F.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);const f=[];for(const p of Js(i))if(p.field.isKeyField())f.push(pc(a,u.key));else{const m=u.data.field(p.field);if(Kc(m))throw new H(F.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const E=p.field.canonicalString();throw new H(F.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${E}' (used as the orderBy) does not exist.`)}f.push(m)}return new hi(f,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=Si(t.firestore);return function(a,c,u,d,f,p){const m=a.explicitOrderBy;if(f.length>m.length)throw new H(F.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const E=[];for(let y=0;y<f.length;y++){const x=f[y];if(m[y].field.isKeyField()){if(typeof x!="string")throw new H(F.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof x}`);if(!lp(a)&&x.indexOf("/")!==-1)throw new H(F.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${x}' contains a slash.`);const N=a.path.child(we.fromString(x));if(!X.isDocumentKey(N))throw new H(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);const I=new X(N);E.push(pc(c,I))}else{const N=h0(u,d,x);E.push(N)}}return new hi(E,p)}(t._query,t.firestore._databaseId,s,e,n,r)}}function _y(t,e,n){if(typeof(n=Oe(n))=="string"){if(n==="")throw new H(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lp(e)&&n.indexOf("/")!==-1)throw new H(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(we.fromString(n));if(!X.isDocumentKey(r))throw new H(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return pc(t,new X(r))}if(n instanceof gt)return pc(t,n._key);throw new H(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ru(n)}.`)}function wy(t,e){if(!Array.isArray(t)||t.length===0)throw new H(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function g0(t,e){const n=function(s,i){for(const a of s)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new H(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new H(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class v0{convertValue(e,n="none"){switch(ps(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Fe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(fs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw J()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ws(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>Fe(a.doubleValue));return new Cp(i)}convertGeoPoint(e){return new Rp(Fe(e.latitude),Fe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=rp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ya(e));default:return null}}convertTimestamp(e){const n=Pr(e);return new He(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=we.fromString(e);he(VI(r));const s=new Xa(r.get(1),r.get(3)),i=new X(r.popFirst(5));return s.isEqual(n)||Bn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Ib extends v0{constructor(e){super(),this.firestore=e}convertBytes(e){return new ms(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new gt(this.firestore,null,n)}}function Tb(){return new db("count")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Bp extends ro{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ol(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ou("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Ol extends Bp{data(e={}){return super.data(e)}}class xb{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Bs(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ol(this._firestore,this._userDataWriter,r.key,r,new Bs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new H(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(c=>{const u=new Ol(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Bs(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new Ol(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Bs(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return c.type!==0&&(d=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:Nb(c.type),doc:u,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function Nb(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mt(t){t=Yt(t,gt);const e=Yt(t.firestore,Ur);return rb(To(e),t._key).then(n=>Ab(e,t,n))}class uu extends v0{constructor(e){super(),this.firestore=e}convertBytes(e){return new ms(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new gt(this.firestore,null,n)}}function Ee(t){t=Yt(t,Kn);const e=Yt(t.firestore,Ur),n=To(e),r=new uu(e);return _b(t._query),sb(n,t._query).then(s=>new xb(e,r,t,s))}function Sb(t,e,n){t=Yt(t,gt);const r=Yt(t.firestore,Ur),s=zp(t.converter,e,n);return $p(r,[Pp(Si(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,mt.none())])}function Ri(t,e,n,...r){t=Yt(t,gt);const s=Yt(t.firestore,Ur),i=Si(s);let a;return a=typeof(e=Oe(e))=="string"||e instanceof xo?d0(i,"updateDoc",t._key,e,n,r):u0(i,"updateDoc",t._key,e),$p(s,[a.toMutation(t._key,mt.exists(!0))])}function zh(t,e){const n=Yt(t.firestore,Ur),r=se(t),s=zp(t.converter,e);return $p(n,[Pp(Si(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,mt.exists(!1))]).then(()=>r)}function $p(t,e){return function(r,s){const i=new ln;return r.asyncQueue.enqueueAndForget(async()=>Wj(await nb(r),s,i)),i.promise}(To(t),e)}function Ab(t,e,n){const r=n.docs.get(e._key),s=new uu(t);return new Bp(t,s,e._key,r,new Bs(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hl(t){return Rb(t,{count:Tb()})}function Rb(t,e){const n=Yt(t.firestore,Ur),r=To(n),s=MP(e,(i,a)=>new gk(a,i.aggregateType,i._internalFieldPath));return ib(r,t._query,s).then(i=>function(c,u,d){const f=new uu(c);return new hb(u,f,d)}(n,t,i))}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb={maxAttempts:5};function Ji(t,e){if((t=Oe(t)).firestore!==e)throw new H(F.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Si(n)}get(n){const r=Ji(n,this._firestore),s=new Ib(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return J();const a=i[0];if(a.isFoundDocument())return new ro(this._firestore,s,a.key,a,r.converter);if(a.isNoDocument())return new ro(this._firestore,s,r._key,null,r.converter);throw J()})}set(n,r,s){const i=Ji(n,this._firestore),a=zp(i.converter,r,s),c=Pp(this._dataReader,"Transaction.set",i._key,a,i.converter!==null,s);return this._transaction.set(i._key,c),this}update(n,r,s,...i){const a=Ji(n,this._firestore);let c;return c=typeof(r=Oe(r))=="string"||r instanceof xo?d0(this._dataReader,"Transaction.update",a._key,r,s,i):u0(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,c),this}delete(n){const r=Ji(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Ji(e,this._firestore),r=new uu(this._firestore);return super.get(e).then(s=>new Bp(this._firestore,r,n._key,s._document,new Bs(!1,!1),n.converter))}}function Ci(t,e,n){t=Yt(t,Ur);const r=Object.assign(Object.assign({},Cb),n);return function(i){if(i.maxAttempts<1)throw new H(F.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,a,c){const u=new ln;return i.asyncQueue.enqueueAndForget(async()=>{const d=await s0(i);new Zj(i.asyncQueue,d,c,a,u).au()}),u.promise}(To(t),s=>e(new Pb(t,s)),r)}function re(){return new kp("serverTimestamp")}function Wp(...t){return new jp("arrayUnion",t)}function Ia(t){return new bp("increment",t)}(function(e,n=!0){(function(s){Ii=s})(_s),cs(new Rr("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new Ur(new xP(r.getProvider("auth-internal")),new RP(r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new H(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xa(d.options.projectId,f)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),gn(Lv,"4.7.3",e),gn(Lv,"4.7.3","esm2017")})();var kb="firebase",jb="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gn(kb,jb,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0="firebasestorage.googleapis.com",bb="storageBucket",Ob=2*60*1e3,Db=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn extends In{constructor(e,n,r=0){super(yd(e),`Firebase Storage: ${n} (${yd(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Tn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return yd(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var En;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(En||(En={}));function yd(t){return"storage/"+t}function Vb(){const t="An unknown error occurred, please check the error payload for server response.";return new Tn(En.UNKNOWN,t)}function Lb(){return new Tn(En.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Mb(){return new Tn(En.CANCELED,"User canceled the upload/download.")}function Fb(t){return new Tn(En.INVALID_URL,"Invalid URL '"+t+"'.")}function Ub(t){return new Tn(En.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Ey(t){return new Tn(En.INVALID_ARGUMENT,t)}function _0(){return new Tn(En.APP_DELETED,"The Firebase app was deleted.")}function zb(t){return new Tn(En.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=rn.makeFromUrl(e,n)}catch{return new rn(e,"")}if(r.path==="")return r;throw Ub(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(k){k.path.charAt(k.path.length-1)==="/"&&(k.path_=k.path_.slice(0,-1))}const a="(/(.*))?$",c=new RegExp("^gs://"+s+a,"i"),u={bucket:1,path:3};function d(k){k.path_=decodeURIComponent(k.path)}const f="v[A-Za-z0-9_]+",p=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",E=new RegExp(`^https?://${p}/${f}/b/${s}/o${m}`,"i"),y={bucket:1,path:3},x=n===y0?"(?:storage.googleapis.com|storage.cloud.google.com)":n,N="([^?#]*)",I=new RegExp(`^https?://${x}/${s}/${N}`,"i"),T=[{regex:c,indices:u,postModify:i},{regex:E,indices:y,postModify:d},{regex:I,indices:{bucket:1,path:2},postModify:d}];for(let k=0;k<T.length;k++){const O=T[k],D=O.regex.exec(e);if(D){const _=D[O.indices.bucket];let v=D[O.indices.path];v||(v=""),r=new rn(_,v),O.postModify(r);break}}if(r==null)throw Fb(e);return r}}class Bb{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $b(t,e,n){let r=1,s=null,i=null,a=!1,c=0;function u(){return c===2}let d=!1;function f(...N){d||(d=!0,e.apply(null,N))}function p(N){s=setTimeout(()=>{s=null,t(E,u())},N)}function m(){i&&clearTimeout(i)}function E(N,...I){if(d){m();return}if(N){m(),f.call(null,N,...I);return}if(u()||a){m(),f.call(null,N,...I);return}r<64&&(r*=2);let T;c===1?(c=2,T=0):T=(r+Math.random())*1e3,p(T)}let y=!1;function x(N){y||(y=!0,m(),!d&&(s!==null?(N||(c=2),clearTimeout(s),p(0)):N||(c=1)))}return p(0),i=setTimeout(()=>{a=!0,x(!0)},n),x}function Wb(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(t){return t!==void 0}function Iy(t,e,n,r){if(r<e)throw Ey(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Ey(`Invalid value for '${t}'. Expected ${n} or less.`)}function Hb(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Ec;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Ec||(Ec={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gb(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e,n,r,s,i,a,c,u,d,f,p,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=f,this.connectionFactory_=p,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((E,y)=>{this.resolve_=E,this.reject_=y,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new fl(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=c=>{const u=c.loaded,d=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const c=i.getErrorCode()===Ec.NO_ERROR,u=i.getStatus();if(!c||Gb(u,this.additionalRetryCodes_)&&this.retry){const f=i.getErrorCode()===Ec.ABORT;r(!1,new fl(!1,null,f));return}const d=this.successCodes_.indexOf(u)!==-1;r(!0,new fl(d,i))})},n=(r,s)=>{const i=this.resolve_,a=this.reject_,c=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(c,c.getResponse());qb(u)?i(u):i()}catch(u){a(u)}else if(c!==null){const u=Vb();u.serverResponse=c.getErrorText(),this.errorCallback_?a(this.errorCallback_(c,u)):a(u)}else if(s.canceled){const u=this.appDelete_?_0():Mb();a(u)}else{const u=Lb();a(u)}};this.canceled_?n(!1,new fl(!1,null,!0)):this.backoffId_=$b(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Wb(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class fl{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Qb(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Yb(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Xb(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Jb(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function Zb(t,e,n,r,s,i,a=!0){const c=Hb(t.urlParams),u=t.url+c,d=Object.assign({},t.headers);return Xb(d,e),Qb(d,n),Yb(d,i),Jb(d,r),new Kb(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function t1(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(e,n){this._service=e,n instanceof rn?this._location=n:this._location=rn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ic(e,n)}get root(){const e=new rn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return t1(this._location.path)}get storage(){return this._service}get parent(){const e=e1(this._location.path);if(e===null)return null;const n=new rn(this._location.bucket,e);return new Ic(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw zb(e)}}function Ty(t,e){const n=e==null?void 0:e[bb];return n==null?null:rn.makeFromBucketSpec(n,t)}function n1(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:aE(s,t.app.options.projectId))}class r1{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=y0,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Ob,this._maxUploadRetryTime=Db,this._requests=new Set,s!=null?this._bucket=rn.makeFromBucketSpec(s,this._host):this._bucket=Ty(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=rn.makeFromBucketSpec(this._url,e):this._bucket=Ty(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Iy("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Iy("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ic(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new Bb(_0());{const a=Zb(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const xy="@firebase/storage",Ny="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w0="storage";function s1(t=Wc(),e){t=Oe(t);const r=$c(t,w0).getImmediate({identifier:e}),s=rE("storage");return s&&i1(r,...s),r}function i1(t,e,n,r={}){n1(t,e,n,r)}function a1(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new r1(n,r,s,e,_s)}function o1(){cs(new Rr(w0,a1,"PUBLIC").setMultipleInstances(!0)),gn(xy,Ny,""),gn(xy,Ny,"esm2017")}o1();const Ta={apiKey:"AIzaSyCWZYQhVFQIE_36SciDNuaDsSV3cA_VAhg",authDomain:"finenproc-ag.firebaseapp.com",projectId:"finenproc-ag",storageBucket:"finenproc-ag.firebasestorage.app",messagingSenderId:"342590603143",appId:"1:342590603143:web:41684e65fb75b5845b9d22"},qp=cE().length?Wc():$f(Ta),cr=qE(qp),W=cb(qp),l1=s1(qp),Sy="provisioning",c1=()=>cE().find(e=>e.name===Sy)||$f(Ta,Sy),u1=()=>qE(c1());try{const t=Object.entries(Ta).filter(([e,n])=>!n).map(([e])=>e);t.length&&console.warn("Firebase env variables missing:",t),console.log("Firebase initialized",{projectId:Ta.projectId,authDomain:Ta.authDomain,hasAuth:!!cr,hasDb:!!W,hasStorage:!!l1})}catch(t){console.warn("Firebase init debug failed:",t)}function E0(){const[t,e]=b.useState(!0),[n,r]=b.useState(!1),[s,i]=b.useState(null);return b.useEffect(()=>{const a=cC(cr,async c=>{var u,d;if(e(!0),!c){i(null),r(!1),e(!1);return}try{const f=c.uid,p=se(W,"users",f),m=await Mt(p),E=(u=m==null?void 0:m.data())==null?void 0:u.role,y=(d=m==null?void 0:m.data())==null?void 0:d.status;console.log("ADMIN AUTH CHECK",{uid:f,userExists:m.exists(),role:E,status:y});const x=!!(m.exists()&&E==="admin"&&y==="active");r(x),i({uid:f,email:c.email,role:E,status:y})}catch(f){console.error("useAdminAuth error",f),r(!1),i(null)}finally{e(!1)}});return()=>a()},[]),{loading:t,isAdmin:n,user:s}}function d1({isOpen:t,onClose:e}){const n=({to:r,children:s,disabled:i,icon:a})=>{const c=()=>{e&&e()};return i?o.jsxs("div",{className:"sidebar-item disabled",children:[a&&o.jsx("span",{className:"sidebar-icon",children:a}),s]}):o.jsxs(RS,{to:r,onClick:c,className:({isActive:u})=>u?"sidebar-item active":"sidebar-item",children:[a&&o.jsx("span",{className:"sidebar-icon",children:a}),s]})};return o.jsxs("aside",{className:`admin-sidebar ${t?"open":""}`,children:[o.jsx("div",{className:"brand",children:"FINENPROC"}),o.jsxs("nav",{children:[o.jsx(n,{to:"/admin",icon:"",children:"Panel"}),o.jsx(n,{to:"/admin/usuarios",icon:"",children:"Usuarios"}),o.jsx("div",{className:"nav-section-title",children:"Operaciones"}),o.jsx(n,{to:"/admin/operaciones/recargas",icon:"",children:"Recargas"}),o.jsx(n,{to:"/admin/operaciones/retiros",icon:"",children:"Retiros"}),o.jsx(n,{to:"/admin/operaciones/inversiones",icon:"",children:"Inversiones"}),o.jsx("div",{className:"nav-section-title",children:"Otros"}),o.jsx(n,{to:"/admin/proyectos",icon:"",children:"Proyectos"}),o.jsx(n,{disabled:!0,icon:"",children:"Configuracin"})]}),o.jsx("div",{className:"sidebar-footer",children:"Admin Panel"})]})}function h1({admin:t,onToggleSidebar:e}){const n=Gn(),r=async()=>{try{await ns(cr),n("/")}catch(s){console.error("Logout error",s)}};return o.jsxs("header",{className:"admin-header",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("button",{className:"menu-button",type:"button","aria-label":"Abrir men",onClick:e,children:""}),o.jsxs("h1",{children:[o.jsx("span",{className:"header-title-main",children:"FINENPROC"}),o.jsx("span",{className:"header-title-badge",children:"ADMIN"})]})]}),o.jsxs("div",{className:"header-right",children:[(t==null?void 0:t.email)&&o.jsx("div",{className:"admin-email",children:t.email}),o.jsx("button",{className:"btn-ghost",onClick:r,children:"Cerrar sesin"})]})]})}function qr({children:t,admin:e}){const[n,r]=b.useState(!1),s=()=>r(a=>!a),i=()=>r(!1);return o.jsxs("div",{className:"admin-root",children:[o.jsx(d1,{isOpen:n,onClose:i}),o.jsxs("div",{className:"admin-main",children:[o.jsx(h1,{admin:e,onToggleSidebar:s}),o.jsx("main",{className:"admin-content",children:t})]}),o.jsx("div",{className:`sidebar-overlay ${n?"show":""}`,onClick:i,"aria-hidden":!n})]})}function f1({title:t,children:e,className:n=""}){return o.jsxs("div",{className:"card "+n,children:[t&&o.jsx("div",{className:"card-title",children:t}),o.jsx("div",{className:"card-body",children:e})]})}function p1(){const[t,e]=b.useState({totalUsers:0,activeUsers:0,pendingTopups:0,approvedTopups:0,rejectedTopups:0,totalTopups:0,pendingWithdrawals:0,activeInvestments:0,totalInvested:0,recentTransactions:[]}),[n,r]=b.useState(!0),[s,i]=b.useState(null),a=async()=>{try{r(!0),i(null);const d=(await Ee(ae(W,"users"))).docs.map(S=>S.data()),f=d.length,p=d.filter(S=>S.status==="active").length,E=(await Ee(ae(W,"topups"))).docs.map(S=>S.data()),y=E.filter(S=>S.status==="pending").length,x=E.filter(S=>S.status==="approved").length,N=E.filter(S=>S.status==="rejected").length,I=E.length,k=(await Ee(ae(W,"withdrawals"))).docs.map(S=>S.data()).filter(S=>S.status==="pending").length,O=ye(ae(W,"investments"),Ce("status","==","active")),_=(await Ee(O)).docs.map(S=>S.data()),v=_.length,A=_.reduce((S,U)=>S+(U.amount||0),0),P=ye(ae(W,"transactions"),wn("createdAt","desc")),j=(await Ee(P)).docs.slice(0,10).map(S=>({id:S.id,...S.data()}));e({totalUsers:f,activeUsers:p,pendingTopups:y,approvedTopups:x,rejectedTopups:N,totalTopups:I,pendingWithdrawals:k,activeInvestments:v,totalInvested:A,recentTransactions:j})}catch(u){console.error("Error en useDashboardKPIs:",u),i(u.message)}finally{r(!1)}};return b.useEffect(()=>{a()},[]),{kpis:t,loading:n,error:s,refetch:()=>a()}}function m1({children:t,variant:e="default"}){return o.jsx("span",{className:"badge badge-"+e,children:t})}function g1({open:t,onClose:e,children:n}){return t?o.jsx("div",{className:"modal-backdrop",onClick:e,children:o.jsx("div",{className:"modal",onClick:r=>r.stopPropagation(),children:n})}):null}const v1=async(t={})=>{var e;try{const n=[wn("createdAt","desc")];t.status&&n.unshift(Ce("status","==",t.status)),t.userId&&n.unshift(Ce("userId","==",t.userId));const r=ye(ae(W,"topups"),...n),s=await Ee(r),i=[];for(const a of s.docs){const c=a.data();let u=null;if(c.userId){const f=se(W,"users",c.userId),p=await Mt(f);p.exists()&&(u={uid:p.id,email:p.data().email,displayName:p.data().displayName||"Sin nombre"})}let d=null;if(c.methodId){const f=se(W,"rechargeMethods",c.methodId),p=await Mt(f);p.exists()&&(d={id:p.id,name:p.data().name,icon:p.data().icon})}i.push({topupId:a.id,id:a.id,amount:c.amount,status:c.status,createdAt:(e=c.createdAt)==null?void 0:e.toDate(),user:u,method:d,receiptUrl:c.receiptUrl,userId:c.userId,methodId:c.methodId})}return{success:!0,data:i}}catch(n){return console.error("Error fetching topups:",n),{success:!1,error:n.message}}},y1=()=>{const[t,e]=b.useState([]),[n,r]=b.useState([]),[s,i]=b.useState({status:"",searchQuery:""}),[a,c]=b.useState(!0),[u,d]=b.useState(null);return b.useEffect(()=>{(async()=>{c(!0),d(null);const m=await v1({});m.success?e(m.data||[]):(e([]),d(m.error||"Error al cargar recargas")),c(!1)})()},[]),b.useEffect(()=>{let p=t;if(s.status&&(p=p.filter(m=>m.status===s.status)),s.searchQuery.trim()){const m=s.searchQuery.toLowerCase();p=p.filter(E=>{var y,x,N,I;return((x=(y=E.user)==null?void 0:y.email)==null?void 0:x.toLowerCase().includes(m))||((I=(N=E.user)==null?void 0:N.displayName)==null?void 0:I.toLowerCase().includes(m))})}r(p)},[t,s.status,s.searchQuery]),{allTopups:t,topups:n,filters:s,setFilters:{status:p=>i(m=>({...m,status:p})),searchQuery:p=>{i(m=>({...m,searchQuery:p}))}},loading:a,error:u}};function _1(){var y,x,N;const[t,e]=b.useState(null),{allTopups:n,topups:r,filters:s,setFilters:i,loading:a,error:c}=y1(),u=s.status?s.status:"all",d=[{value:"all",label:"Todas",count:n.length},{value:"pending",label:"Pendientes",count:n.filter(I=>I.status==="pending").length},{value:"approved",label:"Aprobadas",count:n.filter(I=>I.status==="approved").length},{value:"rejected",label:"Rechazadas",count:n.filter(I=>I.status==="rejected").length}],f=I=>{const w={pending:{variant:"pending",label:"Pendiente"},approved:{variant:"success",label:"Aprobada"},rejected:{variant:"rejected",label:"Rechazada"}},T=w[I]||w.pending;return o.jsx(m1,{variant:T.variant,children:T.label})},p=I=>new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(I),m=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(I),E=(filter==="all",r);return o.jsxs("div",{className:"admin-topups",children:[o.jsx("div",{className:"topups-header",children:o.jsxs("div",{children:[o.jsx("h1",{className:"page-title",children:"Gestin de Recargas"}),o.jsx("p",{className:"page-subtitle",children:"Administra y revisa todas las solicitudes de recarga"})]})}),o.jsx("div",{className:"topups-filters",children:d.map(I=>o.jsxs("button",{className:`filter-btn ${u===I.value?"active":""}`,onClick:()=>i.status(I.value==="all"?"":I.value),children:[I.label,o.jsx("span",{className:"filter-count",children:I.count})]},I.value))}),o.jsx(f1,{className:"topups-table-card",children:a?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsx("div",{className:"empty-state-title",children:"Cargando recargas"}),o.jsx("div",{className:"empty-state-text",children:"Obteniendo datos de Firestore"})]}):c?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsx("div",{className:"empty-state-title",children:"Error al cargar"}),o.jsx("div",{className:"empty-state-text",children:c})]}):E.length>0?o.jsx("div",{className:"table-wrap",children:o.jsxs("table",{className:"table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Usuario"}),o.jsx("th",{children:"Mtodo"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"}),o.jsx("th",{children:"Acciones"})]})}),o.jsx("tbody",{children:E.map(I=>{var w,T,k,O,D,_;return o.jsxs("tr",{children:[o.jsx("td",{children:o.jsxs("div",{className:"user-cell",children:[o.jsx("div",{className:"user-avatar",children:(((w=I.user)==null?void 0:w.displayName)||((T=I.user)==null?void 0:T.email)||"U")[0]}),o.jsxs("div",{children:[o.jsx("div",{className:"user-name",children:((k=I.user)==null?void 0:k.displayName)||"Sin nombre"}),o.jsx("div",{className:"user-email",children:((O=I.user)==null?void 0:O.email)||"Email no disponible"})]})]})}),o.jsx("td",{children:o.jsxs("div",{className:"method-cell",children:[o.jsx("span",{className:"method-icon",children:((D=I.method)==null?void 0:D.icon)||""}),((_=I.method)==null?void 0:_.name)||"Mtodo no disponible"]})}),o.jsx("td",{className:"amount-cell",children:m(I.amount)}),o.jsx("td",{children:f(I.status)}),o.jsx("td",{className:"date-cell",children:p(I.createdAt||new Date)}),o.jsx("td",{children:o.jsx("button",{className:"btn-ghost btn-sm",onClick:()=>e(I),children:"Ver detalles"})})]},I.id)})})]})}):o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsx("div",{className:"empty-state-title",children:"No hay recargas"}),o.jsx("div",{className:"empty-state-text",children:"No se encontraron recargas con el filtro seleccionado"})]})}),t&&o.jsxs(g1,{open:!!t,onClose:()=>e(null),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{className:"modal-title",children:"Detalles de Recarga"}),o.jsx("button",{className:"modal-close",onClick:()=>e(null),children:""})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"ID de transaccin"}),o.jsx("span",{className:"detail-value",children:t.id})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Usuario"}),o.jsx("span",{className:"detail-value",children:((y=t.user)==null?void 0:y.displayName)||"Sin nombre"})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Email"}),o.jsx("span",{className:"detail-value",children:((x=t.user)==null?void 0:x.email)||"Email no disponible"})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Monto"}),o.jsx("span",{className:"detail-value",children:m(t.amount)})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Mtodo"}),o.jsx("span",{className:"detail-value",children:((N=t.method)==null?void 0:N.name)||"Mtodo no disponible"})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Estado"}),o.jsx("span",{className:"detail-value",children:f(t.status)})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Fecha"}),o.jsx("span",{className:"detail-value",children:p(t.createdAt||new Date)})]})]}),o.jsx("div",{className:"modal-footer",children:o.jsx("button",{className:"btn btn-secondary",onClick:()=>e(null),children:"Cerrar"})})]})]})}function w1(){return o.jsxs("div",{className:"admin-not-authorized",children:[o.jsx("h2",{children:"No Autorizado"}),o.jsx("p",{children:"No tienes permiso para acceder al rea de administracin."}),o.jsxs("p",{children:[o.jsx($a,{to:"/login",children:"Ir a Login"})," o ",o.jsx($a,{to:"/register",children:"Registrarse"})]})]})}function E1(){const[t,e]=b.useState(""),[n,r]=b.useState(""),[s,i]=b.useState(null),[a,c]=b.useState(!1),u=Gn(),d=async m=>{const E=se(W,"users",m.uid),y=await Mt(E);if(!y.exists())throw await ns(cr),new Error("Perfil de usuario no encontrado en Firestore");const{role:x,status:N}=y.data();if(x!=="admin")throw await ns(cr),new Error("No tienes permisos de administrador");if(N!=="active")throw await ns(cr),new Error("Tu cuenta no est activa");u("/admin",{replace:!0}),console.log(" Login exitoso:",{uid:m.uid,role:x,status:N})},f=async m=>{m.preventDefault(),c(!0),i(null);try{const E=await aC(cr,t.trim(),n);await d(E.user)}catch(E){i(E.message),console.error("Error en login:",E)}finally{c(!1)}},p=async()=>{c(!0),i(null);try{const m=new Rn,E=await PC(cr,m);await d(E.user)}catch(m){i(m.message),console.error("Error en login Google:",m)}finally{c(!1)}};return o.jsx("div",{className:"auth-wrap",children:o.jsxs("div",{className:"auth-card",children:[o.jsx("h1",{className:"auth-title",children:"Iniciar Sesin (Admin)"}),o.jsx("p",{className:"auth-subtitle",children:"Accede con tus credenciales de administrador"}),o.jsxs("form",{onSubmit:f,className:"auth-form",children:[o.jsxs("label",{children:[o.jsx("span",{children:"Email"}),o.jsx("input",{type:"email",value:t,onChange:m=>e(m.target.value),required:!0})]}),o.jsxs("label",{children:[o.jsx("span",{children:"Contrasea"}),o.jsx("input",{type:"password",value:n,onChange:m=>r(m.target.value),required:!0})]}),s&&o.jsx("div",{className:"auth-error",children:s}),o.jsx("button",{className:"btn btn-primary",type:"submit",disabled:a,children:a?"Accediendo":"Iniciar Sesin"})]}),o.jsx("div",{className:"auth-divider",children:"o"}),o.jsx("button",{className:"btn btn-secondary",onClick:p,disabled:a,children:"Continuar con Google"}),o.jsx("div",{className:"auth-links",children:o.jsx($a,{to:"/register",children:"No tienes cuenta? Regstrate"})})]})})}function I1(){const[t,e]=b.useState(""),[n,r]=b.useState(""),[s,i]=b.useState(null),[a,c]=b.useState(!1),[u,d]=b.useState(!1),f=Gn(),{loading:p,isAdmin:m}=E0(),E=async y=>{if(y.preventDefault(),p)return;if(!m){i("Solo un administrador puede crear cuentas de administrador. Inicia sesin como admin y vuelve a intentar.");return}c(!0),i(null),d(!1);let x=null;const N=u1();try{x=await iC(N,t.trim(),n);const I=x.user;console.log(" Usuario creado en Auth:",I.uid);try{await Sb(se(W,"users",I.uid),{uid:I.uid,email:I.email,role:"admin",status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{merge:!0}),console.log(" Documento Firestore creado exitosamente"),d(!0),await ns(N),setTimeout(()=>f("/admin",{replace:!0}),1500)}catch(w){console.error(" Error al crear documento Firestore:",w);try{await uC(I)}catch(T){console.error(" Error al eliminar usuario recin creado:",T)}throw await ns(N),new Error("Error al crear perfil en Firestore. Revisa permisos/reglas.")}}catch(I){console.error("Error en registro:",I),i(I.message||"Error desconocido en el registro"),await ns(N).catch(w=>console.error("Error en signOut provisioning:",w))}finally{c(!1)}};return o.jsx("div",{className:"auth-wrap",children:o.jsxs("div",{className:"auth-card",children:[o.jsx("h1",{className:"auth-title",children:"Registrar Cuenta (Admin)"}),o.jsx("p",{className:"auth-subtitle",children:"Crea una cuenta con rol de administrador"}),u&&o.jsx("div",{className:"auth-success",children:"Usuario admin registrado exitosamente! Sers redirigido..."}),o.jsxs("form",{onSubmit:E,className:"auth-form",children:[o.jsxs("label",{children:[o.jsx("span",{children:"Email"}),o.jsx("input",{type:"email",value:t,onChange:y=>e(y.target.value),required:!0})]}),o.jsxs("label",{children:[o.jsx("span",{children:"Contrasea"}),o.jsx("input",{type:"password",value:n,onChange:y=>r(y.target.value),required:!0})]}),s&&o.jsx("div",{className:"auth-error",children:s}),o.jsx("button",{className:"btn btn-primary",type:"submit",disabled:a,children:a?"Registrando":"Registrar"})]}),o.jsx("div",{className:"auth-links",children:o.jsx($a,{to:"/login",children:"Ya tienes cuenta? Inicia sesin"})})]})})}function T1(){const{kpis:t,loading:e}=p1();Gn();const n=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(s||0),r=s=>s?new Date(s).toLocaleDateString("es-MX",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}):"-";return e?o.jsx("div",{className:"dashboard-loading",children:o.jsx("div",{children:"Cargando dashboard..."})}):o.jsxs("div",{className:"admin-dashboard-page",children:[o.jsxs("div",{className:"dashboard-header",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"dashboard-title",children:"Panel de Administracin"}),o.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del sistema"})]}),o.jsx("div",{className:"dashboard-meta",children:o.jsx("span",{className:"last-updated",children:"Actualizado: Hoy"})})]}),o.jsxs("div",{className:"kpi-section",children:[o.jsx("h2",{className:"section-title",children:" Usuarios"}),o.jsxs("div",{className:"kpi-grid kpi-grid-2",children:[o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Usuarios Totales"}),o.jsx("div",{className:"kpi-value",children:t.totalUsers})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Usuarios Activos"}),o.jsx("div",{className:"kpi-value",style:{color:"#22c55e"},children:t.activeUsers})]})]})]}),o.jsxs("div",{className:"kpi-section",children:[o.jsx("h2",{className:"section-title",children:" Recargas"}),o.jsxs("div",{className:"kpi-grid kpi-grid-3",children:[o.jsxs("div",{className:"kpi-card alert",children:[o.jsx("div",{className:"kpi-label",children:"Pendientes"}),o.jsx("div",{className:"kpi-value",style:{color:"#f59e0b"},children:t.pendingTopups})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Aprobadas"}),o.jsx("div",{className:"kpi-value",style:{color:"#22c55e"},children:t.approvedTopups})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Total"}),o.jsx("div",{className:"kpi-value",children:t.totalTopups})]})]})]}),o.jsxs("div",{className:"kpi-section",children:[o.jsx("h2",{className:"section-title",children:" Retiros"}),o.jsx("div",{className:"kpi-grid kpi-grid-1",children:o.jsxs("div",{className:"kpi-card alert",children:[o.jsx("div",{className:"kpi-label",children:"Retiros Pendientes"}),o.jsx("div",{className:"kpi-value",style:{color:"#f59e0b"},children:t.pendingWithdrawals})]})})]}),o.jsxs("div",{className:"kpi-section",children:[o.jsx("h2",{className:"section-title",children:" Inversiones"}),o.jsxs("div",{className:"kpi-grid kpi-grid-2",children:[o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Inversiones Activas"}),o.jsx("div",{className:"kpi-value",children:t.activeInvestments})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Capital Invertido"}),o.jsx("div",{className:"kpi-value-currency",children:n(t.totalInvested)})]})]})]}),o.jsxs("div",{className:"kpi-section",children:[o.jsx("h2",{className:"section-title",children:" Transacciones Recientes"}),o.jsx("div",{className:"transactions-card",children:t.recentTransactions.length>0?o.jsx("div",{className:"table-wrapper",children:o.jsxs("table",{className:"transactions-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Tipo"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Usuario"}),o.jsx("th",{children:"Fecha"})]})}),o.jsx("tbody",{children:t.recentTransactions.map(s=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx("span",{className:"tx-type",children:s.type||"transfer"})}),o.jsx("td",{className:"amount",children:n(s.amount)}),o.jsx("td",{className:"user-email",children:s.userEmail||"Usuario no disponible"}),o.jsx("td",{className:"date",children:r(s.createdAt)})]},s.id))})]})}):o.jsx("div",{className:"empty-state",children:"No hay transacciones recientes"})})]}),o.jsxs("div",{className:"kpi-section",children:[o.jsx("h2",{className:"section-title",children:" Alertas Operativas"}),o.jsxs("div",{className:"alerts-container",children:[t.pendingTopups>0&&o.jsxs("div",{className:"alert-item alert-warning",children:[o.jsx("span",{className:"alert-icon",children:""}),o.jsxs("span",{className:"alert-text",children:[t.pendingTopups," recarga(s) pendiente(s) de aprobacin"]})]}),t.pendingWithdrawals>0&&o.jsxs("div",{className:"alert-item alert-warning",children:[o.jsx("span",{className:"alert-icon",children:""}),o.jsxs("span",{className:"alert-text",children:[t.pendingWithdrawals," retiro(s) pendiente(s) de aprobacin"]})]}),t.activeInvestments>0&&o.jsxs("div",{className:"alert-item alert-info",children:[o.jsx("span",{className:"alert-icon",children:""}),o.jsxs("span",{className:"alert-text",children:[t.activeInvestments," inversin(es) activa(s) en el sistema"]})]}),t.pendingTopups===0&&t.pendingWithdrawals===0&&o.jsxs("div",{className:"alert-item alert-success",children:[o.jsx("span",{className:"alert-icon",children:""}),o.jsx("span",{className:"alert-text",children:"Sistema operativo. No hay operaciones pendientes."})]})]})]})]})}function x1(t={}){const[e,n]=b.useState([]),[r,s]=b.useState(!0),[i,a]=b.useState(null),[c,u]=b.useState(0),d=async()=>{try{s(!0),a(null);let p=[];t.status&&t.status!=="all"&&p.push(Ce("status","==",t.status));const m=ye(ae(W,"users"),...p,wn("createdAt","desc")),y=(await Ee(m)).docs.map(N=>({uid:N.id,...N.data()}));let x=y;if(t.search){const N=t.search.toLowerCase();x=y.filter(I=>{var w,T;return((w=I.email)==null?void 0:w.toLowerCase().includes(N))||((T=I.displayName)==null?void 0:T.toLowerCase().includes(N))})}n(x),u(x.length)}catch(p){console.error("Error en useAdminUsers:",p),a(p.message)}finally{s(!1)}};return b.useEffect(()=>{d()},[t.status]),{users:e,loading:r,error:i,total:c,refetch:()=>d()}}function N1(t){const[e,n]=b.useState(null),[r,s]=b.useState(null),[i,a]=b.useState([]),[c,u]=b.useState([]),[d,f]=b.useState([]),[p,m]=b.useState([]),[E,y]=b.useState(!0),[x,N]=b.useState(null),I=async()=>{if(!t){y(!1);return}try{y(!0),N(null);const T=se(W,"users",t),k=await Mt(T);if(!k.exists()){N("Usuario no encontrado"),y(!1);return}n({uid:t,...k.data()});const O=se(W,"users",t,"wallets",t),D=await Mt(O);D.exists()&&s(D.data());const _=ye(ae(W,"investments"),Ce("userId","==",t)),v=await Ee(_);a(v.docs.map(G=>({id:G.id,...G.data()})));const A=ye(ae(W,"topups"),Ce("userId","==",t)),P=await Ee(A);u(P.docs.map(G=>({id:G.id,...G.data()})));const C=ye(ae(W,"withdrawals"),Ce("userId","==",t)),j=await Ee(C);f(j.docs.map(G=>({id:G.id,...G.data()})));const S=ye(ae(W,"transactions"),Ce("userId","==",t)),U=await Ee(S);m(U.docs.map(G=>({id:G.id,...G.data()})))}catch(T){console.error("Error en useUserDetail:",T),N(T.message)}finally{y(!1)}};return b.useEffect(()=>{I()},[t]),{user:e,wallet:r,investments:i,topups:c,withdrawals:d,transactions:p,loading:E,error:x,refetch:()=>I()}}function S1({users:t,loading:e,onSelectUser:n}){if(e)return o.jsx("div",{className:"usuarios-table-loading",children:o.jsx("div",{children:"Cargando usuarios..."})});if(t.length===0)return o.jsx("div",{className:"usuarios-table-empty",children:o.jsx("div",{children:"No hay usuarios encontrados"})});const r=s=>s?new Date(s).toLocaleDateString("es-MX"):"-";return o.jsx("div",{className:"usuarios-table-wrapper",children:o.jsxs("table",{className:"usuarios-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Email"}),o.jsx("th",{children:"Nombre"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Rol"}),o.jsx("th",{children:"Fecha Registro"}),o.jsx("th",{children:"Accin"})]})}),o.jsx("tbody",{children:t.map(s=>o.jsxs("tr",{className:"usuario-row",children:[o.jsx("td",{className:"email-cell",children:s.email}),o.jsx("td",{children:s.displayName||"-"}),o.jsx("td",{children:o.jsx("span",{className:`status-badge status-${s.status}`,children:s.status==="active"?"Activo":"Inactivo"})}),o.jsx("td",{children:s.role||"investor"}),o.jsx("td",{children:r(s.createdAt)}),o.jsx("td",{children:o.jsx("button",{className:"btn-view-detail",onClick:()=>n(s.uid),children:"Ver detalle"})})]},s.uid))})]})})}function I0(){const[t,e]=b.useState(!1),[n,r]=b.useState(null);return{approve:async(i,a,c)=>{var u,d;try{e(!0),r(null);let f=null;try{const p=ye(ae(W,"transactions"),Ce("topupId","==",i),Wn(1));f=((d=(u=(await Ee(p)).docs)==null?void 0:u[0])==null?void 0:d.id)||null}catch{}return await Ci(W,async p=>{const m=se(W,"topups",i),E=await p.get(m);if(!E.exists())throw new Error("Topup no encontrado");const y=E.data(),x=y==null?void 0:y.status;if(x==="approved")return;if(x!=="pending")throw new Error(`No se puede aprobar un topup con status: ${x}`);const N=y==null?void 0:y.userId,I=Number(y==null?void 0:y.amount),w=(y==null?void 0:y.transactionId)||f||null;if(!N)throw new Error("Topup invlido: falta userId");if(!Number.isFinite(I)||I<=0)throw new Error("Topup invlido: amount debe ser > 0");const T=se(W,"users",N,"wallets",N),k=await p.get(T),O=w?se(W,"transactions",w):null,D=O?await p.get(O):null,_=D!=null&&D.exists()?D.data():null,v=_!=null&&_.createdAt&&typeof _.createdAt!="string"?_.createdAt:y!=null&&y.createdAt&&typeof y.createdAt!="string"?y.createdAt:re(),A=(_==null?void 0:_.currency)||(y==null?void 0:y.currency)||"USD",P=(_==null?void 0:_.methodId)||(y==null?void 0:y.methodId)||null,C=(_==null?void 0:_.methodName)||(y==null?void 0:y.methodName)||(y==null?void 0:y.method)||null,j=(_==null?void 0:_.methodType)||(y==null?void 0:y.methodType)||null,S=(_==null?void 0:_.methodDetailsText)||(y==null?void 0:y.methodDetailsText)||null,U=(_==null?void 0:_.proofUrl)||(y==null?void 0:y.proofUrl)||null,G=(_==null?void 0:_.proofPath)||(y==null?void 0:y.proofPath)||null,ne=(_==null?void 0:_.proofFileName)||(y==null?void 0:y.proofFileName)||null,ve=(_==null?void 0:_.proofContentType)||(y==null?void 0:y.proofContentType)||null,B=typeof((_==null?void 0:_.proofSize)??(y==null?void 0:y.proofSize))=="number"?(_==null?void 0:_.proofSize)??(y==null?void 0:y.proofSize):null,Y=(_==null?void 0:_.description)||(y!=null&&y.methodName?`Recarga aprobada (${y.methodName})`:"Recarga aprobada"),L=(_==null?void 0:_.reference)||i,ie=(_==null?void 0:_.topupId)||i,oe=se(ae(W,"transactions"));k.exists()?p.update(T,{balance:Ia(I),updatedAt:re()}):p.set(T,{uid:N,balance:I,createdAt:re(),updatedAt:re()}),p.update(m,{status:"approved",approvedAt:re(),approvedBy:a}),p.set(oe,{userId:N,amount:I,currency:A,methodId:P,methodName:C,methodType:j,methodDetailsText:S,proofUrl:U,proofPath:G,proofFileName:ne,proofContentType:ve,proofSize:B,type:"deposit",status:"approved",description:Y,reference:L,topupId:ie,createdAt:v,approvedAt:re(),approvedBy:a});const pe=se(ae(W,"auditLogs"));p.set(pe,{action:"APPROVE_TOPUP",adminUid:a,adminEmail:c,targetUserId:N,targetId:i,status:"SUCCESS",metadata:{amount:I,topupId:i},timestamp:re()})}),console.log(" Recarga aprobada:",i),!0}catch(f){return console.error(" Error al aprobar recarga:",f),r((f==null?void 0:f.message)||String(f)),!1}finally{e(!1)}},loading:t,error:n}}function T0(){const[t,e]=b.useState(!1),[n,r]=b.useState(null);return{reject:async(i,a,c,u,d)=>{var f,p;try{e(!0),r(null);let m=null;try{const E=ye(ae(W,"transactions"),Ce("topupId","==",i),Wn(1));m=((p=(f=(await Ee(E)).docs)==null?void 0:f[0])==null?void 0:p.id)||null}catch{}return await Ci(W,async E=>{const y=se(W,"topups",i),x=await E.get(y);if(!x.exists())throw new Error("Topup no encontrado");const N=x.data(),I=N==null?void 0:N.status;if(I==="rejected")return;if(I!=="pending")throw new Error(`No se puede rechazar un topup con status: ${I}`);const w=(N==null?void 0:N.userId)||a,T=Number(N==null?void 0:N.amount),k=(N==null?void 0:N.transactionId)||m||null;if(!w)throw new Error("Topup invlido: falta userId");const O=k?se(W,"transactions",k):null,D=O?await E.get(O):null,_=D!=null&&D.exists()?D.data():null,v=_!=null&&_.createdAt&&typeof _.createdAt!="string"?_.createdAt:N!=null&&N.createdAt&&typeof N.createdAt!="string"?N.createdAt:re(),A=(_==null?void 0:_.currency)||(N==null?void 0:N.currency)||"USD",P=(_==null?void 0:_.methodId)||(N==null?void 0:N.methodId)||null,C=(_==null?void 0:_.methodName)||(N==null?void 0:N.methodName)||(N==null?void 0:N.method)||null,j=(_==null?void 0:_.methodType)||(N==null?void 0:N.methodType)||null,S=(_==null?void 0:_.methodDetailsText)||(N==null?void 0:N.methodDetailsText)||null,U=(_==null?void 0:_.proofUrl)||(N==null?void 0:N.proofUrl)||null,G=(_==null?void 0:_.proofPath)||(N==null?void 0:N.proofPath)||null,ne=(_==null?void 0:_.proofFileName)||(N==null?void 0:N.proofFileName)||null,ve=(_==null?void 0:_.proofContentType)||(N==null?void 0:N.proofContentType)||null,B=typeof((_==null?void 0:_.proofSize)??(N==null?void 0:N.proofSize))=="number"?(_==null?void 0:_.proofSize)??(N==null?void 0:N.proofSize):null,Y=(_==null?void 0:_.description)||(N!=null&&N.methodName?`Recarga rechazada (${N.methodName})`:"Recarga rechazada"),L=(_==null?void 0:_.reference)||i,ie=(_==null?void 0:_.topupId)||i,oe=se(ae(W,"transactions"));E.update(y,{status:"rejected",rejectedAt:re(),rejectedBy:u,rejectionReason:c}),E.set(oe,{userId:w,amount:Number.isFinite(T)?T:null,currency:A,methodId:P,methodName:C,methodType:j,methodDetailsText:S,proofUrl:U,proofPath:G,proofFileName:ne,proofContentType:ve,proofSize:B,type:"deposit",status:"rejected",description:Y,reference:L,topupId:ie,createdAt:v,rejectionReason:c,rejectedAt:re(),rejectedBy:u});const pe=se(ae(W,"auditLogs"));E.set(pe,{action:"REJECT_TOPUP",adminUid:u,adminEmail:d,targetUserId:w,targetId:i,status:"SUCCESS",reason:c,timestamp:re()})}),console.log(" Recarga rechazada:",i),!0}catch(m){return console.error(" Error al rechazar recarga:",m),r((m==null?void 0:m.message)||String(m)),!1}finally{e(!1)}},loading:t,error:n}}function du({isOpen:t,title:e,message:n,actionLabel:r,onConfirm:s,onCancel:i,loading:a,showReasonInput:c,reasonPlaceholder:u}){const[d,f]=b.useState(""),p=()=>{if(c&&!d.trim()){alert("Por favor ingresa una razn");return}s(d),f("")};return t?o.jsx("div",{className:"action-modal-overlay",onClick:i,children:o.jsxs("div",{className:"action-modal",onClick:m=>m.stopPropagation(),children:[o.jsx("h2",{className:"action-modal-title",children:e}),o.jsx("p",{className:"action-modal-message",children:n}),c&&o.jsx("textarea",{className:"action-modal-textarea",placeholder:u||"Ingresa una razn...",value:d,onChange:m=>f(m.target.value),disabled:a}),o.jsxs("div",{className:"action-modal-footer",children:[o.jsx("button",{className:"btn-cancel",onClick:i,disabled:a,children:"Cancelar"}),o.jsx("button",{className:"btn-confirm",onClick:p,disabled:a,children:a?"Procesando...":r})]})]})}):null}function A1({isOpen:t,user:e,wallet:n,investments:r,topups:s,withdrawals:i,transactions:a,loading:c,onClose:u,adminData:d,onActionComplete:f}){const[p,m]=b.useState("perfil"),[E,y]=b.useState(null),[x,N]=b.useState({isOpen:!1,type:null}),{approve:I,loading:w}=I0(),{reject:T,loading:k}=T0();if(!t)return null;const O=async A=>{if(!E)return;await I(E.id,d.uid,d.email)&&(N({isOpen:!1,type:null}),y(null),f==null||f())},D=async A=>{if(!E)return;await T(E.id,e.uid,A,d.uid,d.email)&&(N({isOpen:!1,type:null}),y(null),f==null||f())},_=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(A||0),v=A=>A?new Date(A).toLocaleDateString("es-MX"):"-";return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"usuario-detail-overlay",onClick:u}),o.jsxs("div",{className:"usuario-detail-drawer",children:[o.jsxs("div",{className:"drawer-header",children:[o.jsx("h2",{children:"Detalle de Usuario"}),o.jsx("button",{className:"btn-close",onClick:u,children:""})]}),c?o.jsx("div",{className:"drawer-loading",children:"Cargando detalle..."}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"drawer-tabs",children:["perfil","wallet","inversiones","recargas","retiros","transacciones"].map(A=>o.jsx("button",{className:`tab-btn ${p===A?"active":""}`,onClick:()=>m(A),children:A.charAt(0).toUpperCase()+A.slice(1)},A))}),o.jsxs("div",{className:"drawer-content",children:[p==="perfil"&&e&&o.jsx("div",{className:"tab-pane",children:o.jsxs("div",{className:"info-group",children:[o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Email:"}),o.jsx("span",{className:"info-value",children:e.email})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Nombre:"}),o.jsx("span",{className:"info-value",children:e.displayName||"-"})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Estado:"}),o.jsx("span",{className:`status-badge status-${e.status}`,children:e.status==="active"?"Activo":"Inactivo"})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Rol:"}),o.jsx("span",{className:"info-value",children:e.role||"investor"})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Fecha de Registro:"}),o.jsx("span",{className:"info-value",children:v(e.createdAt)})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"UID:"}),o.jsx("span",{className:"info-value uid-value",children:e.uid})]})]})}),p==="wallet"&&o.jsx("div",{className:"tab-pane",children:n?o.jsxs("div",{className:"info-group",children:[o.jsxs("div",{className:"wallet-card",children:[o.jsx("div",{className:"wallet-label",children:"Balance Actual"}),o.jsx("div",{className:"wallet-amount",children:_(n.balance)})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"ltima Actualizacin:"}),o.jsx("span",{className:"info-value",children:v(n.updatedAt)})]})]}):o.jsx("div",{className:"empty-state",children:"Sin informacin de wallet"})}),p==="inversiones"&&o.jsx("div",{className:"tab-pane",children:r.length>0?o.jsx("div",{className:"table-responsive",children:o.jsxs("table",{className:"mini-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"ID"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"})]})}),o.jsx("tbody",{children:r.map(A=>o.jsxs("tr",{children:[o.jsxs("td",{className:"id-cell",children:[A.id.substring(0,8),"..."]}),o.jsx("td",{children:_(A.amount)}),o.jsx("td",{children:o.jsx("span",{className:`status-badge status-${A.status}`,children:A.status})}),o.jsx("td",{children:v(A.createdAt)})]},A.id))})]})}):o.jsx("div",{className:"empty-state",children:"Sin inversiones"})}),p==="recargas"&&o.jsx("div",{className:"tab-pane",children:s.length>0?o.jsx("div",{className:"table-responsive",children:o.jsxs("table",{className:"mini-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"}),o.jsx("th",{children:"Accin"})]})}),o.jsx("tbody",{children:s.map(A=>o.jsxs("tr",{children:[o.jsx("td",{children:_(A.amount)}),o.jsx("td",{children:o.jsx("span",{className:`status-badge status-${A.status}`,children:A.status})}),o.jsx("td",{children:v(A.createdAt)}),o.jsx("td",{children:A.status==="pending"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"btn-action btn-approve",onClick:()=>{y(A),N({isOpen:!0,type:"approve"})},children:""}),o.jsx("button",{className:"btn-action btn-reject",onClick:()=>{y(A),N({isOpen:!0,type:"reject"})},children:""})]})})]},A.id))})]})}):o.jsx("div",{className:"empty-state",children:"Sin recargas"})}),p==="retiros"&&o.jsx("div",{className:"tab-pane",children:i.length>0?o.jsx("div",{className:"table-responsive",children:o.jsxs("table",{className:"mini-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"})]})}),o.jsx("tbody",{children:i.map(A=>o.jsxs("tr",{children:[o.jsx("td",{children:_(A.amount)}),o.jsx("td",{children:o.jsx("span",{className:`status-badge status-${A.status}`,children:A.status})}),o.jsx("td",{children:v(A.createdAt)})]},A.id))})]})}):o.jsx("div",{className:"empty-state",children:"Sin retiros"})}),p==="transacciones"&&o.jsx("div",{className:"tab-pane",children:a.length>0?o.jsx("div",{className:"table-responsive",children:o.jsxs("table",{className:"mini-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Tipo"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Fecha"})]})}),o.jsx("tbody",{children:a.map(A=>o.jsxs("tr",{children:[o.jsx("td",{children:A.type||"transfer"}),o.jsx("td",{children:_(A.amount)}),o.jsx("td",{children:v(A.createdAt)})]},A.id))})]})}):o.jsx("div",{className:"empty-state",children:"Sin transacciones"})})]})]})]}),o.jsx(du,{isOpen:x.isOpen,title:x.type==="approve"?"Aprobar Recarga":"Rechazar Recarga",message:`${x.type==="approve"?"Aprobar":"Rechazar"} recarga de ${E?_(E.amount):""}?`,actionLabel:x.type==="approve"?"Aprobar":"Rechazar",showReasonInput:x.type==="reject",reasonPlaceholder:"Razn del rechazo...",loading:w||k,onConfirm:x.type==="approve"?O:D,onCancel:()=>{N({isOpen:!1,type:null}),y(null)}})]})}function R1({adminData:t}){const[e]=Uf(),[n,r]=b.useState({status:"all",search:""}),[s,i]=b.useState(null),{users:a,loading:c,refetch:u}=x1(n),{user:d,wallet:f,investments:p,topups:m,withdrawals:E,transactions:y,loading:x,refetch:N}=N1(s),I=()=>{u(),N()};return b.useEffect(()=>{const w=e.get("uid");w&&i(w)},[e]),o.jsxs("div",{className:"usuarios-page",children:[o.jsx("div",{className:"page-header",children:o.jsxs("div",{children:[o.jsx("h1",{className:"page-title",children:"Gestin de Usuarios"}),o.jsx("p",{className:"page-subtitle",children:"Administra todos los usuarios del sistema"})]})}),o.jsxs("div",{className:"usuarios-filters-section",children:[o.jsx("div",{className:"filter-group",children:o.jsx("input",{type:"text",placeholder:"Buscar por email o nombre...",className:"filter-input",value:n.search,onChange:w=>r({...n,search:w.target.value})})}),o.jsx("div",{className:"filter-group",children:o.jsxs("select",{className:"filter-select",value:n.status,onChange:w=>r({...n,status:w.target.value}),children:[o.jsx("option",{value:"all",children:"Todos los estados"}),o.jsx("option",{value:"active",children:"Activos"}),o.jsx("option",{value:"inactive",children:"Inactivos"})]})})]}),o.jsxs("div",{className:"usuarios-card",children:[o.jsx("div",{className:"card-header",children:o.jsxs("h3",{children:["Total de usuarios: ",a.length]})}),o.jsx(S1,{users:a,loading:c,onSelectUser:i})]}),o.jsx(A1,{isOpen:!!s,user:d,wallet:f,investments:p,topups:m,withdrawals:E,transactions:y,loading:x,onClose:()=>i(null),adminData:t,onActionComplete:I})]})}function C1(t={}){const[e,n]=b.useState([]),[r,s]=b.useState(!0),[i,a]=b.useState(null),[c,u]=b.useState(0),d=async()=>{try{s(!0),a(null);let p=[];t.status&&t.status!=="all"&&p.push(Ce("status","==",t.status));const m=ye(ae(W,"topups"),...p,wn("createdAt","desc")),y=(await Ee(m)).docs.map(k=>({id:k.id,...k.data()})),x=k=>k?typeof k=="string"?k:k!=null&&k.toDate?k.toDate().toISOString():k instanceof Date?k.toISOString():null:null,N=[...new Set(y.map(k=>k.userId).filter(Boolean))],I=await Promise.all(N.map(async k=>{const O=await Mt(se(W,"users",k));return[k,O.exists()?O.data():null]})),w=Object.fromEntries(I),T=y.map(k=>{const O=w[k.userId]||null;return{...k,userEmail:k.userEmail||(O==null?void 0:O.email)||null,userName:k.userName||(O==null?void 0:O.displayName)||(O==null?void 0:O.fullName)||null,createdAt:x(k.createdAt)||k.createdAt}});n(T),u(T.length)}catch(p){console.error("Error en useAdminTopups:",p),a(p.message)}finally{s(!1)}};return b.useEffect(()=>{d()},[t.status]),{topups:e,loading:r,error:i,total:c,refetch:()=>d()}}const Ay="rechargeMethods",_d=t=>{const e=String(t||"").toLowerCase().trim();return e==="active"||e==="inactive"?e:"inactive"},P1=t=>{if(!t)return null;if(t!=null&&t.toDate)return t.toDate();if(t instanceof Date)return t;const e=new Date(t);return Number.isNaN(e.getTime())?null:e},wd=t=>{const e=P1(t);return e?e.toLocaleString("es-MX"):"-"};function k1({isOpen:t,onClose:e}){const[n,r]=b.useState("list"),[s,i]=b.useState(0),[a,c]=b.useState(!1),[u,d]=b.useState(!1),[f,p]=b.useState(null),[m,E]=b.useState([]),[y,x]=b.useState(null),[N,I]=b.useState({name:"",detailsText:"",status:"",type:""}),w=v=>{v&&(v.style.height="auto",v.style.height=`${v.scrollHeight}px`)},T=()=>{r("list"),i(v=>v+1),c(!1),d(!1),p(null),E([]),x(null),I({name:"",detailsText:"",status:"",type:""})};b.useEffect(()=>{if(!t){T();return}(async()=>{try{c(!0),p(null);const A=ye(ae(W,Ay),wn("createdAt","desc")),C=(await Ee(A)).docs.map(j=>({id:j.id,...j.data()}));E(C)}catch(A){console.error("Error cargando mtodos de recarga:",A),p("No se pudieron cargar los mtodos de recarga")}finally{c(!1)}})()},[t]);const k=b.useMemo(()=>y?(y.name||"")!==(N.name||"")||(y.detailsText||"")!==(N.detailsText||"")||(y.status||"")!==(N.status||"")||(y.type||"")!==(N.type||""):!1,[y,N]),O=v=>{x(v),I({name:(v==null?void 0:v.name)||"",detailsText:(v==null?void 0:v.detailsText)||"",status:_d(v==null?void 0:v.status),type:(v==null?void 0:v.type)||""}),r("edit"),i(A=>A+1),requestAnimationFrame(()=>{const A=document.querySelector(".rm-textarea");w(A)})},D=()=>{x(null),I({name:"",detailsText:"",status:"",type:""}),r("list"),i(v=>v+1)},_=async()=>{if(y&&k)try{d(!0),p(null);const v=se(W,Ay,y.id);await Ri(v,{name:N.name,detailsText:N.detailsText,status:N.status,type:N.type,updateAt:re()});const A={...y,name:N.name,detailsText:N.detailsText,status:N.status,type:N.type};E(P=>P.map(C=>C.id===y.id?A:C)),x(A)}catch(v){console.error("Error guardando mtodo de recarga:",v),p("No se pudieron guardar los cambios")}finally{d(!1)}};return t?o.jsx("div",{className:"recharge-methods-overlay",onClick:e,children:o.jsxs("div",{className:"recharge-methods-modal",onClick:v=>v.stopPropagation(),children:[o.jsxs("div",{className:"rm-header",children:[o.jsx("h2",{className:"rm-title",children:"Mtodos de Recargas"}),o.jsx("button",{className:"rm-close",onClick:e,"aria-label":"Cerrar",children:""})]}),f&&o.jsx("div",{className:"rm-error",children:f}),o.jsx("div",{className:`rm-body rm-anim-${n}`,children:n==="list"?o.jsx(o.Fragment,{children:a?o.jsx("div",{className:"rm-loading",children:"Cargando mtodos..."}):m.length===0?o.jsx("div",{className:"rm-empty",children:"No hay mtodos de recarga"}):o.jsx("div",{className:"rm-list",children:m.map(v=>o.jsxs("button",{className:"rm-list-item",onClick:()=>O(v),title:"Editar mtodo",children:[o.jsxs("div",{className:"rm-list-main",children:[o.jsx("div",{className:"rm-list-name",children:v.name||"Sin nombre"}),o.jsxs("div",{className:"rm-list-meta",children:[o.jsx("span",{className:"rm-pill",children:v.type||"Sin tipo"}),o.jsx("span",{className:"rm-pill",children:v.status||"Sin estado"})]})]}),o.jsx("div",{className:"rm-list-date",children:wd(v.createdAt)})]},v.id))})}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"rm-form",children:[o.jsxs("label",{className:"rm-field",children:[o.jsx("span",{className:"rm-label",children:"Nombre"}),o.jsx("input",{className:"rm-input",value:N.name,onChange:v=>I(A=>({...A,name:v.target.value})),disabled:u})]}),o.jsxs("label",{className:"rm-field",children:[o.jsx("span",{className:"rm-label",children:"Tipo"}),o.jsx("input",{className:"rm-input",value:N.type,onChange:v=>I(A=>({...A,type:v.target.value})),disabled:u})]}),o.jsxs("label",{className:"rm-field",children:[o.jsx("span",{className:"rm-label",children:"Estado"}),o.jsxs("select",{className:"rm-input",value:_d(N.status),onChange:v=>I(A=>({...A,status:_d(v.target.value)})),disabled:u,children:[o.jsx("option",{value:"active",children:"active"}),o.jsx("option",{value:"inactive",children:"inactive"})]})]}),o.jsxs("label",{className:"rm-field",children:[o.jsx("span",{className:"rm-label",children:"Detalles"}),o.jsx("textarea",{className:"rm-textarea",value:N.detailsText,onChange:v=>{I(A=>({...A,detailsText:v.target.value})),w(v.target)},disabled:u,rows:4})]}),o.jsxs("label",{className:"rm-field",children:[o.jsx("span",{className:"rm-label",children:"Creado"}),o.jsx("input",{className:"rm-input rm-input-readonly",value:wd(y==null?void 0:y.createdAt),readOnly:!0})]}),o.jsxs("label",{className:"rm-field",children:[o.jsx("span",{className:"rm-label",children:"Actualizado"}),o.jsx("input",{className:"rm-input rm-input-readonly",value:wd(y==null?void 0:y.updateAt),readOnly:!0})]})]}),o.jsxs("div",{className:"rm-footer",children:[o.jsx("button",{className:"rm-btn rm-btn-secondary",onClick:D,disabled:u,children:"Cancelar"}),o.jsx("button",{className:"rm-btn rm-btn-primary",onClick:_,disabled:u||!k,children:u?"Guardando...":"Guardar cambios"})]})]})},s)]})}):null}function j1({adminData:t}){const[e,n]=b.useState("all"),[r,s]=b.useState(null),[i,a]=b.useState({isOpen:!1,type:null}),[c,u]=b.useState({isOpen:!1,url:null}),[d,f]=b.useState(!1),{topups:p,loading:m,refetch:E}=C1({status:e}),{approve:y,loading:x}=I0(),{reject:N,loading:I}=T0(),w=[{value:"all",label:"Todas"},{value:"pending",label:"Pendientes"},{value:"approved",label:"Aprobadas"},{value:"rejected",label:"Rechazadas"}],T=async()=>{if(!r)return;await y(r.id,t.uid,t.email)&&(a({isOpen:!1,type:null}),s(null),E())},k=async v=>{if(!r)return;await N(r.id,r.userId,v,t.uid,t.email)&&(a({isOpen:!1,type:null}),s(null),E())},O=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(v||0),D=v=>{if(!v)return"-";const A=v!=null&&v.toDate?v.toDate():new Date(v);return Number.isNaN(A.getTime())?"-":A.toLocaleDateString("es-MX")},_=v=>(v==null?void 0:v.proofUrl)||(v==null?void 0:v.receiptUrl)||null;return o.jsxs("div",{className:"recargas-page",children:[o.jsx("div",{className:"page-header",children:o.jsxs("div",{children:[o.jsx("h1",{className:"page-title",children:"Gestin de Recargas"}),o.jsx("p",{className:"page-subtitle",children:"Administra todas las solicitudes de recarga de usuarios"})]})}),o.jsx("div",{className:"recargas-filters",children:w.map(v=>o.jsxs("button",{className:`filter-btn ${e===v.value?"active":""}`,onClick:()=>n(v.value),children:[v.label,o.jsx("span",{className:"filter-count",children:v.value==="all"?p.length:p.filter(A=>A.status===v.value).length})]},v.value))}),o.jsxs("div",{className:"recargas-card",children:[o.jsx("div",{className:"card-header",children:o.jsxs("div",{className:"card-header-row",children:[o.jsxs("h3",{children:["Total de recargas: ",p.length]}),o.jsx("button",{className:"btn-methods",onClick:()=>f(!0),type:"button",children:"Metodos de Recargas"})]})}),m?o.jsx("div",{className:"loading-state",children:"Cargando recargas..."}):p.length===0?o.jsx("div",{className:"empty-state",children:"No hay recargas en este estado"}):o.jsx("div",{className:"table-wrapper",children:o.jsxs("table",{className:"recargas-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Usuario"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Mtodo"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"}),o.jsx("th",{children:"Accin"})]})}),o.jsx("tbody",{children:p.map(v=>o.jsxs("tr",{children:[o.jsx("td",{className:"email-cell",children:v.userEmail||v.userId||"Email no disponible"}),o.jsx("td",{className:"amount-cell",children:O(v.amount)}),o.jsx("td",{children:v.method||"-"}),o.jsx("td",{children:o.jsxs("span",{className:`status-badge status-${v.status}`,children:[v.status==="pending"&&"Pendiente",v.status==="approved"&&"Aprobada",v.status==="rejected"&&"Rechazada"]})}),o.jsx("td",{children:D(v.createdAt)}),o.jsx("td",{children:o.jsxs("div",{className:"action-buttons",children:[_(v)&&o.jsx("button",{className:"btn-action btn-proof",onClick:()=>{u({isOpen:!0,url:_(v)})},title:"Ver comprobante",children:o.jsxs("svg",{className:"btn-icon",viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[o.jsx("path",{d:"M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7S2 12 2 12Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),o.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),v.status==="pending"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"btn-action btn-approve",onClick:()=>{s(v),a({isOpen:!0,type:"approve"})},title:"Aprobar",children:""}),o.jsx("button",{className:"btn-action btn-reject",onClick:()=>{s(v),a({isOpen:!0,type:"reject"})},title:"Rechazar",children:""})]})]})})]},v.id))})]})})]}),c.isOpen&&o.jsx("div",{className:"proof-viewer-overlay",onClick:()=>u({isOpen:!1,url:null}),role:"button",tabIndex:0,"aria-label":"Cerrar comprobante",children:o.jsx("img",{className:"proof-viewer-image",src:c.url,alt:"Comprobante"})}),o.jsx(du,{isOpen:i.isOpen,title:i.type==="approve"?"Aprobar Recarga":"Rechazar Recarga",message:`${i.type==="approve"?"Aprobar":"Rechazar"} recarga de ${r?O(r.amount):""} del usuario ${(r==null?void 0:r.userEmail)||(r==null?void 0:r.userId)}?`,actionLabel:i.type==="approve"?"Aprobar":"Rechazar",showReasonInput:i.type==="reject",reasonPlaceholder:"Razn del rechazo...",loading:x||I,onConfirm:i.type==="approve"?T:k,onCancel:()=>{a({isOpen:!1,type:null}),s(null)}}),o.jsx(k1,{isOpen:d,onClose:()=>f(!1)})]})}function b1(t={}){const[e,n]=b.useState([]),[r,s]=b.useState(!0),[i,a]=b.useState(null),[c,u]=b.useState(0),[d,f]=b.useState({all:0,pending:0,approved:0,rejected:0}),[p,m]=b.useState(t.pageSize||25),[E,y]=b.useState(1),[x,N]=b.useState([]),[I,w]=b.useState(!1),T=t.status||"all",k=C=>C?typeof C=="string"?C:C!=null&&C.toDate?C.toDate().toISOString():C instanceof Date?C.toISOString():null:null,O=async()=>{try{const C=ae(W,"withdrawals"),[j,S,U,G]=await Promise.all([hl(ye(C)),hl(ye(C,Ce("status","==","pending"))),hl(ye(C,Ce("status","==","approved"))),hl(ye(C,Ce("status","==","rejected")))]);f({all:j.data().count,pending:S.data().count,approved:U.data().count,rejected:G.data().count})}catch(C){console.warn("useAdminWithdrawals counts error",C)}},D=async({nextPageSize:C=p,nextPage:j=E,nextCursors:S=x}={})=>{try{s(!0),a(null);const U=[];T&&T!=="all"&&U.push(Ce("status","==",T));const G=j>1?S[j-2]:null;G&&U.push(wb(G));const ne=ye(ae(W,"withdrawals"),...U,wn("createdAt","desc"),Wn(Number(C)+1)),B=(await Ee(ne)).docs,Y=B.length>Number(C),L=Y?B.slice(0,Number(C)):B;if(w(Y),L.length){const Te=L[L.length-1];N(at=>{const No=[...at];return No[j-1]=Te,No})}const ie=L.map(Te=>({id:Te.id,...Te.data()})),oe=[...new Set(ie.map(Te=>Te.userId).filter(Boolean))],pe=await Promise.all(oe.map(async Te=>{const at=await Mt(se(W,"users",Te));return[Te,at.exists()?at.data():null]})),Me=Object.fromEntries(pe),Ge=ie.map(Te=>{const at=Me[Te.userId]||null;return{...Te,userEmail:Te.userEmail||(at==null?void 0:at.email)||null,userName:Te.userName||(at==null?void 0:at.displayName)||(at==null?void 0:at.fullName)||null,createdAt:k(Te.createdAt)||Te.createdAt}});n(Ge);const kt=T==="pending"?d.pending:T==="approved"?d.approved:T==="rejected"?d.rejected:d.all;u(Number.isFinite(kt)&&kt>0?kt:Ge.length)}catch(U){console.error("Error en useAdminWithdrawals:",U),a(U.message)}finally{s(!1)}};b.useEffect(()=>{y(1),N([]),t.pageSize&&m(t.pageSize),O(),D({nextPage:1,nextCursors:[]})},[T]),b.useEffect(()=>{y(1),N([]),D({nextPageSize:p,nextPage:1,nextCursors:[]})},[p]),b.useEffect(()=>{D({nextPage:v})},[E]);const _=()=>{O(),D({nextPage:E})},v=()=>{I&&y(C=>C+1)};return{withdrawals:e,loading:r,error:i,total:c,counts:d,page:E,pageSize:p,hasNextPage:I,nextPage:v,prevPage:()=>{y(C=>Math.max(1,C-1))},setPageSize:C=>{const j=Number(C);!Number.isFinite(j)||j<=0||m(j)},refetch:_}}function O1(){const[t,e]=b.useState(!1),[n,r]=b.useState(null);return{approve:async(i,a,c,u,d)=>{var f,p,m,E;try{e(!0),r(null);let y=null;try{const x=ye(ae(W,"transactions"),Ce("withdrawalId","==",i),Wn(1));if(y=((p=(f=(await Ee(x)).docs)==null?void 0:f[0])==null?void 0:p.id)||null,!y){const I=ye(ae(W,"transactions"),Ce("reference","==",i),Wn(1));y=((E=(m=(await Ee(I)).docs)==null?void 0:m[0])==null?void 0:E.id)||null}}catch{}return await Ci(W,async x=>{const N=se(W,"withdrawals",i),I=await x.get(N);if(!I.exists())throw new Error("Retiro no encontrado");const w=I.data(),T=w==null?void 0:w.status;if(T==="approved")return;if(T!=="pending")throw new Error(`No se puede aprobar un retiro con status: ${T}`);const k=(w==null?void 0:w.userId)||a,O=Number((w==null?void 0:w.amount)??c),D=(w==null?void 0:w.transactionId)||y||i;if(!k)throw new Error("Retiro invlido: falta userId");if(!Number.isFinite(O)||O<=0)throw new Error("Retiro invlido: amount debe ser > 0");const _=se(W,"users",k,"wallets",k);if(!(await x.get(_)).exists())throw new Error("El usuario no tiene wallet; no se puede descontar saldo");x.update(_,{balance:Ia(-O),updatedAt:re()}),x.update(N,{status:"approved",approvedAt:re(),approvedBy:u,updatedAt:re()});const A=se(W,"transactions",D),P=await x.get(A),C=w!=null&&w.createdAt&&typeof w.createdAt!="string"?w.createdAt:re(),j={userId:k,type:"withdrawal",amount:O,status:"approved",sourceType:"withdrawal",sourceId:i,withdrawalId:i,updatedAt:re()};P.exists()?x.update(A,j):x.set(A,{...j,createdAt:C});const S=se(ae(W,"auditLogs"));x.set(S,{action:"APPROVE_WITHDRAWAL",adminUid:u,adminEmail:d,targetUserId:k,targetId:i,status:"SUCCESS",metadata:{amount:O,withdrawalId:i},timestamp:re()})}),console.log(" Retiro aprobado:",i),!0}catch(y){return console.error(" Error al aprobar retiro:",y),r((y==null?void 0:y.message)||String(y)),!1}finally{e(!1)}},loading:t,error:n}}function D1(){const[t,e]=b.useState(!1),[n,r]=b.useState(null);return{reject:async(i,a,c,u,d)=>{var f,p,m,E;try{e(!0),r(null);let y=null;try{const x=ye(ae(W,"transactions"),Ce("withdrawalId","==",i),Wn(1));if(y=((p=(f=(await Ee(x)).docs)==null?void 0:f[0])==null?void 0:p.id)||null,!y){const I=ye(ae(W,"transactions"),Ce("reference","==",i),Wn(1));y=((E=(m=(await Ee(I)).docs)==null?void 0:m[0])==null?void 0:E.id)||null}}catch{}return await Ci(W,async x=>{const N=se(W,"withdrawals",i),I=await x.get(N);if(!I.exists())throw new Error("Retiro no encontrado");const w=I.data(),T=w==null?void 0:w.status;if(T==="rejected")return;if(T!=="pending")throw new Error(`No se puede rechazar un retiro con status: ${T}`);const k=(w==null?void 0:w.userId)||a,O=Number(w==null?void 0:w.amount),D=(w==null?void 0:w.transactionId)||y||i;if(!k)throw new Error("Retiro invlido: falta userId");x.update(N,{status:"rejected",rejectedAt:re(),rejectedBy:u,rejectionReason:c,updatedAt:re()});const _=se(W,"transactions",D),v=await x.get(_),A=w!=null&&w.createdAt&&typeof w.createdAt!="string"?w.createdAt:re(),P={userId:k,type:"withdrawal",amount:Number.isFinite(O)?O:null,status:"rejected",sourceType:"withdrawal",sourceId:i,withdrawalId:i,rejectionReason:c,updatedAt:re()};v.exists()?x.update(_,P):x.set(_,{...P,createdAt:A});const C=se(ae(W,"auditLogs"));x.set(C,{action:"REJECT_WITHDRAWAL",adminUid:u,adminEmail:d,targetUserId:k,targetId:i,status:"SUCCESS",reason:c,timestamp:re()})}),console.log(" Retiro rechazado:",i),!0}catch(y){return console.error(" Error al rechazar retiro:",y),r((y==null?void 0:y.message)||String(y)),!1}finally{e(!1)}},loading:t,error:n}}function V1({adminData:t}){const[e,n]=b.useState("all"),[r,s]=b.useState(25),[i,a]=b.useState(null),[c,u]=b.useState({isOpen:!1,type:null}),{withdrawals:d,loading:f,refetch:p,counts:m,page:E,hasNextPage:y,nextPage:x,prevPage:N,setPageSize:I}=b1({status:e,pageSize:r}),{approve:w,loading:T}=O1(),{reject:k,loading:O}=D1(),D=[{value:"all",label:"Todos"},{value:"pending",label:"Pendientes"},{value:"approved",label:"Aprobados"},{value:"rejected",label:"Rechazados"}],_=async()=>{if(!i)return;await w(i.id,i.userId,i.amount,t.uid,t.email)&&(u({isOpen:!1,type:null}),a(null),p())},v=async C=>{if(!i)return;await k(i.id,i.userId,C,t.uid,t.email)&&(u({isOpen:!1,type:null}),a(null),p())},A=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(C||0),P=C=>{if(!C)return"-";const j=C!=null&&C.toDate?C.toDate():new Date(C);return Number.isNaN(j.getTime())?"-":j.toLocaleDateString("es-MX")};return o.jsxs("div",{className:"retiros-page",children:[o.jsx("div",{className:"page-header",children:o.jsxs("div",{children:[o.jsx("h1",{className:"page-title",children:"Gestin de Retiros"}),o.jsx("p",{className:"page-subtitle",children:"Administra todas las solicitudes de retiro de usuarios"})]})}),o.jsx("div",{className:"retiros-filters",children:D.map(C=>o.jsxs("button",{className:`filter-btn ${e===C.value?"active":""}`,onClick:()=>{n(C.value)},children:[C.label,o.jsx("span",{className:"filter-count",children:C.value==="all"?(m==null?void 0:m.all)??0:(m==null?void 0:m[C.value])??0})]},C.value))}),o.jsxs("div",{className:"retiros-controls",children:[o.jsxs("div",{className:"retiros-control",children:[o.jsx("span",{className:"retiros-control-label",children:"Mostrar"}),o.jsxs("select",{className:"retiros-page-size",value:r,onChange:C=>{const j=Number(C.target.value);s(j),I(j)},children:[o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:25,children:"25"}),o.jsx("option",{value:50,children:"50"}),o.jsx("option",{value:100,children:"100"})]}),o.jsx("span",{className:"retiros-control-label",children:"por pgina"})]}),o.jsxs("div",{className:"retiros-pagination",children:[o.jsx("button",{className:"pagination-btn",onClick:N,disabled:f||E<=1,children:" Anterior"}),o.jsxs("span",{className:"pagination-status",children:["Pgina ",E]}),o.jsx("button",{className:"pagination-btn",onClick:x,disabled:f||!y,children:"Siguiente "})]})]}),o.jsxs("div",{className:"retiros-card",children:[o.jsx("div",{className:"card-header",children:o.jsxs("h3",{children:["Total de retiros: ",d.length]})}),f?o.jsx("div",{className:"loading-state",children:"Cargando retiros..."}):d.length===0?o.jsx("div",{className:"empty-state",children:"No hay retiros en este estado"}):o.jsx("div",{className:"table-wrapper",children:o.jsxs("table",{className:"retiros-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Usuario"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Mtodo"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"}),o.jsx("th",{children:"Accin"})]})}),o.jsx("tbody",{children:d.map(C=>o.jsxs("tr",{children:[o.jsx("td",{className:"email-cell",children:C.userEmail||C.userId||"Email no disponible"}),o.jsx("td",{className:"amount-cell",children:A(C.amount)}),o.jsx("td",{children:C.method||"-"}),o.jsx("td",{children:o.jsxs("span",{className:`status-badge status-${C.status}`,children:[C.status==="pending"&&"Pendiente",C.status==="approved"&&"Aprobado",C.status==="rejected"&&"Rechazado"]})}),o.jsx("td",{children:P(C.createdAt)}),o.jsx("td",{children:C.status==="pending"&&o.jsxs("div",{className:"action-buttons",children:[o.jsx("button",{className:"btn-action btn-approve",onClick:()=>{a(C),u({isOpen:!0,type:"approve"})},title:"Aprobar",children:""}),o.jsx("button",{className:"btn-action btn-reject",onClick:()=>{a(C),u({isOpen:!0,type:"reject"})},title:"Rechazar",children:""})]})})]},C.id))})]})})]}),o.jsx(du,{isOpen:c.isOpen,title:c.type==="approve"?"Aprobar Retiro":"Rechazar Retiro",message:`${c.type==="approve"?"Aprobar":"Rechazar"} retiro de ${i?A(i.amount):""} del usuario ${(i==null?void 0:i.userEmail)||(i==null?void 0:i.userId)}?`,actionLabel:c.type==="approve"?"Aprobar":"Rechazar",showReasonInput:c.type==="reject",reasonPlaceholder:"Razn del rechazo...",loading:T||O,onConfirm:c.type==="approve"?_:v,onCancel:()=>{u({isOpen:!1,type:null}),a(null)}})]})}function x0(t={}){const[e,n]=b.useState([]),[r,s]=b.useState(!0),[i,a]=b.useState(null),[c,u]=b.useState(0),[d,f]=b.useState(0),p=async()=>{try{s(!0),a(null);const E=t.status&&t.status!=="all",y=!!t.projectId,x=!!t.userId,N=[];y?N.push(Ce("projectId","==",t.projectId)):x?N.push(Ce("userId","==",t.userId)):E&&N.push(Ce("status","==",t.status));const I=ye(ae(W,"investments"),...N),k=(await Ee(I)).docs.map(U=>({id:U.id,...U.data()})).filter(U=>!(y&&U.projectId!==t.projectId||x&&U.userId!==t.userId||E&&U.status!==t.status));k.sort((U,G)=>{var B,Y;const ne=(B=U==null?void 0:U.createdAt)!=null&&B.toMillis?U.createdAt.toMillis():U!=null&&U.createdAt?new Date(U.createdAt).getTime():0;return((Y=G==null?void 0:G.createdAt)!=null&&Y.toMillis?G.createdAt.toMillis():G!=null&&G.createdAt?new Date(G.createdAt).getTime():0)-ne});const O=[...new Set(k.map(U=>U.userId).filter(Boolean))],D=[...new Set(k.map(U=>U.projectId).filter(Boolean))],[_,v]=await Promise.all([Promise.all(O.map(async U=>{const G=await Mt(se(W,"users",U));return[U,G.exists()?G.data():null]})),Promise.all(D.map(async U=>{const G=await Mt(se(W,"projects",U));return[U,G.exists()?G.data():null]}))]),A=Object.fromEntries(_),P=Object.fromEntries(v),C=(U,G)=>!U||!G?null:Number(((G-U)/U*100).toFixed(2)),j=k.map(U=>{const G=A[U.userId]||{},ne=P[U.projectId]||{};return{...U,userEmail:G.email||"",userName:G.displayName||G.fullName||"",projectName:ne.name||"",expectedROI:C(U.amount,U.expectedReturn),actualROI:C(U.amount,U.actualReturn||U.realizedReturn||U.payout)}});n(j),u(j.length);const S=j.reduce((U,G)=>U+(G.amount||0),0);f(S)}catch(E){console.error("Error en useAdminInvestments:",E),a(E.message)}finally{s(!1)}};return b.useEffect(()=>{p()},[t.status,t.projectId,t.userId]),{investments:e,loading:r,error:i,total:c,totalAmount:d,refetch:()=>p()}}function N0(){const[t,e]=b.useState([]),[n,r]=b.useState(!0),[s,i]=b.useState(null),a=async()=>{try{r(!0),i(null);const u=ae(W,"projects"),d=ye(u,wn("createdAt","desc")),m=(await Ee(d)).docs.map(E=>({id:E.id,...E.data()})).map(E=>{const y=E.type==="fixed",x=Number(E.targetAmount||0),N=Number(E.totalInvested||0),I=y&&x>0&&N>=x,w=I?"funded":E.status||"draft",T=w==="active"&&!I&&E.status!=="paused"&&E.status!=="closed";return{...E,computedStatus:w,progress:x>0?Math.min(100,Number((N/x*100).toFixed(2))):null,isTargetReached:I,investable:T}});e(m)}catch(u){console.error("Error en useAdminProjects:",u),i(u.message)}finally{r(!1)}};return b.useEffect(()=>{a()},[]),{projects:t,loading:n,error:s,refetch:()=>a()}}function L1(){const[t,e]=b.useState(!1),[n,r]=b.useState(null);return{approve:async(i,a,c)=>{var u,d;try{e(!0),r(null);let f=null;try{const p=ye(ae(W,"transactions"),Ce("investmentId","==",i),Wn(1));f=((d=(u=(await Ee(p)).docs)==null?void 0:u[0])==null?void 0:d.id)||null}catch{}return await Ci(W,async p=>{const m=se(W,"investments",i),E=await p.get(m);if(!E.exists())throw new Error("Inversin no encontrada");const y=E.data(),x=y==null?void 0:y.status;if(x==="active")return;if(x!=="pending")throw new Error(`No se puede aprobar una inversin con status: ${x}`);const N=y==null?void 0:y.userId,I=Number(y==null?void 0:y.amount),w=(y==null?void 0:y.transactionId)||f||null,T=(y==null?void 0:y.projectId)||null;if(!N)throw new Error("Inversin invlida: falta userId");if(!Number.isFinite(I)||I<=0)throw new Error("Inversin invlida: amount debe ser > 0");if(!T)throw new Error("Inversin invlida: falta projectId");const k=se(W,"projects",T),O=await p.get(k);if(!O.exists())throw new Error("Proyecto no encontrado");const D=O.data()||{},_=Number(D.targetAmount??D.target??D.goalAmount),v=Number(D.totalInvestment??D.totalInvested??D.totalInvestedAmount??0);if(!Number.isFinite(v)||v<0)throw new Error("Proyecto invlido: totalInvestment no es numrico");if(Number.isFinite(_)&&_>0){const Ge=_-v;if(Ge<=0)throw new Error("Este proyecto ya alcanz su meta de inversin");if(I>Ge)throw new Error(`La inversin excede el cupo del proyecto. Disponible: ${Ge}`)}const P=se(W,"users",N,"wallets",N),C=await p.get(P);if(!C.exists())throw new Error("El usuario no tiene wallet; no se puede descontar saldo");const j=w?se(W,"transactions",w):null,S=j?await p.get(j):null,U=S!=null&&S.exists()?S.data():null,G=U!=null&&U.createdAt&&typeof U.createdAt!="string"?U.createdAt:y!=null&&y.createdAt&&typeof y.createdAt!="string"?y.createdAt:re(),ne=(U==null?void 0:U.currency)||(y==null?void 0:y.currency)||"USD",ve=(U==null?void 0:U.projectId)||T,B=(U==null?void 0:U.investmentId)||i,Y=(U==null?void 0:U.description)||"Inversin aprobada",L=(U==null?void 0:U.reference)||i,ie=se(ae(W,"transactions")),oe=C.data()||{},pe=Number(oe.balance||0);if(!Number.isFinite(pe))throw new Error("Wallet invlida: balance no es numrico");if(pe<I)throw new Error("Saldo insuficiente para aprobar esta inversin");p.update(P,{balance:Ia(-I),updatedAt:re()}),p.update(k,{totalInvestment:Ia(I),totalInvested:Ia(I),updatedAt:re()}),p.update(m,{status:"active",approvedAt:re(),approvedBy:a,updatedAt:re()}),p.set(ie,{userId:N,projectId:ve,investmentId:B,amount:I,currency:ne,type:"investment",status:"approved",description:Y,reference:L,createdAt:G,approvedAt:re(),approvedBy:a});const Me=se(ae(W,"auditLogs"));p.set(Me,{action:"APPROVE_INVESTMENT",adminUid:a,adminEmail:c,targetUserId:N,targetId:i,status:"SUCCESS",metadata:{amount:I,investmentId:i,projectId:(y==null?void 0:y.projectId)||null},timestamp:re()})}),!0}catch(f){return console.error(" Error al aprobar inversin:",f),r((f==null?void 0:f.message)||String(f)),!1}finally{e(!1)}},loading:t,error:n}}function M1(){const[t,e]=b.useState(!1),[n,r]=b.useState(null);return{reject:async(i,a,c,u)=>{var d,f;try{e(!0),r(null);let p=null;try{const m=ye(ae(W,"transactions"),Ce("investmentId","==",i),Wn(1));p=((f=(d=(await Ee(m)).docs)==null?void 0:d[0])==null?void 0:f.id)||null}catch{}return await Ci(W,async m=>{const E=se(W,"investments",i),y=await m.get(E);if(!y.exists())throw new Error("Inversin no encontrada");const x=y.data(),N=x==null?void 0:x.status;if(N==="cancelled")return;if(N!=="pending")throw new Error(`No se puede rechazar una inversin con status: ${N}`);const I=x==null?void 0:x.userId,w=Number(x==null?void 0:x.amount),T=(x==null?void 0:x.transactionId)||p||null;if(!I)throw new Error("Inversin invlida: falta userId");const k=T?se(W,"transactions",T):null,O=k?await m.get(k):null,D=O!=null&&O.exists()?O.data():null,_=D!=null&&D.createdAt&&typeof D.createdAt!="string"?D.createdAt:x!=null&&x.createdAt&&typeof x.createdAt!="string"?x.createdAt:re(),v=(D==null?void 0:D.currency)||(x==null?void 0:x.currency)||"USD",A=(D==null?void 0:D.projectId)||(x==null?void 0:x.projectId)||null,P=(D==null?void 0:D.investmentId)||i,C=(D==null?void 0:D.description)||"Inversin rechazada",j=(D==null?void 0:D.reference)||i,S=se(ae(W,"transactions"));m.update(E,{status:"cancelled",cancelledAt:re(),cancelledBy:c,cancellationReason:a,updatedAt:re()}),m.set(S,{userId:I,projectId:A,investmentId:P,amount:Number.isFinite(w)?w:null,currency:v,type:"investment",status:"rejected",description:C,reference:j,createdAt:_,rejectionReason:a,rejectedAt:re(),rejectedBy:c});const U=se(ae(W,"auditLogs"));m.set(U,{action:"REJECT_INVESTMENT",adminUid:c,adminEmail:u,targetUserId:I,targetId:i,status:"SUCCESS",reason:a,timestamp:re()})}),!0}catch(p){return console.error(" Error al rechazar inversin:",p),r((p==null?void 0:p.message)||String(p)),!1}finally{e(!1)}},loading:t,error:n}}function F1({adminData:t}){const e=Gn(),[n]=Uf(),r=n.get("projectId")||"",s=n.get("userId")||"",[i,a]=b.useState({status:"all",projectId:r,userId:s,search:""}),{projects:c}=N0(),{investments:u,loading:d,totalAmount:f,refetch:p}=x0({status:i.status,projectId:i.projectId||void 0,userId:i.userId||void 0}),[m,E]=b.useState(null),[y,x]=b.useState({isOpen:!1,type:null}),{approve:N,loading:I}=L1(),{reject:w,loading:T}=M1();b.useEffect(()=>{a(S=>({...S,projectId:r,userId:s}))},[r,s]);const k=[{value:"all",label:"Todas"},{value:"active",label:"Activas"},{value:"completed",label:"Completadas"},{value:"cancelled",label:"Canceladas"}],O=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(S||0),D=S=>S?new Date(S).toLocaleDateString("es-MX"):"",_=S=>S==null?"":`${S.toFixed(2)}%`,v=b.useMemo(()=>{const S=i.search.toLowerCase();return u.filter(U=>{var ne,ve;return S?((ne=U.userEmail)==null?void 0:ne.toLowerCase().includes(S))||((ve=U.userName)==null?void 0:ve.toLowerCase().includes(S)):!0})},[u,i.search]),A=S=>{S&&e(`/admin/usuarios?uid=${S}`)},P=S=>{S&&e(`/admin/proyectos?projectId=${S}`)},C=async()=>{if(!m)return;await N(m.id,t==null?void 0:t.uid,t==null?void 0:t.email)&&(x({isOpen:!1,type:null}),E(null),p==null||p())},j=async S=>{if(!m)return;await w(m.id,S,t==null?void 0:t.uid,t==null?void 0:t.email)&&(x({isOpen:!1,type:null}),E(null),p==null||p())};return o.jsxs("div",{className:"inversiones-page",children:[o.jsx("div",{className:"page-header",children:o.jsxs("div",{children:[o.jsx("h1",{className:"page-title",children:"Gestin de Inversiones"}),o.jsx("p",{className:"page-subtitle",children:"Contexto completo: usuario, proyecto y ROI real vs esperado"})]})}),o.jsxs("div",{className:"inversiones-summary",children:[o.jsxs("div",{className:"summary-card",children:[o.jsx("div",{className:"summary-label",children:"Total Invertido"}),o.jsx("div",{className:"summary-value",children:O(f)})]}),o.jsxs("div",{className:"summary-card",children:[o.jsx("div",{className:"summary-label",children:"Inversiones Activas"}),o.jsx("div",{className:"summary-value",children:u.filter(S=>S.status==="active").length})]}),o.jsxs("div",{className:"summary-card",children:[o.jsx("div",{className:"summary-label",children:"Total de Inversiones"}),o.jsx("div",{className:"summary-value",children:u.length})]})]}),o.jsxs("div",{className:"inversiones-filters",children:[k.map(S=>o.jsxs("button",{className:`filter-btn ${i.status===S.value?"active":""}`,onClick:()=>a({...i,status:S.value}),children:[S.label,o.jsx("span",{className:"filter-count",children:S.value==="all"?u.length:u.filter(U=>U.status===S.value).length})]},S.value)),o.jsxs("select",{className:"filter-select",value:i.projectId,onChange:S=>a({...i,projectId:S.target.value}),children:[o.jsx("option",{value:"",children:"Todos los proyectos"}),c.map(S=>o.jsx("option",{value:S.id,children:S.name||"Proyecto sin nombre"},S.id))]}),o.jsx("input",{type:"text",className:"filter-input",placeholder:"Buscar usuario (email/nombre)",value:i.search,onChange:S=>a({...i,search:S.target.value})})]}),o.jsxs("div",{className:"inversiones-card",children:[o.jsx("div",{className:"card-header",children:o.jsx("h3",{children:"Inversiones"})}),d?o.jsx("div",{className:"loading-state",children:"Cargando inversiones..."}):v.length===0?o.jsx("div",{className:"empty-state",children:"No hay inversiones con estos filtros"}):o.jsx("div",{className:"table-wrapper",children:o.jsxs("table",{className:"inversiones-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Usuario"}),o.jsx("th",{children:"Proyecto"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"ROI Esperado"}),o.jsx("th",{children:"ROI Real"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"}),o.jsx("th",{children:"Acciones"})]})}),o.jsx("tbody",{children:v.map(S=>o.jsxs("tr",{children:[o.jsxs("td",{children:[o.jsx("div",{className:"cell-title",children:S.userName||"Usuario sin datos"}),o.jsx("div",{className:"cell-subtle",children:S.userEmail||"Email no disponible"})]}),o.jsxs("td",{children:[o.jsx("div",{className:"cell-title",children:S.projectName||"Proyecto sin nombre"}),o.jsx("div",{className:"cell-subtle",children:S.expectedReturn?"Con retorno esperado":"Retorno no definido"})]}),o.jsx("td",{className:"amount-cell",children:O(S.amount)}),o.jsx("td",{children:o.jsx("span",{className:`roi-badge ${Number(S.expectedROI)>=0?"roi-positive":"roi-negative"}`,children:_(S.expectedROI)})}),o.jsx("td",{children:o.jsx("span",{className:`roi-badge ${Number(S.actualROI)>=0?"roi-positive":"roi-negative"}`,children:_(S.actualROI)})}),o.jsx("td",{children:o.jsxs("span",{className:`status-badge status-${S.status}`,children:[S.status==="active"&&"Activa",S.status==="completed"&&"Completada",S.status==="cancelled"&&"Cancelada"]})}),o.jsx("td",{children:D(S.createdAt)}),o.jsxs("td",{className:"actions-cell",children:[o.jsx("button",{className:"link-btn",onClick:()=>A(S.userId),children:"Ver usuario"}),o.jsx("button",{className:"link-btn",onClick:()=>P(S.projectId),disabled:!S.projectId,children:"Ver proyecto"}),S.status==="pending"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"link-btn",onClick:()=>{E(S),x({isOpen:!0,type:"approve"})},disabled:I||T,children:"Aprobar"}),o.jsx("button",{className:"link-btn",onClick:()=>{E(S),x({isOpen:!0,type:"reject"})},disabled:I||T,children:"Rechazar"})]})]})]},S.id))})]})})]}),o.jsx(du,{isOpen:y.isOpen,title:y.type==="approve"?"Aprobar Inversin":"Rechazar Inversin",message:`${y.type==="approve"?"Aprobar":"Rechazar"} inversin de ${m?O(m.amount):""} del usuario ${(m==null?void 0:m.userEmail)||(m==null?void 0:m.userId)}? ${y.type==="approve"?"Se descontar del saldo.":""}`,actionLabel:y.type==="approve"?"Aprobar":"Rechazar",showReasonInput:y.type==="reject",reasonPlaceholder:"Razn del rechazo...",loading:I||T,onConfirm:y.type==="approve"?C:j,onCancel:()=>{x({isOpen:!1,type:null}),E(null)}})]})}function U1({isOpen:t,onClose:e,onSuccess:n}){const[r,s]=b.useState({name:"",type:"fixed",category:"",riskLevel:"medium",expectedROI:"",durationMonths:"",targetAmount:"",minInvestment:"",maxInvestment:"",drawdown:"",performance:"",manualControl:!0}),[i,a]=b.useState(!1),[c,u]=b.useState(null),[d,f]=b.useState(!1),[p,m]=b.useState(!1),[E,y]=b.useState(""),x=["Energa","Trading","Crypto","Inmobiliario"],N=()=>{s({name:"",type:"fixed",category:"",riskLevel:"medium",expectedROI:"",durationMonths:"",targetAmount:"",minInvestment:"",maxInvestment:"",drawdown:"",performance:"",manualControl:!0}),u(null)},I=()=>{N(),e()},w=async(T,k="draft")=>{if(T.preventDefault(),!r.name){u("El nombre es obligatorio");return}const O=r.type==="fixed",D=O?Number(r.targetAmount):null,_=O&&r.minInvestment!==""?Number(r.minInvestment):null,v=O&&r.maxInvestment!==""?Number(r.maxInvestment):null;if(O){if(!Number.isFinite(D)||D<=0){u("El capital objetivo (targetAmount) es obligatorio y debe ser mayor a 0");return}if(_!==null){if(!Number.isFinite(_)||_<=0){u("La inversin mnima debe ser un nmero mayor a 0");return}if(_>D){u("La inversin mnima no puede ser mayor al capital objetivo");return}}if(v!==null){if(!Number.isFinite(v)||v<=0){u("La inversin mxima debe ser un nmero mayor a 0");return}if(v>D){u("La inversin mxima no puede ser mayor al capital objetivo");return}}if(_!==null&&v!==null&&_>v){u("La inversin mnima no puede ser mayor que la inversin mxima");return}}try{a(!0),u(null);const A={name:r.name,type:r.type,category:r.category||null,riskLevel:r.riskLevel||"medium",expectedROI:r.expectedROI?Number(r.expectedROI):null,duration:r.durationMonths?Number(r.durationMonths):null,status:"draft",targetAmount:O?D:null,totalInvested:0,totalInvestment:0,minInvestment:O?_:null,maxInvestment:O?v:null,autoLockOnTarget:O?!0:null,drawdown:!O&&r.drawdown?Number(r.drawdown):null,performance:!O&&r.performance?Number(r.performance):null,manualControl:r.manualControl,investable:k==="active",createdAt:re(),updatedAt:re()};await zh(ae(W,"projects"),A),N(),n==null||n(),e()}catch(A){console.error("Error creando proyecto",A),u("No se pudo crear el proyecto")}finally{a(!1)}};return t?o.jsx("div",{className:"project-modal-overlay",onClick:I,children:o.jsxs("div",{className:"project-modal",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Crear Proyecto Financiero"}),o.jsx("button",{className:"close-btn",onClick:I,children:""})]}),o.jsxs("form",{className:"modal-form",onSubmit:T=>w(T,"draft"),children:[o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"form-section-header",children:[o.jsx("h3",{children:"Informacin General"}),o.jsx("p",{children:"Datos bsicos del proyecto financiero"})]}),o.jsx("div",{className:"form-row",children:o.jsxs("label",{children:["Nombre del proyecto *",o.jsx("input",{type:"text",value:r.name,onChange:T=>s({...r,name:T.target.value}),placeholder:"Fondo Deuda USD 12%",required:!0})]})}),o.jsxs("div",{className:"form-row form-row-2",children:[o.jsxs("label",{children:["Tipo de proyecto *",o.jsxs("select",{value:r.type,onChange:T=>s({...r,type:T.target.value}),children:[o.jsx("option",{value:"fixed",children:"Fijo (meta de capital)"}),o.jsx("option",{value:"variable",children:"Variable (trading/crypto)"})]})]}),o.jsxs("label",{children:[o.jsxs("span",{className:"label-with-badge",children:["Categora",o.jsx("span",{className:"label-badge",children:"Catlogo admin"})]}),o.jsxs("div",{className:"category-select",onClick:()=>f(T=>!T),children:[o.jsxs("div",{className:"category-control",role:"button",tabIndex:0,children:[o.jsx("div",{className:"category-value",children:r.category||"Busca o selecciona una categora creada por admin"}),o.jsx("div",{className:"category-caret",children:""})]}),d&&o.jsxs("div",{className:"category-dropdown",onClick:T=>T.stopPropagation(),children:[o.jsx("div",{className:"dropdown-search",children:o.jsx("input",{type:"text",placeholder:"Buscar categoras",value:r.category,onChange:T=>s({...r,category:T.target.value})})}),o.jsx("div",{className:"dropdown-section",children:x.map(T=>o.jsx("button",{type:"button",className:`dropdown-item ${r.category===T?"selected":""}`,onClick:()=>{s({...r,category:T}),m(!1),f(!1)},children:T},T))}),o.jsxs("div",{className:"dropdown-section create-section",children:[o.jsx("button",{type:"button",className:"dropdown-item create-item",onClick:()=>{m(!0)},children:" Crear nueva categora"}),p&&o.jsxs("div",{className:"inline-create",children:[o.jsxs("label",{children:["Nombre de la categora",o.jsx("input",{type:"text",value:E,onChange:T=>y(T.target.value),placeholder:"Ej. Deuda privada USD"})]}),o.jsxs("div",{className:"inline-actions",children:[o.jsx("button",{type:"button",className:"draft-btn ghost",onClick:()=>{m(!1),y("")},children:"Cancelar"}),o.jsx("button",{type:"button",className:"submit-btn compact",onClick:()=>{E.trim()&&(s({...r,category:E.trim()}),m(!1),f(!1),y(""))},children:"Crear y seleccionar"})]})]})]})]})]}),o.jsx("span",{className:"field-hint",children:"Las categoras son creadas por administradores y se reutilizan en proyectos futuros."})]})]}),o.jsxs("div",{className:"form-row form-row-3",children:[o.jsxs("label",{children:["Nivel de riesgo *",o.jsxs("select",{value:r.riskLevel,onChange:T=>s({...r,riskLevel:T.target.value}),children:[o.jsx("option",{value:"low",children:"Bajo"}),o.jsx("option",{value:"medium",children:"Medio"}),o.jsx("option",{value:"high",children:"Alto"})]})]}),o.jsxs("label",{children:["ROI esperado (%)",o.jsx("input",{type:"number",step:"0.01",value:r.expectedROI,onChange:T=>s({...r,expectedROI:T.target.value}),placeholder:"12"})]}),o.jsxs("label",{children:["Duracin (meses)",o.jsx("input",{type:"number",value:r.durationMonths,onChange:T=>s({...r,durationMonths:T.target.value}),placeholder:"12"})]})]}),r.type==="fixed"&&o.jsxs("div",{className:"form-section form-section-financial",children:[o.jsxs("div",{className:"form-section-header",children:[o.jsx("h3",{children:" Configuracin Financiera (Proyecto Fijo)"}),o.jsx("p",{children:"Establece los lmites de capital e inversin"})]}),o.jsxs("div",{className:"form-row form-row-3",children:[o.jsxs("label",{children:["Capital objetivo (USD)",o.jsx("input",{type:"number",value:r.targetAmount,onChange:T=>s({...r,targetAmount:T.target.value}),placeholder:"500000"})]}),o.jsxs("label",{children:["Inversin mnima (USD)",o.jsx("input",{type:"number",value:r.minInvestment,onChange:T=>s({...r,minInvestment:T.target.value}),placeholder:"1000"})]}),o.jsxs("label",{children:["Inversin mxima (USD)",o.jsx("input",{type:"number",value:r.maxInvestment,onChange:T=>s({...r,maxInvestment:T.target.value}),placeholder:"50000"})]})]})]}),r.type==="variable"&&o.jsxs("div",{className:"form-section form-section-financial",children:[o.jsxs("div",{className:"form-section-header",children:[o.jsx("h3",{children:" Configuracin Financiera (Proyecto Variable)"}),o.jsx("p",{children:"Mtricas de rendimiento y control"})]}),o.jsxs("div",{className:"form-row form-row-2",children:[o.jsxs("label",{children:["Drawdown (%)",o.jsx("input",{type:"number",step:"0.01",value:r.drawdown,onChange:T=>s({...r,drawdown:T.target.value}),placeholder:"-5"})]}),o.jsxs("label",{children:["Performance (%)",o.jsx("input",{type:"number",step:"0.01",value:r.performance,onChange:T=>s({...r,performance:T.target.value}),placeholder:"8"})]})]}),o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",checked:r.manualControl,onChange:T=>s({...r,manualControl:T.target.checked})}),"Control manual del estado (permite pausar/reanudar)"]})]}),o.jsxs("div",{className:"form-section form-section-advanced",children:[o.jsxs("div",{className:"form-section-header",children:[o.jsx("h3",{children:" Configuracin avanzada"}),o.jsx("p",{children:"Prximamente campos tcnicos para proyectos mixtos o de trading/crypto"})]}),o.jsx("div",{className:"placeholder-box",children:o.jsx("p",{children:"Esta rea reservar parmetros como ejecucin, exchanges, riesgo dinmico y conectores tcnicos."})})]}),c&&o.jsx("div",{className:"form-error",children:c})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{type:"button",className:"cancel-btn",onClick:I,disabled:i,children:"Cancelar"}),o.jsx("button",{type:"submit",className:"draft-btn",disabled:i,children:i?"Guardando...":"Crear borrador"}),o.jsx("button",{type:"button",className:"submit-btn",onClick:T=>w(T,"active"),disabled:i,children:i?"Publicando...":"Crear y publicar"})]})]})]})}):null}function S0(t){const[e,n]=b.useState([]),[r,s]=b.useState(!0),[i,a]=b.useState(null),c=async()=>{if(!t){n([]),s(!1);return}try{s(!0),a(null);const p=ae(W,"projects",t,"timeline"),m=ye(p,wn("createdAt","desc")),y=(await Ee(m)).docs.map(x=>({id:x.id,...x.data()}));n(y)}catch(p){console.error("Error en useProjectTimeline:",p),a(p.message)}finally{s(!1)}};b.useEffect(()=>{c()},[t]);const u=async p=>{if(!t)return null;try{const m=ae(W,"projects",t,"timeline"),E={type:p.type||"update",title:p.title||"",description:p.description||"",visibility:p.visibility||"admin",createdBy:p.createdBy||null,metadata:p.metadata||null,createdAt:re()},y=await zh(m,E);return(E.visibility==="investors"||E.visibility==="all")&&await d(t,y.id,E),await c(),y.id}catch(m){throw console.error("Error creando evento timeline:",m),m}},d=async(p,m,E)=>{try{const y=ae(W,"investments"),x=ye(y),N=await Ee(x),I=new Set;N.docs.forEach(k=>{const O=k.data();O.projectId===p&&(O.status==="active"||O.status==="completed")&&I.add(O.userId)});const w=ae(W,"notifications"),T=Array.from(I).map(k=>zh(w,{userId:k,projectId:p,eventId:m,type:"project_update",title:E.title,message:E.description||E.title,read:!1,createdAt:re()}));await Promise.all(T)}catch(y){console.error("Error creando notificaciones:",y)}};return{events:e,loading:r,error:i,addEvent:u,refetch:()=>c()}}function z1({project:t,isOpen:e,onClose:n,onSuccess:r,onTimelineEvent:s}){const[i,a]=b.useState({name:(t==null?void 0:t.name)||"",category:(t==null?void 0:t.category)||"",expectedROI:(t==null?void 0:t.expectedROI)||"",duration:(t==null?void 0:t.duration)||"",drawdown:(t==null?void 0:t.drawdown)||"",performance:(t==null?void 0:t.performance)||""}),[c,u]=b.useState(!1),[d,f]=b.useState(null);Hh.useEffect(()=>{t&&a({name:t.name||"",category:t.category||"",expectedROI:t.expectedROI||"",duration:t.duration||"",drawdown:t.drawdown||"",performance:t.performance||""})},[t]);const p=()=>{f(null),n()},m=async E=>{if(E.preventDefault(),!!(t!=null&&t.id))try{u(!0),f(null);const y=[];i.name!==t.name&&y.push(`Nombre: "${t.name}"  "${i.name}"`),i.category!==t.category&&y.push(`Categora: "${t.category||"N/A"}"  "${i.category}"`),Number(i.expectedROI)!==Number(t.expectedROI)&&y.push(`ROI esperado: ${t.expectedROI}%  ${i.expectedROI}%`),Number(i.duration)!==Number(t.duration)&&y.push(`Duracin: ${t.duration}  ${i.duration} meses`),t.type==="variable"&&(Number(i.drawdown)!==Number(t.drawdown)&&y.push(`Drawdown: ${t.drawdown}%  ${i.drawdown}%`),Number(i.performance)!==Number(t.performance)&&y.push(`Performance: ${t.performance}%  ${i.performance}%`));const x={name:i.name,category:i.category||null,expectedROI:i.expectedROI?Number(i.expectedROI):null,duration:i.duration?Number(i.duration):null,updatedAt:re()};if(t.type==="variable"&&(x.drawdown=i.drawdown?Number(i.drawdown):null,x.performance=i.performance?Number(i.performance):null),await Ri(se(W,"projects",t.id),x),y.length>0&&s)try{await s({type:"system",title:"Proyecto actualizado",description:`Se editaron los siguientes campos:
${y.join(`
`)}`,visibility:"admin",metadata:{changes:y}})}catch(N){console.warn("No se pudo registrar evento en timeline:",N)}r==null||r(),p()}catch(y){console.error("Error actualizando proyecto:",y),(y==null?void 0:y.code)==="permission-denied"?f("Permisos insuficientes para actualizar el proyecto"):f("No se pudo actualizar el proyecto")}finally{u(!1)}};return!e||!t?null:o.jsx("div",{className:"edit-modal-overlay",onClick:p,children:o.jsxs("div",{className:"edit-modal",onClick:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{className:"modal-header-content",children:[o.jsx("h2",{children:" Editar Proyecto"}),o.jsx("p",{className:"modal-subtitle",children:"Actualiza la informacin del proyecto"})]}),o.jsx("button",{className:"close-btn",onClick:p,"aria-label":"Cerrar",children:""})]}),o.jsxs("form",{className:"modal-form",onSubmit:m,children:[o.jsxs("div",{className:"form-section",children:[o.jsx("h3",{className:"section-title",children:" Informacin General"}),o.jsxs("div",{className:"form-field",children:[o.jsxs("label",{htmlFor:"project-name",children:["Nombre del proyecto ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx("input",{id:"project-name",type:"text",className:"form-input",value:i.name,onChange:E=>a({...i,name:E.target.value}),placeholder:"Ej: Proyecto Solar Valle Verde",required:!0})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-category",children:"Categora"}),o.jsx("input",{id:"project-category",type:"text",className:"form-input",value:i.category,onChange:E=>a({...i,category:E.target.value}),placeholder:"Ej: Energa Renovable, Trading, Crypto"})]})]}),o.jsxs("div",{className:"form-section",children:[o.jsx("h3",{className:"section-title",children:" Mtricas Financieras"}),o.jsxs("div",{className:"form-row-2",children:[o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-roi",children:"ROI esperado (%)"}),o.jsxs("div",{className:"input-with-icon",children:[o.jsx("input",{id:"project-roi",type:"number",className:"form-input",step:"0.01",value:i.expectedROI,onChange:E=>a({...i,expectedROI:E.target.value}),placeholder:"0.00"}),o.jsx("span",{className:"input-icon",children:"%"})]})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-duration",children:"Duracin (meses)"}),o.jsxs("div",{className:"input-with-icon",children:[o.jsx("input",{id:"project-duration",type:"number",className:"form-input",value:i.duration,onChange:E=>a({...i,duration:E.target.value}),placeholder:"12"}),o.jsx("span",{className:"input-icon",children:"meses"})]})]})]})]}),t.type==="variable"&&o.jsxs("div",{className:"form-section variable-section",children:[o.jsx("h3",{className:"section-title",children:" Mtricas Variables"}),o.jsxs("div",{className:"form-row-2",children:[o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-drawdown",children:"Drawdown (%)"}),o.jsxs("div",{className:"input-with-icon",children:[o.jsx("input",{id:"project-drawdown",type:"number",className:"form-input",step:"0.01",value:i.drawdown,onChange:E=>a({...i,drawdown:E.target.value}),placeholder:"0.00"}),o.jsx("span",{className:"input-icon negative",children:"%"})]})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-performance",children:"Performance (%)"}),o.jsxs("div",{className:"input-with-icon",children:[o.jsx("input",{id:"project-performance",type:"number",className:"form-input",step:"0.01",value:i.performance,onChange:E=>a({...i,performance:E.target.value}),placeholder:"0.00"}),o.jsx("span",{className:"input-icon positive",children:"%"})]})]})]})]}),o.jsxs("div",{className:"info-box",children:[o.jsx("div",{className:"info-icon",children:""}),o.jsxs("div",{className:"info-content",children:[o.jsx("strong",{children:"Campos no editables:"}),o.jsx("p",{children:"Tipo de proyecto, Nivel de riesgo, Capital objetivo y Estado computado."}),o.jsx("p",{className:"info-note",children:"Para cambios crticos en estos campos, contacta al administrador del sistema."})]})]}),d&&o.jsxs("div",{className:"form-error",children:[o.jsx("span",{className:"error-icon",children:""}),o.jsx("span",{children:d})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{type:"button",className:"cancel-btn",onClick:p,disabled:c,children:"Cancelar"}),o.jsx("button",{type:"submit",className:"submit-btn",disabled:c,children:c?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"spinner"}),"Guardando..."]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),"Guardar cambios"]})})]})]})]})})}function B1({projectId:t,adminData:e}){const{events:n,loading:r,addEvent:s}=S0(t),[i,a]=b.useState(!1),[c,u]=b.useState({type:"update",title:"",description:"",visibility:"admin"}),[d,f]=b.useState(!1),p=async x=>{if(x.preventDefault(),!!c.title)try{f(!0),await s({...c,createdBy:(e==null?void 0:e.uid)||null}),u({type:"update",title:"",description:"",visibility:"admin"}),a(!1)}catch(N){console.error("Error creando evento:",N)}finally{f(!1)}},m=x=>x?(x.toDate?x.toDate():new Date(x)).toLocaleDateString("en-US",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",E=x=>({milestone:"",update:"",notice:"",system:""})[x]||"",y=x=>{const N={investors:{label:"Inversionistas",class:"badge-investors"},all:{label:"Pblico",class:"badge-all"},admin:{label:"Admin",class:"badge-admin"}};return N[x]||N.admin};return o.jsxs("div",{className:"project-timeline",children:[o.jsxs("div",{className:"timeline-header",children:[o.jsx("h3",{children:"Lnea de Tiempo"}),!i&&o.jsx("button",{className:"add-event-btn",onClick:()=>a(!0),children:"+ Agregar evento"})]}),i&&o.jsxs("form",{className:"event-form",onSubmit:p,children:[o.jsxs("div",{className:"form-row",children:[o.jsxs("label",{children:["Tipo de evento",o.jsxs("select",{value:c.type,onChange:x=>u({...c,type:x.target.value}),children:[o.jsx("option",{value:"milestone",children:"Hito (Milestone)"}),o.jsx("option",{value:"update",children:"Actualizacin"}),o.jsx("option",{value:"notice",children:"Aviso"}),o.jsx("option",{value:"system",children:"Sistema"})]})]}),o.jsxs("label",{children:["Visibilidad",o.jsxs("select",{value:c.visibility,onChange:x=>u({...c,visibility:x.target.value}),children:[o.jsx("option",{value:"admin",children:"Solo admin"}),o.jsx("option",{value:"investors",children:"Inversionistas"}),o.jsx("option",{value:"all",children:"Todos"})]})]})]}),o.jsxs("label",{children:["Ttulo",o.jsx("input",{type:"text",value:c.title,onChange:x=>u({...c,title:x.target.value}),placeholder:"Ej: Primer desembolso realizado",required:!0})]}),o.jsxs("label",{children:["Descripcin",o.jsx("textarea",{value:c.description,onChange:x=>u({...c,description:x.target.value}),placeholder:"Detalla el evento...",rows:3})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>a(!1),disabled:d,children:"Cancelar"}),o.jsx("button",{type:"submit",className:"submit-btn",disabled:d,children:d?"Guardando...":"Publicar"})]})]}),r?o.jsx("div",{className:"timeline-loading",children:"Cargando eventos..."}):n.length===0?o.jsx("div",{className:"timeline-empty",children:"No hay eventos en la lnea de tiempo"}):o.jsx("div",{className:"timeline-list",children:n.map(x=>{const N=y(x.visibility);return o.jsxs("div",{className:"timeline-item",children:[o.jsx("div",{className:"timeline-icon",children:E(x.type)}),o.jsxs("div",{className:"timeline-content",children:[o.jsxs("div",{className:"timeline-header-row",children:[o.jsx("h4",{className:"timeline-title",children:x.title}),o.jsx("span",{className:`visibility-badge ${N.class}`,children:N.label})]}),x.description&&o.jsx("p",{className:"timeline-description",children:x.description}),o.jsxs("div",{className:"timeline-meta",children:[o.jsx("span",{className:"timeline-date",children:m(x.createdAt)}),x.type&&o.jsx("span",{className:"timeline-type",children:x.type})]})]})]},x.id)})})]})}function $1(t){const[e,n]=b.useState(null),[r,s]=b.useState(null),[i,a]=b.useState(null),[c,u]=b.useState([]),[d,f]=b.useState([]),[p,m]=b.useState(!0),[E,y]=b.useState(null),x=async()=>{if(!t){m(!1);return}try{m(!0),y(null);const w=se(W,"investments",t),T=await Mt(w);if(!T.exists())throw new Error("Inversin no encontrada");const k={id:T.id,...T.data()};let O=null;if(k.userId){const S=se(W,"users",k.userId),U=await Mt(S);U.exists()&&(O={id:U.id,...U.data()})}let D=null;if(k.projectId){const S=se(W,"projects",k.projectId),U=await Mt(S);U.exists()&&(D={id:U.id,...U.data()})}let _=[];if(k.projectId){const S=ae(W,"projects",k.projectId,"timeline"),U=ye(S,wn("createdAt","desc"));_=(await Ee(U)).docs.map(ne=>({id:ne.id,...ne.data()}))}let v=[];const A=ae(W,"investments",t,"auditLog"),P=ye(A,wn("timestamp","desc"));v=(await Ee(P)).docs.map(S=>({id:S.id,...S.data()}));const j=N(k,D);n(j),s(O),a(D),u(_),f(v)}catch(w){console.error("Error en useInvestmentDetail:",w),y(w.message)}finally{m(!1)}},N=(w,T)=>{const k=Number(w.amount||0),O=Number(w.expectedReturn||0),D=Number(w.actualReturn||w.realizedReturn||w.payout||0),_=Number((T==null?void 0:T.totalInvested)||0),v=k>0?((O-k)/k*100).toFixed(2):null,A=k>0&&D>0?((D-k)/k*100).toFixed(2):null,P=_>0?(k/_*100).toFixed(2):null,C=O-k,j=D>0?D-k:null;return{...w,expectedROI:Number(v),actualROI:A?Number(A):null,projectionOfTotal:Number(P),expectedGain:C,actualGain:j}},I=()=>x();return b.useEffect(()=>{x()},[t]),{investment:e,user:r,project:i,projectEvents:c,auditLog:d,loading:p,error:E,refetch:I}}async function W1(t,e,n=""){try{const r=se(W,"investments",t),s={action:"status_change",previousStatus:null,newStatus:e,reason:n,changedBy:"admin",timestamp:re()};return await Ri(r,{status:e,updatedAt:re(),auditLog:Wp(s)}),{success:!0,message:`Inversin actualizada a ${e}`}}catch(r){throw console.error("Error actualizando estado de inversin:",r),r}}async function q1(t,e,n="",r={}){try{const s=se(W,"investments",t),i={action:"system_event",eventTitle:e,eventDescription:n,metadata:r,recordedBy:"admin",timestamp:re()};return await Ri(s,{auditLog:Wp(i),updatedAt:re()}),{success:!0,message:"Evento registrado"}}catch(s){throw console.error("Error registrando evento de sistema:",s),s}}async function H1(t,e,n=""){try{const r=se(W,"investments",t),s={action:"return_update",previousValue:null,newValue:e,notes:n,updatedBy:"admin",timestamp:re()};return await Ri(r,{realizedReturn:Number(e),payout:Number(e),auditLog:Wp(s),updatedAt:re()}),{success:!0,message:"Retorno actualizado"}}catch(r){throw console.error("Error actualizando retorno:",r),r}}function G1({investmentId:t,isOpen:e,onClose:n,onUpdate:r}){const{investment:s,user:i,project:a,projectEvents:c,auditLog:u,loading:d,error:f,refetch:p}=$1(t),[m,E]=b.useState("overview"),[y,x]=b.useState(!1),[N,I]=b.useState(null),[w,T]=b.useState(null),[k,O]=b.useState(!1),[D,_]=b.useState(!1),[v,A]=b.useState(!1),P=ne=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(ne||0),C=ne=>ne?(ne.toDate?ne.toDate():new Date(ne)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",j=ne=>ne?(ne.toDate?ne.toDate():new Date(ne)).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",S=async(ne,ve)=>{try{x(!0),I(null),await W1(t,ne,ve),T(`Inversin actualizada a ${ne}`),await p(),r==null||r(),O(!1),setTimeout(()=>T(null),3e3)}catch(B){I(B.message)}finally{x(!1)}},U=async(ne,ve,B)=>{try{x(!0),I(null),await q1(t,ne,ve,B),T("Evento registrado"),await p(),r==null||r(),A(!1),setTimeout(()=>T(null),3e3)}catch(Y){I(Y.message)}finally{x(!1)}},G=async(ne,ve)=>{try{x(!0),I(null),await H1(t,ne,ve),T("Retorno actualizado"),await p(),r==null||r(),_(!1),setTimeout(()=>T(null),3e3)}catch(B){I(B.message)}finally{x(!1)}};return e?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"investment-drawer-overlay",onClick:n}),o.jsxs("div",{className:"investment-drawer",children:[o.jsxs("div",{className:"investment-drawer-header",children:[o.jsxs("div",{className:"header-top",children:[o.jsx("button",{className:"close-btn",onClick:n,children:" Volver"}),o.jsx("h2",{className:"header-title",children:"Detalle de Inversin"})]}),d?o.jsx("div",{className:"loading-state",children:"Cargando..."}):f?o.jsx("div",{className:"error-state",children:f}):s?o.jsxs("div",{className:"header-info",children:[o.jsxs("div",{className:"header-investor",children:[o.jsxs("div",{className:"investor-info",children:[o.jsx("span",{className:"investor-name",children:(i==null?void 0:i.displayName)||(i==null?void 0:i.fullName)||"Usuario"}),o.jsx("span",{className:"investor-email",children:(i==null?void 0:i.email)||""})]}),o.jsxs("span",{className:`status-badge status-${s.status}`,children:[s.status==="active"&&"Activa",s.status==="completed"&&"Completada",s.status==="cancelled"&&"Cancelada",s.status==="paused"&&"Pausada"]})]}),o.jsxs("div",{className:"header-meta",children:[o.jsxs("div",{className:"meta-item",children:[o.jsx("span",{className:"meta-label",children:"Monto Invertido"}),o.jsx("span",{className:"meta-value bold",children:P(s.amount)})]}),o.jsxs("div",{className:"meta-item",children:[o.jsx("span",{className:"meta-label",children:"Proyecto"}),o.jsx("span",{className:"meta-value",children:(a==null?void 0:a.name)||""})]}),o.jsxs("div",{className:"meta-item",children:[o.jsx("span",{className:"meta-label",children:"Fecha"}),o.jsx("span",{className:"meta-value",children:C(s.createdAt)})]})]})]}):null]}),s&&o.jsxs("div",{className:"investment-tabs",children:[o.jsx("button",{className:`tab ${m==="overview"?"active":""}`,onClick:()=>E("overview"),children:"Resumen"}),o.jsx("button",{className:`tab ${m==="financial"?"active":""}`,onClick:()=>E("financial"),children:"Financiero"}),o.jsxs("button",{className:`tab ${m==="project"?"active":""}`,onClick:()=>E("project"),children:["Proyecto (",c.length,")"]}),o.jsxs("button",{className:`tab ${m==="audit"?"active":""}`,onClick:()=>E("audit"),children:["Audit (",u.length,")"]})]}),w&&o.jsxs("div",{className:"success-message",children:[" ",w]}),N&&o.jsxs("div",{className:"error-message",children:[" ",N]}),o.jsx("div",{className:"investment-content",children:d?o.jsx("div",{className:"content-loading",children:"Cargando detalles..."}):s?m==="overview"?o.jsx(K1,{investment:s,project:a,user:i,formatCurrency:P,formatDate:C}):m==="financial"?o.jsx(Q1,{investment:s,project:a,formatCurrency:P,onUpdateReturn:()=>_(!0)}):m==="project"?o.jsx(Y1,{projectEvents:c,formatDateTime:j}):m==="audit"?o.jsx(X1,{auditLog:u,formatDateTime:j}):null:o.jsx("div",{className:"content-empty",children:"No se pudo cargar la inversin"})}),s&&o.jsxs("div",{className:"investment-actions",children:[o.jsx("button",{className:"action-btn primary",onClick:()=>O(!0),disabled:y,children:"Cambiar Estado"}),o.jsx("button",{className:"action-btn secondary",onClick:()=>A(!0),disabled:y,children:"Registrar Evento"}),s.status==="active"&&o.jsx("button",{className:"action-btn secondary",onClick:()=>_(!0),disabled:y,children:"Actualizar Retorno"})]}),k&&o.jsx(J1,{currentStatus:s.status,onConfirm:S,onClose:()=>O(!1),isLoading:y}),D&&o.jsx(Z1,{currentReturn:s.realizedReturn||s.payout,expectedReturn:s.expectedReturn,amount:s.amount,onConfirm:G,onClose:()=>_(!1),isLoading:y,formatCurrency:P}),v&&o.jsx(eO,{onConfirm:U,onClose:()=>A(!1),isLoading:y})]})]}):null}function K1({investment:t,project:e,user:n,formatCurrency:r,formatDate:s}){return o.jsxs("div",{className:"tab-content overview-tab",children:[o.jsxs("div",{className:"info-cards",children:[o.jsxs("div",{className:"info-card",children:[o.jsx("div",{className:"card-label",children:"Inversionista"}),o.jsx("div",{className:"card-value",children:(n==null?void 0:n.displayName)||(n==null?void 0:n.fullName)||"Usuario"}),o.jsx("div",{className:"card-sublabel",children:n==null?void 0:n.email})]}),o.jsxs("div",{className:"info-card",children:[o.jsx("div",{className:"card-label",children:"Monto Invertido"}),o.jsx("div",{className:"card-value",children:r(t.amount)})]}),o.jsxs("div",{className:"info-card",children:[o.jsx("div",{className:"card-label",children:"% del Proyecto"}),o.jsxs("div",{className:"card-value",children:[t.projectionOfTotal,"%"]})]}),o.jsxs("div",{className:"info-card",children:[o.jsx("div",{className:"card-label",children:"Estado"}),o.jsxs("div",{className:`card-value status-${t.status}`,children:[t.status==="active"&&"Activa",t.status==="completed"&&"Completada",t.status==="cancelled"&&"Cancelada",t.status==="paused"&&"Pausada"]})]})]}),o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{className:"section-title",children:"Informacin General"}),o.jsxs("div",{className:"info-items",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"label",children:"Proyecto"}),o.jsx("span",{className:"value",children:(e==null?void 0:e.name)||""})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"label",children:"Tipo de Proyecto"}),o.jsx("span",{className:"value",children:(e==null?void 0:e.type)==="fixed"?"Fijo":"Variable"})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"label",children:"Riesgo del Proyecto"}),o.jsxs("span",{className:`value risk-${e==null?void 0:e.riskLevel}`,children:[(e==null?void 0:e.riskLevel)==="low"&&"Riesgo Bajo",(e==null?void 0:e.riskLevel)==="medium"&&"Riesgo Medio",(e==null?void 0:e.riskLevel)==="high"&&"Riesgo Alto"]})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"label",children:"Fecha de Inversin"}),o.jsx("span",{className:"value",children:s(t.createdAt)})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"label",children:"Estado del Proyecto"}),o.jsx("span",{className:"value",children:(e==null?void 0:e.computedStatus)||(e==null?void 0:e.status)||""})]})]})]})]})}function Q1({investment:t,project:e,formatCurrency:n,onUpdateReturn:r}){const s=t.amount&&t.expectedReturn?t.expectedReturn-t.amount:0,i=t.amount&&t.realizedReturn?t.realizedReturn-t.amount:null;return o.jsxs("div",{className:"tab-content financial-tab",children:[o.jsxs("div",{className:"financial-grid",children:[o.jsxs("div",{className:"fin-card roi",children:[o.jsx("div",{className:"fin-label",children:"ROI Esperado"}),o.jsx("div",{className:`fin-value ${t.expectedROI>=0?"positive":"negative"}`,children:t.expectedROI!==null?`${t.expectedROI}%`:""})]}),o.jsxs("div",{className:"fin-card roi",children:[o.jsx("div",{className:"fin-label",children:"ROI Real"}),o.jsx("div",{className:`fin-value ${t.actualROI>=0?"positive":"negative"}`,children:t.actualROI!==null?`${t.actualROI}%`:"Pendiente"})]}),o.jsxs("div",{className:"fin-card gain",children:[o.jsx("div",{className:"fin-label",children:"Ganancia Esperada"}),o.jsx("div",{className:`fin-value ${s>=0?"positive":"negative"}`,children:n(s)})]}),o.jsxs("div",{className:"fin-card gain",children:[o.jsx("div",{className:"fin-label",children:"Ganancia Realizada"}),o.jsx("div",{className:`fin-value ${i>=0?"positive":"negative"}`,children:i!==null?n(i):"Pendiente"})]})]}),o.jsxs("div",{className:"financial-details",children:[o.jsxs("div",{className:"fin-detail-section",children:[o.jsx("h3",{className:"section-title",children:"Detalles Financieros"}),o.jsxs("div",{className:"fin-items",children:[o.jsxs("div",{className:"fin-item",children:[o.jsx("span",{className:"label",children:"Monto Invertido"}),o.jsx("span",{className:"value bold",children:n(t.amount)})]}),o.jsxs("div",{className:"fin-item",children:[o.jsx("span",{className:"label",children:"Retorno Esperado"}),o.jsx("span",{className:"value",children:n(t.expectedReturn)})]}),o.jsxs("div",{className:"fin-item",children:[o.jsx("span",{className:"label",children:"Retorno Realizado"}),o.jsx("span",{className:"value",children:n(t.realizedReturn||t.payout||0)})]}),t.status==="active"&&o.jsx("div",{className:"fin-item action",children:o.jsx("button",{className:"update-btn",onClick:r,children:"Actualizar Retorno"})})]})]}),o.jsxs("div",{className:"fin-detail-section",children:[o.jsx("h3",{className:"section-title",children:"Relacin con Proyecto"}),o.jsxs("div",{className:"fin-items",children:[o.jsxs("div",{className:"fin-item",children:[o.jsx("span",{className:"label",children:"% del Capital Total"}),o.jsxs("span",{className:"value",children:[t.projectionOfTotal,"%"]})]}),o.jsxs("div",{className:"fin-item",children:[o.jsx("span",{className:"label",children:"Capital Total del Proyecto"}),o.jsx("span",{className:"value",children:n((e==null?void 0:e.totalInvested)||0)})]}),o.jsxs("div",{className:"fin-item",children:[o.jsx("span",{className:"label",children:"Meta del Proyecto"}),o.jsx("span",{className:"value",children:(e==null?void 0:e.type)==="fixed"?n(e==null?void 0:e.targetAmount):"Variable"})]})]})]})]})]})}function Y1({projectEvents:t,formatDateTime:e}){const n=t.filter(r=>r.type==="system"||r.visibility==="investors"||r.visibility==="all");return o.jsx("div",{className:"tab-content project-tab",children:n.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-icon",children:""}),o.jsx("div",{className:"empty-title",children:"Sin eventos del proyecto"}),o.jsx("div",{className:"empty-subtitle",children:"No hay actualizaciones de proyecto relacionadas"})]}):o.jsx("div",{className:"events-list",children:n.map(r=>o.jsxs("div",{className:"event-item",children:[o.jsxs("div",{className:"event-header",children:[o.jsx("span",{className:"event-title",children:r.title}),o.jsx("span",{className:"event-date",children:e(r.createdAt)})]}),r.description&&o.jsx("div",{className:"event-description",children:r.description}),o.jsx("div",{className:"event-meta",children:o.jsxs("span",{className:`badge visibility-${r.visibility}`,children:[r.visibility==="admin"&&"Solo admin",r.visibility==="investors"&&"Inversionistas",r.visibility==="all"&&"Todos"]})})]},r.id))})})}function X1({auditLog:t,formatDateTime:e}){return o.jsx("div",{className:"tab-content audit-tab",children:t.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-icon",children:""}),o.jsx("div",{className:"empty-title",children:"Sin historial de cambios"}),o.jsx("div",{className:"empty-subtitle",children:"No hay cambios registrados en esta inversin"})]}):o.jsx("div",{className:"audit-list",children:t.map((n,r)=>o.jsxs("div",{className:"audit-entry",children:[o.jsxs("div",{className:"audit-header",children:[o.jsx("span",{className:"audit-action",children:tO(n.action)}),o.jsx("span",{className:"audit-date",children:e(n.timestamp)})]}),n.action==="status_change"&&o.jsxs("div",{className:"audit-details",children:[o.jsxs("span",{children:["De ",o.jsx("strong",{children:n.previousStatus})," a ",o.jsx("strong",{children:n.newStatus})]}),n.reason&&o.jsxs("span",{className:"reason",children:["Razn: ",n.reason]})]}),n.action==="system_event"&&o.jsxs("div",{className:"audit-details",children:[o.jsx("span",{className:"title",children:n.eventTitle}),n.eventDescription&&o.jsx("span",{className:"desc",children:n.eventDescription})]}),n.action==="return_update"&&o.jsxs("div",{className:"audit-details",children:[o.jsxs("span",{children:["Retorno actualizado a ",o.jsxs("strong",{children:["$",n.newValue]})]}),n.notes&&o.jsxs("span",{className:"notes",children:["Notas: ",n.notes]})]})]},n.id||r))})})}function J1({currentStatus:t,onConfirm:e,onClose:n,isLoading:r}){const[s,i]=b.useState(t),[a,c]=b.useState(""),u=[{value:"active",label:"Activa"},{value:"paused",label:"Pausada"},{value:"completed",label:"Completada"},{value:"cancelled",label:"Cancelada"}];return o.jsx("div",{className:"modal-overlay",onClick:n,children:o.jsxs("div",{className:"modal-content",onClick:d=>d.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h3",{children:"Cambiar Estado de Inversin"}),o.jsx("button",{className:"close-modal-btn",onClick:n,children:""})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Nuevo Estado"}),o.jsx("select",{value:s,onChange:d=>i(d.target.value),disabled:r,children:u.map(d=>o.jsx("option",{value:d.value,children:d.label},d.value))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Razn (opcional)"}),o.jsx("textarea",{value:a,onChange:d=>c(d.target.value),placeholder:"Explica el cambio de estado...",disabled:r,rows:3})]})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{className:"btn secondary",onClick:n,disabled:r,children:"Cancelar"}),o.jsx("button",{className:"btn primary",onClick:()=>e(s,a),disabled:r,children:r?"Actualizando...":"Confirmar"})]})]})})}function Z1({currentReturn:t,expectedReturn:e,amount:n,onConfirm:r,onClose:s,isLoading:i,formatCurrency:a}){const[c,u]=b.useState(t||e||""),[d,f]=b.useState(""),p=c?Number(c)-n:0,m=n>0&&c?(p/n*100).toFixed(2):0;return o.jsx("div",{className:"modal-overlay",onClick:s,children:o.jsxs("div",{className:"modal-content",onClick:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h3",{children:"Actualizar Retorno de Inversin"}),o.jsx("button",{className:"close-modal-btn",onClick:s,children:""})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Retorno Realizado (USD)"}),o.jsx("input",{type:"number",value:c,onChange:E=>u(E.target.value),placeholder:"Cantidad recibida",disabled:i}),o.jsxs("div",{className:"form-hint",children:["Monto invertido: ",a(n)]})]}),c&&o.jsxs("div",{className:"return-preview",children:[o.jsxs("div",{className:"preview-item",children:[o.jsx("span",{children:"Ganancia / Prdida"}),o.jsx("span",{className:p>=0?"positive":"negative",children:a(p)})]}),o.jsxs("div",{className:"preview-item",children:[o.jsx("span",{children:"ROI"}),o.jsxs("span",{className:m>=0?"positive":"negative",children:[m,"%"]})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Notas (opcional)"}),o.jsx("textarea",{value:d,onChange:E=>f(E.target.value),placeholder:"Detalles sobre el retorno...",disabled:i,rows:3})]})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{className:"btn secondary",onClick:s,disabled:i,children:"Cancelar"}),o.jsx("button",{className:"btn primary",onClick:()=>r(c,d),disabled:i||!c,children:i?"Actualizando...":"Guardar Retorno"})]})]})})}function eO({onConfirm:t,onClose:e,isLoading:n}){const[r,s]=b.useState(""),[i,a]=b.useState("");return o.jsx("div",{className:"modal-overlay",onClick:e,children:o.jsxs("div",{className:"modal-content",onClick:c=>c.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h3",{children:"Registrar Evento de Sistema"}),o.jsx("button",{className:"close-modal-btn",onClick:e,children:""})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Ttulo del Evento"}),o.jsx("input",{type:"text",value:r,onChange:c=>s(c.target.value),placeholder:"Ej: Pago parcial recibido",disabled:n})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Descripcin (opcional)"}),o.jsx("textarea",{value:i,onChange:c=>a(c.target.value),placeholder:"Detalles adicionales...",disabled:n,rows:4})]})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{className:"btn secondary",onClick:e,disabled:n,children:"Cancelar"}),o.jsx("button",{className:"btn primary",onClick:()=>t(r,i,{}),disabled:n||!r,children:n?"Registrando...":"Registrar Evento"})]})]})})}function tO(t){return{status_change:"Cambio de Estado",system_event:"Evento de Sistema",return_update:"Actualizacin de Retorno"}[t]||t}function nO({project:t,isOpen:e,onClose:n,onRefresh:r,adminData:s,activeTab:i="overview",onTabChange:a=null}){const[c,u]=b.useState("overview"),[d,f]=b.useState(!1),[p,m]=b.useState(null),E=a?i:c,y=a||u,{investments:x,loading:N}=x0({projectId:t==null?void 0:t.id}),{events:I,addEvent:w,refetch:T}=S0(t==null?void 0:t.id),k=j=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(j||0),O=j=>j?(j.toDate?j.toDate():new Date(j)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",D=j=>j?(j.toDate?j.toDate():new Date(j)).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",_=()=>{r(),T()},v=async j=>{await w(j),T()},A=b.useMemo(()=>I.filter(j=>j.type==="system"||j.visibility==="admin"),[I]),P=b.useMemo(()=>{const j=x.length,S=x.filter(G=>G.status==="active").length,U=x.reduce((G,ne)=>G+(ne.amount||0),0);return{total:j,active:S,totalAmount:U}},[x]);if(!t||!e)return null;const C=o.jsxs(o.Fragment,{children:[o.jsx("div",{className:`drawer-overlay ${e?"open":""}`,onClick:n}),o.jsxs("div",{className:`project-drawer ${e?"open":""}`,children:[o.jsxs("div",{className:"drawer-header",children:[o.jsxs("div",{className:"drawer-header-top",children:[o.jsx("button",{className:"close-drawer-btn",onClick:n,children:" Volver a proyectos"}),o.jsxs("div",{className:"drawer-actions",children:[o.jsx("button",{className:"action-btn secondary",onClick:()=>f(!0),children:" Editar"}),o.jsx("button",{className:"action-btn primary",onClick:()=>y("timeline"),children:" Publicar evento"})]})]}),o.jsxs("div",{className:"drawer-header-content",children:[o.jsxs("div",{className:"project-title-section",children:[o.jsx("h1",{className:"drawer-title",children:t.name}),o.jsxs("div",{className:"drawer-badges",children:[o.jsx("span",{className:`badge type-badge type-${t.type}`,children:t.type==="variable"?" Variable":" Fijo"}),o.jsxs("span",{className:`badge risk-badge risk-${t.riskLevel}`,children:[t.riskLevel==="low"&&" Riesgo Bajo",t.riskLevel==="medium"&&" Riesgo Medio",t.riskLevel==="high"&&" Riesgo Alto"]}),o.jsxs("span",{className:`badge status-badge status-${t.computedStatus}`,children:[t.computedStatus==="funded"&&" Funded",t.computedStatus==="active"&&" Activo",t.computedStatus==="paused"&&" Pausado",t.computedStatus==="closed"&&" Cerrado",t.computedStatus==="draft"&&" Borrador"]})]}),t.category&&o.jsxs("div",{className:"project-meta",children:[" ",t.category]})]}),t.type==="fixed"&&t.targetAmount&&o.jsxs("div",{className:"header-progress",children:[o.jsxs("div",{className:"progress-header-row",children:[o.jsx("span",{className:"progress-label-text",children:" Capital Recaudado"}),o.jsxs("span",{className:"progress-percent",children:[t.progress||0,"%"]})]}),o.jsx("div",{className:"progress-bar-header",children:o.jsx("div",{className:"progress-fill-header",style:{width:`${t.progress||0}%`}})}),o.jsxs("div",{className:"progress-stats-row",children:[o.jsxs("div",{className:"progress-stat",children:[o.jsx("span",{className:"stat-label",children:"Recaudado"}),o.jsx("span",{className:"stat-value",children:k(t.totalInvested)})]}),o.jsxs("div",{className:"progress-stat",children:[o.jsx("span",{className:"stat-label",children:"Meta"}),o.jsx("span",{className:"stat-value",children:k(t.targetAmount)})]})]})]})]}),o.jsxs("div",{className:"drawer-tabs",children:[o.jsx("button",{className:`drawer-tab ${E==="overview"?"active":""}`,onClick:()=>y("overview"),children:" Resumen"}),o.jsxs("button",{className:`drawer-tab ${E==="investments"?"active":""}`,onClick:()=>y("investments"),children:[" Inversiones (",P.total,")"]}),o.jsxs("button",{className:`drawer-tab ${E==="timeline"?"active":""}`,onClick:()=>y("timeline"),children:[" Timeline (",I.length,")"]}),o.jsxs("button",{className:`drawer-tab ${E==="activity"?"active":""}`,onClick:()=>y("activity"),children:[" Actividad (",A.length,")"]})]})]}),o.jsxs("div",{className:"drawer-content",children:[E==="overview"&&o.jsxs("div",{className:"overview-section",children:[o.jsxs("div",{className:"overview-grid",children:[o.jsxs("div",{className:"kpi-box",children:[o.jsx("div",{className:"kpi-icon",children:""}),o.jsxs("div",{className:"kpi-data",children:[o.jsx("div",{className:"kpi-label",children:"Total Invertido"}),o.jsx("div",{className:"kpi-value",children:k(P.totalAmount)})]})]}),o.jsxs("div",{className:"kpi-box",children:[o.jsx("div",{className:"kpi-icon",children:""}),o.jsxs("div",{className:"kpi-data",children:[o.jsx("div",{className:"kpi-label",children:"Inversionistas"}),o.jsx("div",{className:"kpi-value",children:P.total}),o.jsxs("div",{className:"kpi-sublabel",children:[P.active," activos"]})]})]}),o.jsxs("div",{className:"kpi-box",children:[o.jsx("div",{className:"kpi-icon",children:""}),o.jsxs("div",{className:"kpi-data",children:[o.jsx("div",{className:"kpi-label",children:"ROI Esperado"}),o.jsx("div",{className:"kpi-value",children:t.expectedROI?`${t.expectedROI}%`:""})]})]}),o.jsxs("div",{className:"kpi-box",children:[o.jsx("div",{className:"kpi-icon",children:""}),o.jsxs("div",{className:"kpi-data",children:[o.jsx("div",{className:"kpi-label",children:"Duracin"}),o.jsx("div",{className:"kpi-value",children:t.duration?`${t.duration}m`:""})]})]})]}),o.jsxs("div",{className:"info-sections",children:[o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{className:"section-title",children:" Informacin General"}),o.jsxs("div",{className:"info-grid",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Fecha de creacin"}),o.jsx("span",{className:"info-val",children:O(t.createdAt)})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"ltima actualizacin"}),o.jsx("span",{className:"info-val",children:O(t.updatedAt)})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Moneda base"}),o.jsx("span",{className:"info-val",children:"USD "})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Estado de inversin"}),o.jsx("span",{className:"info-val",children:t.investable?" Abierto":" Cerrado"})]})]})]}),t.type==="fixed"&&o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{className:"section-title",children:" Configuracin Fija"}),o.jsxs("div",{className:"info-grid",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Capital objetivo"}),o.jsx("span",{className:"info-val bold",children:k(t.targetAmount)})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Inversin mnima"}),o.jsx("span",{className:"info-val",children:k(t.minInvestment)})]}),t.maxInvestment&&o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Inversin mxima"}),o.jsx("span",{className:"info-val",children:k(t.maxInvestment)})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Auto-lock al alcanzar meta"}),o.jsx("span",{className:"info-val",children:o.jsx("span",{className:`pill ${t.autoLockOnTarget?"pill-on":"pill-off"}`,children:t.autoLockOnTarget?" Activado":" Desactivado"})})]})]})]}),t.type==="variable"&&o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{className:"section-title",children:" Mtricas Variables"}),o.jsxs("div",{className:"metrics-cards",children:[o.jsxs("div",{className:"metric-card performance",children:[o.jsx("div",{className:"metric-icon",children:""}),o.jsx("div",{className:"metric-label",children:"Performance"}),o.jsx("div",{className:"metric-value positive",children:t.performance!==void 0?`${t.performance}%`:""})]}),o.jsxs("div",{className:"metric-card drawdown",children:[o.jsx("div",{className:"metric-icon",children:""}),o.jsx("div",{className:"metric-label",children:"Drawdown"}),o.jsx("div",{className:"metric-value negative",children:t.drawdown!==void 0?`${t.drawdown}%`:""})]})]})]})]})]}),E==="investments"&&o.jsx("div",{className:"investments-section",children:N?o.jsx("div",{className:"loading-state",children:"Cargando inversiones..."}):x.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-icon",children:""}),o.jsx("div",{className:"empty-title",children:"Sin inversiones"}),o.jsx("div",{className:"empty-subtitle",children:"Este proyecto an no tiene inversionistas"})]}):o.jsx("div",{className:"investments-table-wrapper",children:o.jsxs("table",{className:"investments-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Inversionista"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"ROI Esperado"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"})]})}),o.jsx("tbody",{children:x.map(j=>o.jsxs("tr",{onClick:()=>m(j.id),className:"clickable-row",children:[o.jsx("td",{children:o.jsxs("div",{className:"investor-cell",children:[o.jsx("div",{className:"investor-name",children:j.userName||"Usuario"}),o.jsx("div",{className:"investor-email",children:j.userEmail})]})}),o.jsx("td",{className:"amount-cell",children:k(j.amount)}),o.jsx("td",{children:o.jsx("span",{className:"roi-badge",children:j.expectedROI!==null?`${j.expectedROI}%`:""})}),o.jsx("td",{children:o.jsxs("span",{className:`badge status-badge status-${j.status}`,children:[j.status==="active"&&" Activa",j.status==="completed"&&" Completada",j.status==="cancelled"&&" Cancelada"]})}),o.jsx("td",{className:"date-cell",children:O(j.createdAt)})]},j.id))})]})})}),E==="timeline"&&o.jsx("div",{className:"timeline-section",children:o.jsx(B1,{projectId:t.id,adminData:s})}),E==="activity"&&o.jsx("div",{className:"activity-section",children:A.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-icon",children:""}),o.jsx("div",{className:"empty-title",children:"Sin actividad"}),o.jsx("div",{className:"empty-subtitle",children:"No hay eventos del sistema registrados"})]}):o.jsx("div",{className:"activity-list",children:A.map(j=>o.jsxs("div",{className:"activity-item",children:[o.jsx("div",{className:"activity-icon",children:j.type==="system"?"":""}),o.jsxs("div",{className:"activity-content",children:[o.jsxs("div",{className:"activity-header",children:[o.jsx("span",{className:"activity-title",children:j.title}),o.jsx("span",{className:"activity-date",children:D(j.createdAt)})]}),j.description&&o.jsx("div",{className:"activity-description",children:j.description}),o.jsx("div",{className:"activity-meta",children:o.jsxs("span",{className:`badge visibility-badge visibility-${j.visibility}`,children:[j.visibility==="admin"&&"Solo admin",j.visibility==="investors"&&"Inversionistas",j.visibility==="all"&&"Todos"]})})]})]},j.id))})})]})]}),o.jsx(z1,{project:t,isOpen:d,onClose:()=>f(!1),onSuccess:_,onTimelineEvent:v}),o.jsx(G1,{investmentId:p,isOpen:!!p,onClose:()=>m(null),onUpdate:()=>{r(),x.length>0}})]});return Uw.createPortal(C,document.body)}function rO({adminData:t}){const e=Gn(),[n]=Uf(),r=n.get("projectId")||"",{projects:s,loading:i,refetch:a}=N0(),[c,u]=b.useState(!1),[d,f]=b.useState(!1),[p,m]=b.useState(null),[E,y]=b.useState("overview"),[x,N]=b.useState({type:"all",category:"all",status:"all",risk:"all"}),[I,w]=b.useState(null),[T,k]=b.useState({page:1,perPage:20}),[O,D]=b.useState(null);b.useEffect(()=>{d?document.body.style.overflow="hidden":(m(null),y("overview"),document.body.style.overflow="")},[d]),b.useEffect(()=>{if(!d||!(p!=null&&p.id))return;const L=s.find(ie=>ie.id===p.id);L&&L!==p&&m(L)},[s,d,p==null?void 0:p.id]);const _=()=>{a()},v=async(L,ie)=>{if(!(!L||!ie))try{w(L),await Ri(se(W,"projects",L),{status:ie,updatedAt:re()}),a()}catch(oe){console.error("Error actualizando estado",oe)}finally{w(null)}},A=L=>{L&&e(`/admin/operaciones/inversiones?projectId=${L}`)},P=L=>{m(L),y("overview"),f(!0)},C=()=>{f(!1)},j=b.useMemo(()=>{const L=new Set;return s.forEach(ie=>ie.category&&L.add(ie.category)),["all",...Array.from(L)]},[s]),S=b.useMemo(()=>s.filter(L=>!(x.type!=="all"&&L.type!==x.type||x.category!=="all"&&L.category!==x.category||x.status!=="all"&&L.computedStatus!==x.status||x.risk!=="all"&&L.riskLevel!==x.risk)),[s,x]),U=b.useMemo(()=>{const L=(T.page-1)*T.perPage,ie=L+T.perPage;return S.slice(L,ie)},[S,T]),G=Math.ceil(S.length/T.perPage),ne=L=>{k({...T,page:L}),window.scrollTo({top:0,behavior:"smooth"})},ve=L=>{k({page:1,perPage:L})},B=b.useMemo(()=>{const L=s.length,ie=s.filter(Me=>Me.computedStatus==="active").length,oe=s.filter(Me=>Me.computedStatus==="funded").length,pe=s.filter(Me=>Me.type==="fixed").reduce((Me,Ge)=>Me+Number(Ge.totalInvested||0),0);return{total:L,active:ie,funded:oe,totalCapital:pe}},[s]),Y=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(L||0);return o.jsxs("div",{className:"proyectos-page",children:[o.jsxs("div",{className:"page-header",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"page-title",children:"Catlogo de Proyectos"}),o.jsx("p",{className:"page-subtitle",children:"Gestin y control de productos financieros"})]}),o.jsx("button",{className:"create-btn",onClick:()=>u(!0),children:"+ Crear proyecto"})]}),o.jsxs("div",{className:"kpis-section",children:[o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Proyectos Totales"}),o.jsx("div",{className:"kpi-value",children:B.total})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Activos"}),o.jsx("div",{className:"kpi-value kpi-success",children:B.active})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Funded"}),o.jsx("div",{className:"kpi-value kpi-info",children:B.funded})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Capital Total"}),o.jsx("div",{className:"kpi-value kpi-currency",children:Y(B.totalCapital)})]})]}),o.jsx("div",{className:"filters-bar",children:o.jsxs("div",{className:"filters-row",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{className:"filter-label",children:"Tipo"}),o.jsxs("select",{className:"filter-select",value:x.type,onChange:L=>N({...x,type:L.target.value}),children:[o.jsx("option",{value:"all",children:"Todos"}),o.jsx("option",{value:"fixed",children:"Fijos"}),o.jsx("option",{value:"variable",children:"Variables"})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{className:"filter-label",children:"Categora"}),o.jsxs("select",{className:"filter-select",value:x.category,onChange:L=>N({...x,category:L.target.value}),children:[o.jsx("option",{value:"all",children:"Todas"}),j.filter(L=>L!=="all").map(L=>o.jsx("option",{value:L,children:L},L))]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{className:"filter-label",children:"Estado"}),o.jsxs("select",{className:"filter-select",value:x.status,onChange:L=>N({...x,status:L.target.value}),children:[o.jsx("option",{value:"all",children:"Todos"}),o.jsx("option",{value:"draft",children:"Borrador"}),o.jsx("option",{value:"active",children:"Activo"}),o.jsx("option",{value:"paused",children:"Pausado"}),o.jsx("option",{value:"funded",children:"Funded"}),o.jsx("option",{value:"closed",children:"Cerrado"})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{className:"filter-label",children:"Riesgo"}),o.jsxs("select",{className:"filter-select",value:x.risk,onChange:L=>N({...x,risk:L.target.value}),children:[o.jsx("option",{value:"all",children:"Todos"}),o.jsx("option",{value:"low",children:"Bajo"}),o.jsx("option",{value:"medium",children:"Medio"}),o.jsx("option",{value:"high",children:"Alto"})]})]})]})}),o.jsxs("div",{className:"proyectos-card",children:[o.jsxs("div",{className:"card-header",children:[o.jsx("div",{className:"card-header-left",children:o.jsxs("h3",{children:[S.length," proyectos encontrados"]})}),o.jsx("div",{className:"card-header-right",children:o.jsxs("label",{className:"per-page-label",children:["Mostrar:",o.jsxs("select",{className:"per-page-select",value:T.perPage,onChange:L=>ve(Number(L.target.value)),children:[o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:20,children:"20"}),o.jsx("option",{value:50,children:"50"})]})]})})]}),i?o.jsx("div",{className:"loading-state",children:"Cargando proyectos..."}):S.length===0?o.jsx("div",{className:"empty-state",children:"No hay proyectos con estos filtros"}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"table-wrapper",children:o.jsxs("table",{className:"proyectos-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Proyecto"}),o.jsx("th",{children:"Tipo"}),o.jsx("th",{children:"Riesgo"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Capital / Mtricas"}),o.jsx("th",{className:"actions-header",children:"Acciones"})]})}),o.jsx("tbody",{children:U.map(L=>o.jsxs("tr",{className:L.id===r?"highlight":"",children:[o.jsxs("td",{children:[o.jsx("div",{className:"cell-title",children:L.name||"Proyecto sin nombre"}),o.jsx("div",{className:"cell-subtle",children:L.createdAt?"Creado":"Sin fecha"})]}),o.jsx("td",{children:o.jsx("span",{className:`type-badge type-${L.type||"fixed"}`,children:L.type==="variable"?"Variable":"Fijo"})}),o.jsx("td",{children:o.jsxs("span",{className:`risk-badge risk-${L.riskLevel||"medium"}`,children:[L.riskLevel==="low"&&"Bajo",L.riskLevel==="medium"&&"Medio",L.riskLevel==="high"&&"Alto"]})}),o.jsx("td",{children:o.jsxs("span",{className:`status-badge status-${L.computedStatus||"draft"}`,children:[L.computedStatus==="funded"&&"Funded",L.computedStatus==="active"&&"Activo",L.computedStatus==="paused"&&"Pausado",L.computedStatus==="closed"&&"Cerrado",L.computedStatus==="draft"&&"Borrador"]})}),o.jsx("td",{children:L.type==="fixed"?o.jsxs("div",{className:"progress-col",children:[o.jsx("div",{className:"progress-top",children:L.totalInvested?`$${L.totalInvested} USD`:"Sin inversiones"}),L.targetAmount?o.jsx("div",{className:"progress-bar",children:o.jsx("div",{className:"progress-fill",style:{width:`${L.progress||0}%`}})}):o.jsx("div",{className:"cell-subtle",children:"Sin target definido"}),L.targetAmount&&o.jsxs("div",{className:"progress-foot",children:[L.progress||0,"% de $",L.targetAmount," USD"]})]}):o.jsxs("div",{className:"metrics-col",children:[o.jsxs("div",{className:"metric-line",children:["Performance: ",L.performance!==void 0&&L.performance!==null?`${L.performance}%`:""]}),o.jsxs("div",{className:"metric-line",children:["Drawdown: ",L.drawdown!==void 0&&L.drawdown!==null?`${L.drawdown}%`:""]})]})}),o.jsx("td",{className:"actions-cell",children:o.jsxs("div",{className:"actions-wrapper",children:[o.jsx("button",{className:"action-btn-icon",onClick:()=>P(L),title:"Ver detalle",children:""}),o.jsxs("div",{className:"action-menu-wrapper",children:[o.jsx("button",{className:"action-menu-btn",onClick:()=>D(O===L.id?null:L.id),title:"Ms acciones",children:""}),O===L.id&&o.jsxs("div",{className:"action-menu",children:[o.jsx("button",{className:"action-menu-item",onClick:()=>{A(L.id),D(null)},children:"Ver inversiones"}),L.computedStatus==="draft"&&o.jsx("button",{className:"action-menu-item",disabled:!!I,onClick:()=>{v(L.id,"active"),D(null)},children:" Activar"}),L.computedStatus==="active"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"action-menu-item",disabled:!!I,onClick:()=>{v(L.id,"paused"),D(null)},children:" Pausar"}),o.jsx("button",{className:"action-menu-item danger",disabled:!!I,onClick:()=>{v(L.id,"closed"),D(null)},children:" Cerrar"})]}),L.computedStatus==="paused"&&o.jsx("button",{className:"action-menu-item",disabled:!!I,onClick:()=>{v(L.id,"active"),D(null)},children:" Reanudar"}),L.computedStatus==="funded"&&o.jsx("button",{className:"action-menu-item danger",disabled:!!I,onClick:()=>{v(L.id,"closed"),D(null)},children:" Cerrar"})]})]})]})})]},L.id))})]})}),G>1&&o.jsxs("div",{className:"pagination",children:[o.jsx("button",{className:"pagination-btn",onClick:()=>ne(T.page-1),disabled:T.page===1,children:" Anterior"}),o.jsxs("div",{className:"pagination-info",children:["Pgina ",T.page," de ",G]}),o.jsx("button",{className:"pagination-btn",onClick:()=>ne(T.page+1),disabled:T.page===G,children:"Siguiente "})]})]})]}),o.jsx(nO,{project:p,isOpen:d,onClose:C,onRefresh:a,adminData:t,activeTab:E,onTabChange:y}),o.jsx(U1,{isOpen:c,onClose:()=>u(!1),onSuccess:_})]})}function sO(){const{loading:t,isAdmin:e,user:n}=E0();return t?o.jsxs("div",{className:"admin-router-loading",children:[o.jsx("div",{className:"admin-router-loading-message",children:"Verificando permisos"}),o.jsx("div",{className:"admin-router-loading-submessage",children:"Validando credenciales en Firestore"})]}):o.jsxs(gS,{children:[o.jsx(Bt,{path:"/login",element:o.jsx(E1,{})}),o.jsx(Bt,{path:"/register",element:o.jsx(I1,{})}),o.jsx(Bt,{path:"/admin",element:e?o.jsx(qr,{admin:n,children:o.jsx(T1,{})}):o.jsx(Zn,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Bt,{path:"/admin/usuarios",element:e?o.jsx(qr,{admin:n,children:o.jsx(R1,{adminData:n})}):o.jsx(Zn,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Bt,{path:"/admin/operaciones/recargas",element:e?o.jsx(qr,{admin:n,children:o.jsx(j1,{adminData:n})}):o.jsx(Zn,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Bt,{path:"/admin/operaciones/retiros",element:e?o.jsx(qr,{admin:n,children:o.jsx(V1,{adminData:n})}):o.jsx(Zn,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Bt,{path:"/admin/operaciones/inversiones",element:e?o.jsx(qr,{admin:n,children:o.jsx(F1,{adminData:n})}):o.jsx(Zn,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Bt,{path:"/admin/proyectos",element:e?o.jsx(qr,{admin:n,children:o.jsx(rO,{adminData:n})}):o.jsx(Zn,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Bt,{path:"/admin/topups",element:e?o.jsx(qr,{admin:n,children:o.jsx(_1,{})}):o.jsx(Zn,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Bt,{path:"/admin/not-authorized",element:o.jsx(w1,{})}),o.jsx(Bt,{path:"/",element:o.jsx(Zn,{to:"/login",replace:!0})})]})}function iO(){return o.jsx(NS,{children:o.jsx(sO,{})})}zw(document.getElementById("root")).render(o.jsx(Hh.StrictMode,{children:o.jsx(iO,{})}));
