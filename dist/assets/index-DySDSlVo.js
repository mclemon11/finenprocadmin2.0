function O0(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function D0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qy={exports:{}},kc={},Hy={exports:{}},le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fo=Symbol.for("react.element"),L0=Symbol.for("react.portal"),V0=Symbol.for("react.fragment"),M0=Symbol.for("react.strict_mode"),F0=Symbol.for("react.profiler"),U0=Symbol.for("react.provider"),z0=Symbol.for("react.context"),B0=Symbol.for("react.forward_ref"),$0=Symbol.for("react.suspense"),W0=Symbol.for("react.memo"),q0=Symbol.for("react.lazy"),og=Symbol.iterator;function H0(t){return t===null||typeof t!="object"?null:(t=og&&t[og]||t["@@iterator"],typeof t=="function"?t:null)}var Ky={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Gy=Object.assign,Qy={};function Ei(t,e,n){this.props=t,this.context=e,this.refs=Qy,this.updater=n||Ky}Ei.prototype.isReactComponent={};Ei.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ei.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Yy(){}Yy.prototype=Ei.prototype;function Zh(t,e,n){this.props=t,this.context=e,this.refs=Qy,this.updater=n||Ky}var ef=Zh.prototype=new Yy;ef.constructor=Zh;Gy(ef,Ei.prototype);ef.isPureReactComponent=!0;var lg=Array.isArray,Xy=Object.prototype.hasOwnProperty,tf={current:null},Jy={key:!0,ref:!0,__self:!0,__source:!0};function Zy(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)Xy.call(e,r)&&!Jy.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:fo,type:t,key:i,ref:a,props:s,_owner:tf.current}}function K0(t,e){return{$$typeof:fo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function nf(t){return typeof t=="object"&&t!==null&&t.$$typeof===fo}function G0(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var cg=/\/+/g;function $u(t,e){return typeof t=="object"&&t!==null&&t.key!=null?G0(""+t.key):e.toString(36)}function Il(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case fo:case L0:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+$u(a,0):r,lg(s)?(n="",t!=null&&(n=t.replace(cg,"$&/")+"/"),Il(s,e,n,"",function(d){return d})):s!=null&&(nf(s)&&(s=K0(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(cg,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",lg(t))for(var c=0;c<t.length;c++){i=t[c];var u=r+$u(i,c);a+=Il(i,e,n,u,s)}else if(u=H0(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=r+$u(i,c++),a+=Il(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Jo(t,e,n){if(t==null)return t;var r=[],s=0;return Il(t,r,"","",function(i){return e.call(n,i,s++)}),r}function Q0(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Rt={current:null},Tl={transition:null},Y0={ReactCurrentDispatcher:Rt,ReactCurrentBatchConfig:Tl,ReactCurrentOwner:tf};function e_(){throw Error("act(...) is not supported in production builds of React.")}le.Children={map:Jo,forEach:function(t,e,n){Jo(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Jo(t,function(){e++}),e},toArray:function(t){return Jo(t,function(e){return e})||[]},only:function(t){if(!nf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};le.Component=Ei;le.Fragment=V0;le.Profiler=F0;le.PureComponent=Zh;le.StrictMode=M0;le.Suspense=$0;le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y0;le.act=e_;le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Gy({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=tf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)Xy.call(e,u)&&!Jy.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:fo,type:t.type,key:s,ref:i,props:r,_owner:a}};le.createContext=function(t){return t={$$typeof:z0,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:U0,_context:t},t.Consumer=t};le.createElement=Zy;le.createFactory=function(t){var e=Zy.bind(null,t);return e.type=t,e};le.createRef=function(){return{current:null}};le.forwardRef=function(t){return{$$typeof:B0,render:t}};le.isValidElement=nf;le.lazy=function(t){return{$$typeof:q0,_payload:{_status:-1,_result:t},_init:Q0}};le.memo=function(t,e){return{$$typeof:W0,type:t,compare:e===void 0?null:e}};le.startTransition=function(t){var e=Tl.transition;Tl.transition={};try{t()}finally{Tl.transition=e}};le.unstable_act=e_;le.useCallback=function(t,e){return Rt.current.useCallback(t,e)};le.useContext=function(t){return Rt.current.useContext(t)};le.useDebugValue=function(){};le.useDeferredValue=function(t){return Rt.current.useDeferredValue(t)};le.useEffect=function(t,e){return Rt.current.useEffect(t,e)};le.useId=function(){return Rt.current.useId()};le.useImperativeHandle=function(t,e,n){return Rt.current.useImperativeHandle(t,e,n)};le.useInsertionEffect=function(t,e){return Rt.current.useInsertionEffect(t,e)};le.useLayoutEffect=function(t,e){return Rt.current.useLayoutEffect(t,e)};le.useMemo=function(t,e){return Rt.current.useMemo(t,e)};le.useReducer=function(t,e,n){return Rt.current.useReducer(t,e,n)};le.useRef=function(t){return Rt.current.useRef(t)};le.useState=function(t){return Rt.current.useState(t)};le.useSyncExternalStore=function(t,e,n){return Rt.current.useSyncExternalStore(t,e,n)};le.useTransition=function(){return Rt.current.useTransition()};le.version="18.3.1";Hy.exports=le;var b=Hy.exports;const t_=D0(b),X0=O0({__proto__:null,default:t_},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J0=b,Z0=Symbol.for("react.element"),eT=Symbol.for("react.fragment"),tT=Object.prototype.hasOwnProperty,nT=J0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rT={key:!0,ref:!0,__self:!0,__source:!0};function n_(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)tT.call(e,r)&&!rT.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Z0,type:t,key:i,ref:a,props:s,_owner:nT.current}}kc.Fragment=eT;kc.jsx=n_;kc.jsxs=n_;qy.exports=kc;var o=qy.exports,r_={exports:{}},Wt={},s_={exports:{}},i_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,Y){var V=B.length;B.push(Y);e:for(;0<V;){var ie=V-1>>>1,oe=B[ie];if(0<s(oe,Y))B[ie]=Y,B[V]=oe,V=ie;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var Y=B[0],V=B.pop();if(V!==Y){B[0]=V;e:for(var ie=0,oe=B.length,pe=oe>>>1;ie<pe;){var Pe=2*(ie+1)-1,ot=B[Pe],Et=Pe+1,ye=B[Et];if(0>s(ot,V))Et<oe&&0>s(ye,ot)?(B[ie]=ye,B[Et]=V,ie=Et):(B[ie]=ot,B[Pe]=V,ie=Pe);else if(Et<oe&&0>s(ye,V))B[ie]=ye,B[Et]=V,ie=Et;else break e}}return Y}function s(B,Y){var V=B.sortIndex-Y.sortIndex;return V!==0?V:B.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var u=[],d=[],f=1,p=null,m=3,I=!1,y=!1,N=!1,T=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(B){for(var Y=n(d);Y!==null;){if(Y.callback===null)r(d);else if(Y.startTime<=B)r(d),Y.sortIndex=Y.expirationTime,e(u,Y);else break;Y=n(d)}}function k(B){if(N=!1,E(B),!y)if(n(u)!==null)y=!0,te(O);else{var Y=n(d);Y!==null&&ve(k,Y.startTime-B)}}function O(B,Y){y=!1,N&&(N=!1,x(v),v=-1),I=!0;var V=m;try{for(E(Y),p=n(u);p!==null&&(!(p.expirationTime>Y)||B&&!C());){var ie=p.callback;if(typeof ie=="function"){p.callback=null,m=p.priorityLevel;var oe=ie(p.expirationTime<=Y);Y=t.unstable_now(),typeof oe=="function"?p.callback=oe:p===n(u)&&r(u),E(Y)}else r(u);p=n(u)}if(p!==null)var pe=!0;else{var Pe=n(d);Pe!==null&&ve(k,Pe.startTime-Y),pe=!1}return pe}finally{p=null,m=V,I=!1}}var D=!1,w=null,v=-1,A=5,P=-1;function C(){return!(t.unstable_now()-P<A)}function j(){if(w!==null){var B=t.unstable_now();P=B;var Y=!0;try{Y=w(!0,B)}finally{Y?S():(D=!1,w=null)}}else D=!1}var S;if(typeof _=="function")S=function(){_(j)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,K=U.port2;U.port1.onmessage=j,S=function(){K.postMessage(null)}}else S=function(){T(j,0)};function te(B){w=B,D||(D=!0,S())}function ve(B,Y){v=T(function(){B(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){y||I||(y=!0,te(O))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(B){switch(m){case 1:case 2:case 3:var Y=3;break;default:Y=m}var V=m;m=Y;try{return B()}finally{m=V}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,Y){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var V=m;m=B;try{return Y()}finally{m=V}},t.unstable_scheduleCallback=function(B,Y,V){var ie=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?ie+V:ie):V=ie,B){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=V+oe,B={id:f++,callback:Y,priorityLevel:B,startTime:V,expirationTime:oe,sortIndex:-1},V>ie?(B.sortIndex=V,e(d,B),n(u)===null&&B===n(d)&&(N?(x(v),v=-1):N=!0,ve(k,V-ie))):(B.sortIndex=oe,e(u,B),y||I||(y=!0,te(O))),B},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(B){var Y=m;return function(){var V=m;m=Y;try{return B.apply(this,arguments)}finally{m=V}}}})(i_);s_.exports=i_;var sT=s_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iT=b,$t=sT;function $(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a_=new Set,Pa={};function Es(t,e){ii(t,e),ii(t+"Capture",e)}function ii(t,e){for(Pa[t]=e,t=0;t<e.length;t++)a_.add(e[t])}var Mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kd=Object.prototype.hasOwnProperty,aT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ug={},dg={};function oT(t){return kd.call(dg,t)?!0:kd.call(ug,t)?!1:aT.test(t)?dg[t]=!0:(ug[t]=!0,!1)}function lT(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function cT(t,e,n,r){if(e===null||typeof e>"u"||lT(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ct(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var it={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){it[t]=new Ct(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];it[e]=new Ct(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){it[t]=new Ct(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){it[t]=new Ct(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){it[t]=new Ct(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){it[t]=new Ct(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){it[t]=new Ct(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){it[t]=new Ct(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){it[t]=new Ct(t,5,!1,t.toLowerCase(),null,!1,!1)});var rf=/[\-:]([a-z])/g;function sf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(rf,sf);it[e]=new Ct(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(rf,sf);it[e]=new Ct(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(rf,sf);it[e]=new Ct(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){it[t]=new Ct(t,1,!1,t.toLowerCase(),null,!1,!1)});it.xlinkHref=new Ct("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){it[t]=new Ct(t,1,!1,t.toLowerCase(),null,!0,!0)});function af(t,e,n,r){var s=it.hasOwnProperty(e)?it[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(cT(e,n,s,r)&&(n=null),r||s===null?oT(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Kn=iT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zo=Symbol.for("react.element"),Ds=Symbol.for("react.portal"),Ls=Symbol.for("react.fragment"),of=Symbol.for("react.strict_mode"),Pd=Symbol.for("react.profiler"),o_=Symbol.for("react.provider"),l_=Symbol.for("react.context"),lf=Symbol.for("react.forward_ref"),jd=Symbol.for("react.suspense"),bd=Symbol.for("react.suspense_list"),cf=Symbol.for("react.memo"),rr=Symbol.for("react.lazy"),c_=Symbol.for("react.offscreen"),hg=Symbol.iterator;function Gi(t){return t===null||typeof t!="object"?null:(t=hg&&t[hg]||t["@@iterator"],typeof t=="function"?t:null)}var De=Object.assign,Wu;function ia(t){if(Wu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Wu=e&&e[1]||""}return`
`+Wu+t}var qu=!1;function Hu(t,e){if(!t||qu)return"";qu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,c=i.length-1;1<=a&&0<=c&&s[a]!==i[c];)c--;for(;1<=a&&0<=c;a--,c--)if(s[a]!==i[c]){if(a!==1||c!==1)do if(a--,c--,0>c||s[a]!==i[c]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=c);break}}}finally{qu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ia(t):""}function uT(t){switch(t.tag){case 5:return ia(t.type);case 16:return ia("Lazy");case 13:return ia("Suspense");case 19:return ia("SuspenseList");case 0:case 2:case 15:return t=Hu(t.type,!1),t;case 11:return t=Hu(t.type.render,!1),t;case 1:return t=Hu(t.type,!0),t;default:return""}}function Od(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ls:return"Fragment";case Ds:return"Portal";case Pd:return"Profiler";case of:return"StrictMode";case jd:return"Suspense";case bd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case l_:return(t.displayName||"Context")+".Consumer";case o_:return(t._context.displayName||"Context")+".Provider";case lf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case cf:return e=t.displayName||null,e!==null?e:Od(t.type)||"Memo";case rr:e=t._payload,t=t._init;try{return Od(t(e))}catch{}}return null}function dT(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Od(e);case 8:return e===of?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Cr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function u_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function hT(t){var e=u_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function el(t){t._valueTracker||(t._valueTracker=hT(t))}function d_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=u_(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Wl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Dd(t,e){var n=e.checked;return De({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function fg(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Cr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function h_(t,e){e=e.checked,e!=null&&af(t,"checked",e,!1)}function Ld(t,e){h_(t,e);var n=Cr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vd(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vd(t,e.type,Cr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function pg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vd(t,e,n){(e!=="number"||Wl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var aa=Array.isArray;function Gs(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Cr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Md(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return De({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function mg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error($(92));if(aa(n)){if(1<n.length)throw Error($(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Cr(n)}}function f_(t,e){var n=Cr(e.value),r=Cr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function gg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function p_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?p_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var tl,m_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(tl=tl||document.createElement("div"),tl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=tl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ja(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var pa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fT=["Webkit","ms","Moz","O"];Object.keys(pa).forEach(function(t){fT.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),pa[e]=pa[t]})});function g_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||pa.hasOwnProperty(t)&&pa[t]?(""+e).trim():e+"px"}function v_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=g_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var pT=De({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ud(t,e){if(e){if(pT[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function zd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bd=null;function uf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $d=null,Qs=null,Ys=null;function vg(t){if(t=go(t)){if(typeof $d!="function")throw Error($(280));var e=t.stateNode;e&&(e=Dc(e),$d(t.stateNode,t.type,e))}}function y_(t){Qs?Ys?Ys.push(t):Ys=[t]:Qs=t}function __(){if(Qs){var t=Qs,e=Ys;if(Ys=Qs=null,vg(t),e)for(t=0;t<e.length;t++)vg(e[t])}}function w_(t,e){return t(e)}function E_(){}var Ku=!1;function x_(t,e,n){if(Ku)return t(e,n);Ku=!0;try{return w_(t,e,n)}finally{Ku=!1,(Qs!==null||Ys!==null)&&(E_(),__())}}function ba(t,e){var n=t.stateNode;if(n===null)return null;var r=Dc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error($(231,e,typeof n));return n}var Wd=!1;if(Mn)try{var Qi={};Object.defineProperty(Qi,"passive",{get:function(){Wd=!0}}),window.addEventListener("test",Qi,Qi),window.removeEventListener("test",Qi,Qi)}catch{Wd=!1}function mT(t,e,n,r,s,i,a,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var ma=!1,ql=null,Hl=!1,qd=null,gT={onError:function(t){ma=!0,ql=t}};function vT(t,e,n,r,s,i,a,c,u){ma=!1,ql=null,mT.apply(gT,arguments)}function yT(t,e,n,r,s,i,a,c,u){if(vT.apply(this,arguments),ma){if(ma){var d=ql;ma=!1,ql=null}else throw Error($(198));Hl||(Hl=!0,qd=d)}}function xs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function I_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function yg(t){if(xs(t)!==t)throw Error($(188))}function _T(t){var e=t.alternate;if(!e){if(e=xs(t),e===null)throw Error($(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return yg(s),t;if(i===r)return yg(s),e;i=i.sibling}throw Error($(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,c=s.child;c;){if(c===n){a=!0,n=s,r=i;break}if(c===r){a=!0,r=s,n=i;break}c=c.sibling}if(!a){for(c=i.child;c;){if(c===n){a=!0,n=i,r=s;break}if(c===r){a=!0,r=i,n=s;break}c=c.sibling}if(!a)throw Error($(189))}}if(n.alternate!==r)throw Error($(190))}if(n.tag!==3)throw Error($(188));return n.stateNode.current===n?t:e}function T_(t){return t=_T(t),t!==null?N_(t):null}function N_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=N_(t);if(e!==null)return e;t=t.sibling}return null}var S_=$t.unstable_scheduleCallback,_g=$t.unstable_cancelCallback,wT=$t.unstable_shouldYield,ET=$t.unstable_requestPaint,Be=$t.unstable_now,xT=$t.unstable_getCurrentPriorityLevel,df=$t.unstable_ImmediatePriority,A_=$t.unstable_UserBlockingPriority,Kl=$t.unstable_NormalPriority,IT=$t.unstable_LowPriority,R_=$t.unstable_IdlePriority,Pc=null,yn=null;function TT(t){if(yn&&typeof yn.onCommitFiberRoot=="function")try{yn.onCommitFiberRoot(Pc,t,void 0,(t.current.flags&128)===128)}catch{}}var ln=Math.clz32?Math.clz32:AT,NT=Math.log,ST=Math.LN2;function AT(t){return t>>>=0,t===0?32:31-(NT(t)/ST|0)|0}var nl=64,rl=4194304;function oa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Gl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var c=a&~s;c!==0?r=oa(c):(i&=a,i!==0&&(r=oa(i)))}else a=n&~s,a!==0?r=oa(a):i!==0&&(r=oa(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ln(e),s=1<<n,r|=t[n],e&=~s;return r}function RT(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function CT(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-ln(i),c=1<<a,u=s[a];u===-1?(!(c&n)||c&r)&&(s[a]=RT(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function Hd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function C_(){var t=nl;return nl<<=1,!(nl&4194240)&&(nl=64),t}function Gu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function po(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ln(e),t[e]=n}function kT(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-ln(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function hf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ln(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var we=0;function k_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var P_,ff,j_,b_,O_,Kd=!1,sl=[],vr=null,yr=null,_r=null,Oa=new Map,Da=new Map,ir=[],PT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wg(t,e){switch(t){case"focusin":case"focusout":vr=null;break;case"dragenter":case"dragleave":yr=null;break;case"mouseover":case"mouseout":_r=null;break;case"pointerover":case"pointerout":Oa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Da.delete(e.pointerId)}}function Yi(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=go(e),e!==null&&ff(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function jT(t,e,n,r,s){switch(e){case"focusin":return vr=Yi(vr,t,e,n,r,s),!0;case"dragenter":return yr=Yi(yr,t,e,n,r,s),!0;case"mouseover":return _r=Yi(_r,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Oa.set(i,Yi(Oa.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Da.set(i,Yi(Da.get(i)||null,t,e,n,r,s)),!0}return!1}function D_(t){var e=Jr(t.target);if(e!==null){var n=xs(e);if(n!==null){if(e=n.tag,e===13){if(e=I_(n),e!==null){t.blockedOn=e,O_(t.priority,function(){j_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Nl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Gd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Bd=r,n.target.dispatchEvent(r),Bd=null}else return e=go(n),e!==null&&ff(e),t.blockedOn=n,!1;e.shift()}return!0}function Eg(t,e,n){Nl(t)&&n.delete(e)}function bT(){Kd=!1,vr!==null&&Nl(vr)&&(vr=null),yr!==null&&Nl(yr)&&(yr=null),_r!==null&&Nl(_r)&&(_r=null),Oa.forEach(Eg),Da.forEach(Eg)}function Xi(t,e){t.blockedOn===e&&(t.blockedOn=null,Kd||(Kd=!0,$t.unstable_scheduleCallback($t.unstable_NormalPriority,bT)))}function La(t){function e(s){return Xi(s,t)}if(0<sl.length){Xi(sl[0],t);for(var n=1;n<sl.length;n++){var r=sl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(vr!==null&&Xi(vr,t),yr!==null&&Xi(yr,t),_r!==null&&Xi(_r,t),Oa.forEach(e),Da.forEach(e),n=0;n<ir.length;n++)r=ir[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ir.length&&(n=ir[0],n.blockedOn===null);)D_(n),n.blockedOn===null&&ir.shift()}var Xs=Kn.ReactCurrentBatchConfig,Ql=!0;function OT(t,e,n,r){var s=we,i=Xs.transition;Xs.transition=null;try{we=1,pf(t,e,n,r)}finally{we=s,Xs.transition=i}}function DT(t,e,n,r){var s=we,i=Xs.transition;Xs.transition=null;try{we=4,pf(t,e,n,r)}finally{we=s,Xs.transition=i}}function pf(t,e,n,r){if(Ql){var s=Gd(t,e,n,r);if(s===null)sd(t,e,r,Yl,n),wg(t,r);else if(jT(s,t,e,n,r))r.stopPropagation();else if(wg(t,r),e&4&&-1<PT.indexOf(t)){for(;s!==null;){var i=go(s);if(i!==null&&P_(i),i=Gd(t,e,n,r),i===null&&sd(t,e,r,Yl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else sd(t,e,r,null,n)}}var Yl=null;function Gd(t,e,n,r){if(Yl=null,t=uf(r),t=Jr(t),t!==null)if(e=xs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=I_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Yl=t,null}function L_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xT()){case df:return 1;case A_:return 4;case Kl:case IT:return 16;case R_:return 536870912;default:return 16}default:return 16}}var fr=null,mf=null,Sl=null;function V_(){if(Sl)return Sl;var t,e=mf,n=e.length,r,s="value"in fr?fr.value:fr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Sl=s.slice(t,1<r?1-r:void 0)}function Al(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function il(){return!0}function xg(){return!1}function qt(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?il:xg,this.isPropagationStopped=xg,this}return De(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=il)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=il)},persist:function(){},isPersistent:il}),e}var xi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gf=qt(xi),mo=De({},xi,{view:0,detail:0}),LT=qt(mo),Qu,Yu,Ji,jc=De({},mo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ji&&(Ji&&t.type==="mousemove"?(Qu=t.screenX-Ji.screenX,Yu=t.screenY-Ji.screenY):Yu=Qu=0,Ji=t),Qu)},movementY:function(t){return"movementY"in t?t.movementY:Yu}}),Ig=qt(jc),VT=De({},jc,{dataTransfer:0}),MT=qt(VT),FT=De({},mo,{relatedTarget:0}),Xu=qt(FT),UT=De({},xi,{animationName:0,elapsedTime:0,pseudoElement:0}),zT=qt(UT),BT=De({},xi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),$T=qt(BT),WT=De({},xi,{data:0}),Tg=qt(WT),qT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},HT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},KT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function GT(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=KT[t])?!!e[t]:!1}function vf(){return GT}var QT=De({},mo,{key:function(t){if(t.key){var e=qT[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Al(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?HT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vf,charCode:function(t){return t.type==="keypress"?Al(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Al(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),YT=qt(QT),XT=De({},jc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ng=qt(XT),JT=De({},mo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vf}),ZT=qt(JT),eN=De({},xi,{propertyName:0,elapsedTime:0,pseudoElement:0}),tN=qt(eN),nN=De({},jc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),rN=qt(nN),sN=[9,13,27,32],yf=Mn&&"CompositionEvent"in window,ga=null;Mn&&"documentMode"in document&&(ga=document.documentMode);var iN=Mn&&"TextEvent"in window&&!ga,M_=Mn&&(!yf||ga&&8<ga&&11>=ga),Sg=" ",Ag=!1;function F_(t,e){switch(t){case"keyup":return sN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function U_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Vs=!1;function aN(t,e){switch(t){case"compositionend":return U_(e);case"keypress":return e.which!==32?null:(Ag=!0,Sg);case"textInput":return t=e.data,t===Sg&&Ag?null:t;default:return null}}function oN(t,e){if(Vs)return t==="compositionend"||!yf&&F_(t,e)?(t=V_(),Sl=mf=fr=null,Vs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return M_&&e.locale!=="ko"?null:e.data;default:return null}}var lN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!lN[t.type]:e==="textarea"}function z_(t,e,n,r){y_(r),e=Xl(e,"onChange"),0<e.length&&(n=new gf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var va=null,Va=null;function cN(t){J_(t,0)}function bc(t){var e=Us(t);if(d_(e))return t}function uN(t,e){if(t==="change")return e}var B_=!1;if(Mn){var Ju;if(Mn){var Zu="oninput"in document;if(!Zu){var Cg=document.createElement("div");Cg.setAttribute("oninput","return;"),Zu=typeof Cg.oninput=="function"}Ju=Zu}else Ju=!1;B_=Ju&&(!document.documentMode||9<document.documentMode)}function kg(){va&&(va.detachEvent("onpropertychange",$_),Va=va=null)}function $_(t){if(t.propertyName==="value"&&bc(Va)){var e=[];z_(e,Va,t,uf(t)),x_(cN,e)}}function dN(t,e,n){t==="focusin"?(kg(),va=e,Va=n,va.attachEvent("onpropertychange",$_)):t==="focusout"&&kg()}function hN(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return bc(Va)}function fN(t,e){if(t==="click")return bc(e)}function pN(t,e){if(t==="input"||t==="change")return bc(e)}function mN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var hn=typeof Object.is=="function"?Object.is:mN;function Ma(t,e){if(hn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!kd.call(e,s)||!hn(t[s],e[s]))return!1}return!0}function Pg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function jg(t,e){var n=Pg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Pg(n)}}function W_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?W_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function q_(){for(var t=window,e=Wl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Wl(t.document)}return e}function _f(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function gN(t){var e=q_(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&W_(n.ownerDocument.documentElement,n)){if(r!==null&&_f(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=jg(n,i);var a=jg(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var vN=Mn&&"documentMode"in document&&11>=document.documentMode,Ms=null,Qd=null,ya=null,Yd=!1;function bg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Yd||Ms==null||Ms!==Wl(r)||(r=Ms,"selectionStart"in r&&_f(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ya&&Ma(ya,r)||(ya=r,r=Xl(Qd,"onSelect"),0<r.length&&(e=new gf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ms)))}function al(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Fs={animationend:al("Animation","AnimationEnd"),animationiteration:al("Animation","AnimationIteration"),animationstart:al("Animation","AnimationStart"),transitionend:al("Transition","TransitionEnd")},ed={},H_={};Mn&&(H_=document.createElement("div").style,"AnimationEvent"in window||(delete Fs.animationend.animation,delete Fs.animationiteration.animation,delete Fs.animationstart.animation),"TransitionEvent"in window||delete Fs.transitionend.transition);function Oc(t){if(ed[t])return ed[t];if(!Fs[t])return t;var e=Fs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in H_)return ed[t]=e[n];return t}var K_=Oc("animationend"),G_=Oc("animationiteration"),Q_=Oc("animationstart"),Y_=Oc("transitionend"),X_=new Map,Og="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(t,e){X_.set(t,e),Es(e,[t])}for(var td=0;td<Og.length;td++){var nd=Og[td],yN=nd.toLowerCase(),_N=nd[0].toUpperCase()+nd.slice(1);Dr(yN,"on"+_N)}Dr(K_,"onAnimationEnd");Dr(G_,"onAnimationIteration");Dr(Q_,"onAnimationStart");Dr("dblclick","onDoubleClick");Dr("focusin","onFocus");Dr("focusout","onBlur");Dr(Y_,"onTransitionEnd");ii("onMouseEnter",["mouseout","mouseover"]);ii("onMouseLeave",["mouseout","mouseover"]);ii("onPointerEnter",["pointerout","pointerover"]);ii("onPointerLeave",["pointerout","pointerover"]);Es("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Es("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Es("onBeforeInput",["compositionend","keypress","textInput","paste"]);Es("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Es("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Es("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var la="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wN=new Set("cancel close invalid load scroll toggle".split(" ").concat(la));function Dg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,yT(r,e,void 0,t),t.currentTarget=null}function J_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var c=r[a],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Dg(s,c,d),i=u}else for(a=0;a<r.length;a++){if(c=r[a],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Dg(s,c,d),i=u}}}if(Hl)throw t=qd,Hl=!1,qd=null,t}function Ae(t,e){var n=e[th];n===void 0&&(n=e[th]=new Set);var r=t+"__bubble";n.has(r)||(Z_(e,t,2,!1),n.add(r))}function rd(t,e,n){var r=0;e&&(r|=4),Z_(n,t,r,e)}var ol="_reactListening"+Math.random().toString(36).slice(2);function Fa(t){if(!t[ol]){t[ol]=!0,a_.forEach(function(n){n!=="selectionchange"&&(wN.has(n)||rd(n,!1,t),rd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ol]||(e[ol]=!0,rd("selectionchange",!1,e))}}function Z_(t,e,n,r){switch(L_(e)){case 1:var s=OT;break;case 4:s=DT;break;default:s=pf}n=s.bind(null,e,n,t),s=void 0,!Wd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function sd(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;c!==null;){if(a=Jr(c),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}c=c.parentNode}}r=r.return}x_(function(){var d=i,f=uf(n),p=[];e:{var m=X_.get(t);if(m!==void 0){var I=gf,y=t;switch(t){case"keypress":if(Al(n)===0)break e;case"keydown":case"keyup":I=YT;break;case"focusin":y="focus",I=Xu;break;case"focusout":y="blur",I=Xu;break;case"beforeblur":case"afterblur":I=Xu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=Ig;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=MT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=ZT;break;case K_:case G_:case Q_:I=zT;break;case Y_:I=tN;break;case"scroll":I=LT;break;case"wheel":I=rN;break;case"copy":case"cut":case"paste":I=$T;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=Ng}var N=(e&4)!==0,T=!N&&t==="scroll",x=N?m!==null?m+"Capture":null:m;N=[];for(var _=d,E;_!==null;){E=_;var k=E.stateNode;if(E.tag===5&&k!==null&&(E=k,x!==null&&(k=ba(_,x),k!=null&&N.push(Ua(_,k,E)))),T)break;_=_.return}0<N.length&&(m=new I(m,y,null,n,f),p.push({event:m,listeners:N}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",m&&n!==Bd&&(y=n.relatedTarget||n.fromElement)&&(Jr(y)||y[Fn]))break e;if((I||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,I?(y=n.relatedTarget||n.toElement,I=d,y=y?Jr(y):null,y!==null&&(T=xs(y),y!==T||y.tag!==5&&y.tag!==6)&&(y=null)):(I=null,y=d),I!==y)){if(N=Ig,k="onMouseLeave",x="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(N=Ng,k="onPointerLeave",x="onPointerEnter",_="pointer"),T=I==null?m:Us(I),E=y==null?m:Us(y),m=new N(k,_+"leave",I,n,f),m.target=T,m.relatedTarget=E,k=null,Jr(f)===d&&(N=new N(x,_+"enter",y,n,f),N.target=E,N.relatedTarget=T,k=N),T=k,I&&y)t:{for(N=I,x=y,_=0,E=N;E;E=js(E))_++;for(E=0,k=x;k;k=js(k))E++;for(;0<_-E;)N=js(N),_--;for(;0<E-_;)x=js(x),E--;for(;_--;){if(N===x||x!==null&&N===x.alternate)break t;N=js(N),x=js(x)}N=null}else N=null;I!==null&&Lg(p,m,I,N,!1),y!==null&&T!==null&&Lg(p,T,y,N,!0)}}e:{if(m=d?Us(d):window,I=m.nodeName&&m.nodeName.toLowerCase(),I==="select"||I==="input"&&m.type==="file")var O=uN;else if(Rg(m))if(B_)O=pN;else{O=hN;var D=dN}else(I=m.nodeName)&&I.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=fN);if(O&&(O=O(t,d))){z_(p,O,n,f);break e}D&&D(t,m,d),t==="focusout"&&(D=m._wrapperState)&&D.controlled&&m.type==="number"&&Vd(m,"number",m.value)}switch(D=d?Us(d):window,t){case"focusin":(Rg(D)||D.contentEditable==="true")&&(Ms=D,Qd=d,ya=null);break;case"focusout":ya=Qd=Ms=null;break;case"mousedown":Yd=!0;break;case"contextmenu":case"mouseup":case"dragend":Yd=!1,bg(p,n,f);break;case"selectionchange":if(vN)break;case"keydown":case"keyup":bg(p,n,f)}var w;if(yf)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Vs?F_(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(M_&&n.locale!=="ko"&&(Vs||v!=="onCompositionStart"?v==="onCompositionEnd"&&Vs&&(w=V_()):(fr=f,mf="value"in fr?fr.value:fr.textContent,Vs=!0)),D=Xl(d,v),0<D.length&&(v=new Tg(v,t,null,n,f),p.push({event:v,listeners:D}),w?v.data=w:(w=U_(n),w!==null&&(v.data=w)))),(w=iN?aN(t,n):oN(t,n))&&(d=Xl(d,"onBeforeInput"),0<d.length&&(f=new Tg("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=w))}J_(p,e)})}function Ua(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Xl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ba(t,n),i!=null&&r.unshift(Ua(t,i,s)),i=ba(t,e),i!=null&&r.push(Ua(t,i,s))),t=t.return}return r}function js(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Lg(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=ba(n,i),u!=null&&a.unshift(Ua(n,u,c))):s||(u=ba(n,i),u!=null&&a.push(Ua(n,u,c)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var EN=/\r\n?/g,xN=/\u0000|\uFFFD/g;function Vg(t){return(typeof t=="string"?t:""+t).replace(EN,`
`).replace(xN,"")}function ll(t,e,n){if(e=Vg(e),Vg(t)!==e&&n)throw Error($(425))}function Jl(){}var Xd=null,Jd=null;function Zd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var eh=typeof setTimeout=="function"?setTimeout:void 0,IN=typeof clearTimeout=="function"?clearTimeout:void 0,Mg=typeof Promise=="function"?Promise:void 0,TN=typeof queueMicrotask=="function"?queueMicrotask:typeof Mg<"u"?function(t){return Mg.resolve(null).then(t).catch(NN)}:eh;function NN(t){setTimeout(function(){throw t})}function id(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),La(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);La(e)}function wr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Fg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ii=Math.random().toString(36).slice(2),gn="__reactFiber$"+Ii,za="__reactProps$"+Ii,Fn="__reactContainer$"+Ii,th="__reactEvents$"+Ii,SN="__reactListeners$"+Ii,AN="__reactHandles$"+Ii;function Jr(t){var e=t[gn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Fn]||n[gn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Fg(t);t!==null;){if(n=t[gn])return n;t=Fg(t)}return e}t=n,n=t.parentNode}return null}function go(t){return t=t[gn]||t[Fn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Us(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error($(33))}function Dc(t){return t[za]||null}var nh=[],zs=-1;function Lr(t){return{current:t}}function Re(t){0>zs||(t.current=nh[zs],nh[zs]=null,zs--)}function Ne(t,e){zs++,nh[zs]=t.current,t.current=e}var kr={},_t=Lr(kr),jt=Lr(!1),ls=kr;function ai(t,e){var n=t.type.contextTypes;if(!n)return kr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function bt(t){return t=t.childContextTypes,t!=null}function Zl(){Re(jt),Re(_t)}function Ug(t,e,n){if(_t.current!==kr)throw Error($(168));Ne(_t,e),Ne(jt,n)}function ew(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error($(108,dT(t)||"Unknown",s));return De({},n,r)}function ec(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||kr,ls=_t.current,Ne(_t,t),Ne(jt,jt.current),!0}function zg(t,e,n){var r=t.stateNode;if(!r)throw Error($(169));n?(t=ew(t,e,ls),r.__reactInternalMemoizedMergedChildContext=t,Re(jt),Re(_t),Ne(_t,t)):Re(jt),Ne(jt,n)}var Cn=null,Lc=!1,ad=!1;function tw(t){Cn===null?Cn=[t]:Cn.push(t)}function RN(t){Lc=!0,tw(t)}function Vr(){if(!ad&&Cn!==null){ad=!0;var t=0,e=we;try{var n=Cn;for(we=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Cn=null,Lc=!1}catch(s){throw Cn!==null&&(Cn=Cn.slice(t+1)),S_(df,Vr),s}finally{we=e,ad=!1}}return null}var Bs=[],$s=0,tc=null,nc=0,Kt=[],Gt=0,cs=null,Pn=1,jn="";function Qr(t,e){Bs[$s++]=nc,Bs[$s++]=tc,tc=t,nc=e}function nw(t,e,n){Kt[Gt++]=Pn,Kt[Gt++]=jn,Kt[Gt++]=cs,cs=t;var r=Pn;t=jn;var s=32-ln(r)-1;r&=~(1<<s),n+=1;var i=32-ln(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Pn=1<<32-ln(e)+s|n<<s|r,jn=i+t}else Pn=1<<i|n<<s|r,jn=t}function wf(t){t.return!==null&&(Qr(t,1),nw(t,1,0))}function Ef(t){for(;t===tc;)tc=Bs[--$s],Bs[$s]=null,nc=Bs[--$s],Bs[$s]=null;for(;t===cs;)cs=Kt[--Gt],Kt[Gt]=null,jn=Kt[--Gt],Kt[Gt]=null,Pn=Kt[--Gt],Kt[Gt]=null}var zt=null,Mt=null,Ce=!1,an=null;function rw(t,e){var n=Qt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Bg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,zt=t,Mt=wr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,zt=t,Mt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=cs!==null?{id:Pn,overflow:jn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Qt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,zt=t,Mt=null,!0):!1;default:return!1}}function rh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function sh(t){if(Ce){var e=Mt;if(e){var n=e;if(!Bg(t,e)){if(rh(t))throw Error($(418));e=wr(n.nextSibling);var r=zt;e&&Bg(t,e)?rw(r,n):(t.flags=t.flags&-4097|2,Ce=!1,zt=t)}}else{if(rh(t))throw Error($(418));t.flags=t.flags&-4097|2,Ce=!1,zt=t}}}function $g(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;zt=t}function cl(t){if(t!==zt)return!1;if(!Ce)return $g(t),Ce=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Zd(t.type,t.memoizedProps)),e&&(e=Mt)){if(rh(t))throw sw(),Error($(418));for(;e;)rw(t,e),e=wr(e.nextSibling)}if($g(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error($(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Mt=wr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Mt=null}}else Mt=zt?wr(t.stateNode.nextSibling):null;return!0}function sw(){for(var t=Mt;t;)t=wr(t.nextSibling)}function oi(){Mt=zt=null,Ce=!1}function xf(t){an===null?an=[t]:an.push(t)}var CN=Kn.ReactCurrentBatchConfig;function Zi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error($(309));var r=n.stateNode}if(!r)throw Error($(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var c=s.refs;a===null?delete c[i]:c[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error($(284));if(!n._owner)throw Error($(290,t))}return t}function ul(t,e){throw t=Object.prototype.toString.call(e),Error($(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Wg(t){var e=t._init;return e(t._payload)}function iw(t){function e(x,_){if(t){var E=x.deletions;E===null?(x.deletions=[_],x.flags|=16):E.push(_)}}function n(x,_){if(!t)return null;for(;_!==null;)e(x,_),_=_.sibling;return null}function r(x,_){for(x=new Map;_!==null;)_.key!==null?x.set(_.key,_):x.set(_.index,_),_=_.sibling;return x}function s(x,_){return x=Tr(x,_),x.index=0,x.sibling=null,x}function i(x,_,E){return x.index=E,t?(E=x.alternate,E!==null?(E=E.index,E<_?(x.flags|=2,_):E):(x.flags|=2,_)):(x.flags|=1048576,_)}function a(x){return t&&x.alternate===null&&(x.flags|=2),x}function c(x,_,E,k){return _===null||_.tag!==6?(_=fd(E,x.mode,k),_.return=x,_):(_=s(_,E),_.return=x,_)}function u(x,_,E,k){var O=E.type;return O===Ls?f(x,_,E.props.children,k,E.key):_!==null&&(_.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===rr&&Wg(O)===_.type)?(k=s(_,E.props),k.ref=Zi(x,_,E),k.return=x,k):(k=Ol(E.type,E.key,E.props,null,x.mode,k),k.ref=Zi(x,_,E),k.return=x,k)}function d(x,_,E,k){return _===null||_.tag!==4||_.stateNode.containerInfo!==E.containerInfo||_.stateNode.implementation!==E.implementation?(_=pd(E,x.mode,k),_.return=x,_):(_=s(_,E.children||[]),_.return=x,_)}function f(x,_,E,k,O){return _===null||_.tag!==7?(_=ss(E,x.mode,k,O),_.return=x,_):(_=s(_,E),_.return=x,_)}function p(x,_,E){if(typeof _=="string"&&_!==""||typeof _=="number")return _=fd(""+_,x.mode,E),_.return=x,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Zo:return E=Ol(_.type,_.key,_.props,null,x.mode,E),E.ref=Zi(x,null,_),E.return=x,E;case Ds:return _=pd(_,x.mode,E),_.return=x,_;case rr:var k=_._init;return p(x,k(_._payload),E)}if(aa(_)||Gi(_))return _=ss(_,x.mode,E,null),_.return=x,_;ul(x,_)}return null}function m(x,_,E,k){var O=_!==null?_.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return O!==null?null:c(x,_,""+E,k);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Zo:return E.key===O?u(x,_,E,k):null;case Ds:return E.key===O?d(x,_,E,k):null;case rr:return O=E._init,m(x,_,O(E._payload),k)}if(aa(E)||Gi(E))return O!==null?null:f(x,_,E,k,null);ul(x,E)}return null}function I(x,_,E,k,O){if(typeof k=="string"&&k!==""||typeof k=="number")return x=x.get(E)||null,c(_,x,""+k,O);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Zo:return x=x.get(k.key===null?E:k.key)||null,u(_,x,k,O);case Ds:return x=x.get(k.key===null?E:k.key)||null,d(_,x,k,O);case rr:var D=k._init;return I(x,_,E,D(k._payload),O)}if(aa(k)||Gi(k))return x=x.get(E)||null,f(_,x,k,O,null);ul(_,k)}return null}function y(x,_,E,k){for(var O=null,D=null,w=_,v=_=0,A=null;w!==null&&v<E.length;v++){w.index>v?(A=w,w=null):A=w.sibling;var P=m(x,w,E[v],k);if(P===null){w===null&&(w=A);break}t&&w&&P.alternate===null&&e(x,w),_=i(P,_,v),D===null?O=P:D.sibling=P,D=P,w=A}if(v===E.length)return n(x,w),Ce&&Qr(x,v),O;if(w===null){for(;v<E.length;v++)w=p(x,E[v],k),w!==null&&(_=i(w,_,v),D===null?O=w:D.sibling=w,D=w);return Ce&&Qr(x,v),O}for(w=r(x,w);v<E.length;v++)A=I(w,x,v,E[v],k),A!==null&&(t&&A.alternate!==null&&w.delete(A.key===null?v:A.key),_=i(A,_,v),D===null?O=A:D.sibling=A,D=A);return t&&w.forEach(function(C){return e(x,C)}),Ce&&Qr(x,v),O}function N(x,_,E,k){var O=Gi(E);if(typeof O!="function")throw Error($(150));if(E=O.call(E),E==null)throw Error($(151));for(var D=O=null,w=_,v=_=0,A=null,P=E.next();w!==null&&!P.done;v++,P=E.next()){w.index>v?(A=w,w=null):A=w.sibling;var C=m(x,w,P.value,k);if(C===null){w===null&&(w=A);break}t&&w&&C.alternate===null&&e(x,w),_=i(C,_,v),D===null?O=C:D.sibling=C,D=C,w=A}if(P.done)return n(x,w),Ce&&Qr(x,v),O;if(w===null){for(;!P.done;v++,P=E.next())P=p(x,P.value,k),P!==null&&(_=i(P,_,v),D===null?O=P:D.sibling=P,D=P);return Ce&&Qr(x,v),O}for(w=r(x,w);!P.done;v++,P=E.next())P=I(w,x,v,P.value,k),P!==null&&(t&&P.alternate!==null&&w.delete(P.key===null?v:P.key),_=i(P,_,v),D===null?O=P:D.sibling=P,D=P);return t&&w.forEach(function(j){return e(x,j)}),Ce&&Qr(x,v),O}function T(x,_,E,k){if(typeof E=="object"&&E!==null&&E.type===Ls&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Zo:e:{for(var O=E.key,D=_;D!==null;){if(D.key===O){if(O=E.type,O===Ls){if(D.tag===7){n(x,D.sibling),_=s(D,E.props.children),_.return=x,x=_;break e}}else if(D.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===rr&&Wg(O)===D.type){n(x,D.sibling),_=s(D,E.props),_.ref=Zi(x,D,E),_.return=x,x=_;break e}n(x,D);break}else e(x,D);D=D.sibling}E.type===Ls?(_=ss(E.props.children,x.mode,k,E.key),_.return=x,x=_):(k=Ol(E.type,E.key,E.props,null,x.mode,k),k.ref=Zi(x,_,E),k.return=x,x=k)}return a(x);case Ds:e:{for(D=E.key;_!==null;){if(_.key===D)if(_.tag===4&&_.stateNode.containerInfo===E.containerInfo&&_.stateNode.implementation===E.implementation){n(x,_.sibling),_=s(_,E.children||[]),_.return=x,x=_;break e}else{n(x,_);break}else e(x,_);_=_.sibling}_=pd(E,x.mode,k),_.return=x,x=_}return a(x);case rr:return D=E._init,T(x,_,D(E._payload),k)}if(aa(E))return y(x,_,E,k);if(Gi(E))return N(x,_,E,k);ul(x,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,_!==null&&_.tag===6?(n(x,_.sibling),_=s(_,E),_.return=x,x=_):(n(x,_),_=fd(E,x.mode,k),_.return=x,x=_),a(x)):n(x,_)}return T}var li=iw(!0),aw=iw(!1),rc=Lr(null),sc=null,Ws=null,If=null;function Tf(){If=Ws=sc=null}function Nf(t){var e=rc.current;Re(rc),t._currentValue=e}function ih(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Js(t,e){sc=t,If=Ws=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Pt=!0),t.firstContext=null)}function Xt(t){var e=t._currentValue;if(If!==t)if(t={context:t,memoizedValue:e,next:null},Ws===null){if(sc===null)throw Error($(308));Ws=t,sc.dependencies={lanes:0,firstContext:t}}else Ws=Ws.next=t;return e}var Zr=null;function Sf(t){Zr===null?Zr=[t]:Zr.push(t)}function ow(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Sf(e)):(n.next=s.next,s.next=n),e.interleaved=n,Un(t,r)}function Un(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var sr=!1;function Af(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ln(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Er(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,fe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Un(t,n)}return s=r.interleaved,s===null?(e.next=e,Sf(r)):(e.next=s.next,s.next=e),r.interleaved=e,Un(t,n)}function Rl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hf(t,n)}}function qg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ic(t,e,n,r){var s=t.updateQueue;sr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,a===null?i=d:a.next=d,a=u;var f=t.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==a&&(c===null?f.firstBaseUpdate=d:c.next=d,f.lastBaseUpdate=u))}if(i!==null){var p=s.baseState;a=0,f=d=u=null,c=i;do{var m=c.lane,I=c.eventTime;if((r&m)===m){f!==null&&(f=f.next={eventTime:I,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var y=t,N=c;switch(m=e,I=n,N.tag){case 1:if(y=N.payload,typeof y=="function"){p=y.call(I,p,m);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=N.payload,m=typeof y=="function"?y.call(I,p,m):y,m==null)break e;p=De({},p,m);break e;case 2:sr=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[c]:m.push(c))}else I={eventTime:I,lane:m,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(d=f=I,u=p):f=f.next=I,a|=m;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;m=c,c=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(f===null&&(u=p),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ds|=a,t.lanes=a,t.memoizedState=p}}function Hg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error($(191,s));s.call(r)}}}var vo={},_n=Lr(vo),Ba=Lr(vo),$a=Lr(vo);function es(t){if(t===vo)throw Error($(174));return t}function Rf(t,e){switch(Ne($a,e),Ne(Ba,t),Ne(_n,vo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Fd(e,t)}Re(_n),Ne(_n,e)}function ci(){Re(_n),Re(Ba),Re($a)}function cw(t){es($a.current);var e=es(_n.current),n=Fd(e,t.type);e!==n&&(Ne(Ba,t),Ne(_n,n))}function Cf(t){Ba.current===t&&(Re(_n),Re(Ba))}var je=Lr(0);function ac(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var od=[];function kf(){for(var t=0;t<od.length;t++)od[t]._workInProgressVersionPrimary=null;od.length=0}var Cl=Kn.ReactCurrentDispatcher,ld=Kn.ReactCurrentBatchConfig,us=0,be=null,He=null,Ye=null,oc=!1,_a=!1,Wa=0,kN=0;function ht(){throw Error($(321))}function Pf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!hn(t[n],e[n]))return!1;return!0}function jf(t,e,n,r,s,i){if(us=i,be=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Cl.current=t===null||t.memoizedState===null?ON:DN,t=n(r,s),_a){i=0;do{if(_a=!1,Wa=0,25<=i)throw Error($(301));i+=1,Ye=He=null,e.updateQueue=null,Cl.current=LN,t=n(r,s)}while(_a)}if(Cl.current=lc,e=He!==null&&He.next!==null,us=0,Ye=He=be=null,oc=!1,e)throw Error($(300));return t}function bf(){var t=Wa!==0;return Wa=0,t}function mn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ye===null?be.memoizedState=Ye=t:Ye=Ye.next=t,Ye}function Jt(){if(He===null){var t=be.alternate;t=t!==null?t.memoizedState:null}else t=He.next;var e=Ye===null?be.memoizedState:Ye.next;if(e!==null)Ye=e,He=t;else{if(t===null)throw Error($(310));He=t,t={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},Ye===null?be.memoizedState=Ye=t:Ye=Ye.next=t}return Ye}function qa(t,e){return typeof e=="function"?e(t):e}function cd(t){var e=Jt(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=He,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=a=null,u=null,d=i;do{var f=d.lane;if((us&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=p,a=r):u=u.next=p,be.lanes|=f,ds|=f}d=d.next}while(d!==null&&d!==i);u===null?a=r:u.next=c,hn(r,e.memoizedState)||(Pt=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,be.lanes|=i,ds|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ud(t){var e=Jt(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);hn(i,e.memoizedState)||(Pt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function uw(){}function dw(t,e){var n=be,r=Jt(),s=e(),i=!hn(r.memoizedState,s);if(i&&(r.memoizedState=s,Pt=!0),r=r.queue,Of(pw.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Ye!==null&&Ye.memoizedState.tag&1){if(n.flags|=2048,Ha(9,fw.bind(null,n,r,s,e),void 0,null),Je===null)throw Error($(349));us&30||hw(n,e,s)}return s}function hw(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=be.updateQueue,e===null?(e={lastEffect:null,stores:null},be.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function fw(t,e,n,r){e.value=n,e.getSnapshot=r,mw(e)&&gw(t)}function pw(t,e,n){return n(function(){mw(e)&&gw(t)})}function mw(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!hn(t,n)}catch{return!0}}function gw(t){var e=Un(t,1);e!==null&&cn(e,t,1,-1)}function Kg(t){var e=mn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:t},e.queue=t,t=t.dispatch=bN.bind(null,be,t),[e.memoizedState,t]}function Ha(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=be.updateQueue,e===null?(e={lastEffect:null,stores:null},be.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function vw(){return Jt().memoizedState}function kl(t,e,n,r){var s=mn();be.flags|=t,s.memoizedState=Ha(1|e,n,void 0,r===void 0?null:r)}function Vc(t,e,n,r){var s=Jt();r=r===void 0?null:r;var i=void 0;if(He!==null){var a=He.memoizedState;if(i=a.destroy,r!==null&&Pf(r,a.deps)){s.memoizedState=Ha(e,n,i,r);return}}be.flags|=t,s.memoizedState=Ha(1|e,n,i,r)}function Gg(t,e){return kl(8390656,8,t,e)}function Of(t,e){return Vc(2048,8,t,e)}function yw(t,e){return Vc(4,2,t,e)}function _w(t,e){return Vc(4,4,t,e)}function ww(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Ew(t,e,n){return n=n!=null?n.concat([t]):null,Vc(4,4,ww.bind(null,e,t),n)}function Df(){}function xw(t,e){var n=Jt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Pf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Iw(t,e){var n=Jt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Pf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Tw(t,e,n){return us&21?(hn(n,e)||(n=C_(),be.lanes|=n,ds|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Pt=!0),t.memoizedState=n)}function PN(t,e){var n=we;we=n!==0&&4>n?n:4,t(!0);var r=ld.transition;ld.transition={};try{t(!1),e()}finally{we=n,ld.transition=r}}function Nw(){return Jt().memoizedState}function jN(t,e,n){var r=Ir(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Sw(t))Aw(e,n);else if(n=ow(t,e,n,r),n!==null){var s=At();cn(n,t,r,s),Rw(n,e,r)}}function bN(t,e,n){var r=Ir(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Sw(t))Aw(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,c=i(a,n);if(s.hasEagerState=!0,s.eagerState=c,hn(c,a)){var u=e.interleaved;u===null?(s.next=s,Sf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=ow(t,e,s,r),n!==null&&(s=At(),cn(n,t,r,s),Rw(n,e,r))}}function Sw(t){var e=t.alternate;return t===be||e!==null&&e===be}function Aw(t,e){_a=oc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Rw(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hf(t,n)}}var lc={readContext:Xt,useCallback:ht,useContext:ht,useEffect:ht,useImperativeHandle:ht,useInsertionEffect:ht,useLayoutEffect:ht,useMemo:ht,useReducer:ht,useRef:ht,useState:ht,useDebugValue:ht,useDeferredValue:ht,useTransition:ht,useMutableSource:ht,useSyncExternalStore:ht,useId:ht,unstable_isNewReconciler:!1},ON={readContext:Xt,useCallback:function(t,e){return mn().memoizedState=[t,e===void 0?null:e],t},useContext:Xt,useEffect:Gg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,kl(4194308,4,ww.bind(null,e,t),n)},useLayoutEffect:function(t,e){return kl(4194308,4,t,e)},useInsertionEffect:function(t,e){return kl(4,2,t,e)},useMemo:function(t,e){var n=mn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=mn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=jN.bind(null,be,t),[r.memoizedState,t]},useRef:function(t){var e=mn();return t={current:t},e.memoizedState=t},useState:Kg,useDebugValue:Df,useDeferredValue:function(t){return mn().memoizedState=t},useTransition:function(){var t=Kg(!1),e=t[0];return t=PN.bind(null,t[1]),mn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=be,s=mn();if(Ce){if(n===void 0)throw Error($(407));n=n()}else{if(n=e(),Je===null)throw Error($(349));us&30||hw(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Gg(pw.bind(null,r,i,t),[t]),r.flags|=2048,Ha(9,fw.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=mn(),e=Je.identifierPrefix;if(Ce){var n=jn,r=Pn;n=(r&~(1<<32-ln(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Wa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=kN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},DN={readContext:Xt,useCallback:xw,useContext:Xt,useEffect:Of,useImperativeHandle:Ew,useInsertionEffect:yw,useLayoutEffect:_w,useMemo:Iw,useReducer:cd,useRef:vw,useState:function(){return cd(qa)},useDebugValue:Df,useDeferredValue:function(t){var e=Jt();return Tw(e,He.memoizedState,t)},useTransition:function(){var t=cd(qa)[0],e=Jt().memoizedState;return[t,e]},useMutableSource:uw,useSyncExternalStore:dw,useId:Nw,unstable_isNewReconciler:!1},LN={readContext:Xt,useCallback:xw,useContext:Xt,useEffect:Of,useImperativeHandle:Ew,useInsertionEffect:yw,useLayoutEffect:_w,useMemo:Iw,useReducer:ud,useRef:vw,useState:function(){return ud(qa)},useDebugValue:Df,useDeferredValue:function(t){var e=Jt();return He===null?e.memoizedState=t:Tw(e,He.memoizedState,t)},useTransition:function(){var t=ud(qa)[0],e=Jt().memoizedState;return[t,e]},useMutableSource:uw,useSyncExternalStore:dw,useId:Nw,unstable_isNewReconciler:!1};function rn(t,e){if(t&&t.defaultProps){e=De({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ah(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:De({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Mc={isMounted:function(t){return(t=t._reactInternals)?xs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=At(),s=Ir(t),i=Ln(r,s);i.payload=e,n!=null&&(i.callback=n),e=Er(t,i,s),e!==null&&(cn(e,t,s,r),Rl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=At(),s=Ir(t),i=Ln(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Er(t,i,s),e!==null&&(cn(e,t,s,r),Rl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=At(),r=Ir(t),s=Ln(n,r);s.tag=2,e!=null&&(s.callback=e),e=Er(t,s,r),e!==null&&(cn(e,t,r,n),Rl(e,t,r))}};function Qg(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!Ma(n,r)||!Ma(s,i):!0}function Cw(t,e,n){var r=!1,s=kr,i=e.contextType;return typeof i=="object"&&i!==null?i=Xt(i):(s=bt(e)?ls:_t.current,r=e.contextTypes,i=(r=r!=null)?ai(t,s):kr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Mc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Yg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Mc.enqueueReplaceState(e,e.state,null)}function oh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Af(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Xt(i):(i=bt(e)?ls:_t.current,s.context=ai(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(ah(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Mc.enqueueReplaceState(s,s.state,null),ic(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ui(t,e){try{var n="",r=e;do n+=uT(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function dd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function lh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var VN=typeof WeakMap=="function"?WeakMap:Map;function kw(t,e,n){n=Ln(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){uc||(uc=!0,yh=r),lh(t,e)},n}function Pw(t,e,n){n=Ln(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){lh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){lh(t,e),typeof r!="function"&&(xr===null?xr=new Set([this]):xr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Xg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new VN;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=XN.bind(null,t,e,n),e.then(t,t))}function Jg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Zg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ln(-1,1),e.tag=2,Er(n,e,1))),n.lanes|=1),t)}var MN=Kn.ReactCurrentOwner,Pt=!1;function Nt(t,e,n,r){e.child=t===null?aw(e,null,n,r):li(e,t.child,n,r)}function ev(t,e,n,r,s){n=n.render;var i=e.ref;return Js(e,s),r=jf(t,e,n,r,i,s),n=bf(),t!==null&&!Pt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,zn(t,e,s)):(Ce&&n&&wf(e),e.flags|=1,Nt(t,e,r,s),e.child)}function tv(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!$f(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,jw(t,e,i,r,s)):(t=Ol(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ma,n(a,r)&&t.ref===e.ref)return zn(t,e,s)}return e.flags|=1,t=Tr(i,r),t.ref=e.ref,t.return=e,e.child=t}function jw(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ma(i,r)&&t.ref===e.ref)if(Pt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Pt=!0);else return e.lanes=t.lanes,zn(t,e,s)}return ch(t,e,n,r,s)}function bw(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ne(Hs,Vt),Vt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ne(Hs,Vt),Vt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ne(Hs,Vt),Vt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ne(Hs,Vt),Vt|=r;return Nt(t,e,s,n),e.child}function Ow(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ch(t,e,n,r,s){var i=bt(n)?ls:_t.current;return i=ai(e,i),Js(e,s),n=jf(t,e,n,r,i,s),r=bf(),t!==null&&!Pt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,zn(t,e,s)):(Ce&&r&&wf(e),e.flags|=1,Nt(t,e,n,s),e.child)}function nv(t,e,n,r,s){if(bt(n)){var i=!0;ec(e)}else i=!1;if(Js(e,s),e.stateNode===null)Pl(t,e),Cw(e,n,r),oh(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,c=e.memoizedProps;a.props=c;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=Xt(d):(d=bt(n)?ls:_t.current,d=ai(e,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==r||u!==d)&&Yg(e,a,r,d),sr=!1;var m=e.memoizedState;a.state=m,ic(e,r,a,s),u=e.memoizedState,c!==r||m!==u||jt.current||sr?(typeof f=="function"&&(ah(e,n,f,r),u=e.memoizedState),(c=sr||Qg(e,n,c,r,m,u,d))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=d,r=c):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,lw(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:rn(e.type,c),a.props=d,p=e.pendingProps,m=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Xt(u):(u=bt(n)?ls:_t.current,u=ai(e,u));var I=n.getDerivedStateFromProps;(f=typeof I=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==p||m!==u)&&Yg(e,a,r,u),sr=!1,m=e.memoizedState,a.state=m,ic(e,r,a,s);var y=e.memoizedState;c!==p||m!==y||jt.current||sr?(typeof I=="function"&&(ah(e,n,I,r),y=e.memoizedState),(d=sr||Qg(e,n,d,r,m,y,u)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,y,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,y,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),a.props=r,a.state=y,a.context=u,r=d):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return uh(t,e,n,r,i,s)}function uh(t,e,n,r,s,i){Ow(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&zg(e,n,!1),zn(t,e,i);r=e.stateNode,MN.current=e;var c=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=li(e,t.child,null,i),e.child=li(e,null,c,i)):Nt(t,e,c,i),e.memoizedState=r.state,s&&zg(e,n,!0),e.child}function Dw(t){var e=t.stateNode;e.pendingContext?Ug(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ug(t,e.context,!1),Rf(t,e.containerInfo)}function rv(t,e,n,r,s){return oi(),xf(s),e.flags|=256,Nt(t,e,n,r),e.child}var dh={dehydrated:null,treeContext:null,retryLane:0};function hh(t){return{baseLanes:t,cachePool:null,transitions:null}}function Lw(t,e,n){var r=e.pendingProps,s=je.current,i=!1,a=(e.flags&128)!==0,c;if((c=a)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ne(je,s&1),t===null)return sh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=zc(a,r,0,null),t=ss(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=hh(n),e.memoizedState=dh,t):Lf(e,a));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return FN(t,e,a,r,c,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Tr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Tr(c,i):(i=ss(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?hh(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=dh,r}return i=t.child,t=i.sibling,r=Tr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Lf(t,e){return e=zc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function dl(t,e,n,r){return r!==null&&xf(r),li(e,t.child,null,n),t=Lf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function FN(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=dd(Error($(422))),dl(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=zc({mode:"visible",children:r.children},s,0,null),i=ss(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&li(e,t.child,null,a),e.child.memoizedState=hh(a),e.memoizedState=dh,i);if(!(e.mode&1))return dl(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error($(419)),r=dd(i,r,void 0),dl(t,e,a,r)}if(c=(a&t.childLanes)!==0,Pt||c){if(r=Je,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Un(t,s),cn(r,t,s,-1))}return Bf(),r=dd(Error($(421))),dl(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=JN.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Mt=wr(s.nextSibling),zt=e,Ce=!0,an=null,t!==null&&(Kt[Gt++]=Pn,Kt[Gt++]=jn,Kt[Gt++]=cs,Pn=t.id,jn=t.overflow,cs=e),e=Lf(e,r.children),e.flags|=4096,e)}function sv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),ih(t.return,e,n)}function hd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Vw(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Nt(t,e,r.children,n),r=je.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&sv(t,n,e);else if(t.tag===19)sv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ne(je,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&ac(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),hd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ac(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}hd(e,!0,n,null,i);break;case"together":hd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Pl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function zn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ds|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error($(153));if(e.child!==null){for(t=e.child,n=Tr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Tr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function UN(t,e,n){switch(e.tag){case 3:Dw(e),oi();break;case 5:cw(e);break;case 1:bt(e.type)&&ec(e);break;case 4:Rf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ne(rc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ne(je,je.current&1),e.flags|=128,null):n&e.child.childLanes?Lw(t,e,n):(Ne(je,je.current&1),t=zn(t,e,n),t!==null?t.sibling:null);Ne(je,je.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Vw(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ne(je,je.current),r)break;return null;case 22:case 23:return e.lanes=0,bw(t,e,n)}return zn(t,e,n)}var Mw,fh,Fw,Uw;Mw=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};fh=function(){};Fw=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,es(_n.current);var i=null;switch(n){case"input":s=Dd(t,s),r=Dd(t,r),i=[];break;case"select":s=De({},s,{value:void 0}),r=De({},r,{value:void 0}),i=[];break;case"textarea":s=Md(t,s),r=Md(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Jl)}Ud(n,r);var a;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Pa.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(a in c)!c.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&c[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Pa.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ae("scroll",t),i||c===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Uw=function(t,e,n,r){n!==r&&(e.flags|=4)};function ea(t,e){if(!Ce)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ft(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function zN(t,e,n){var r=e.pendingProps;switch(Ef(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ft(e),null;case 1:return bt(e.type)&&Zl(),ft(e),null;case 3:return r=e.stateNode,ci(),Re(jt),Re(_t),kf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(cl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,an!==null&&(Eh(an),an=null))),fh(t,e),ft(e),null;case 5:Cf(e);var s=es($a.current);if(n=e.type,t!==null&&e.stateNode!=null)Fw(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error($(166));return ft(e),null}if(t=es(_n.current),cl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[gn]=e,r[za]=i,t=(e.mode&1)!==0,n){case"dialog":Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":case"embed":Ae("load",r);break;case"video":case"audio":for(s=0;s<la.length;s++)Ae(la[s],r);break;case"source":Ae("error",r);break;case"img":case"image":case"link":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"input":fg(r,i),Ae("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ae("invalid",r);break;case"textarea":mg(r,i),Ae("invalid",r)}Ud(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var c=i[a];a==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&ll(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&ll(r.textContent,c,t),s=["children",""+c]):Pa.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&Ae("scroll",r)}switch(n){case"input":el(r),pg(r,i,!0);break;case"textarea":el(r),gg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Jl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=p_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[gn]=e,t[za]=r,Mw(t,e,!1,!1),e.stateNode=t;e:{switch(a=zd(n,r),n){case"dialog":Ae("cancel",t),Ae("close",t),s=r;break;case"iframe":case"object":case"embed":Ae("load",t),s=r;break;case"video":case"audio":for(s=0;s<la.length;s++)Ae(la[s],t);s=r;break;case"source":Ae("error",t),s=r;break;case"img":case"image":case"link":Ae("error",t),Ae("load",t),s=r;break;case"details":Ae("toggle",t),s=r;break;case"input":fg(t,r),s=Dd(t,r),Ae("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=De({},r,{value:void 0}),Ae("invalid",t);break;case"textarea":mg(t,r),s=Md(t,r),Ae("invalid",t);break;default:s=r}Ud(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?v_(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&m_(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ja(t,u):typeof u=="number"&&ja(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Pa.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ae("scroll",t):u!=null&&af(t,i,u,a))}switch(n){case"input":el(t),pg(t,r,!1);break;case"textarea":el(t),gg(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Cr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Gs(t,!!r.multiple,i,!1):r.defaultValue!=null&&Gs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Jl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ft(e),null;case 6:if(t&&e.stateNode!=null)Uw(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error($(166));if(n=es($a.current),es(_n.current),cl(e)){if(r=e.stateNode,n=e.memoizedProps,r[gn]=e,(i=r.nodeValue!==n)&&(t=zt,t!==null))switch(t.tag){case 3:ll(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ll(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[gn]=e,e.stateNode=r}return ft(e),null;case 13:if(Re(je),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ce&&Mt!==null&&e.mode&1&&!(e.flags&128))sw(),oi(),e.flags|=98560,i=!1;else if(i=cl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error($(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));i[gn]=e}else oi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ft(e),i=!1}else an!==null&&(Eh(an),an=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||je.current&1?Ke===0&&(Ke=3):Bf())),e.updateQueue!==null&&(e.flags|=4),ft(e),null);case 4:return ci(),fh(t,e),t===null&&Fa(e.stateNode.containerInfo),ft(e),null;case 10:return Nf(e.type._context),ft(e),null;case 17:return bt(e.type)&&Zl(),ft(e),null;case 19:if(Re(je),i=e.memoizedState,i===null)return ft(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)ea(i,!1);else{if(Ke!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=ac(t),a!==null){for(e.flags|=128,ea(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ne(je,je.current&1|2),e.child}t=t.sibling}i.tail!==null&&Be()>di&&(e.flags|=128,r=!0,ea(i,!1),e.lanes=4194304)}else{if(!r)if(t=ac(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ea(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ce)return ft(e),null}else 2*Be()-i.renderingStartTime>di&&n!==1073741824&&(e.flags|=128,r=!0,ea(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Be(),e.sibling=null,n=je.current,Ne(je,r?n&1|2:n&1),e):(ft(e),null);case 22:case 23:return zf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Vt&1073741824&&(ft(e),e.subtreeFlags&6&&(e.flags|=8192)):ft(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function BN(t,e){switch(Ef(e),e.tag){case 1:return bt(e.type)&&Zl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ci(),Re(jt),Re(_t),kf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Cf(e),null;case 13:if(Re(je),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error($(340));oi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Re(je),null;case 4:return ci(),null;case 10:return Nf(e.type._context),null;case 22:case 23:return zf(),null;case 24:return null;default:return null}}var hl=!1,gt=!1,$N=typeof WeakSet=="function"?WeakSet:Set,G=null;function qs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Me(t,e,r)}else n.current=null}function ph(t,e,n){try{n()}catch(r){Me(t,e,r)}}var iv=!1;function WN(t,e){if(Xd=Ql,t=q_(),_f(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,c=-1,u=-1,d=0,f=0,p=t,m=null;t:for(;;){for(var I;p!==n||s!==0&&p.nodeType!==3||(c=a+s),p!==i||r!==0&&p.nodeType!==3||(u=a+r),p.nodeType===3&&(a+=p.nodeValue.length),(I=p.firstChild)!==null;)m=p,p=I;for(;;){if(p===t)break t;if(m===n&&++d===s&&(c=a),m===i&&++f===r&&(u=a),(I=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=I}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Jd={focusedElem:t,selectionRange:n},Ql=!1,G=e;G!==null;)if(e=G,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,G=t;else for(;G!==null;){e=G;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var N=y.memoizedProps,T=y.memoizedState,x=e.stateNode,_=x.getSnapshotBeforeUpdate(e.elementType===e.type?N:rn(e.type,N),T);x.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(k){Me(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}return y=iv,iv=!1,y}function wa(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&ph(e,n,i)}s=s.next}while(s!==r)}}function Fc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function mh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function zw(t){var e=t.alternate;e!==null&&(t.alternate=null,zw(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gn],delete e[za],delete e[th],delete e[SN],delete e[AN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Bw(t){return t.tag===5||t.tag===3||t.tag===4}function av(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Bw(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function gh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Jl));else if(r!==4&&(t=t.child,t!==null))for(gh(t,e,n),t=t.sibling;t!==null;)gh(t,e,n),t=t.sibling}function vh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(vh(t,e,n),t=t.sibling;t!==null;)vh(t,e,n),t=t.sibling}var et=null,sn=!1;function er(t,e,n){for(n=n.child;n!==null;)$w(t,e,n),n=n.sibling}function $w(t,e,n){if(yn&&typeof yn.onCommitFiberUnmount=="function")try{yn.onCommitFiberUnmount(Pc,n)}catch{}switch(n.tag){case 5:gt||qs(n,e);case 6:var r=et,s=sn;et=null,er(t,e,n),et=r,sn=s,et!==null&&(sn?(t=et,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):et.removeChild(n.stateNode));break;case 18:et!==null&&(sn?(t=et,n=n.stateNode,t.nodeType===8?id(t.parentNode,n):t.nodeType===1&&id(t,n),La(t)):id(et,n.stateNode));break;case 4:r=et,s=sn,et=n.stateNode.containerInfo,sn=!0,er(t,e,n),et=r,sn=s;break;case 0:case 11:case 14:case 15:if(!gt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&ph(n,e,a),s=s.next}while(s!==r)}er(t,e,n);break;case 1:if(!gt&&(qs(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Me(n,e,c)}er(t,e,n);break;case 21:er(t,e,n);break;case 22:n.mode&1?(gt=(r=gt)||n.memoizedState!==null,er(t,e,n),gt=r):er(t,e,n);break;default:er(t,e,n)}}function ov(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new $N),e.forEach(function(r){var s=ZN.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function nn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,c=a;e:for(;c!==null;){switch(c.tag){case 5:et=c.stateNode,sn=!1;break e;case 3:et=c.stateNode.containerInfo,sn=!0;break e;case 4:et=c.stateNode.containerInfo,sn=!0;break e}c=c.return}if(et===null)throw Error($(160));$w(i,a,s),et=null,sn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Me(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Ww(e,t),e=e.sibling}function Ww(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(nn(e,t),pn(t),r&4){try{wa(3,t,t.return),Fc(3,t)}catch(N){Me(t,t.return,N)}try{wa(5,t,t.return)}catch(N){Me(t,t.return,N)}}break;case 1:nn(e,t),pn(t),r&512&&n!==null&&qs(n,n.return);break;case 5:if(nn(e,t),pn(t),r&512&&n!==null&&qs(n,n.return),t.flags&32){var s=t.stateNode;try{ja(s,"")}catch(N){Me(t,t.return,N)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&h_(s,i),zd(c,a);var d=zd(c,i);for(a=0;a<u.length;a+=2){var f=u[a],p=u[a+1];f==="style"?v_(s,p):f==="dangerouslySetInnerHTML"?m_(s,p):f==="children"?ja(s,p):af(s,f,p,d)}switch(c){case"input":Ld(s,i);break;case"textarea":f_(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var I=i.value;I!=null?Gs(s,!!i.multiple,I,!1):m!==!!i.multiple&&(i.defaultValue!=null?Gs(s,!!i.multiple,i.defaultValue,!0):Gs(s,!!i.multiple,i.multiple?[]:"",!1))}s[za]=i}catch(N){Me(t,t.return,N)}}break;case 6:if(nn(e,t),pn(t),r&4){if(t.stateNode===null)throw Error($(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(N){Me(t,t.return,N)}}break;case 3:if(nn(e,t),pn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{La(e.containerInfo)}catch(N){Me(t,t.return,N)}break;case 4:nn(e,t),pn(t);break;case 13:nn(e,t),pn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Ff=Be())),r&4&&ov(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(gt=(d=gt)||f,nn(e,t),gt=d):nn(e,t),pn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(G=t,f=t.child;f!==null;){for(p=G=f;G!==null;){switch(m=G,I=m.child,m.tag){case 0:case 11:case 14:case 15:wa(4,m,m.return);break;case 1:qs(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(N){Me(r,n,N)}}break;case 5:qs(m,m.return);break;case 22:if(m.memoizedState!==null){cv(p);continue}}I!==null?(I.return=m,G=I):cv(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=p.stateNode,u=p.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=g_("display",a))}catch(N){Me(t,t.return,N)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(N){Me(t,t.return,N)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:nn(e,t),pn(t),r&4&&ov(t);break;case 21:break;default:nn(e,t),pn(t)}}function pn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Bw(n)){var r=n;break e}n=n.return}throw Error($(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ja(s,""),r.flags&=-33);var i=av(t);vh(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,c=av(t);gh(t,c,a);break;default:throw Error($(161))}}catch(u){Me(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function qN(t,e,n){G=t,qw(t)}function qw(t,e,n){for(var r=(t.mode&1)!==0;G!==null;){var s=G,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||hl;if(!a){var c=s.alternate,u=c!==null&&c.memoizedState!==null||gt;c=hl;var d=gt;if(hl=a,(gt=u)&&!d)for(G=s;G!==null;)a=G,u=a.child,a.tag===22&&a.memoizedState!==null?uv(s):u!==null?(u.return=a,G=u):uv(s);for(;i!==null;)G=i,qw(i),i=i.sibling;G=s,hl=c,gt=d}lv(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,G=i):lv(t)}}function lv(t){for(;G!==null;){var e=G;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:gt||Fc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!gt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:rn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Hg(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Hg(e,a,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&La(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}gt||e.flags&512&&mh(e)}catch(m){Me(e,e.return,m)}}if(e===t){G=null;break}if(n=e.sibling,n!==null){n.return=e.return,G=n;break}G=e.return}}function cv(t){for(;G!==null;){var e=G;if(e===t){G=null;break}var n=e.sibling;if(n!==null){n.return=e.return,G=n;break}G=e.return}}function uv(t){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Fc(4,e)}catch(u){Me(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Me(e,s,u)}}var i=e.return;try{mh(e)}catch(u){Me(e,i,u)}break;case 5:var a=e.return;try{mh(e)}catch(u){Me(e,a,u)}}}catch(u){Me(e,e.return,u)}if(e===t){G=null;break}var c=e.sibling;if(c!==null){c.return=e.return,G=c;break}G=e.return}}var HN=Math.ceil,cc=Kn.ReactCurrentDispatcher,Vf=Kn.ReactCurrentOwner,Yt=Kn.ReactCurrentBatchConfig,fe=0,Je=null,We=null,rt=0,Vt=0,Hs=Lr(0),Ke=0,Ka=null,ds=0,Uc=0,Mf=0,Ea=null,kt=null,Ff=0,di=1/0,Rn=null,uc=!1,yh=null,xr=null,fl=!1,pr=null,dc=0,xa=0,_h=null,jl=-1,bl=0;function At(){return fe&6?Be():jl!==-1?jl:jl=Be()}function Ir(t){return t.mode&1?fe&2&&rt!==0?rt&-rt:CN.transition!==null?(bl===0&&(bl=C_()),bl):(t=we,t!==0||(t=window.event,t=t===void 0?16:L_(t.type)),t):1}function cn(t,e,n,r){if(50<xa)throw xa=0,_h=null,Error($(185));po(t,n,r),(!(fe&2)||t!==Je)&&(t===Je&&(!(fe&2)&&(Uc|=n),Ke===4&&ar(t,rt)),Ot(t,r),n===1&&fe===0&&!(e.mode&1)&&(di=Be()+500,Lc&&Vr()))}function Ot(t,e){var n=t.callbackNode;CT(t,e);var r=Gl(t,t===Je?rt:0);if(r===0)n!==null&&_g(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&_g(n),e===1)t.tag===0?RN(dv.bind(null,t)):tw(dv.bind(null,t)),TN(function(){!(fe&6)&&Vr()}),n=null;else{switch(k_(r)){case 1:n=df;break;case 4:n=A_;break;case 16:n=Kl;break;case 536870912:n=R_;break;default:n=Kl}n=Zw(n,Hw.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Hw(t,e){if(jl=-1,bl=0,fe&6)throw Error($(327));var n=t.callbackNode;if(Zs()&&t.callbackNode!==n)return null;var r=Gl(t,t===Je?rt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=hc(t,r);else{e=r;var s=fe;fe|=2;var i=Gw();(Je!==t||rt!==e)&&(Rn=null,di=Be()+500,rs(t,e));do try{QN();break}catch(c){Kw(t,c)}while(!0);Tf(),cc.current=i,fe=s,We!==null?e=0:(Je=null,rt=0,e=Ke)}if(e!==0){if(e===2&&(s=Hd(t),s!==0&&(r=s,e=wh(t,s))),e===1)throw n=Ka,rs(t,0),ar(t,r),Ot(t,Be()),n;if(e===6)ar(t,r);else{if(s=t.current.alternate,!(r&30)&&!KN(s)&&(e=hc(t,r),e===2&&(i=Hd(t),i!==0&&(r=i,e=wh(t,i))),e===1))throw n=Ka,rs(t,0),ar(t,r),Ot(t,Be()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error($(345));case 2:Yr(t,kt,Rn);break;case 3:if(ar(t,r),(r&130023424)===r&&(e=Ff+500-Be(),10<e)){if(Gl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){At(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=eh(Yr.bind(null,t,kt,Rn),e);break}Yr(t,kt,Rn);break;case 4:if(ar(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-ln(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=Be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*HN(r/1960))-r,10<r){t.timeoutHandle=eh(Yr.bind(null,t,kt,Rn),r);break}Yr(t,kt,Rn);break;case 5:Yr(t,kt,Rn);break;default:throw Error($(329))}}}return Ot(t,Be()),t.callbackNode===n?Hw.bind(null,t):null}function wh(t,e){var n=Ea;return t.current.memoizedState.isDehydrated&&(rs(t,e).flags|=256),t=hc(t,e),t!==2&&(e=kt,kt=n,e!==null&&Eh(e)),t}function Eh(t){kt===null?kt=t:kt.push.apply(kt,t)}function KN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!hn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ar(t,e){for(e&=~Mf,e&=~Uc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ln(e),r=1<<n;t[n]=-1,e&=~r}}function dv(t){if(fe&6)throw Error($(327));Zs();var e=Gl(t,0);if(!(e&1))return Ot(t,Be()),null;var n=hc(t,e);if(t.tag!==0&&n===2){var r=Hd(t);r!==0&&(e=r,n=wh(t,r))}if(n===1)throw n=Ka,rs(t,0),ar(t,e),Ot(t,Be()),n;if(n===6)throw Error($(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Yr(t,kt,Rn),Ot(t,Be()),null}function Uf(t,e){var n=fe;fe|=1;try{return t(e)}finally{fe=n,fe===0&&(di=Be()+500,Lc&&Vr())}}function hs(t){pr!==null&&pr.tag===0&&!(fe&6)&&Zs();var e=fe;fe|=1;var n=Yt.transition,r=we;try{if(Yt.transition=null,we=1,t)return t()}finally{we=r,Yt.transition=n,fe=e,!(fe&6)&&Vr()}}function zf(){Vt=Hs.current,Re(Hs)}function rs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,IN(n)),We!==null)for(n=We.return;n!==null;){var r=n;switch(Ef(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Zl();break;case 3:ci(),Re(jt),Re(_t),kf();break;case 5:Cf(r);break;case 4:ci();break;case 13:Re(je);break;case 19:Re(je);break;case 10:Nf(r.type._context);break;case 22:case 23:zf()}n=n.return}if(Je=t,We=t=Tr(t.current,null),rt=Vt=e,Ke=0,Ka=null,Mf=Uc=ds=0,kt=Ea=null,Zr!==null){for(e=0;e<Zr.length;e++)if(n=Zr[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}Zr=null}return t}function Kw(t,e){do{var n=We;try{if(Tf(),Cl.current=lc,oc){for(var r=be.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}oc=!1}if(us=0,Ye=He=be=null,_a=!1,Wa=0,Vf.current=null,n===null||n.return===null){Ke=1,Ka=e,We=null;break}e:{var i=t,a=n.return,c=n,u=e;if(e=rt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=c,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var I=Jg(a);if(I!==null){I.flags&=-257,Zg(I,a,c,i,e),I.mode&1&&Xg(i,d,e),e=I,u=d;var y=e.updateQueue;if(y===null){var N=new Set;N.add(u),e.updateQueue=N}else y.add(u);break e}else{if(!(e&1)){Xg(i,d,e),Bf();break e}u=Error($(426))}}else if(Ce&&c.mode&1){var T=Jg(a);if(T!==null){!(T.flags&65536)&&(T.flags|=256),Zg(T,a,c,i,e),xf(ui(u,c));break e}}i=u=ui(u,c),Ke!==4&&(Ke=2),Ea===null?Ea=[i]:Ea.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=kw(i,u,e);qg(i,x);break e;case 1:c=u;var _=i.type,E=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(xr===null||!xr.has(E)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=Pw(i,c,e);qg(i,k);break e}}i=i.return}while(i!==null)}Yw(n)}catch(O){e=O,We===n&&n!==null&&(We=n=n.return);continue}break}while(!0)}function Gw(){var t=cc.current;return cc.current=lc,t===null?lc:t}function Bf(){(Ke===0||Ke===3||Ke===2)&&(Ke=4),Je===null||!(ds&268435455)&&!(Uc&268435455)||ar(Je,rt)}function hc(t,e){var n=fe;fe|=2;var r=Gw();(Je!==t||rt!==e)&&(Rn=null,rs(t,e));do try{GN();break}catch(s){Kw(t,s)}while(!0);if(Tf(),fe=n,cc.current=r,We!==null)throw Error($(261));return Je=null,rt=0,Ke}function GN(){for(;We!==null;)Qw(We)}function QN(){for(;We!==null&&!wT();)Qw(We)}function Qw(t){var e=Jw(t.alternate,t,Vt);t.memoizedProps=t.pendingProps,e===null?Yw(t):We=e,Vf.current=null}function Yw(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=BN(n,e),n!==null){n.flags&=32767,We=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ke=6,We=null;return}}else if(n=zN(n,e,Vt),n!==null){We=n;return}if(e=e.sibling,e!==null){We=e;return}We=e=t}while(e!==null);Ke===0&&(Ke=5)}function Yr(t,e,n){var r=we,s=Yt.transition;try{Yt.transition=null,we=1,YN(t,e,n,r)}finally{Yt.transition=s,we=r}return null}function YN(t,e,n,r){do Zs();while(pr!==null);if(fe&6)throw Error($(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error($(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(kT(t,i),t===Je&&(We=Je=null,rt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||fl||(fl=!0,Zw(Kl,function(){return Zs(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Yt.transition,Yt.transition=null;var a=we;we=1;var c=fe;fe|=4,Vf.current=null,WN(t,n),Ww(n,t),gN(Jd),Ql=!!Xd,Jd=Xd=null,t.current=n,qN(n),ET(),fe=c,we=a,Yt.transition=i}else t.current=n;if(fl&&(fl=!1,pr=t,dc=s),i=t.pendingLanes,i===0&&(xr=null),TT(n.stateNode),Ot(t,Be()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(uc)throw uc=!1,t=yh,yh=null,t;return dc&1&&t.tag!==0&&Zs(),i=t.pendingLanes,i&1?t===_h?xa++:(xa=0,_h=t):xa=0,Vr(),null}function Zs(){if(pr!==null){var t=k_(dc),e=Yt.transition,n=we;try{if(Yt.transition=null,we=16>t?16:t,pr===null)var r=!1;else{if(t=pr,pr=null,dc=0,fe&6)throw Error($(331));var s=fe;for(fe|=4,G=t.current;G!==null;){var i=G,a=i.child;if(G.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(G=d;G!==null;){var f=G;switch(f.tag){case 0:case 11:case 15:wa(8,f,i)}var p=f.child;if(p!==null)p.return=f,G=p;else for(;G!==null;){f=G;var m=f.sibling,I=f.return;if(zw(f),f===d){G=null;break}if(m!==null){m.return=I,G=m;break}G=I}}}var y=i.alternate;if(y!==null){var N=y.child;if(N!==null){y.child=null;do{var T=N.sibling;N.sibling=null,N=T}while(N!==null)}}G=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,G=a;else e:for(;G!==null;){if(i=G,i.flags&2048)switch(i.tag){case 0:case 11:case 15:wa(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,G=x;break e}G=i.return}}var _=t.current;for(G=_;G!==null;){a=G;var E=a.child;if(a.subtreeFlags&2064&&E!==null)E.return=a,G=E;else e:for(a=_;G!==null;){if(c=G,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Fc(9,c)}}catch(O){Me(c,c.return,O)}if(c===a){G=null;break e}var k=c.sibling;if(k!==null){k.return=c.return,G=k;break e}G=c.return}}if(fe=s,Vr(),yn&&typeof yn.onPostCommitFiberRoot=="function")try{yn.onPostCommitFiberRoot(Pc,t)}catch{}r=!0}return r}finally{we=n,Yt.transition=e}}return!1}function hv(t,e,n){e=ui(n,e),e=kw(t,e,1),t=Er(t,e,1),e=At(),t!==null&&(po(t,1,e),Ot(t,e))}function Me(t,e,n){if(t.tag===3)hv(t,t,n);else for(;e!==null;){if(e.tag===3){hv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(xr===null||!xr.has(r))){t=ui(n,t),t=Pw(e,t,1),e=Er(e,t,1),t=At(),e!==null&&(po(e,1,t),Ot(e,t));break}}e=e.return}}function XN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=At(),t.pingedLanes|=t.suspendedLanes&n,Je===t&&(rt&n)===n&&(Ke===4||Ke===3&&(rt&130023424)===rt&&500>Be()-Ff?rs(t,0):Mf|=n),Ot(t,e)}function Xw(t,e){e===0&&(t.mode&1?(e=rl,rl<<=1,!(rl&130023424)&&(rl=4194304)):e=1);var n=At();t=Un(t,e),t!==null&&(po(t,e,n),Ot(t,n))}function JN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Xw(t,n)}function ZN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(e),Xw(t,n)}var Jw;Jw=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||jt.current)Pt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Pt=!1,UN(t,e,n);Pt=!!(t.flags&131072)}else Pt=!1,Ce&&e.flags&1048576&&nw(e,nc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Pl(t,e),t=e.pendingProps;var s=ai(e,_t.current);Js(e,n),s=jf(null,e,r,t,s,n);var i=bf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,bt(r)?(i=!0,ec(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Af(e),s.updater=Mc,e.stateNode=s,s._reactInternals=e,oh(e,r,t,n),e=uh(null,e,r,!0,i,n)):(e.tag=0,Ce&&i&&wf(e),Nt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Pl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=tS(r),t=rn(r,t),s){case 0:e=ch(null,e,r,t,n);break e;case 1:e=nv(null,e,r,t,n);break e;case 11:e=ev(null,e,r,t,n);break e;case 14:e=tv(null,e,r,rn(r.type,t),n);break e}throw Error($(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:rn(r,s),ch(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:rn(r,s),nv(t,e,r,s,n);case 3:e:{if(Dw(e),t===null)throw Error($(387));r=e.pendingProps,i=e.memoizedState,s=i.element,lw(t,e),ic(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ui(Error($(423)),e),e=rv(t,e,r,n,s);break e}else if(r!==s){s=ui(Error($(424)),e),e=rv(t,e,r,n,s);break e}else for(Mt=wr(e.stateNode.containerInfo.firstChild),zt=e,Ce=!0,an=null,n=aw(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(oi(),r===s){e=zn(t,e,n);break e}Nt(t,e,r,n)}e=e.child}return e;case 5:return cw(e),t===null&&sh(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Zd(r,s)?a=null:i!==null&&Zd(r,i)&&(e.flags|=32),Ow(t,e),Nt(t,e,a,n),e.child;case 6:return t===null&&sh(e),null;case 13:return Lw(t,e,n);case 4:return Rf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=li(e,null,r,n):Nt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:rn(r,s),ev(t,e,r,s,n);case 7:return Nt(t,e,e.pendingProps,n),e.child;case 8:return Nt(t,e,e.pendingProps.children,n),e.child;case 12:return Nt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Ne(rc,r._currentValue),r._currentValue=a,i!==null)if(hn(i.value,a)){if(i.children===s.children&&!jt.current){e=zn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){a=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Ln(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),ih(i.return,n,e),c.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error($(341));a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),ih(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Nt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Js(e,n),s=Xt(s),r=r(s),e.flags|=1,Nt(t,e,r,n),e.child;case 14:return r=e.type,s=rn(r,e.pendingProps),s=rn(r.type,s),tv(t,e,r,s,n);case 15:return jw(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:rn(r,s),Pl(t,e),e.tag=1,bt(r)?(t=!0,ec(e)):t=!1,Js(e,n),Cw(e,r,s),oh(e,r,s,n),uh(null,e,r,!0,t,n);case 19:return Vw(t,e,n);case 22:return bw(t,e,n)}throw Error($(156,e.tag))};function Zw(t,e){return S_(t,e)}function eS(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(t,e,n,r){return new eS(t,e,n,r)}function $f(t){return t=t.prototype,!(!t||!t.isReactComponent)}function tS(t){if(typeof t=="function")return $f(t)?1:0;if(t!=null){if(t=t.$$typeof,t===lf)return 11;if(t===cf)return 14}return 2}function Tr(t,e){var n=t.alternate;return n===null?(n=Qt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ol(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")$f(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Ls:return ss(n.children,s,i,e);case of:a=8,s|=8;break;case Pd:return t=Qt(12,n,e,s|2),t.elementType=Pd,t.lanes=i,t;case jd:return t=Qt(13,n,e,s),t.elementType=jd,t.lanes=i,t;case bd:return t=Qt(19,n,e,s),t.elementType=bd,t.lanes=i,t;case c_:return zc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case o_:a=10;break e;case l_:a=9;break e;case lf:a=11;break e;case cf:a=14;break e;case rr:a=16,r=null;break e}throw Error($(130,t==null?t:typeof t,""))}return e=Qt(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ss(t,e,n,r){return t=Qt(7,t,r,e),t.lanes=n,t}function zc(t,e,n,r){return t=Qt(22,t,r,e),t.elementType=c_,t.lanes=n,t.stateNode={isHidden:!1},t}function fd(t,e,n){return t=Qt(6,t,null,e),t.lanes=n,t}function pd(t,e,n){return e=Qt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function nS(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gu(0),this.expirationTimes=Gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Wf(t,e,n,r,s,i,a,c,u){return t=new nS(t,e,n,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Qt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Af(i),t}function rS(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ds,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function eE(t){if(!t)return kr;t=t._reactInternals;e:{if(xs(t)!==t||t.tag!==1)throw Error($(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(bt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(t.tag===1){var n=t.type;if(bt(n))return ew(t,n,e)}return e}function tE(t,e,n,r,s,i,a,c,u){return t=Wf(n,r,!0,t,s,i,a,c,u),t.context=eE(null),n=t.current,r=At(),s=Ir(n),i=Ln(r,s),i.callback=e??null,Er(n,i,s),t.current.lanes=s,po(t,s,r),Ot(t,r),t}function Bc(t,e,n,r){var s=e.current,i=At(),a=Ir(s);return n=eE(n),e.context===null?e.context=n:e.pendingContext=n,e=Ln(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Er(s,e,a),t!==null&&(cn(t,s,a,i),Rl(t,s,a)),a}function fc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function qf(t,e){fv(t,e),(t=t.alternate)&&fv(t,e)}function sS(){return null}var nE=typeof reportError=="function"?reportError:function(t){console.error(t)};function Hf(t){this._internalRoot=t}$c.prototype.render=Hf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error($(409));Bc(t,e,null,null)};$c.prototype.unmount=Hf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;hs(function(){Bc(null,t,null,null)}),e[Fn]=null}};function $c(t){this._internalRoot=t}$c.prototype.unstable_scheduleHydration=function(t){if(t){var e=b_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ir.length&&e!==0&&e<ir[n].priority;n++);ir.splice(n,0,t),n===0&&D_(t)}};function Kf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Wc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pv(){}function iS(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=fc(a);i.call(d)}}var a=tE(e,r,t,0,null,!1,!1,"",pv);return t._reactRootContainer=a,t[Fn]=a.current,Fa(t.nodeType===8?t.parentNode:t),hs(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=fc(u);c.call(d)}}var u=Wf(t,0,!1,null,null,!1,!1,"",pv);return t._reactRootContainer=u,t[Fn]=u.current,Fa(t.nodeType===8?t.parentNode:t),hs(function(){Bc(e,u,n,r)}),u}function qc(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var c=s;s=function(){var u=fc(a);c.call(u)}}Bc(e,a,t,s)}else a=iS(n,e,t,s,r);return fc(a)}P_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=oa(e.pendingLanes);n!==0&&(hf(e,n|1),Ot(e,Be()),!(fe&6)&&(di=Be()+500,Vr()))}break;case 13:hs(function(){var r=Un(t,1);if(r!==null){var s=At();cn(r,t,1,s)}}),qf(t,1)}};ff=function(t){if(t.tag===13){var e=Un(t,134217728);if(e!==null){var n=At();cn(e,t,134217728,n)}qf(t,134217728)}};j_=function(t){if(t.tag===13){var e=Ir(t),n=Un(t,e);if(n!==null){var r=At();cn(n,t,e,r)}qf(t,e)}};b_=function(){return we};O_=function(t,e){var n=we;try{return we=t,e()}finally{we=n}};$d=function(t,e,n){switch(e){case"input":if(Ld(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Dc(r);if(!s)throw Error($(90));d_(r),Ld(r,s)}}}break;case"textarea":f_(t,n);break;case"select":e=n.value,e!=null&&Gs(t,!!n.multiple,e,!1)}};w_=Uf;E_=hs;var aS={usingClientEntryPoint:!1,Events:[go,Us,Dc,y_,__,Uf]},ta={findFiberByHostInstance:Jr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oS={bundleType:ta.bundleType,version:ta.version,rendererPackageName:ta.rendererPackageName,rendererConfig:ta.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Kn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=T_(t),t===null?null:t.stateNode},findFiberByHostInstance:ta.findFiberByHostInstance||sS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pl.isDisabled&&pl.supportsFiber)try{Pc=pl.inject(oS),yn=pl}catch{}}Wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aS;Wt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Kf(e))throw Error($(200));return rS(t,e,null,n)};Wt.createRoot=function(t,e){if(!Kf(t))throw Error($(299));var n=!1,r="",s=nE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Wf(t,1,!1,null,null,n,!1,r,s),t[Fn]=e.current,Fa(t.nodeType===8?t.parentNode:t),new Hf(e)};Wt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error($(188)):(t=Object.keys(t).join(","),Error($(268,t)));return t=T_(e),t=t===null?null:t.stateNode,t};Wt.flushSync=function(t){return hs(t)};Wt.hydrate=function(t,e,n){if(!Wc(e))throw Error($(200));return qc(null,t,e,!0,n)};Wt.hydrateRoot=function(t,e,n){if(!Kf(t))throw Error($(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=nE;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=tE(e,null,t,1,n??null,s,!1,i,a),t[Fn]=e.current,Fa(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new $c(e)};Wt.render=function(t,e,n){if(!Wc(e))throw Error($(200));return qc(null,t,e,!1,n)};Wt.unmountComponentAtNode=function(t){if(!Wc(t))throw Error($(40));return t._reactRootContainer?(hs(function(){qc(null,null,t,!1,function(){t._reactRootContainer=null,t[Fn]=null})}),!0):!1};Wt.unstable_batchedUpdates=Uf;Wt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Wc(n))throw Error($(200));if(t==null||t._reactInternals===void 0)throw Error($(38));return qc(t,e,n,!1,r)};Wt.version="18.3.1-next-f1338f8080-20240426";function rE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rE)}catch(t){console.error(t)}}rE(),r_.exports=Wt;var sE=r_.exports,iE,mv=sE;iE=mv.createRoot,mv.hydrateRoot;/**
 * @remix-run/router v1.15.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ga(){return Ga=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ga.apply(this,arguments)}var mr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(mr||(mr={}));const gv="popstate";function lS(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:a,hash:c}=r.location;return xh("",{pathname:i,search:a,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:pc(s)}return uS(e,n,null,t)}function Oe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function aE(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function cS(){return Math.random().toString(36).substr(2,8)}function vv(t,e){return{usr:t.state,key:t.key,idx:e}}function xh(t,e,n,r){return n===void 0&&(n=null),Ga({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ti(e):e,{state:n,key:e&&e.key||r||cS()})}function pc(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ti(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function uS(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,c=mr.Pop,u=null,d=f();d==null&&(d=0,a.replaceState(Ga({},a.state,{idx:d}),""));function f(){return(a.state||{idx:null}).idx}function p(){c=mr.Pop;let T=f(),x=T==null?null:T-d;d=T,u&&u({action:c,location:N.location,delta:x})}function m(T,x){c=mr.Push;let _=xh(N.location,T,x);d=f()+1;let E=vv(_,d),k=N.createHref(_);try{a.pushState(E,"",k)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(k)}i&&u&&u({action:c,location:N.location,delta:1})}function I(T,x){c=mr.Replace;let _=xh(N.location,T,x);d=f();let E=vv(_,d),k=N.createHref(_);a.replaceState(E,"",k),i&&u&&u({action:c,location:N.location,delta:0})}function y(T){let x=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof T=="string"?T:pc(T);return _=_.replace(/ $/,"%20"),Oe(x,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,x)}let N={get action(){return c},get location(){return t(s,a)},listen(T){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(gv,p),u=T,()=>{s.removeEventListener(gv,p),u=null}},createHref(T){return e(s,T)},createURL:y,encodeLocation(T){let x=y(T);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:m,replace:I,go(T){return a.go(T)}};return N}var yv;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(yv||(yv={}));function dS(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Ti(e):e,s=hi(r.pathname||"/",n);if(s==null)return null;let i=oE(t);hS(i);let a=null;for(let c=0;a==null&&c<i.length;++c){let u=IS(s);a=ES(i[c],u)}return a}function oE(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,a,c)=>{let u={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith("/")&&(Oe(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=Nr([r,u.relativePath]),f=n.concat(u);i.children&&i.children.length>0&&(Oe(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),oE(i.children,e,f,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:_S(d,i.index),routesMeta:f})};return t.forEach((i,a)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))s(i,a);else for(let u of lE(i.path))s(i,a,u)}),e}function lE(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=lE(r.join("/")),c=[];return c.push(...a.map(u=>u===""?i:[i,u].join("/"))),s&&c.push(...a),c.map(u=>t.startsWith("/")&&u===""?"/":u)}function hS(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:wS(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const fS=/^:[\w-]+$/,pS=3,mS=2,gS=1,vS=10,yS=-2,_v=t=>t==="*";function _S(t,e){let n=t.split("/"),r=n.length;return n.some(_v)&&(r+=yS),e&&(r+=mS),n.filter(s=>!_v(s)).reduce((s,i)=>s+(fS.test(i)?pS:i===""?gS:vS),r)}function wS(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function ES(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let a=0;a<n.length;++a){let c=n[a],u=a===n.length-1,d=s==="/"?e:e.slice(s.length)||"/",f=Ih({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d);if(!f)return null;Object.assign(r,f.params);let p=c.route;i.push({params:r,pathname:Nr([s,f.pathname]),pathnameBase:AS(Nr([s,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(s=Nr([s,f.pathnameBase]))}return i}function Ih(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=xS(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:r.reduce((d,f,p)=>{let{paramName:m,isOptional:I}=f;if(m==="*"){let N=c[p]||"";a=i.slice(0,i.length-N.length).replace(/(.)\/+$/,"$1")}const y=c[p];return I&&!y?d[m]=void 0:d[m]=(y||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:a,pattern:t}}function xS(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),aE(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function IS(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return aE(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function hi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function TS(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Ti(t):t;return{pathname:n?n.startsWith("/")?n:NS(n,e):e,search:RS(r),hash:CS(s)}}function NS(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function md(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function SS(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Gf(t,e){let n=SS(t);return e?n.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Qf(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Ti(t):(s=Ga({},t),Oe(!s.pathname||!s.pathname.includes("?"),md("?","pathname","search",s)),Oe(!s.pathname||!s.pathname.includes("#"),md("#","pathname","hash",s)),Oe(!s.search||!s.search.includes("#"),md("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,c;if(a==null)c=n;else{let p=e.length-1;if(!r&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),p-=1;s.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=TS(s,c),d=a&&a!=="/"&&a.endsWith("/"),f=(i||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||f)&&(u.pathname+="/"),u}const Nr=t=>t.join("/").replace(/\/\/+/g,"/"),AS=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),RS=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,CS=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function kS(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const cE=["post","put","patch","delete"];new Set(cE);const PS=["get",...cE];new Set(PS);/**
 * React Router v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qa(){return Qa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qa.apply(this,arguments)}const Hc=b.createContext(null),uE=b.createContext(null),Gn=b.createContext(null),Kc=b.createContext(null),Mr=b.createContext({outlet:null,matches:[],isDataRoute:!1}),dE=b.createContext(null);function jS(t,e){let{relative:n}=e===void 0?{}:e;Ni()||Oe(!1);let{basename:r,navigator:s}=b.useContext(Gn),{hash:i,pathname:a,search:c}=Gc(t,{relative:n}),u=a;return r!=="/"&&(u=a==="/"?r:Nr([r,a])),s.createHref({pathname:u,search:c,hash:i})}function Ni(){return b.useContext(Kc)!=null}function Is(){return Ni()||Oe(!1),b.useContext(Kc).location}function hE(t){b.useContext(Gn).static||b.useLayoutEffect(t)}function Qn(){let{isDataRoute:t}=b.useContext(Mr);return t?qS():bS()}function bS(){Ni()||Oe(!1);let t=b.useContext(Hc),{basename:e,future:n,navigator:r}=b.useContext(Gn),{matches:s}=b.useContext(Mr),{pathname:i}=Is(),a=JSON.stringify(Gf(s,n.v7_relativeSplatPath)),c=b.useRef(!1);return hE(()=>{c.current=!0}),b.useCallback(function(d,f){if(f===void 0&&(f={}),!c.current)return;if(typeof d=="number"){r.go(d);return}let p=Qf(d,JSON.parse(a),i,f.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Nr([e,p.pathname])),(f.replace?r.replace:r.push)(p,f.state,f)},[e,r,a,i,t])}function Gc(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=b.useContext(Gn),{matches:s}=b.useContext(Mr),{pathname:i}=Is(),a=JSON.stringify(Gf(s,r.v7_relativeSplatPath));return b.useMemo(()=>Qf(t,JSON.parse(a),i,n==="path"),[t,a,i,n])}function OS(t,e){return DS(t,e)}function DS(t,e,n,r){Ni()||Oe(!1);let{navigator:s}=b.useContext(Gn),{matches:i}=b.useContext(Mr),a=i[i.length-1],c=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let d=Is(),f;if(e){var p;let T=typeof e=="string"?Ti(e):e;u==="/"||(p=T.pathname)!=null&&p.startsWith(u)||Oe(!1),f=T}else f=d;let m=f.pathname||"/",I=m;if(u!=="/"){let T=u.replace(/^\//,"").split("/");I="/"+m.replace(/^\//,"").split("/").slice(T.length).join("/")}let y=dS(t,{pathname:I}),N=US(y&&y.map(T=>Object.assign({},T,{params:Object.assign({},c,T.params),pathname:Nr([u,s.encodeLocation?s.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?u:Nr([u,s.encodeLocation?s.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),i,n,r);return e&&N?b.createElement(Kc.Provider,{value:{location:Qa({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:mr.Pop}},N):N}function LS(){let t=WS(),e=kS(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),n?b.createElement("pre",{style:s},n):null,null)}const VS=b.createElement(LS,null);class MS extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?b.createElement(Mr.Provider,{value:this.props.routeContext},b.createElement(dE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function FS(t){let{routeContext:e,match:n,children:r}=t,s=b.useContext(Hc);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),b.createElement(Mr.Provider,{value:e},r)}function US(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if((i=n)!=null&&i.errors)t=n.matches;else return null}let a=t,c=(s=n)==null?void 0:s.errors;if(c!=null){let f=a.findIndex(p=>p.route.id&&(c==null?void 0:c[p.route.id]));f>=0||Oe(!1),a=a.slice(0,Math.min(a.length,f+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let f=0;f<a.length;f++){let p=a[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=f),p.route.id){let{loaderData:m,errors:I}=n,y=p.route.loader&&m[p.route.id]===void 0&&(!I||I[p.route.id]===void 0);if(p.route.lazy||y){u=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,p,m)=>{let I,y=!1,N=null,T=null;n&&(I=c&&p.route.id?c[p.route.id]:void 0,N=p.route.errorElement||VS,u&&(d<0&&m===0?(HS("route-fallback"),y=!0,T=null):d===m&&(y=!0,T=p.route.hydrateFallbackElement||null)));let x=e.concat(a.slice(0,m+1)),_=()=>{let E;return I?E=N:y?E=T:p.route.Component?E=b.createElement(p.route.Component,null):p.route.element?E=p.route.element:E=f,b.createElement(FS,{match:p,routeContext:{outlet:f,matches:x,isDataRoute:n!=null},children:E})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?b.createElement(MS,{location:n.location,revalidation:n.revalidation,component:N,error:I,children:_(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):_()},null)}var fE=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(fE||{}),pE=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(pE||{});function zS(t){let e=b.useContext(Hc);return e||Oe(!1),e}function BS(t){let e=b.useContext(uE);return e||Oe(!1),e}function $S(t){let e=b.useContext(Mr);return e||Oe(!1),e}function mE(t){let e=$S(),n=e.matches[e.matches.length-1];return n.route.id||Oe(!1),n.route.id}function WS(){var t;let e=b.useContext(dE),n=BS(),r=mE();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function qS(){let{router:t}=zS(fE.UseNavigateStable),e=mE(pE.UseNavigateStable),n=b.useRef(!1);return hE(()=>{n.current=!0}),b.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Qa({fromRouteId:e},i)))},[t,e])}const wv={};function HS(t,e,n){wv[t]||(wv[t]=!0)}function tr(t){let{to:e,replace:n,state:r,relative:s}=t;Ni()||Oe(!1);let{future:i,static:a}=b.useContext(Gn),{matches:c}=b.useContext(Mr),{pathname:u}=Is(),d=Qn(),f=Qf(e,Gf(c,i.v7_relativeSplatPath),u,s==="path"),p=JSON.stringify(f);return b.useEffect(()=>d(JSON.parse(p),{replace:n,state:r,relative:s}),[d,p,s,n,r]),null}function Ht(t){Oe(!1)}function KS(t){let{basename:e="/",children:n=null,location:r,navigationType:s=mr.Pop,navigator:i,static:a=!1,future:c}=t;Ni()&&Oe(!1);let u=e.replace(/^\/*/,"/"),d=b.useMemo(()=>({basename:u,navigator:i,static:a,future:Qa({v7_relativeSplatPath:!1},c)}),[u,c,i,a]);typeof r=="string"&&(r=Ti(r));let{pathname:f="/",search:p="",hash:m="",state:I=null,key:y="default"}=r,N=b.useMemo(()=>{let T=hi(f,u);return T==null?null:{location:{pathname:T,search:p,hash:m,state:I,key:y},navigationType:s}},[u,f,p,m,I,y,s]);return N==null?null:b.createElement(Gn.Provider,{value:d},b.createElement(Kc.Provider,{children:n,value:N}))}function GS(t){let{children:e,location:n}=t;return OS(Th(e),n)}new Promise(()=>{});function Th(t,e){e===void 0&&(e=[]);let n=[];return b.Children.forEach(t,(r,s)=>{if(!b.isValidElement(r))return;let i=[...e,s];if(r.type===b.Fragment){n.push.apply(n,Th(r.props.children,i));return}r.type!==Ht&&Oe(!1),!r.props.index||!r.props.children||Oe(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Th(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function mc(){return mc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},mc.apply(this,arguments)}function gE(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function QS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function YS(t,e){return t.button===0&&(!e||e==="_self")&&!QS(t)}function Nh(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function XS(t,e){let n=Nh(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const JS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],ZS=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],eA="6";try{window.__reactRouterVersion=eA}catch{}const tA=b.createContext({isTransitioning:!1}),nA="startTransition",Ev=X0[nA];function rA(t){let{basename:e,children:n,future:r,window:s}=t,i=b.useRef();i.current==null&&(i.current=lS({window:s,v5Compat:!0}));let a=i.current,[c,u]=b.useState({action:a.action,location:a.location}),{v7_startTransition:d}=r||{},f=b.useCallback(p=>{d&&Ev?Ev(()=>u(p)):u(p)},[u,d]);return b.useLayoutEffect(()=>a.listen(f),[a,f]),b.createElement(KS,{basename:e,children:n,location:c.location,navigationType:c.action,navigator:a,future:r})}const sA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",iA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ya=b.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:a,state:c,target:u,to:d,preventScrollReset:f,unstable_viewTransition:p}=e,m=gE(e,JS),{basename:I}=b.useContext(Gn),y,N=!1;if(typeof d=="string"&&iA.test(d)&&(y=d,sA))try{let E=new URL(window.location.href),k=d.startsWith("//")?new URL(E.protocol+d):new URL(d),O=hi(k.pathname,I);k.origin===E.origin&&O!=null?d=O+k.search+k.hash:N=!0}catch{}let T=jS(d,{relative:s}),x=lA(d,{replace:a,state:c,target:u,preventScrollReset:f,relative:s,unstable_viewTransition:p});function _(E){r&&r(E),E.defaultPrevented||x(E)}return b.createElement("a",mc({},m,{href:y||T,onClick:N||i?r:_,ref:n,target:u}))}),aA=b.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:a=!1,style:c,to:u,unstable_viewTransition:d,children:f}=e,p=gE(e,ZS),m=Gc(u,{relative:p.relative}),I=Is(),y=b.useContext(uE),{navigator:N,basename:T}=b.useContext(Gn),x=y!=null&&cA(m)&&d===!0,_=N.encodeLocation?N.encodeLocation(m).pathname:m.pathname,E=I.pathname,k=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;s||(E=E.toLowerCase(),k=k?k.toLowerCase():null,_=_.toLowerCase()),k&&T&&(k=hi(k,T)||k);const O=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let D=E===_||!a&&E.startsWith(_)&&E.charAt(O)==="/",w=k!=null&&(k===_||!a&&k.startsWith(_)&&k.charAt(_.length)==="/"),v={isActive:D,isPending:w,isTransitioning:x},A=D?r:void 0,P;typeof i=="function"?P=i(v):P=[i,D?"active":null,w?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let C=typeof c=="function"?c(v):c;return b.createElement(Ya,mc({},p,{"aria-current":A,className:P,ref:n,style:C,to:u,unstable_viewTransition:d}),typeof f=="function"?f(v):f)});var Sh;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Sh||(Sh={}));var xv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(xv||(xv={}));function oA(t){let e=b.useContext(Hc);return e||Oe(!1),e}function lA(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:a,unstable_viewTransition:c}=e===void 0?{}:e,u=Qn(),d=Is(),f=Gc(t,{relative:a});return b.useCallback(p=>{if(YS(p,n)){p.preventDefault();let m=r!==void 0?r:pc(d)===pc(f);u(t,{replace:m,state:s,preventScrollReset:i,relative:a,unstable_viewTransition:c})}},[d,u,f,r,s,n,t,i,a,c])}function Yf(t){let e=b.useRef(Nh(t)),n=b.useRef(!1),r=Is(),s=b.useMemo(()=>XS(r.search,n.current?null:e.current),[r.search]),i=Qn(),a=b.useCallback((c,u)=>{const d=Nh(typeof c=="function"?c(s):c);n.current=!0,i("?"+d,u)},[i,s]);return[s,a]}function cA(t,e){e===void 0&&(e={});let n=b.useContext(tA);n==null&&Oe(!1);let{basename:r}=oA(Sh.useViewTransitionState),s=Gc(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=hi(n.currentLocation.pathname,r)||n.currentLocation.pathname,a=hi(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Ih(s.pathname,a)!=null||Ih(s.pathname,i)!=null}var Iv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},uA=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],c=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},yE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,c=a?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,p=(i&3)<<4|c>>4;let m=(c&15)<<2|d>>6,I=d&63;u||(I=64,a||(m=64)),r.push(n[f],n[p],n[m],n[I])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(vE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):uA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||d==null||p==null)throw new dA;const m=i<<2|c>>4;if(r.push(m),d!==64){const I=c<<4&240|d>>2;if(r.push(I),p!==64){const y=d<<6&192|p;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class dA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const hA=function(t){const e=vE(t);return yE.encodeByteArray(e,!0)},gc=function(t){return hA(t).replace(/\./g,"")},_E=function(t){try{return yE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA=()=>fA().__FIREBASE_DEFAULTS__,mA=()=>{if(typeof process>"u"||typeof Iv>"u")return;const t=Iv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},gA=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&_E(t[1]);return e&&JSON.parse(e)},Qc=()=>{try{return pA()||mA()||gA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},wE=t=>{var e,n;return(n=(e=Qc())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},EE=t=>{const e=wE(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},xE=()=>{var t;return(t=Qc())===null||t===void 0?void 0:t.config},IE=t=>{var e;return(e=Qc())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[gc(JSON.stringify(n)),gc(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function yA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(wt())}function _A(){var t;const e=(t=Qc())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function wA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function EA(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function xA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function IA(){const t=wt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function TA(){return!_A()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function NA(){try{return typeof indexedDB=="object"}catch{return!1}}function SA(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA="FirebaseError";class Nn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=AA,Object.setPrototypeOf(this,Nn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yo.prototype.create)}}class yo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?RA(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new Nn(s,c,r)}}function RA(t,e){return t.replace(CA,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const CA=/\{\$([^}]+)}/g;function kA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Xa(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(Tv(i)&&Tv(a)){if(!Xa(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Tv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _o(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ca(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function ua(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function PA(t,e){const n=new jA(t,e);return n.subscribe.bind(n)}class jA{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");bA(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=gd),s.error===void 0&&(s.error=gd),s.complete===void 0&&(s.complete=gd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bA(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function gd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(t){return t&&t._delegate?t._delegate:t}class Pr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new vA;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(LA(e))try{this.getOrInitializeService({instanceIdentifier:Xr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Xr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xr){return this.instances.has(e)}getOptions(e=Xr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:DA(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xr){return this.component?this.component.multipleInstances?e:Xr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function DA(t){return t===Xr?void 0:t}function LA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new OA(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ue;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ue||(ue={}));const MA={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},FA=ue.INFO,UA={[ue.DEBUG]:"log",[ue.VERBOSE]:"log",[ue.INFO]:"info",[ue.WARN]:"warn",[ue.ERROR]:"error"},zA=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=UA[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Xf{constructor(e){this.name=e,this._logLevel=FA,this._logHandler=zA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?MA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ue.DEBUG,...e),this._logHandler(this,ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ue.VERBOSE,...e),this._logHandler(this,ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ue.INFO,...e),this._logHandler(this,ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ue.WARN,...e),this._logHandler(this,ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ue.ERROR,...e),this._logHandler(this,ue.ERROR,...e)}}const BA=(t,e)=>e.some(n=>t instanceof n);let Nv,Sv;function $A(){return Nv||(Nv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function WA(){return Sv||(Sv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const NE=new WeakMap,Ah=new WeakMap,SE=new WeakMap,vd=new WeakMap,Jf=new WeakMap;function qA(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Sr(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&NE.set(n,t)}).catch(()=>{}),Jf.set(e,t),e}function HA(t){if(Ah.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Ah.set(t,e)}let Rh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ah.get(t);if(e==="objectStoreNames")return t.objectStoreNames||SE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Sr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function KA(t){Rh=t(Rh)}function GA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(yd(this),e,...n);return SE.set(r,e.sort?e.sort():[e]),Sr(r)}:WA().includes(t)?function(...e){return t.apply(yd(this),e),Sr(NE.get(this))}:function(...e){return Sr(t.apply(yd(this),e))}}function QA(t){return typeof t=="function"?GA(t):(t instanceof IDBTransaction&&HA(t),BA(t,$A())?new Proxy(t,Rh):t)}function Sr(t){if(t instanceof IDBRequest)return qA(t);if(vd.has(t))return vd.get(t);const e=QA(t);return e!==t&&(vd.set(t,e),Jf.set(e,t)),e}const yd=t=>Jf.get(t);function YA(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),c=Sr(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Sr(a.result),u.oldVersion,u.newVersion,Sr(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const XA=["get","getKey","getAll","getAllKeys","count"],JA=["put","add","delete","clear"],_d=new Map;function Av(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(_d.get(e))return _d.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=JA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||XA.includes(n)))return;const i=async function(a,...c){const u=this.transaction(a,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),s&&u.done]))[0]};return _d.set(e,i),i}KA(t=>({...t,get:(e,n,r)=>Av(e,n)||t.get(e,n,r),has:(e,n)=>!!Av(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(eR(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function eR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ch="@firebase/app",Rv="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn=new Xf("@firebase/app"),tR="@firebase/app-compat",nR="@firebase/analytics-compat",rR="@firebase/analytics",sR="@firebase/app-check-compat",iR="@firebase/app-check",aR="@firebase/auth",oR="@firebase/auth-compat",lR="@firebase/database",cR="@firebase/data-connect",uR="@firebase/database-compat",dR="@firebase/functions",hR="@firebase/functions-compat",fR="@firebase/installations",pR="@firebase/installations-compat",mR="@firebase/messaging",gR="@firebase/messaging-compat",vR="@firebase/performance",yR="@firebase/performance-compat",_R="@firebase/remote-config",wR="@firebase/remote-config-compat",ER="@firebase/storage",xR="@firebase/storage-compat",IR="@firebase/firestore",TR="@firebase/vertexai-preview",NR="@firebase/firestore-compat",SR="firebase",AR="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kh="[DEFAULT]",RR={[Ch]:"fire-core",[tR]:"fire-core-compat",[rR]:"fire-analytics",[nR]:"fire-analytics-compat",[iR]:"fire-app-check",[sR]:"fire-app-check-compat",[aR]:"fire-auth",[oR]:"fire-auth-compat",[lR]:"fire-rtdb",[cR]:"fire-data-connect",[uR]:"fire-rtdb-compat",[dR]:"fire-fn",[hR]:"fire-fn-compat",[fR]:"fire-iid",[pR]:"fire-iid-compat",[mR]:"fire-fcm",[gR]:"fire-fcm-compat",[vR]:"fire-perf",[yR]:"fire-perf-compat",[_R]:"fire-rc",[wR]:"fire-rc-compat",[ER]:"fire-gcs",[xR]:"fire-gcs-compat",[IR]:"fire-fst",[NR]:"fire-fst-compat",[TR]:"fire-vertex","fire-js":"fire-js",[SR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja=new Map,CR=new Map,Ph=new Map;function Cv(t,e){try{t.container.addComponent(e)}catch(n){Bn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function fs(t){const e=t.name;if(Ph.has(e))return Bn.debug(`There were multiple attempts to register component ${e}.`),!1;Ph.set(e,t);for(const n of Ja.values())Cv(n,t);for(const n of CR.values())Cv(n,t);return!0}function Yc(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function on(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ar=new yo("app","Firebase",kR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Pr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ar.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts=AR;function Zf(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:kh,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Ar.create("bad-app-name",{appName:String(s)});if(n||(n=xE()),!n)throw Ar.create("no-options");const i=Ja.get(s);if(i){if(Xa(n,i.options)&&Xa(r,i.config))return i;throw Ar.create("duplicate-app",{appName:s})}const a=new VA(s);for(const u of Ph.values())a.addComponent(u);const c=new PR(n,r,a);return Ja.set(s,c),c}function Xc(t=kh){const e=Ja.get(t);if(!e&&t===kh&&xE())return Zf();if(!e)throw Ar.create("no-app",{appName:t});return e}function AE(){return Array.from(Ja.values())}function wn(t,e,n){var r;let s=(r=RR[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const c=[`Unable to register library "${s}" with version "${e}":`];i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Bn.warn(c.join(" "));return}fs(new Pr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jR="firebase-heartbeat-database",bR=1,Za="firebase-heartbeat-store";let wd=null;function RE(){return wd||(wd=YA(jR,bR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Za)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ar.create("idb-open",{originalErrorMessage:t.message})})),wd}async function OR(t){try{const n=(await RE()).transaction(Za),r=await n.objectStore(Za).get(CE(t));return await n.done,r}catch(e){if(e instanceof Nn)Bn.warn(e.message);else{const n=Ar.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Bn.warn(n.message)}}}async function kv(t,e){try{const r=(await RE()).transaction(Za,"readwrite");await r.objectStore(Za).put(e,CE(t)),await r.done}catch(n){if(n instanceof Nn)Bn.warn(n.message);else{const r=Ar.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Bn.warn(r.message)}}}function CE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR=1024,LR=30*24*60*60*1e3;class VR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new FR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Pv();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const c=new Date(a.date).valueOf();return Date.now()-c<=LR}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Bn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Pv(),{heartbeatsToSend:r,unsentEntries:s}=MR(this._heartbeatsCache.heartbeats),i=gc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Bn.warn(n),""}}}function Pv(){return new Date().toISOString().substring(0,10)}function MR(t,e=DR){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),jv(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),jv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class FR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return NA()?SA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await OR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return kv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return kv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function jv(t){return gc(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UR(t){fs(new Pr("platform-logger",e=>new ZA(e),"PRIVATE")),fs(new Pr("heartbeat",e=>new VR(e),"PRIVATE")),wn(Ch,Rv,t),wn(Ch,Rv,"esm2017"),wn("fire-js","")}UR("");function ep(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function kE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const zR=kE,PE=new yo("auth","Firebase",kE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vc=new Xf("@firebase/auth");function BR(t,...e){vc.logLevel<=ue.WARN&&vc.warn(`Auth (${Ts}): ${t}`,...e)}function Dl(t,...e){vc.logLevel<=ue.ERROR&&vc.error(`Auth (${Ts}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zt(t,...e){throw np(t,...e)}function un(t,...e){return np(t,...e)}function tp(t,e,n){const r=Object.assign(Object.assign({},zR()),{[e]:n});return new yo("auth","Firebase",r).create(e,{appName:t.name})}function Vn(t){return tp(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $R(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Zt(t,"argument-error"),tp(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function np(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return PE.create(t,...e)}function re(t,e,...n){if(!t)throw np(e,...n)}function bn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Dl(e),new Error(e)}function $n(t,e){t||bn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function WR(){return bv()==="http:"||bv()==="https:"}function bv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(WR()||EA()||"connection"in navigator)?navigator.onLine:!0}function HR(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e,n){this.shortDelay=e,this.longDelay=n,$n(n>e,"Short delay should be less than long delay!"),this.isMobile=yA()||xA()}get(){return qR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rp(t,e){$n(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GR=new wo(3e4,6e4);function Fr(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ur(t,e,n,r,s={}){return bE(t,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=_o(Object.assign({key:t.config.apiKey},a)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return wA()||(d.referrerPolicy="no-referrer"),jE.fetch()(OE(t,t.config.apiHost,n,c),d)})}async function bE(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},KR),e);try{const s=new YR(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw ml(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw ml(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw ml(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw ml(t,"user-disabled",a);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw tp(t,f,d);Zt(t,f)}}catch(s){if(s instanceof Nn)throw s;Zt(t,"network-request-failed",{message:String(s)})}}async function Eo(t,e,n,r,s={}){const i=await Ur(t,e,n,r,s);return"mfaPendingCredential"in i&&Zt(t,"multi-factor-auth-required",{_serverResponse:i}),i}function OE(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?rp(t.config,s):`${t.config.apiScheme}://${s}`}function QR(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class YR{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(un(this.auth,"network-request-failed")),GR.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ml(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=un(t,e,r);return s.customData._tokenResponse=n,s}function Ov(t){return t!==void 0&&t.enterprise!==void 0}class XR{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return QR(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function JR(t,e){return Ur(t,"GET","/v2/recaptchaConfig",Fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZR(t,e){return Ur(t,"POST","/v1/accounts:delete",e)}async function DE(t,e){return Ur(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ia(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function eC(t,e=!1){const n=Te(t),r=await n.getIdToken(e),s=sp(r);re(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Ia(Ed(s.auth_time)),issuedAtTime:Ia(Ed(s.iat)),expirationTime:Ia(Ed(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ed(t){return Number(t)*1e3}function sp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Dl("JWT malformed, contained fewer than 3 sections"),null;try{const s=_E(n);return s?JSON.parse(s):(Dl("Failed to decode base64 JWT payload"),null)}catch(s){return Dl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Dv(t){const e=sp(t);return re(e,"internal-error"),re(typeof e.exp<"u","internal-error"),re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eo(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Nn&&tC(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function tC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ia(this.lastLoginAt),this.creationTime=Ia(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yc(t){var e;const n=t.auth,r=await t.getIdToken(),s=await eo(t,DE(n,{idToken:r}));re(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?LE(i.providerUserInfo):[],c=sC(t.providerData,a),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(c!=null&&c.length),f=u?d:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new bh(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(t,p)}async function rC(t){const e=Te(t);await yc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function sC(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function LE(t){return t.map(e=>{var{providerId:n}=e,r=ep(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iC(t,e){const n=await bE(t,{},async()=>{const r=_o({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=OE(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",jE.fetch()(a,{method:"POST",headers:c,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function aC(t,e){return Ur(t,"POST","/v2/accounts:revokeToken",Fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){re(e.idToken,"internal-error"),re(typeof e.idToken<"u","internal-error"),re(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Dv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){re(e.length!==0,"internal-error");const n=Dv(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await iC(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,a=new ei;return r&&(re(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(re(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(re(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ei,this.toJSON())}_performRefresh(){return bn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(t,e){re(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class On{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=ep(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new nC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new bh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await eo(this,this.stsTokenManager.getToken(this.auth,e));return re(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return eC(this,e)}reload(){return rC(this)}_assign(e){this!==e&&(re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new On(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await yc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(on(this.auth.app))return Promise.reject(Vn(this.auth));const e=await this.getIdToken();return await eo(this,ZR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,a,c,u,d,f;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(s=n.email)!==null&&s!==void 0?s:void 0,I=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,y=(a=n.photoURL)!==null&&a!==void 0?a:void 0,N=(c=n.tenantId)!==null&&c!==void 0?c:void 0,T=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,x=(d=n.createdAt)!==null&&d!==void 0?d:void 0,_=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:E,emailVerified:k,isAnonymous:O,providerData:D,stsTokenManager:w}=n;re(E&&w,e,"internal-error");const v=ei.fromJSON(this.name,w);re(typeof E=="string",e,"internal-error"),nr(p,e.name),nr(m,e.name),re(typeof k=="boolean",e,"internal-error"),re(typeof O=="boolean",e,"internal-error"),nr(I,e.name),nr(y,e.name),nr(N,e.name),nr(T,e.name),nr(x,e.name),nr(_,e.name);const A=new On({uid:E,auth:e,email:m,emailVerified:k,displayName:p,isAnonymous:O,photoURL:y,phoneNumber:I,tenantId:N,stsTokenManager:v,createdAt:x,lastLoginAt:_});return D&&Array.isArray(D)&&(A.providerData=D.map(P=>Object.assign({},P))),T&&(A._redirectEventId=T),A}static async _fromIdTokenResponse(e,n,r=!1){const s=new ei;s.updateFromServerResponse(n);const i=new On({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await yc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];re(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?LE(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new ei;c.updateFromIdToken(r);const u=new On({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new bh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lv=new Map;function Dn(t){$n(t instanceof Function,"Expected a class definition");let e=Lv.get(t);return e?($n(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Lv.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}VE.type="NONE";const Vv=VE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ll(t,e,n){return`firebase:${t}:${e}:${n}`}class ti{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Ll(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ll("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?On._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ti(Dn(Vv),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Dn(Vv);const a=Ll(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const f=await d._get(a);if(f){const p=On._fromJSON(e,f);d!==i&&(c=p),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new ti(i,e,r):(i=u[0],c&&await i._set(a,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(a)}catch{}})),new ti(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(zE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ME(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($E(e))return"Blackberry";if(WE(e))return"Webos";if(FE(e))return"Safari";if((e.includes("chrome/")||UE(e))&&!e.includes("edge/"))return"Chrome";if(BE(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function ME(t=wt()){return/firefox\//i.test(t)}function FE(t=wt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function UE(t=wt()){return/crios\//i.test(t)}function zE(t=wt()){return/iemobile/i.test(t)}function BE(t=wt()){return/android/i.test(t)}function $E(t=wt()){return/blackberry/i.test(t)}function WE(t=wt()){return/webos/i.test(t)}function ip(t=wt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function oC(t=wt()){var e;return ip(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function lC(){return IA()&&document.documentMode===10}function qE(t=wt()){return ip(t)||BE(t)||WE(t)||$E(t)||/windows phone/i.test(t)||zE(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HE(t,e=[]){let n;switch(t){case"Browser":n=Mv(wt());break;case"Worker":n=`${Mv(wt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ts}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((a,c)=>{try{const u=e(i);a(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uC(t,e={}){return Ur(t,"GET","/v2/passwordPolicy",Fr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=6;class hC{constructor(e){var n,r,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:dC,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,a,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(a=u.containsNumericCharacter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Fv(this),this.idTokenSubscription=new Fv(this),this.beforeStateQueue=new cC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=PE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Dn(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await ti.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await DE(this,{idToken:e}),r=await On._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(on(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,c=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===c)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await yc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=HR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(on(this.app))return Promise.reject(Vn(this));const n=e?Te(e):null;return n&&re(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return on(this.app)?Promise.reject(Vn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return on(this.app)?Promise.reject(Vn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Dn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uC(this),n=new hC(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new yo("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await aC(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Dn(e)||this._popupRedirectResolver;re(n,this,"argument-error"),this.redirectPersistenceManager=await ti.create(this,[Dn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(re(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{a=!0,u()}}else{const u=e.addObserver(n);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=HE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&BR(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function zr(t){return Te(t)}class Fv{constructor(e){this.auth=e,this.observer=null,this.addObserver=PA(n=>this.observer=n)}get next(){return re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pC(t){Jc=t}function KE(t){return Jc.loadJS(t)}function mC(){return Jc.recaptchaEnterpriseScript}function gC(){return Jc.gapiScript}function vC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const yC="recaptcha-enterprise",_C="NO_RECAPTCHA";class wC{constructor(e){this.type=yC,this.auth=zr(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,c)=>{JR(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new XR(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,a(d.siteKey)}}).catch(u=>{c(u)})})}function s(i,a,c){const u=window.grecaptcha;Ov(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{a(d)}).catch(()=>{a(_C)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,a)=>{r(this.auth).then(c=>{if(!n&&Ov(window.grecaptcha))s(c,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=mC();u.length!==0&&(u+=c),KE(u).then(()=>{s(c,i,a)}).catch(d=>{a(d)})}}).catch(c=>{a(c)})})}}async function Uv(t,e,n,r=!1){const s=new wC(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:i}):Object.assign(a,{captchaResponse:i}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Oh(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Uv(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Uv(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EC(t,e){const n=Yc(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Xa(i,e??{}))return s;Zt(s,"already-initialized")}return n.initialize({options:e})}function xC(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Dn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function IC(t,e,n){const r=zr(t);re(r._canInitEmulator,r,"emulator-config-failed"),re(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=GE(e),{host:a,port:c}=TC(e),u=c===null?"":`:${c}`;r.config.emulator={url:`${i}//${a}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),NC()}function GE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function TC(t){const e=GE(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:zv(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:zv(a)}}}function zv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function NC(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return bn("not implemented")}_getIdTokenResponse(e){return bn("not implemented")}_linkToIdToken(e,n){return bn("not implemented")}_getReauthenticationResolver(e){return bn("not implemented")}}async function SC(t,e){return Ur(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AC(t,e){return Eo(t,"POST","/v1/accounts:signInWithPassword",Fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RC(t,e){return Eo(t,"POST","/v1/accounts:signInWithEmailLink",Fr(t,e))}async function CC(t,e){return Eo(t,"POST","/v1/accounts:signInWithEmailLink",Fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to extends ap{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new to(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new to(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Oh(e,n,"signInWithPassword",AC);case"emailLink":return RC(e,{email:this._email,oobCode:this._password});default:Zt(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Oh(e,r,"signUpPassword",SC);case"emailLink":return CC(e,{idToken:n,email:this._email,oobCode:this._password});default:Zt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ni(t,e){return Eo(t,"POST","/v1/accounts:signInWithIdp",Fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC="http://localhost";class ps extends ap{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ps(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Zt("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=ep(n,["providerId","signInMethod"]);if(!r||!s)return null;const a=new ps(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return ni(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ni(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ni(e,n)}buildRequest(){const e={requestUri:kC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=_o(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PC(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function jC(t){const e=ca(ua(t)).link,n=e?ca(ua(e)).deep_link_id:null,r=ca(ua(t)).deep_link_id;return(r?ca(ua(r)).link:null)||r||n||e||t}class op{constructor(e){var n,r,s,i,a,c;const u=ca(ua(e)),d=(n=u.apiKey)!==null&&n!==void 0?n:null,f=(r=u.oobCode)!==null&&r!==void 0?r:null,p=PC((s=u.mode)!==null&&s!==void 0?s:null);re(d&&f&&p,"argument-error"),this.apiKey=d,this.operation=p,this.code=f,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(a=u.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(c=u.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){const n=jC(e);try{return new op(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(){this.providerId=Si.PROVIDER_ID}static credential(e,n){return to._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=op.parseLink(n);return re(r,"argument-error"),to._fromEmailAndCode(e,r.code,r.tenantId)}}Si.PROVIDER_ID="password";Si.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Si.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo extends lp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or extends xo{constructor(){super("facebook.com")}static credential(e){return ps._fromParams({providerId:or.PROVIDER_ID,signInMethod:or.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return or.credentialFromTaggedObject(e)}static credentialFromError(e){return or.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return or.credential(e.oauthAccessToken)}catch{return null}}}or.FACEBOOK_SIGN_IN_METHOD="facebook.com";or.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn extends xo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ps._fromParams({providerId:kn.PROVIDER_ID,signInMethod:kn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return kn.credentialFromTaggedObject(e)}static credentialFromError(e){return kn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return kn.credential(n,r)}catch{return null}}}kn.GOOGLE_SIGN_IN_METHOD="google.com";kn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr extends xo{constructor(){super("github.com")}static credential(e){return ps._fromParams({providerId:lr.PROVIDER_ID,signInMethod:lr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return lr.credentialFromTaggedObject(e)}static credentialFromError(e){return lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return lr.credential(e.oauthAccessToken)}catch{return null}}}lr.GITHUB_SIGN_IN_METHOD="github.com";lr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr extends xo{constructor(){super("twitter.com")}static credential(e,n){return ps._fromParams({providerId:cr.PROVIDER_ID,signInMethod:cr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return cr.credentialFromTaggedObject(e)}static credentialFromError(e){return cr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return cr.credential(n,r)}catch{return null}}}cr.TWITTER_SIGN_IN_METHOD="twitter.com";cr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bC(t,e){return Eo(t,"POST","/v1/accounts:signUp",Fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await On._fromIdTokenResponse(e,r,s),a=Bv(r);return new ms({user:i,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Bv(r);return new ms({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Bv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c extends Nn{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,_c.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new _c(e,n,r,s)}}function QE(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?_c._fromErrorAndOperation(t,i,e,r):i})}async function OC(t,e,n=!1){const r=await eo(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ms._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DC(t,e,n=!1){const{auth:r}=t;if(on(r.app))return Promise.reject(Vn(r));const s="reauthenticate";try{const i=await eo(t,QE(r,s,e,t),n);re(i.idToken,r,"internal-error");const a=sp(i.idToken);re(a,r,"internal-error");const{sub:c}=a;return re(t.uid===c,r,"user-mismatch"),ms._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Zt(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YE(t,e,n=!1){if(on(t.app))return Promise.reject(Vn(t));const r="signIn",s=await QE(t,r,e),i=await ms._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function LC(t,e){return YE(zr(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XE(t){const e=zr(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function VC(t,e,n){if(on(t.app))return Promise.reject(Vn(t));const r=zr(t),a=await Oh(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",bC).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&XE(t),u}),c=await ms._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(c.user),c}function MC(t,e,n){return on(t.app)?Promise.reject(Vn(t)):LC(Te(t),Si.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&XE(t),r})}function FC(t,e,n,r){return Te(t).onIdTokenChanged(e,n,r)}function UC(t,e,n){return Te(t).beforeAuthStateChanged(e,n)}function zC(t,e,n,r){return Te(t).onAuthStateChanged(e,n,r)}function is(t){return Te(t).signOut()}async function BC(t){return Te(t).delete()}const wc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(wc,"1"),this.storage.removeItem(wc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C=1e3,WC=10;class ZE extends JE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=qE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);lC()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,WC):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},$C)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}ZE.type="LOCAL";const qC=ZE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex extends JE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}ex.type="SESSION";const tx=ex;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Zc(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async d=>d(n.origin,i)),u=await HC(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Zc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,u)=>{const d=cp("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(m.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(){return window}function GC(t){En().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nx(){return typeof En().WorkerGlobalScope<"u"&&typeof En().importScripts=="function"}async function QC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function YC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function XC(){return nx()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx="firebaseLocalStorageDb",JC=1,Ec="firebaseLocalStorage",sx="fbase_key";class Io{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function eu(t,e){return t.transaction([Ec],e?"readwrite":"readonly").objectStore(Ec)}function ZC(){const t=indexedDB.deleteDatabase(rx);return new Io(t).toPromise()}function Dh(){const t=indexedDB.open(rx,JC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Ec,{keyPath:sx})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Ec)?e(r):(r.close(),await ZC(),e(await Dh()))})})}async function $v(t,e,n){const r=eu(t,!0).put({[sx]:e,value:n});return new Io(r).toPromise()}async function ek(t,e){const n=eu(t,!1).get(e),r=await new Io(n).toPromise();return r===void 0?null:r.value}function Wv(t,e){const n=eu(t,!0).delete(e);return new Io(n).toPromise()}const tk=800,nk=3;class ix{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Dh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>nk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Zc._getInstance(XC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await QC(),!this.activeServiceWorker)return;this.sender=new KC(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||YC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Dh();return await $v(e,wc,"1"),await Wv(e,wc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>$v(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>ek(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Wv(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=eu(s,!1).getAll();return new Io(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),tk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ix.type="LOCAL";const rk=ix;new wo(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ax(t,e){return e?Dn(e):(re(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up extends ap{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ni(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ni(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ni(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function sk(t){return YE(t.auth,new up(t),t.bypassAuthState)}function ik(t){const{auth:e,user:n}=t;return re(n,e,"internal-error"),DC(n,new up(t),t.bypassAuthState)}async function ak(t){const{auth:e,user:n}=t;return re(n,e,"internal-error"),OC(n,new up(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return sk;case"linkViaPopup":case"linkViaRedirect":return ak;case"reauthViaPopup":case"reauthViaRedirect":return ik;default:Zt(this.auth,"internal-error")}}resolve(e){$n(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){$n(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ok=new wo(2e3,1e4);async function lk(t,e,n){if(on(t.app))return Promise.reject(un(t,"operation-not-supported-in-this-environment"));const r=zr(t);$R(t,e,lp);const s=ax(r,n);return new ts(r,"signInViaPopup",e,s).executeNotNull()}class ts extends ox{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ts.currentPopupAction&&ts.currentPopupAction.cancel(),ts.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return re(e,this.auth,"internal-error"),e}async onExecution(){$n(this.filter.length===1,"Popup operations only handle one event");const e=cp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(un(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(un(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ts.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(un(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ok.get())};e()}}ts.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ck="pendingRedirect",Vl=new Map;class uk extends ox{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Vl.get(this.auth._key());if(!e){try{const r=await dk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Vl.set(this.auth._key(),e)}return this.bypassAuthState||Vl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function dk(t,e){const n=pk(e),r=fk(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function hk(t,e){Vl.set(t._key(),e)}function fk(t){return Dn(t._redirectPersistence)}function pk(t){return Ll(ck,t.config.apiKey,t.name)}async function mk(t,e,n=!1){if(on(t.app))return Promise.reject(Vn(t));const r=zr(t),s=ax(r,e),a=await new uk(r,s,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk=10*60*1e3;class vk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!yk(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!lx(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(un(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=gk&&this.cachedEventUids.clear(),this.cachedEventUids.has(qv(e))}saveEventToCache(e){this.cachedEventUids.add(qv(e)),this.lastProcessedEventTime=Date.now()}}function qv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function lx({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function yk(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lx(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _k(t,e={}){return Ur(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ek=/^https?/;async function xk(t){if(t.config.emulator)return;const{authorizedDomains:e}=await _k(t);for(const n of e)try{if(Ik(n))return}catch{}Zt(t,"unauthorized-domain")}function Ik(t){const e=jh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!Ek.test(n))return!1;if(wk.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tk=new wo(3e4,6e4);function Hv(){const t=En().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Nk(t){return new Promise((e,n)=>{var r,s,i;function a(){Hv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Hv(),n(un(t,"network-request-failed"))},timeout:Tk.get()})}if(!((s=(r=En().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=En().gapi)===null||i===void 0)&&i.load)a();else{const c=vC("iframefcb");return En()[c]=()=>{gapi.load?a():n(un(t,"network-request-failed"))},KE(`${gC()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw Ml=null,e})}let Ml=null;function Sk(t){return Ml=Ml||Nk(t),Ml}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak=new wo(5e3,15e3),Rk="__/auth/iframe",Ck="emulator/auth/iframe",kk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Pk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function jk(t){const e=t.config;re(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?rp(e,Ck):`https://${t.config.authDomain}/${Rk}`,r={apiKey:e.apiKey,appName:t.name,v:Ts},s=Pk.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${_o(r).slice(1)}`}async function bk(t){const e=await Sk(t),n=En().gapi;return re(n,t,"internal-error"),e.open({where:document.body,url:jk(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:kk,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=un(t,"network-request-failed"),c=En().setTimeout(()=>{i(a)},Ak.get());function u(){En().clearTimeout(c),s(r)}r.ping(u).then(u,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ok={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Dk=500,Lk=600,Vk="_blank",Mk="http://localhost";class Kv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Fk(t,e,n,r=Dk,s=Lk){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},Ok),{width:r.toString(),height:s.toString(),top:i,left:a}),d=wt().toLowerCase();n&&(c=UE(d)?Vk:n),ME(d)&&(e=e||Mk,u.scrollbars="yes");const f=Object.entries(u).reduce((m,[I,y])=>`${m}${I}=${y},`,"");if(oC(d)&&c!=="_self")return Uk(e||"",c),new Kv(null);const p=window.open(e||"",c,f);re(p,t,"popup-blocked");try{p.focus()}catch{}return new Kv(p)}function Uk(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk="__/auth/handler",Bk="emulator/auth/handler",$k=encodeURIComponent("fac");async function Gv(t,e,n,r,s,i){re(t.config.authDomain,t,"auth-domain-config-required"),re(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ts,eventId:s};if(e instanceof lp){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",kA(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof xo){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),d=u?`#${$k}=${encodeURIComponent(u)}`:"";return`${Wk(t)}?${_o(c).slice(1)}${d}`}function Wk({config:t}){return t.emulator?rp(t,Bk):`https://${t.authDomain}/${zk}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd="webStorageSupport";class qk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tx,this._completeRedirectFn=mk,this._overrideRedirectResult=hk}async _openPopup(e,n,r,s){var i;$n((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await Gv(e,n,r,jh(),s);return Fk(e,a,cp())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Gv(e,n,r,jh(),s);return GC(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):($n(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await bk(e),r=new vk(e);return n.register("authEvent",s=>(re(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(xd,{type:xd},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[xd];a!==void 0&&n(!!a),Zt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=xk(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return qE()||FE()||ip()}}const Hk=qk;var Qv="@firebase/auth",Yv="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Qk(t){fs(new Pr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;re(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:HE(t)},d=new fC(r,s,i,u);return xC(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),fs(new Pr("auth-internal",e=>{const n=zr(e.getProvider("auth").getImmediate());return(r=>new Kk(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),wn(Qv,Yv,Gk(t)),wn(Qv,Yv,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk=5*60,Xk=IE("authIdTokenMaxAge")||Yk;let Xv=null;const Jk=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Xk)return;const s=n==null?void 0:n.token;Xv!==s&&(Xv=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function cx(t=Xc()){const e=Yc(t,"auth");if(e.isInitialized())return e.getImmediate();const n=EC(t,{popupRedirectResolver:Hk,persistence:[rk,qC,tx]}),r=IE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=Jk(i.toString());UC(n,a,()=>a(n.currentUser)),FC(n,c=>a(c))}}const s=wE("auth");return s&&IC(n,`http://${s}`),n}function Zk(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}pC({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=un("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Zk().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Qk("Browser");var Jv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var as,ux;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,v){function A(){}A.prototype=v.prototype,w.D=v.prototype,w.prototype=new A,w.prototype.constructor=w,w.C=function(P,C,j){for(var S=Array(arguments.length-2),U=2;U<arguments.length;U++)S[U-2]=arguments[U];return v.prototype[C].apply(P,S)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,v,A){A||(A=0);var P=Array(16);if(typeof v=="string")for(var C=0;16>C;++C)P[C]=v.charCodeAt(A++)|v.charCodeAt(A++)<<8|v.charCodeAt(A++)<<16|v.charCodeAt(A++)<<24;else for(C=0;16>C;++C)P[C]=v[A++]|v[A++]<<8|v[A++]<<16|v[A++]<<24;v=w.g[0],A=w.g[1],C=w.g[2];var j=w.g[3],S=v+(j^A&(C^j))+P[0]+3614090360&4294967295;v=A+(S<<7&4294967295|S>>>25),S=j+(C^v&(A^C))+P[1]+3905402710&4294967295,j=v+(S<<12&4294967295|S>>>20),S=C+(A^j&(v^A))+P[2]+606105819&4294967295,C=j+(S<<17&4294967295|S>>>15),S=A+(v^C&(j^v))+P[3]+3250441966&4294967295,A=C+(S<<22&4294967295|S>>>10),S=v+(j^A&(C^j))+P[4]+4118548399&4294967295,v=A+(S<<7&4294967295|S>>>25),S=j+(C^v&(A^C))+P[5]+1200080426&4294967295,j=v+(S<<12&4294967295|S>>>20),S=C+(A^j&(v^A))+P[6]+2821735955&4294967295,C=j+(S<<17&4294967295|S>>>15),S=A+(v^C&(j^v))+P[7]+4249261313&4294967295,A=C+(S<<22&4294967295|S>>>10),S=v+(j^A&(C^j))+P[8]+1770035416&4294967295,v=A+(S<<7&4294967295|S>>>25),S=j+(C^v&(A^C))+P[9]+2336552879&4294967295,j=v+(S<<12&4294967295|S>>>20),S=C+(A^j&(v^A))+P[10]+4294925233&4294967295,C=j+(S<<17&4294967295|S>>>15),S=A+(v^C&(j^v))+P[11]+2304563134&4294967295,A=C+(S<<22&4294967295|S>>>10),S=v+(j^A&(C^j))+P[12]+1804603682&4294967295,v=A+(S<<7&4294967295|S>>>25),S=j+(C^v&(A^C))+P[13]+4254626195&4294967295,j=v+(S<<12&4294967295|S>>>20),S=C+(A^j&(v^A))+P[14]+2792965006&4294967295,C=j+(S<<17&4294967295|S>>>15),S=A+(v^C&(j^v))+P[15]+1236535329&4294967295,A=C+(S<<22&4294967295|S>>>10),S=v+(C^j&(A^C))+P[1]+4129170786&4294967295,v=A+(S<<5&4294967295|S>>>27),S=j+(A^C&(v^A))+P[6]+3225465664&4294967295,j=v+(S<<9&4294967295|S>>>23),S=C+(v^A&(j^v))+P[11]+643717713&4294967295,C=j+(S<<14&4294967295|S>>>18),S=A+(j^v&(C^j))+P[0]+3921069994&4294967295,A=C+(S<<20&4294967295|S>>>12),S=v+(C^j&(A^C))+P[5]+3593408605&4294967295,v=A+(S<<5&4294967295|S>>>27),S=j+(A^C&(v^A))+P[10]+38016083&4294967295,j=v+(S<<9&4294967295|S>>>23),S=C+(v^A&(j^v))+P[15]+3634488961&4294967295,C=j+(S<<14&4294967295|S>>>18),S=A+(j^v&(C^j))+P[4]+3889429448&4294967295,A=C+(S<<20&4294967295|S>>>12),S=v+(C^j&(A^C))+P[9]+568446438&4294967295,v=A+(S<<5&4294967295|S>>>27),S=j+(A^C&(v^A))+P[14]+3275163606&4294967295,j=v+(S<<9&4294967295|S>>>23),S=C+(v^A&(j^v))+P[3]+4107603335&4294967295,C=j+(S<<14&4294967295|S>>>18),S=A+(j^v&(C^j))+P[8]+1163531501&4294967295,A=C+(S<<20&4294967295|S>>>12),S=v+(C^j&(A^C))+P[13]+2850285829&4294967295,v=A+(S<<5&4294967295|S>>>27),S=j+(A^C&(v^A))+P[2]+4243563512&4294967295,j=v+(S<<9&4294967295|S>>>23),S=C+(v^A&(j^v))+P[7]+1735328473&4294967295,C=j+(S<<14&4294967295|S>>>18),S=A+(j^v&(C^j))+P[12]+2368359562&4294967295,A=C+(S<<20&4294967295|S>>>12),S=v+(A^C^j)+P[5]+4294588738&4294967295,v=A+(S<<4&4294967295|S>>>28),S=j+(v^A^C)+P[8]+2272392833&4294967295,j=v+(S<<11&4294967295|S>>>21),S=C+(j^v^A)+P[11]+1839030562&4294967295,C=j+(S<<16&4294967295|S>>>16),S=A+(C^j^v)+P[14]+4259657740&4294967295,A=C+(S<<23&4294967295|S>>>9),S=v+(A^C^j)+P[1]+2763975236&4294967295,v=A+(S<<4&4294967295|S>>>28),S=j+(v^A^C)+P[4]+1272893353&4294967295,j=v+(S<<11&4294967295|S>>>21),S=C+(j^v^A)+P[7]+4139469664&4294967295,C=j+(S<<16&4294967295|S>>>16),S=A+(C^j^v)+P[10]+3200236656&4294967295,A=C+(S<<23&4294967295|S>>>9),S=v+(A^C^j)+P[13]+681279174&4294967295,v=A+(S<<4&4294967295|S>>>28),S=j+(v^A^C)+P[0]+3936430074&4294967295,j=v+(S<<11&4294967295|S>>>21),S=C+(j^v^A)+P[3]+3572445317&4294967295,C=j+(S<<16&4294967295|S>>>16),S=A+(C^j^v)+P[6]+76029189&4294967295,A=C+(S<<23&4294967295|S>>>9),S=v+(A^C^j)+P[9]+3654602809&4294967295,v=A+(S<<4&4294967295|S>>>28),S=j+(v^A^C)+P[12]+3873151461&4294967295,j=v+(S<<11&4294967295|S>>>21),S=C+(j^v^A)+P[15]+530742520&4294967295,C=j+(S<<16&4294967295|S>>>16),S=A+(C^j^v)+P[2]+3299628645&4294967295,A=C+(S<<23&4294967295|S>>>9),S=v+(C^(A|~j))+P[0]+4096336452&4294967295,v=A+(S<<6&4294967295|S>>>26),S=j+(A^(v|~C))+P[7]+1126891415&4294967295,j=v+(S<<10&4294967295|S>>>22),S=C+(v^(j|~A))+P[14]+2878612391&4294967295,C=j+(S<<15&4294967295|S>>>17),S=A+(j^(C|~v))+P[5]+4237533241&4294967295,A=C+(S<<21&4294967295|S>>>11),S=v+(C^(A|~j))+P[12]+1700485571&4294967295,v=A+(S<<6&4294967295|S>>>26),S=j+(A^(v|~C))+P[3]+2399980690&4294967295,j=v+(S<<10&4294967295|S>>>22),S=C+(v^(j|~A))+P[10]+4293915773&4294967295,C=j+(S<<15&4294967295|S>>>17),S=A+(j^(C|~v))+P[1]+2240044497&4294967295,A=C+(S<<21&4294967295|S>>>11),S=v+(C^(A|~j))+P[8]+1873313359&4294967295,v=A+(S<<6&4294967295|S>>>26),S=j+(A^(v|~C))+P[15]+4264355552&4294967295,j=v+(S<<10&4294967295|S>>>22),S=C+(v^(j|~A))+P[6]+2734768916&4294967295,C=j+(S<<15&4294967295|S>>>17),S=A+(j^(C|~v))+P[13]+1309151649&4294967295,A=C+(S<<21&4294967295|S>>>11),S=v+(C^(A|~j))+P[4]+4149444226&4294967295,v=A+(S<<6&4294967295|S>>>26),S=j+(A^(v|~C))+P[11]+3174756917&4294967295,j=v+(S<<10&4294967295|S>>>22),S=C+(v^(j|~A))+P[2]+718787259&4294967295,C=j+(S<<15&4294967295|S>>>17),S=A+(j^(C|~v))+P[9]+3951481745&4294967295,w.g[0]=w.g[0]+v&4294967295,w.g[1]=w.g[1]+(C+(S<<21&4294967295|S>>>11))&4294967295,w.g[2]=w.g[2]+C&4294967295,w.g[3]=w.g[3]+j&4294967295}r.prototype.u=function(w,v){v===void 0&&(v=w.length);for(var A=v-this.blockSize,P=this.B,C=this.h,j=0;j<v;){if(C==0)for(;j<=A;)s(this,w,j),j+=this.blockSize;if(typeof w=="string"){for(;j<v;)if(P[C++]=w.charCodeAt(j++),C==this.blockSize){s(this,P),C=0;break}}else for(;j<v;)if(P[C++]=w[j++],C==this.blockSize){s(this,P),C=0;break}}this.h=C,this.o+=v},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var v=1;v<w.length-8;++v)w[v]=0;var A=8*this.o;for(v=w.length-8;v<w.length;++v)w[v]=A&255,A/=256;for(this.u(w),w=Array(16),v=A=0;4>v;++v)for(var P=0;32>P;P+=8)w[A++]=this.g[v]>>>P&255;return w};function i(w,v){var A=c;return Object.prototype.hasOwnProperty.call(A,w)?A[w]:A[w]=v(w)}function a(w,v){this.h=v;for(var A=[],P=!0,C=w.length-1;0<=C;C--){var j=w[C]|0;P&&j==v||(A[C]=j,P=!1)}this.g=A}var c={};function u(w){return-128<=w&&128>w?i(w,function(v){return new a([v|0],0>v?-1:0)}):new a([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return p;if(0>w)return T(d(-w));for(var v=[],A=1,P=0;w>=A;P++)v[P]=w/A|0,A*=4294967296;return new a(v,0)}function f(w,v){if(w.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(w.charAt(0)=="-")return T(f(w.substring(1),v));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=d(Math.pow(v,8)),P=p,C=0;C<w.length;C+=8){var j=Math.min(8,w.length-C),S=parseInt(w.substring(C,C+j),v);8>j?(j=d(Math.pow(v,j)),P=P.j(j).add(d(S))):(P=P.j(A),P=P.add(d(S)))}return P}var p=u(0),m=u(1),I=u(16777216);t=a.prototype,t.m=function(){if(N(this))return-T(this).m();for(var w=0,v=1,A=0;A<this.g.length;A++){var P=this.i(A);w+=(0<=P?P:4294967296+P)*v,v*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(y(this))return"0";if(N(this))return"-"+T(this).toString(w);for(var v=d(Math.pow(w,6)),A=this,P="";;){var C=k(A,v).g;A=x(A,C.j(v));var j=((0<A.g.length?A.g[0]:A.h)>>>0).toString(w);if(A=C,y(A))return j+P;for(;6>j.length;)j="0"+j;P=j+P}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function y(w){if(w.h!=0)return!1;for(var v=0;v<w.g.length;v++)if(w.g[v]!=0)return!1;return!0}function N(w){return w.h==-1}t.l=function(w){return w=x(this,w),N(w)?-1:y(w)?0:1};function T(w){for(var v=w.g.length,A=[],P=0;P<v;P++)A[P]=~w.g[P];return new a(A,~w.h).add(m)}t.abs=function(){return N(this)?T(this):this},t.add=function(w){for(var v=Math.max(this.g.length,w.g.length),A=[],P=0,C=0;C<=v;C++){var j=P+(this.i(C)&65535)+(w.i(C)&65535),S=(j>>>16)+(this.i(C)>>>16)+(w.i(C)>>>16);P=S>>>16,j&=65535,S&=65535,A[C]=S<<16|j}return new a(A,A[A.length-1]&-2147483648?-1:0)};function x(w,v){return w.add(T(v))}t.j=function(w){if(y(this)||y(w))return p;if(N(this))return N(w)?T(this).j(T(w)):T(T(this).j(w));if(N(w))return T(this.j(T(w)));if(0>this.l(I)&&0>w.l(I))return d(this.m()*w.m());for(var v=this.g.length+w.g.length,A=[],P=0;P<2*v;P++)A[P]=0;for(P=0;P<this.g.length;P++)for(var C=0;C<w.g.length;C++){var j=this.i(P)>>>16,S=this.i(P)&65535,U=w.i(C)>>>16,K=w.i(C)&65535;A[2*P+2*C]+=S*K,_(A,2*P+2*C),A[2*P+2*C+1]+=j*K,_(A,2*P+2*C+1),A[2*P+2*C+1]+=S*U,_(A,2*P+2*C+1),A[2*P+2*C+2]+=j*U,_(A,2*P+2*C+2)}for(P=0;P<v;P++)A[P]=A[2*P+1]<<16|A[2*P];for(P=v;P<2*v;P++)A[P]=0;return new a(A,0)};function _(w,v){for(;(w[v]&65535)!=w[v];)w[v+1]+=w[v]>>>16,w[v]&=65535,v++}function E(w,v){this.g=w,this.h=v}function k(w,v){if(y(v))throw Error("division by zero");if(y(w))return new E(p,p);if(N(w))return v=k(T(w),v),new E(T(v.g),T(v.h));if(N(v))return v=k(w,T(v)),new E(T(v.g),v.h);if(30<w.g.length){if(N(w)||N(v))throw Error("slowDivide_ only works with positive integers.");for(var A=m,P=v;0>=P.l(w);)A=O(A),P=O(P);var C=D(A,1),j=D(P,1);for(P=D(P,2),A=D(A,2);!y(P);){var S=j.add(P);0>=S.l(w)&&(C=C.add(A),j=S),P=D(P,1),A=D(A,1)}return v=x(w,C.j(v)),new E(C,v)}for(C=p;0<=w.l(v);){for(A=Math.max(1,Math.floor(w.m()/v.m())),P=Math.ceil(Math.log(A)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),j=d(A),S=j.j(v);N(S)||0<S.l(w);)A-=P,j=d(A),S=j.j(v);y(j)&&(j=m),C=C.add(j),w=x(w,S)}return new E(C,w)}t.A=function(w){return k(this,w).h},t.and=function(w){for(var v=Math.max(this.g.length,w.g.length),A=[],P=0;P<v;P++)A[P]=this.i(P)&w.i(P);return new a(A,this.h&w.h)},t.or=function(w){for(var v=Math.max(this.g.length,w.g.length),A=[],P=0;P<v;P++)A[P]=this.i(P)|w.i(P);return new a(A,this.h|w.h)},t.xor=function(w){for(var v=Math.max(this.g.length,w.g.length),A=[],P=0;P<v;P++)A[P]=this.i(P)^w.i(P);return new a(A,this.h^w.h)};function O(w){for(var v=w.g.length+1,A=[],P=0;P<v;P++)A[P]=w.i(P)<<1|w.i(P-1)>>>31;return new a(A,w.h)}function D(w,v){var A=v>>5;v%=32;for(var P=w.g.length-A,C=[],j=0;j<P;j++)C[j]=0<v?w.i(j+A)>>>v|w.i(j+A+1)<<32-v:w.i(j+A);return new a(C,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,ux=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=f,as=a}).apply(typeof Jv<"u"?Jv:typeof self<"u"?self:typeof window<"u"?window:{});var gl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dx,da,hx,Fl,Lh,fx,px,mx;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,g){return l==Array.prototype||l==Object.prototype||(l[h]=g.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof gl=="object"&&gl];for(var h=0;h<l.length;++h){var g=l[h];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(l,h){if(h)e:{var g=r;l=l.split(".");for(var R=0;R<l.length-1;R++){var L=l[R];if(!(L in g))break e;g=g[L]}l=l[l.length-1],R=g[l],h=h(R),h!=R&&h!=null&&e(g,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var g=0,R=!1,L={next:function(){if(!R&&g<l.length){var M=g++;return{value:h(M,l[M]),done:!1}}return R=!0,{done:!0,value:void 0}}};return L[Symbol.iterator]=function(){return L},L}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function f(l,h,g){return l.call.apply(l.bind,arguments)}function p(l,h,g){if(!l)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var L=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(L,R),l.apply(h,L)}}return function(){return l.apply(h,arguments)}}function m(l,h,g){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,m.apply(null,arguments)}function I(l,h){var g=Array.prototype.slice.call(arguments,1);return function(){var R=g.slice();return R.push.apply(R,arguments),l.apply(this,R)}}function y(l,h){function g(){}g.prototype=h.prototype,l.aa=h.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(R,L,M){for(var q=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)q[Ie-2]=arguments[Ie];return h.prototype[L].apply(R,q)}}function N(l){const h=l.length;if(0<h){const g=Array(h);for(let R=0;R<h;R++)g[R]=l[R];return g}return[]}function T(l,h){for(let g=1;g<arguments.length;g++){const R=arguments[g];if(u(R)){const L=l.length||0,M=R.length||0;l.length=L+M;for(let q=0;q<M;q++)l[L+q]=R[q]}else l.push(R)}}class x{constructor(h,g){this.i=h,this.j=g,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function _(l){return/^[\s\xa0]*$/.test(l)}function E(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function k(l){return k[" "](l),l}k[" "]=function(){};var O=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function D(l,h,g){for(const R in l)h.call(g,l[R],R,l)}function w(l,h){for(const g in l)h.call(void 0,l[g],g,l)}function v(l){const h={};for(const g in l)h[g]=l[g];return h}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(l,h){let g,R;for(let L=1;L<arguments.length;L++){R=arguments[L];for(g in R)l[g]=R[g];for(let M=0;M<A.length;M++)g=A[M],Object.prototype.hasOwnProperty.call(R,g)&&(l[g]=R[g])}}function C(l){var h=1;l=l.split(":");const g=[];for(;0<h&&l.length;)g.push(l.shift()),h--;return l.length&&g.push(l.join(":")),g}function j(l){c.setTimeout(()=>{throw l},0)}function S(){var l=Y;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class U{constructor(){this.h=this.g=null}add(h,g){const R=K.get();R.set(h,g),this.h?this.h.next=R:this.g=R,this.h=R}}var K=new x(()=>new te,l=>l.reset());class te{constructor(){this.next=this.g=this.h=null}set(h,g){this.h=h,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ve,B=!1,Y=new U,V=()=>{const l=c.Promise.resolve(void 0);ve=()=>{l.then(ie)}};var ie=()=>{for(var l;l=S();){try{l.h.call(l.g)}catch(g){j(g)}var h=K;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}B=!1};function oe(){this.s=this.s,this.C=this.C}oe.prototype.s=!1,oe.prototype.ma=function(){this.s||(this.s=!0,this.N())},oe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function pe(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}pe.prototype.h=function(){this.defaultPrevented=!0};var Pe=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};c.addEventListener("test",g,h),c.removeEventListener("test",g,h)}catch{}return l}();function ot(l,h){if(pe.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,R=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(O){e:{try{k(h.nodeName);var L=!0;break e}catch{}L=!1}L||(h=null)}}else g=="mouseover"?h=l.fromElement:g=="mouseout"&&(h=l.toElement);this.relatedTarget=h,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Et[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&ot.aa.h.call(this)}}y(ot,pe);var Et={2:"touch",3:"pen",4:"mouse"};ot.prototype.h=function(){ot.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ye="closure_listenable_"+(1e6*Math.random()|0),lt=0;function bo(l,h,g,R,L){this.listener=l,this.proxy=null,this.src=h,this.type=g,this.capture=!!R,this.ha=L,this.key=++lt,this.da=this.fa=!1}function Oo(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Do(l){this.src=l,this.g={},this.h=0}Do.prototype.add=function(l,h,g,R,L){var M=l.toString();l=this.g[M],l||(l=this.g[M]=[],this.h++);var q=Eu(l,h,R,L);return-1<q?(h=l[q],g||(h.fa=!1)):(h=new bo(h,this.src,M,!!R,L),h.fa=g,l.push(h)),h};function wu(l,h){var g=h.type;if(g in l.g){var R=l.g[g],L=Array.prototype.indexOf.call(R,h,void 0),M;(M=0<=L)&&Array.prototype.splice.call(R,L,1),M&&(Oo(h),l.g[g].length==0&&(delete l.g[g],l.h--))}}function Eu(l,h,g,R){for(var L=0;L<l.length;++L){var M=l[L];if(!M.da&&M.listener==h&&M.capture==!!g&&M.ha==R)return L}return-1}var xu="closure_lm_"+(1e6*Math.random()|0),Iu={};function lm(l,h,g,R,L){if(Array.isArray(h)){for(var M=0;M<h.length;M++)lm(l,h[M],g,R,L);return null}return g=dm(g),l&&l[ye]?l.K(h,g,d(R)?!!R.capture:!1,L):i0(l,h,g,!1,R,L)}function i0(l,h,g,R,L,M){if(!h)throw Error("Invalid event type");var q=d(L)?!!L.capture:!!L,Ie=Nu(l);if(Ie||(l[xu]=Ie=new Do(l)),g=Ie.add(h,g,R,q,M),g.proxy)return g;if(R=a0(),g.proxy=R,R.src=l,R.listener=g,l.addEventListener)Pe||(L=q),L===void 0&&(L=!1),l.addEventListener(h.toString(),R,L);else if(l.attachEvent)l.attachEvent(um(h.toString()),R);else if(l.addListener&&l.removeListener)l.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return g}function a0(){function l(g){return h.call(l.src,l.listener,g)}const h=o0;return l}function cm(l,h,g,R,L){if(Array.isArray(h))for(var M=0;M<h.length;M++)cm(l,h[M],g,R,L);else R=d(R)?!!R.capture:!!R,g=dm(g),l&&l[ye]?(l=l.i,h=String(h).toString(),h in l.g&&(M=l.g[h],g=Eu(M,g,R,L),-1<g&&(Oo(M[g]),Array.prototype.splice.call(M,g,1),M.length==0&&(delete l.g[h],l.h--)))):l&&(l=Nu(l))&&(h=l.g[h.toString()],l=-1,h&&(l=Eu(h,g,R,L)),(g=-1<l?h[l]:null)&&Tu(g))}function Tu(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[ye])wu(h.i,l);else{var g=l.type,R=l.proxy;h.removeEventListener?h.removeEventListener(g,R,l.capture):h.detachEvent?h.detachEvent(um(g),R):h.addListener&&h.removeListener&&h.removeListener(R),(g=Nu(h))?(wu(g,l),g.h==0&&(g.src=null,h[xu]=null)):Oo(l)}}}function um(l){return l in Iu?Iu[l]:Iu[l]="on"+l}function o0(l,h){if(l.da)l=!0;else{h=new ot(h,this);var g=l.listener,R=l.ha||l.src;l.fa&&Tu(l),l=g.call(R,h)}return l}function Nu(l){return l=l[xu],l instanceof Do?l:null}var Su="__closure_events_fn_"+(1e9*Math.random()>>>0);function dm(l){return typeof l=="function"?l:(l[Su]||(l[Su]=function(h){return l.handleEvent(h)}),l[Su])}function ct(){oe.call(this),this.i=new Do(this),this.M=this,this.F=null}y(ct,oe),ct.prototype[ye]=!0,ct.prototype.removeEventListener=function(l,h,g,R){cm(this,l,h,g,R)};function xt(l,h){var g,R=l.F;if(R)for(g=[];R;R=R.F)g.push(R);if(l=l.M,R=h.type||h,typeof h=="string")h=new pe(h,l);else if(h instanceof pe)h.target=h.target||l;else{var L=h;h=new pe(R,l),P(h,L)}if(L=!0,g)for(var M=g.length-1;0<=M;M--){var q=h.g=g[M];L=Lo(q,R,!0,h)&&L}if(q=h.g=l,L=Lo(q,R,!0,h)&&L,L=Lo(q,R,!1,h)&&L,g)for(M=0;M<g.length;M++)q=h.g=g[M],L=Lo(q,R,!1,h)&&L}ct.prototype.N=function(){if(ct.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var g=l.g[h],R=0;R<g.length;R++)Oo(g[R]);delete l.g[h],l.h--}}this.F=null},ct.prototype.K=function(l,h,g,R){return this.i.add(String(l),h,!1,g,R)},ct.prototype.L=function(l,h,g,R){return this.i.add(String(l),h,!0,g,R)};function Lo(l,h,g,R){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var L=!0,M=0;M<h.length;++M){var q=h[M];if(q&&!q.da&&q.capture==g){var Ie=q.listener,Ze=q.ha||q.src;q.fa&&wu(l.i,q),L=Ie.call(Ze,R)!==!1&&L}}return L&&!R.defaultPrevented}function hm(l,h,g){if(typeof l=="function")g&&(l=m(l,g));else if(l&&typeof l.handleEvent=="function")l=m(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(l,h||0)}function fm(l){l.g=hm(()=>{l.g=null,l.i&&(l.i=!1,fm(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class l0 extends oe{constructor(h,g){super(),this.m=h,this.l=g,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:fm(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Di(l){oe.call(this),this.h=l,this.g={}}y(Di,oe);var pm=[];function mm(l){D(l.g,function(h,g){this.g.hasOwnProperty(g)&&Tu(h)},l),l.g={}}Di.prototype.N=function(){Di.aa.N.call(this),mm(this)},Di.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Au=c.JSON.stringify,c0=c.JSON.parse,u0=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function Ru(){}Ru.prototype.h=null;function gm(l){return l.h||(l.h=l.i())}function vm(){}var Li={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Cu(){pe.call(this,"d")}y(Cu,pe);function ku(){pe.call(this,"c")}y(ku,pe);var Wr={},ym=null;function Vo(){return ym=ym||new ct}Wr.La="serverreachability";function _m(l){pe.call(this,Wr.La,l)}y(_m,pe);function Vi(l){const h=Vo();xt(h,new _m(h))}Wr.STAT_EVENT="statevent";function wm(l,h){pe.call(this,Wr.STAT_EVENT,l),this.stat=h}y(wm,pe);function It(l){const h=Vo();xt(h,new wm(h,l))}Wr.Ma="timingevent";function Em(l,h){pe.call(this,Wr.Ma,l),this.size=h}y(Em,pe);function Mi(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},h)}function Fi(){this.g=!0}Fi.prototype.xa=function(){this.g=!1};function d0(l,h,g,R,L,M){l.info(function(){if(l.g)if(M)for(var q="",Ie=M.split("&"),Ze=0;Ze<Ie.length;Ze++){var me=Ie[Ze].split("=");if(1<me.length){var ut=me[0];me=me[1];var dt=ut.split("_");q=2<=dt.length&&dt[1]=="type"?q+(ut+"="+me+"&"):q+(ut+"=redacted&")}}else q=null;else q=M;return"XMLHTTP REQ ("+R+") [attempt "+L+"]: "+h+`
`+g+`
`+q})}function h0(l,h,g,R,L,M,q){l.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+L+"]: "+h+`
`+g+`
`+M+" "+q})}function Rs(l,h,g,R){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+p0(l,g)+(R?" "+R:"")})}function f0(l,h){l.info(function(){return"TIMEOUT: "+h})}Fi.prototype.info=function(){};function p0(l,h){if(!l.g)return h;if(!h)return null;try{var g=JSON.parse(h);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var R=g[l];if(!(2>R.length)){var L=R[1];if(Array.isArray(L)&&!(1>L.length)){var M=L[0];if(M!="noop"&&M!="stop"&&M!="close")for(var q=1;q<L.length;q++)L[q]=""}}}}return Au(g)}catch{return h}}var Mo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},xm={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Pu;function Fo(){}y(Fo,Ru),Fo.prototype.g=function(){return new XMLHttpRequest},Fo.prototype.i=function(){return{}},Pu=new Fo;function Xn(l,h,g,R){this.j=l,this.i=h,this.l=g,this.R=R||1,this.U=new Di(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Im}function Im(){this.i=null,this.g="",this.h=!1}var Tm={},ju={};function bu(l,h,g){l.L=1,l.v=$o(Sn(h)),l.m=g,l.P=!0,Nm(l,null)}function Nm(l,h){l.F=Date.now(),Uo(l),l.A=Sn(l.v);var g=l.A,R=l.R;Array.isArray(R)||(R=[String(R)]),Fm(g.i,"t",R),l.C=0,g=l.j.J,l.h=new Im,l.g=rg(l.j,g?h:null,!l.m),0<l.O&&(l.M=new l0(m(l.Y,l,l.g),l.O)),h=l.U,g=l.g,R=l.ca;var L="readystatechange";Array.isArray(L)||(L&&(pm[0]=L.toString()),L=pm);for(var M=0;M<L.length;M++){var q=lm(g,L[M],R||h.handleEvent,!1,h.h||h);if(!q)break;h.g[q.key]=q}h=l.H?v(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Vi(),d0(l.i,l.u,l.A,l.l,l.R,l.m)}Xn.prototype.ca=function(l){l=l.target;const h=this.M;h&&An(l)==3?h.j():this.Y(l)},Xn.prototype.Y=function(l){try{if(l==this.g)e:{const dt=An(this.g);var h=this.g.Ba();const Ps=this.g.Z();if(!(3>dt)&&(dt!=3||this.g&&(this.h.h||this.g.oa()||Hm(this.g)))){this.J||dt!=4||h==7||(h==8||0>=Ps?Vi(3):Vi(2)),Ou(this);var g=this.g.Z();this.X=g;t:if(Sm(this)){var R=Hm(this.g);l="";var L=R.length,M=An(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){qr(this),Ui(this);var q="";break t}this.h.i=new c.TextDecoder}for(h=0;h<L;h++)this.h.h=!0,l+=this.h.i.decode(R[h],{stream:!(M&&h==L-1)});R.length=0,this.h.g+=l,this.C=0,q=this.h.g}else q=this.g.oa();if(this.o=g==200,h0(this.i,this.u,this.A,this.l,this.R,dt,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Ie,Ze=this.g;if((Ie=Ze.g?Ze.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(Ie)){var me=Ie;break t}}me=null}if(g=me)Rs(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Du(this,g);else{this.o=!1,this.s=3,It(12),qr(this),Ui(this);break e}}if(this.P){g=!0;let tn;for(;!this.J&&this.C<q.length;)if(tn=m0(this,q),tn==ju){dt==4&&(this.s=4,It(14),g=!1),Rs(this.i,this.l,null,"[Incomplete Response]");break}else if(tn==Tm){this.s=4,It(15),Rs(this.i,this.l,q,"[Invalid Chunk]"),g=!1;break}else Rs(this.i,this.l,tn,null),Du(this,tn);if(Sm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dt!=4||q.length!=0||this.h.h||(this.s=1,It(16),g=!1),this.o=this.o&&g,!g)Rs(this.i,this.l,q,"[Invalid Chunked Response]"),qr(this),Ui(this);else if(0<q.length&&!this.W){this.W=!0;var ut=this.j;ut.g==this&&ut.ba&&!ut.M&&(ut.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),zu(ut),ut.M=!0,It(11))}}else Rs(this.i,this.l,q,null),Du(this,q);dt==4&&qr(this),this.o&&!this.J&&(dt==4?Zm(this.j,this):(this.o=!1,Uo(this)))}else j0(this.g),g==400&&0<q.indexOf("Unknown SID")?(this.s=3,It(12)):(this.s=0,It(13)),qr(this),Ui(this)}}}catch{}finally{}};function Sm(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function m0(l,h){var g=l.C,R=h.indexOf(`
`,g);return R==-1?ju:(g=Number(h.substring(g,R)),isNaN(g)?Tm:(R+=1,R+g>h.length?ju:(h=h.slice(R,R+g),l.C=R+g,h)))}Xn.prototype.cancel=function(){this.J=!0,qr(this)};function Uo(l){l.S=Date.now()+l.I,Am(l,l.I)}function Am(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Mi(m(l.ba,l),h)}function Ou(l){l.B&&(c.clearTimeout(l.B),l.B=null)}Xn.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(f0(this.i,this.A),this.L!=2&&(Vi(),It(17)),qr(this),this.s=2,Ui(this)):Am(this,this.S-l)};function Ui(l){l.j.G==0||l.J||Zm(l.j,l)}function qr(l){Ou(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,mm(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Du(l,h){try{var g=l.j;if(g.G!=0&&(g.g==l||Lu(g.h,l))){if(!l.K&&Lu(g.h,l)&&g.G==3){try{var R=g.Da.g.parse(h)}catch{R=null}if(Array.isArray(R)&&R.length==3){var L=R;if(L[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)Qo(g),Ko(g);else break e;Uu(g),It(18)}}else g.za=L[1],0<g.za-g.T&&37500>L[2]&&g.F&&g.v==0&&!g.C&&(g.C=Mi(m(g.Za,g),6e3));if(1>=km(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Kr(g,11)}else if((l.K||g.g==l)&&Qo(g),!_(h))for(L=g.Da.g.parse(h),h=0;h<L.length;h++){let me=L[h];if(g.T=me[0],me=me[1],g.G==2)if(me[0]=="c"){g.K=me[1],g.ia=me[2];const ut=me[3];ut!=null&&(g.la=ut,g.j.info("VER="+g.la));const dt=me[4];dt!=null&&(g.Aa=dt,g.j.info("SVER="+g.Aa));const Ps=me[5];Ps!=null&&typeof Ps=="number"&&0<Ps&&(R=1.5*Ps,g.L=R,g.j.info("backChannelRequestTimeoutMs_="+R)),R=g;const tn=l.g;if(tn){const Xo=tn.g?tn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xo){var M=R.h;M.g||Xo.indexOf("spdy")==-1&&Xo.indexOf("quic")==-1&&Xo.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Vu(M,M.h),M.h=null))}if(R.D){const Bu=tn.g?tn.g.getResponseHeader("X-HTTP-Session-Id"):null;Bu&&(R.ya=Bu,Se(R.I,R.D,Bu))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),R=g;var q=l;if(R.qa=ng(R,R.J?R.ia:null,R.W),q.K){Pm(R.h,q);var Ie=q,Ze=R.L;Ze&&(Ie.I=Ze),Ie.B&&(Ou(Ie),Uo(Ie)),R.g=q}else Xm(R);0<g.i.length&&Go(g)}else me[0]!="stop"&&me[0]!="close"||Kr(g,7);else g.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?Kr(g,7):Fu(g):me[0]!="noop"&&g.l&&g.l.ta(me),g.v=0)}}Vi(4)}catch{}}var g0=class{constructor(l,h){this.g=l,this.map=h}};function Rm(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Cm(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function km(l){return l.h?1:l.g?l.g.size:0}function Lu(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Vu(l,h){l.g?l.g.add(h):l.h=h}function Pm(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Rm.prototype.cancel=function(){if(this.i=jm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function jm(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const g of l.g.values())h=h.concat(g.D);return h}return N(l.i)}function v0(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],g=l.length,R=0;R<g;R++)h.push(l[R]);return h}h=[],g=0;for(R in l)h[g++]=l[R];return h}function y0(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var g=0;g<l;g++)h.push(g);return h}h=[],g=0;for(const R in l)h[g++]=R;return h}}}function bm(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var g=y0(l),R=v0(l),L=R.length,M=0;M<L;M++)h.call(void 0,R[M],g&&g[M],l)}var Om=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _0(l,h){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var R=l[g].indexOf("="),L=null;if(0<=R){var M=l[g].substring(0,R);L=l[g].substring(R+1)}else M=l[g];h(M,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function Hr(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Hr){this.h=l.h,zo(this,l.j),this.o=l.o,this.g=l.g,Bo(this,l.s),this.l=l.l;var h=l.i,g=new $i;g.i=h.i,h.g&&(g.g=new Map(h.g),g.h=h.h),Dm(this,g),this.m=l.m}else l&&(h=String(l).match(Om))?(this.h=!1,zo(this,h[1]||"",!0),this.o=zi(h[2]||""),this.g=zi(h[3]||"",!0),Bo(this,h[4]),this.l=zi(h[5]||"",!0),Dm(this,h[6]||"",!0),this.m=zi(h[7]||"")):(this.h=!1,this.i=new $i(null,this.h))}Hr.prototype.toString=function(){var l=[],h=this.j;h&&l.push(Bi(h,Lm,!0),":");var g=this.g;return(g||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Bi(h,Lm,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(Bi(g,g.charAt(0)=="/"?x0:E0,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",Bi(g,T0)),l.join("")};function Sn(l){return new Hr(l)}function zo(l,h,g){l.j=g?zi(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Bo(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function Dm(l,h,g){h instanceof $i?(l.i=h,N0(l.i,l.h)):(g||(h=Bi(h,I0)),l.i=new $i(h,l.h))}function Se(l,h,g){l.i.set(h,g)}function $o(l){return Se(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function zi(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Bi(l,h,g){return typeof l=="string"?(l=encodeURI(l).replace(h,w0),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function w0(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Lm=/[#\/\?@]/g,E0=/[#\?:]/g,x0=/[#\?]/g,I0=/[#\?@]/g,T0=/#/g;function $i(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Jn(l){l.g||(l.g=new Map,l.h=0,l.i&&_0(l.i,function(h,g){l.add(decodeURIComponent(h.replace(/\+/g," ")),g)}))}t=$i.prototype,t.add=function(l,h){Jn(this),this.i=null,l=Cs(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(h),this.h+=1,this};function Vm(l,h){Jn(l),h=Cs(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Mm(l,h){return Jn(l),h=Cs(l,h),l.g.has(h)}t.forEach=function(l,h){Jn(this),this.g.forEach(function(g,R){g.forEach(function(L){l.call(h,L,R,this)},this)},this)},t.na=function(){Jn(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),g=[];for(let R=0;R<h.length;R++){const L=l[R];for(let M=0;M<L.length;M++)g.push(h[R])}return g},t.V=function(l){Jn(this);let h=[];if(typeof l=="string")Mm(this,l)&&(h=h.concat(this.g.get(Cs(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)h=h.concat(l[g])}return h},t.set=function(l,h){return Jn(this),this.i=null,l=Cs(this,l),Mm(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Fm(l,h,g){Vm(l,h),0<g.length&&(l.i=null,l.g.set(Cs(l,h),N(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var g=0;g<h.length;g++){var R=h[g];const M=encodeURIComponent(String(R)),q=this.V(R);for(R=0;R<q.length;R++){var L=M;q[R]!==""&&(L+="="+encodeURIComponent(String(q[R]))),l.push(L)}}return this.i=l.join("&")};function Cs(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function N0(l,h){h&&!l.j&&(Jn(l),l.i=null,l.g.forEach(function(g,R){var L=R.toLowerCase();R!=L&&(Vm(this,R),Fm(this,L,g))},l)),l.j=h}function S0(l,h){const g=new Fi;if(c.Image){const R=new Image;R.onload=I(Zn,g,"TestLoadImage: loaded",!0,h,R),R.onerror=I(Zn,g,"TestLoadImage: error",!1,h,R),R.onabort=I(Zn,g,"TestLoadImage: abort",!1,h,R),R.ontimeout=I(Zn,g,"TestLoadImage: timeout",!1,h,R),c.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=l}else h(!1)}function A0(l,h){const g=new Fi,R=new AbortController,L=setTimeout(()=>{R.abort(),Zn(g,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:R.signal}).then(M=>{clearTimeout(L),M.ok?Zn(g,"TestPingServer: ok",!0,h):Zn(g,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(L),Zn(g,"TestPingServer: error",!1,h)})}function Zn(l,h,g,R,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),R(g)}catch{}}function R0(){this.g=new u0}function C0(l,h,g){const R=g||"";try{bm(l,function(L,M){let q=L;d(L)&&(q=Au(L)),h.push(R+M+"="+encodeURIComponent(q))})}catch(L){throw h.push(R+"type="+encodeURIComponent("_badmap")),L}}function Wo(l){this.l=l.Ub||null,this.j=l.eb||!1}y(Wo,Ru),Wo.prototype.g=function(){return new qo(this.l,this.j)},Wo.prototype.i=function(l){return function(){return l}}({});function qo(l,h){ct.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(qo,ct),t=qo.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,qi(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Wi(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,qi(this)),this.g&&(this.readyState=3,qi(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Um(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Um(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Wi(this):qi(this),this.readyState==3&&Um(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Wi(this))},t.Qa=function(l){this.g&&(this.response=l,Wi(this))},t.ga=function(){this.g&&Wi(this)};function Wi(l){l.readyState=4,l.l=null,l.j=null,l.v=null,qi(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var g=h.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=h.next();return l.join(`\r
`)};function qi(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(qo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function zm(l){let h="";return D(l,function(g,R){h+=R,h+=":",h+=g,h+=`\r
`}),h}function Mu(l,h,g){e:{for(R in g){var R=!1;break e}R=!0}R||(g=zm(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):Se(l,h,g))}function Ve(l){ct.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Ve,ct);var k0=/^https?$/i,P0=["POST","PUT"];t=Ve.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,g,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Pu.g(),this.v=this.o?gm(this.o):gm(Pu),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(M){Bm(this,M);return}if(l=g||"",g=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var L in R)g.set(L,R[L]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const M of R.keys())g.set(M,R.get(M));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(g.keys()).find(M=>M.toLowerCase()=="content-type"),L=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(P0,h,void 0))||R||L||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,q]of g)this.g.setRequestHeader(M,q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qm(this),this.u=!0,this.g.send(l),this.u=!1}catch(M){Bm(this,M)}};function Bm(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,$m(l),Ho(l)}function $m(l){l.A||(l.A=!0,xt(l,"complete"),xt(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,xt(this,"complete"),xt(this,"abort"),Ho(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ho(this,!0)),Ve.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Wm(this):this.bb())},t.bb=function(){Wm(this)};function Wm(l){if(l.h&&typeof a<"u"&&(!l.v[1]||An(l)!=4||l.Z()!=2)){if(l.u&&An(l)==4)hm(l.Ea,0,l);else if(xt(l,"readystatechange"),An(l)==4){l.h=!1;try{const q=l.Z();e:switch(q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var g;if(!(g=h)){var R;if(R=q===0){var L=String(l.D).match(Om)[1]||null;!L&&c.self&&c.self.location&&(L=c.self.location.protocol.slice(0,-1)),R=!k0.test(L?L.toLowerCase():"")}g=R}if(g)xt(l,"complete"),xt(l,"success");else{l.m=6;try{var M=2<An(l)?l.g.statusText:""}catch{M=""}l.l=M+" ["+l.Z()+"]",$m(l)}}finally{Ho(l)}}}}function Ho(l,h){if(l.g){qm(l);const g=l.g,R=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||xt(l,"ready");try{g.onreadystatechange=R}catch{}}}function qm(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function An(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<An(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),c0(h)}};function Hm(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function j0(l){const h={};l=(l.g&&2<=An(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<l.length;R++){if(_(l[R]))continue;var g=C(l[R]);const L=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const M=h[L]||[];h[L]=M,M.push(g)}w(h,function(R){return R.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Hi(l,h,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||h}function Km(l){this.Aa=0,this.i=[],this.j=new Fi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Hi("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Hi("baseRetryDelayMs",5e3,l),this.cb=Hi("retryDelaySeedMs",1e4,l),this.Wa=Hi("forwardChannelMaxRetries",2,l),this.wa=Hi("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Rm(l&&l.concurrentRequestLimit),this.Da=new R0,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Km.prototype,t.la=8,t.G=1,t.connect=function(l,h,g,R){It(0),this.W=l,this.H=h||{},g&&R!==void 0&&(this.H.OSID=g,this.H.OAID=R),this.F=this.X,this.I=ng(this,null,this.W),Go(this)};function Fu(l){if(Gm(l),l.G==3){var h=l.U++,g=Sn(l.I);if(Se(g,"SID",l.K),Se(g,"RID",h),Se(g,"TYPE","terminate"),Ki(l,g),h=new Xn(l,l.j,h),h.L=2,h.v=$o(Sn(g)),g=!1,c.navigator&&c.navigator.sendBeacon)try{g=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!g&&c.Image&&(new Image().src=h.v,g=!0),g||(h.g=rg(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Uo(h)}tg(l)}function Ko(l){l.g&&(zu(l),l.g.cancel(),l.g=null)}function Gm(l){Ko(l),l.u&&(c.clearTimeout(l.u),l.u=null),Qo(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function Go(l){if(!Cm(l.h)&&!l.s){l.s=!0;var h=l.Ga;ve||V(),B||(ve(),B=!0),Y.add(h,l),l.B=0}}function b0(l,h){return km(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Mi(m(l.Ga,l,h),eg(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const L=new Xn(this,this.j,l);let M=this.o;if(this.S&&(M?(M=v(M),P(M,this.S)):M=this.S),this.m!==null||this.O||(L.H=M,M=null),this.P)e:{for(var h=0,g=0;g<this.i.length;g++){t:{var R=this.i[g];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(h+=R,4096<h){h=g;break e}if(h===4096||g===this.i.length-1){h=g+1;break e}}h=1e3}else h=1e3;h=Ym(this,L,h),g=Sn(this.I),Se(g,"RID",l),Se(g,"CVER",22),this.D&&Se(g,"X-HTTP-Session-Id",this.D),Ki(this,g),M&&(this.O?h="headers="+encodeURIComponent(String(zm(M)))+"&"+h:this.m&&Mu(g,this.m,M)),Vu(this.h,L),this.Ua&&Se(g,"TYPE","init"),this.P?(Se(g,"$req",h),Se(g,"SID","null"),L.T=!0,bu(L,g,null)):bu(L,g,h),this.G=2}}else this.G==3&&(l?Qm(this,l):this.i.length==0||Cm(this.h)||Qm(this))};function Qm(l,h){var g;h?g=h.l:g=l.U++;const R=Sn(l.I);Se(R,"SID",l.K),Se(R,"RID",g),Se(R,"AID",l.T),Ki(l,R),l.m&&l.o&&Mu(R,l.m,l.o),g=new Xn(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Ym(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Vu(l.h,g),bu(g,R,h)}function Ki(l,h){l.H&&D(l.H,function(g,R){Se(h,R,g)}),l.l&&bm({},function(g,R){Se(h,R,g)})}function Ym(l,h,g){g=Math.min(l.i.length,g);var R=l.l?m(l.l.Na,l.l,l):null;e:{var L=l.i;let M=-1;for(;;){const q=["count="+g];M==-1?0<g?(M=L[0].g,q.push("ofs="+M)):M=0:q.push("ofs="+M);let Ie=!0;for(let Ze=0;Ze<g;Ze++){let me=L[Ze].g;const ut=L[Ze].map;if(me-=M,0>me)M=Math.max(0,L[Ze].g-100),Ie=!1;else try{C0(ut,q,"req"+me+"_")}catch{R&&R(ut)}}if(Ie){R=q.join("&");break e}}}return l=l.i.splice(0,g),h.D=l,R}function Xm(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;ve||V(),B||(ve(),B=!0),Y.add(h,l),l.v=0}}function Uu(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Mi(m(l.Fa,l),eg(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Jm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Mi(m(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,It(10),Ko(this),Jm(this))};function zu(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Jm(l){l.g=new Xn(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=Sn(l.qa);Se(h,"RID","rpc"),Se(h,"SID",l.K),Se(h,"AID",l.T),Se(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&Se(h,"TO",l.ja),Se(h,"TYPE","xmlhttp"),Ki(l,h),l.m&&l.o&&Mu(h,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=$o(Sn(h)),g.m=null,g.P=!0,Nm(g,l)}t.Za=function(){this.C!=null&&(this.C=null,Ko(this),Uu(this),It(19))};function Qo(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Zm(l,h){var g=null;if(l.g==h){Qo(l),zu(l),l.g=null;var R=2}else if(Lu(l.h,h))g=h.D,Pm(l.h,h),R=1;else return;if(l.G!=0){if(h.o)if(R==1){g=h.m?h.m.length:0,h=Date.now()-h.F;var L=l.B;R=Vo(),xt(R,new Em(R,g)),Go(l)}else Xm(l);else if(L=h.s,L==3||L==0&&0<h.X||!(R==1&&b0(l,h)||R==2&&Uu(l)))switch(g&&0<g.length&&(h=l.h,h.i=h.i.concat(g)),L){case 1:Kr(l,5);break;case 4:Kr(l,10);break;case 3:Kr(l,6);break;default:Kr(l,2)}}}function eg(l,h){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*h}function Kr(l,h){if(l.j.info("Error code "+h),h==2){var g=m(l.fb,l),R=l.Xa;const L=!R;R=new Hr(R||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||zo(R,"https"),$o(R),L?S0(R.toString(),g):A0(R.toString(),g)}else It(2);l.G=0,l.l&&l.l.sa(h),tg(l),Gm(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),It(2)):(this.j.info("Failed to ping google.com"),It(1))};function tg(l){if(l.G=0,l.ka=[],l.l){const h=jm(l.h);(h.length!=0||l.i.length!=0)&&(T(l.ka,h),T(l.ka,l.i),l.h.i.length=0,N(l.i),l.i.length=0),l.l.ra()}}function ng(l,h,g){var R=g instanceof Hr?Sn(g):new Hr(g);if(R.g!="")h&&(R.g=h+"."+R.g),Bo(R,R.s);else{var L=c.location;R=L.protocol,h=h?h+"."+L.hostname:L.hostname,L=+L.port;var M=new Hr(null);R&&zo(M,R),h&&(M.g=h),L&&Bo(M,L),g&&(M.l=g),R=M}return g=l.D,h=l.ya,g&&h&&Se(R,g,h),Se(R,"VER",l.la),Ki(l,R),R}function rg(l,h,g){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new Ve(new Wo({eb:g})):new Ve(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function sg(){}t=sg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Yo(){}Yo.prototype.g=function(l,h){return new Lt(l,h)};function Lt(l,h){ct.call(this),this.g=new Km(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!_(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!_(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new ks(this)}y(Lt,ct),Lt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Lt.prototype.close=function(){Fu(this.g)},Lt.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=Au(l),l=g);h.i.push(new g0(h.Ya++,l)),h.G==3&&Go(h)},Lt.prototype.N=function(){this.g.l=null,delete this.j,Fu(this.g),delete this.g,Lt.aa.N.call(this)};function ig(l){Cu.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const g in h){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}y(ig,Cu);function ag(){ku.call(this),this.status=1}y(ag,ku);function ks(l){this.g=l}y(ks,sg),ks.prototype.ua=function(){xt(this.g,"a")},ks.prototype.ta=function(l){xt(this.g,new ig(l))},ks.prototype.sa=function(l){xt(this.g,new ag)},ks.prototype.ra=function(){xt(this.g,"b")},Yo.prototype.createWebChannel=Yo.prototype.g,Lt.prototype.send=Lt.prototype.o,Lt.prototype.open=Lt.prototype.m,Lt.prototype.close=Lt.prototype.close,mx=function(){return new Yo},px=function(){return Vo()},fx=Wr,Lh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Mo.NO_ERROR=0,Mo.TIMEOUT=8,Mo.HTTP_ERROR=6,Fl=Mo,xm.COMPLETE="complete",hx=xm,vm.EventType=Li,Li.OPEN="a",Li.CLOSE="b",Li.ERROR="c",Li.MESSAGE="d",ct.prototype.listen=ct.prototype.K,da=vm,Ve.prototype.listenOnce=Ve.prototype.L,Ve.prototype.getLastError=Ve.prototype.Ka,Ve.prototype.getLastErrorCode=Ve.prototype.Ba,Ve.prototype.getStatus=Ve.prototype.Z,Ve.prototype.getResponseJson=Ve.prototype.Oa,Ve.prototype.getResponseText=Ve.prototype.oa,Ve.prototype.send=Ve.prototype.ea,Ve.prototype.setWithCredentials=Ve.prototype.Ha,dx=Ve}).apply(typeof gl<"u"?gl:typeof self<"u"?self:typeof window<"u"?window:{});const Zv="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}mt.UNAUTHENTICATED=new mt(null),mt.GOOGLE_CREDENTIALS=new mt("google-credentials-uid"),mt.FIRST_PARTY=new mt("first-party-uid"),mt.MOCK_USER=new mt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ai="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs=new Xf("@firebase/firestore");function na(){return gs.logLevel}function Q(t,...e){if(gs.logLevel<=ue.DEBUG){const n=e.map(dp);gs.debug(`Firestore (${Ai}): ${t}`,...n)}}function Wn(t,...e){if(gs.logLevel<=ue.ERROR){const n=e.map(dp);gs.error(`Firestore (${Ai}): ${t}`,...n)}}function fi(t,...e){if(gs.logLevel<=ue.WARN){const n=e.map(dp);gs.warn(`Firestore (${Ai}): ${t}`,...n)}}function dp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ee(t="Unexpected state"){const e=`FIRESTORE (${Ai}) INTERNAL ASSERTION FAILED: `+t;throw Wn(e),new Error(e)}function he(t,e){t||ee()}function se(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class H extends Nn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class eP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(mt.UNAUTHENTICATED))}shutdown(){}}class tP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class nP{constructor(e){this.t=e,this.currentUser=mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){he(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new dn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new dn,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{Q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Q("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new dn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(he(typeof r.accessToken=="string"),new gx(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return he(e===null||typeof e=="string"),new mt(e)}}class rP{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=mt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class sP{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new rP(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class iP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class aP{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){he(this.o===void 0);const r=i=>{i.error!=null&&Q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,Q("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):Q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(he(typeof n.token=="string"),this.R=n.token,new iP(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=oP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function ge(t,e){return t<e?-1:t>e?1:0}function pi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new H(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new H(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new H(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new H(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ge.fromMillis(Date.now())}static fromDate(e){return Ge.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ge(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ge(this.nanoseconds,e.nanoseconds):ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ne(e)}static min(){return new ne(new Ge(0,0))}static max(){return new ne(new Ge(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n,r){n===void 0?n=0:n>e.length&&ee(),r===void 0?r=e.length-n:r>e.length-n&&ee(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return no.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof no?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ee extends no{construct(e,n,r){return new Ee(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new H(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ee(n)}static emptyPath(){return new Ee([])}}const lP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nt extends no{construct(e,n,r){return new nt(e,n,r)}static isValidIdentifier(e){return lP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new nt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new H(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new H(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new H(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new H(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new nt(n)}static emptyPath(){return new nt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.path=e}static fromPath(e){return new X(Ee.fromString(e))}static fromName(e){return new X(Ee.fromString(e).popFirst(5))}static empty(){return new X(Ee.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ee.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ee.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new X(new Ee(e.slice()))}}function cP(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ne.fromTimestamp(r===1e9?new Ge(n+1,0):new Ge(n,r));return new jr(s,X.empty(),e)}function uP(t){return new jr(t.readTime,t.key,-1)}class jr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new jr(ne.min(),X.empty(),-1)}static max(){return new jr(ne.max(),X.empty(),-1)}}function dP(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=X.comparator(t.documentKey,e.documentKey),n!==0?n:ge(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class fP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function To(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==hP)throw t;Q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ee(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new z((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof z?n:z.resolve(n)}catch(n){return z.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):z.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):z.reject(n)}static resolve(e){return new z((n,r)=>{n(e)})}static reject(e){return new z((n,r)=>{r(e)})}static waitFor(e){return new z((n,r)=>{let s=0,i=0,a=!1;e.forEach(c=>{++s,c.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(e){let n=z.resolve(!1);for(const r of e)n=n.next(s=>s?z.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new z((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(f=>{a[d]=f,++c,c===i&&r(a)},f=>s(f))}})}static doWhile(e,n){return new z((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function pP(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function No(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}hp.oe=-1;function So(t){return t==null}function xc(t){return t===0&&1/t==-1/0}function mP(t){return typeof t=="number"&&Number.isInteger(t)&&!xc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ns(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function gP(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function yx(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e,n){this.comparator=e,this.root=n||tt.EMPTY}insert(e,n){return new Le(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,tt.BLACK,null,null))}remove(e){return new Le(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vl(this.root,e,this.comparator,!1)}getReverseIterator(){return new vl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vl(this.root,e,this.comparator,!0)}}class vl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class tt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??tt.RED,this.left=s??tt.EMPTY,this.right=i??tt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new tt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return tt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return tt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,tt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,tt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ee();const e=this.left.check();if(e!==this.right.check())throw ee();return e+(this.isRed()?0:1)}}tt.EMPTY=null,tt.RED=!0,tt.BLACK=!1;tt.EMPTY=new class{constructor(){this.size=0}get key(){throw ee()}get value(){throw ee()}get color(){throw ee()}get left(){throw ee()}get right(){throw ee()}copy(e,n,r,s,i){return this}insert(e,n,r){return new tt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.comparator=e,this.data=new Le(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ty(this.data.getIterator())}getIteratorFrom(e){return new ty(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof st)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new st(this.comparator);return n.data=e,n}}class ty{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.fields=e,e.sort(nt.comparator)}static empty(){return new Ft([])}unionWith(e){let n=new st(nt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Ft(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return pi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new _x("Invalid base64 string: "+i):i}}(e);return new at(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new at(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}at.EMPTY_BYTE_STRING=new at("");const vP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function br(t){if(he(!!t),typeof t=="string"){let e=0;const n=vP.exec(t);if(he(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ze(t.seconds),nanos:ze(t.nanos)}}function ze(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function vs(t){return typeof t=="string"?at.fromBase64String(t):at.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function fp(t){const e=t.mapValue.fields.__previous_value__;return tu(e)?fp(e):e}function ro(t){const e=br(t.mapValue.fields.__local_write_time__.timestampValue);return new Ge(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e,n,r,s,i,a,c,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d}}class so{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new so("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof so&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yl={mapValue:{}};function ys(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?tu(t)?4:wP(t)?9007199254740991:_P(t)?10:11:ee()}function In(t,e){if(t===e)return!0;const n=ys(t);if(n!==ys(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ro(t).isEqual(ro(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=br(s.timestampValue),c=br(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return vs(s.bytesValue).isEqual(vs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ze(s.geoPointValue.latitude)===ze(i.geoPointValue.latitude)&&ze(s.geoPointValue.longitude)===ze(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ze(s.integerValue)===ze(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=ze(s.doubleValue),c=ze(i.doubleValue);return a===c?xc(a)===xc(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return pi(t.arrayValue.values||[],e.arrayValue.values||[],In);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(ey(a)!==ey(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!In(a[u],c[u])))return!1;return!0}(t,e);default:return ee()}}function io(t,e){return(t.values||[]).find(n=>In(n,e))!==void 0}function mi(t,e){if(t===e)return 0;const n=ys(t),r=ys(e);if(n!==r)return ge(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ge(t.booleanValue,e.booleanValue);case 2:return function(i,a){const c=ze(i.integerValue||i.doubleValue),u=ze(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return ny(t.timestampValue,e.timestampValue);case 4:return ny(ro(t),ro(e));case 5:return ge(t.stringValue,e.stringValue);case 6:return function(i,a){const c=vs(i),u=vs(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),u=a.split("/");for(let d=0;d<c.length&&d<u.length;d++){const f=ge(c[d],u[d]);if(f!==0)return f}return ge(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const c=ge(ze(i.latitude),ze(a.latitude));return c!==0?c:ge(ze(i.longitude),ze(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return ry(t.arrayValue,e.arrayValue);case 10:return function(i,a){var c,u,d,f;const p=i.fields||{},m=a.fields||{},I=(c=p.value)===null||c===void 0?void 0:c.arrayValue,y=(u=m.value)===null||u===void 0?void 0:u.arrayValue,N=ge(((d=I==null?void 0:I.values)===null||d===void 0?void 0:d.length)||0,((f=y==null?void 0:y.values)===null||f===void 0?void 0:f.length)||0);return N!==0?N:ry(I,y)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===yl.mapValue&&a===yl.mapValue)return 0;if(i===yl.mapValue)return 1;if(a===yl.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),d=a.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const m=ge(u[p],f[p]);if(m!==0)return m;const I=mi(c[u[p]],d[f[p]]);if(I!==0)return I}return ge(u.length,f.length)}(t.mapValue,e.mapValue);default:throw ee()}}function ny(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ge(t,e);const n=br(t),r=br(e),s=ge(n.seconds,r.seconds);return s!==0?s:ge(n.nanos,r.nanos)}function ry(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=mi(n[s],r[s]);if(i)return i}return ge(n.length,r.length)}function gi(t){return Vh(t)}function Vh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=br(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return vs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return X.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Vh(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Vh(n.fields[a])}`;return s+"}"}(t.mapValue):ee()}function Ic(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Mh(t){return!!t&&"integerValue"in t}function pp(t){return!!t&&"arrayValue"in t}function sy(t){return!!t&&"nullValue"in t}function iy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ul(t){return!!t&&"mapValue"in t}function _P(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Ta(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ns(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ta(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ta(t.arrayValue.values[n]);return e}return Object.assign({},t)}function wP(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.value=e}static empty(){return new St({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ul(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ta(n)}setAll(e){let n=nt.emptyPath(),r={},s=[];e.forEach((a,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}a?r[c.lastSegment()]=Ta(a):s.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Ul(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return In(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Ul(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Ns(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new St(Ta(this.value))}}function wx(t){const e=[];return Ns(t.fields,(n,r)=>{const s=new nt([n]);if(Ul(r)){const i=wx(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Ft(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e,n,r,s,i,a,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Xe(e,0,ne.min(),ne.min(),ne.min(),St.empty(),0)}static newFoundDocument(e,n,r,s){return new Xe(e,1,n,ne.min(),r,s,0)}static newNoDocument(e,n){return new Xe(e,2,n,ne.min(),ne.min(),St.empty(),0)}static newUnknownDocument(e,n){return new Xe(e,3,n,ne.min(),ne.min(),St.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=St.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=St.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,n){this.position=e,this.inclusive=n}}function ay(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=X.comparator(X.fromName(a.referenceValue),n.key):r=mi(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function oy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!In(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,n="asc"){this.field=e,this.dir=n}}function EP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{}class qe extends Ex{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new IP(e,n,r):n==="array-contains"?new SP(e,r):n==="in"?new AP(e,r):n==="not-in"?new RP(e,r):n==="array-contains-any"?new CP(e,r):new qe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new TP(e,r):new NP(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(mi(n,this.value)):n!==null&&ys(this.value)===ys(n)&&this.matchesComparison(mi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ee()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fn extends Ex{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new fn(e,n)}matches(e){return xx(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function xx(t){return t.op==="and"}function Ix(t){return xP(t)&&xx(t)}function xP(t){for(const e of t.filters)if(e instanceof fn)return!1;return!0}function Fh(t){if(t instanceof qe)return t.field.canonicalString()+t.op.toString()+gi(t.value);if(Ix(t))return t.filters.map(e=>Fh(e)).join(",");{const e=t.filters.map(n=>Fh(n)).join(",");return`${t.op}(${e})`}}function Tx(t,e){return t instanceof qe?function(r,s){return s instanceof qe&&r.op===s.op&&r.field.isEqual(s.field)&&In(r.value,s.value)}(t,e):t instanceof fn?function(r,s){return s instanceof fn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,c)=>i&&Tx(a,s.filters[c]),!0):!1}(t,e):void ee()}function Nx(t){return t instanceof qe?function(n){return`${n.field.canonicalString()} ${n.op} ${gi(n.value)}`}(t):t instanceof fn?function(n){return n.op.toString()+" {"+n.getFilters().map(Nx).join(" ,")+"}"}(t):"Filter"}class IP extends qe{constructor(e,n,r){super(e,n,r),this.key=X.fromName(r.referenceValue)}matches(e){const n=X.comparator(e.key,this.key);return this.matchesComparison(n)}}class TP extends qe{constructor(e,n){super(e,"in",n),this.keys=Sx("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class NP extends qe{constructor(e,n){super(e,"not-in",n),this.keys=Sx("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Sx(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>X.fromName(r.referenceValue))}class SP extends qe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return pp(n)&&io(n.arrayValue,this.value)}}class AP extends qe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&io(this.value.arrayValue,n)}}class RP extends qe{constructor(e,n){super(e,"not-in",n)}matches(e){if(io(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!io(this.value.arrayValue,n)}}class CP extends qe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!pp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>io(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(e,n=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.ue=null}}function ly(t,e=null,n=[],r=[],s=null,i=null,a=null){return new kP(t,e,n,r,s,i,a)}function mp(t){const e=se(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Fh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),So(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>gi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>gi(r)).join(",")),e.ue=n}return e.ue}function gp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!EP(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Tx(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!oy(t.startAt,e.startAt)&&oy(t.endAt,e.endAt)}function Uh(t){return X.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,n=null,r=[],s=[],i=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function PP(t,e,n,r,s,i,a,c){return new Ss(t,e,n,r,s,i,a,c)}function vp(t){return new Ss(t)}function cy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function yp(t){return t.collectionGroup!==null}function ri(t){const e=se(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new st(nt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new ao(i,r))}),n.has(nt.keyField().canonicalString())||e.ce.push(new ao(nt.keyField(),r))}return e.ce}function xn(t){const e=se(t);return e.le||(e.le=Ax(e,ri(t))),e.le}function jP(t){const e=se(t);return e.he||(e.he=Ax(e,t.explicitOrderBy)),e.he}function Ax(t,e){if(t.limitType==="F")return ly(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new ao(s.field,i)});const n=t.endAt?new vi(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new vi(t.startAt.position,t.startAt.inclusive):null;return ly(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function zh(t,e){const n=t.filters.concat([e]);return new Ss(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Tc(t,e,n){return new Ss(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function nu(t,e){return gp(xn(t),xn(e))&&t.limitType===e.limitType}function Rx(t){return`${mp(xn(t))}|lt:${t.limitType}`}function bs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Nx(s)).join(", ")}]`),So(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>gi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>gi(s)).join(",")),`Target(${r})`}(xn(t))}; limitType=${t.limitType})`}function ru(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):X.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of ri(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,c,u){const d=ay(a,c,u);return a.inclusive?d<=0:d<0}(r.startAt,ri(r),s)||r.endAt&&!function(a,c,u){const d=ay(a,c,u);return a.inclusive?d>=0:d>0}(r.endAt,ri(r),s))}(t,e)}function bP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Cx(t){return(e,n)=>{let r=!1;for(const s of ri(t)){const i=OP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function OP(t,e,n){const r=t.field.isKeyField()?X.comparator(e.key,n.key):function(i,a,c){const u=a.data.field(i),d=c.data.field(i);return u!==null&&d!==null?mi(u,d):ee()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ee()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ns(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return yx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP=new Le(X.comparator);function qn(){return DP}const kx=new Le(X.comparator);function ha(...t){let e=kx;for(const n of t)e=e.insert(n.key,n);return e}function Px(t){let e=kx;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ns(){return Na()}function jx(){return Na()}function Na(){return new Ri(t=>t.toString(),(t,e)=>t.isEqual(e))}const LP=new Le(X.comparator),VP=new st(X.comparator);function ce(...t){let e=VP;for(const n of t)e=e.add(n);return e}const MP=new st(ge);function FP(){return MP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xc(e)?"-0":e}}function bx(t){return{integerValue:""+t}}function Ox(t,e){return mP(e)?bx(e):_p(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(){this._=void 0}}function UP(t,e,n){return t instanceof oo?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&tu(i)&&(i=fp(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof yi?Lx(t,e):t instanceof lo?Vx(t,e):function(s,i){const a=Dx(s,i),c=uy(a)+uy(s.Pe);return Mh(a)&&Mh(s.Pe)?bx(c):_p(s.serializer,c)}(t,e)}function zP(t,e,n){return t instanceof yi?Lx(t,e):t instanceof lo?Vx(t,e):n}function Dx(t,e){return t instanceof co?function(r){return Mh(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class oo extends su{}class yi extends su{constructor(e){super(),this.elements=e}}function Lx(t,e){const n=Mx(e);for(const r of t.elements)n.some(s=>In(s,r))||n.push(r);return{arrayValue:{values:n}}}class lo extends su{constructor(e){super(),this.elements=e}}function Vx(t,e){let n=Mx(e);for(const r of t.elements)n=n.filter(s=>!In(s,r));return{arrayValue:{values:n}}}class co extends su{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function uy(t){return ze(t.integerValue||t.doubleValue)}function Mx(t){return pp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e,n){this.field=e,this.transform=n}}function BP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof yi&&s instanceof yi||r instanceof lo&&s instanceof lo?pi(r.elements,s.elements,In):r instanceof co&&s instanceof co?In(r.Pe,s.Pe):r instanceof oo&&s instanceof oo}(t.transform,e.transform)}class $P{constructor(e,n){this.version=e,this.transformResults=n}}class vt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new vt}static exists(e){return new vt(void 0,e)}static updateTime(e){return new vt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class iu{}function Fx(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ep(t.key,vt.none()):new Ao(t.key,t.data,vt.none());{const n=t.data,r=St.empty();let s=new st(nt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Br(t.key,r,new Ft(s.toArray()),vt.none())}}function WP(t,e,n){t instanceof Ao?function(s,i,a){const c=s.value.clone(),u=hy(s.fieldTransforms,i,a.transformResults);c.setAll(u),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):t instanceof Br?function(s,i,a){if(!zl(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=hy(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(Ux(s)),u.setAll(c),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Sa(t,e,n,r){return t instanceof Ao?function(i,a,c,u){if(!zl(i.precondition,a))return c;const d=i.value.clone(),f=fy(i.fieldTransforms,u,a);return d.setAll(f),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Br?function(i,a,c,u){if(!zl(i.precondition,a))return c;const d=fy(i.fieldTransforms,u,a),f=a.data;return f.setAll(Ux(i)),f.setAll(d),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,a,c){return zl(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,n)}function qP(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Dx(r.transform,s||null);i!=null&&(n===null&&(n=St.empty()),n.set(r.field,i))}return n||null}function dy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&pi(r,s,(i,a)=>BP(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ao extends iu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Br extends iu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ux(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function hy(t,e,n){const r=new Map;he(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,zP(a,c,n[s]))}return r}function fy(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,UP(i,a,e))}return r}class Ep extends iu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zx extends iu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&WP(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Sa(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Sa(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=jx();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=n.has(s.key)?null:c;const u=Fx(a,c);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(ne.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ce())}isEqual(e){return this.batchId===e.batchId&&pi(this.mutations,e.mutations,(n,r)=>dy(n,r))&&pi(this.baseMutations,e.baseMutations,(n,r)=>dy(n,r))}}class xp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){he(e.mutations.length===r.length);let s=function(){return LP}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new xp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $e,de;function Bx(t){switch(t){default:return ee();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function $x(t){if(t===void 0)return Wn("GRPC error has no .code"),F.UNKNOWN;switch(t){case $e.OK:return F.OK;case $e.CANCELLED:return F.CANCELLED;case $e.UNKNOWN:return F.UNKNOWN;case $e.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case $e.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case $e.INTERNAL:return F.INTERNAL;case $e.UNAVAILABLE:return F.UNAVAILABLE;case $e.UNAUTHENTICATED:return F.UNAUTHENTICATED;case $e.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case $e.NOT_FOUND:return F.NOT_FOUND;case $e.ALREADY_EXISTS:return F.ALREADY_EXISTS;case $e.PERMISSION_DENIED:return F.PERMISSION_DENIED;case $e.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case $e.ABORTED:return F.ABORTED;case $e.OUT_OF_RANGE:return F.OUT_OF_RANGE;case $e.UNIMPLEMENTED:return F.UNIMPLEMENTED;case $e.DATA_LOSS:return F.DATA_LOSS;default:return ee()}}(de=$e||($e={}))[de.OK=0]="OK",de[de.CANCELLED=1]="CANCELLED",de[de.UNKNOWN=2]="UNKNOWN",de[de.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",de[de.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",de[de.NOT_FOUND=5]="NOT_FOUND",de[de.ALREADY_EXISTS=6]="ALREADY_EXISTS",de[de.PERMISSION_DENIED=7]="PERMISSION_DENIED",de[de.UNAUTHENTICATED=16]="UNAUTHENTICATED",de[de.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",de[de.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",de[de.ABORTED=10]="ABORTED",de[de.OUT_OF_RANGE=11]="OUT_OF_RANGE",de[de.UNIMPLEMENTED=12]="UNIMPLEMENTED",de[de.INTERNAL=13]="INTERNAL",de[de.UNAVAILABLE=14]="UNAVAILABLE",de[de.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP=new as([4294967295,4294967295],0);function py(t){const e=YP().encode(t),n=new ux;return n.update(e),new Uint8Array(n.digest())}function my(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new as([n,r],0),new as([s,i],0)]}class Ip{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new fa(`Invalid padding: ${n}`);if(r<0)throw new fa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new fa(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new fa(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=as.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(as.fromNumber(r)));return s.compare(XP)===1&&(s=new as([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=py(e),[r,s]=my(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Ip(i,s,n);return r.forEach(c=>a.insert(c)),a}insert(e){if(this.Ie===0)return;const n=py(e),[r,s]=my(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class fa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ro.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new au(ne.min(),s,new Le(ge),qn(),ce())}}class Ro{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ro(r,n,ce(),ce(),ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class Wx{constructor(e,n){this.targetId=e,this.me=n}}class qx{constructor(e,n,r=at.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class gy{constructor(){this.fe=0,this.ge=yy(),this.pe=at.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ce(),n=ce(),r=ce();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ee()}}),new Ro(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=yy()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,he(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class JP{constructor(e){this.Le=e,this.Be=new Map,this.ke=qn(),this.qe=vy(),this.Qe=new Le(ge)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ee()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(Uh(i))if(r===0){const a=new X(i.path);this.Ue(n,a,Xe.newNoDocument(a,ne.min()))}else he(r===1);else{const a=this.Ye(n);if(a!==r){const c=this.Ze(e),u=c?this.Xe(c,e,a):1;if(u!==0){this.je(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,c;try{a=vs(r).toUint8Array()}catch(u){if(u instanceof _x)return fi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Ip(a,s,i)}catch(u){return fi(u instanceof fa?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Ie===0?null:c}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const c=this.Je(a);if(c){if(i.current&&Uh(c.target)){const u=new X(c.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,Xe.newNoDocument(u,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=ce();this.qe.forEach((i,a)=>{let c=!0;a.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new au(e,n,this.Qe,this.ke,r);return this.ke=qn(),this.qe=vy(),this.Qe=new Le(ge),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new gy,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new st(ge),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Q("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new gy),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function vy(){return new Le(X.comparator)}function yy(){return new Le(X.comparator)}const ZP={asc:"ASCENDING",desc:"DESCENDING"},ej={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},tj={and:"AND",or:"OR"};class nj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Bh(t,e){return t.useProto3Json||So(e)?e:{value:e}}function Nc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Hx(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function rj(t,e){return Nc(t,e.toTimestamp())}function Bt(t){return he(!!t),ne.fromTimestamp(function(n){const r=br(n);return new Ge(r.seconds,r.nanos)}(t))}function Tp(t,e){return $h(t,e).canonicalString()}function $h(t,e){const n=function(s){return new Ee(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Kx(t){const e=Ee.fromString(t);return he(eI(e)),e}function Sc(t,e){return Tp(t.databaseId,e.path)}function Aa(t,e){const n=Kx(e);if(n.get(1)!==t.databaseId.projectId)throw new H(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new H(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new X(Qx(n))}function Gx(t,e){return Tp(t.databaseId,e)}function sj(t){const e=Kx(t);return e.length===4?Ee.emptyPath():Qx(e)}function Wh(t){return new Ee(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Qx(t){return he(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function _y(t,e,n){return{name:Sc(t,e),fields:n.value.mapValue.fields}}function ij(t,e){return"found"in e?function(r,s){he(!!s.found),s.found.name,s.found.updateTime;const i=Aa(r,s.found.name),a=Bt(s.found.updateTime),c=s.found.createTime?Bt(s.found.createTime):ne.min(),u=new St({mapValue:{fields:s.found.fields}});return Xe.newFoundDocument(i,a,c,u)}(t,e):"missing"in e?function(r,s){he(!!s.missing),he(!!s.readTime);const i=Aa(r,s.missing),a=Bt(s.readTime);return Xe.newNoDocument(i,a)}(t,e):ee()}function aj(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ee()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(he(f===void 0||typeof f=="string"),at.fromBase64String(f||"")):(he(f===void 0||f instanceof Buffer||f instanceof Uint8Array),at.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(d){const f=d.code===void 0?F.UNKNOWN:$x(d.code);return new H(f,d.message||"")}(a);n=new qx(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Aa(t,r.document.name),i=Bt(r.document.updateTime),a=r.document.createTime?Bt(r.document.createTime):ne.min(),c=new St({mapValue:{fields:r.document.fields}}),u=Xe.newFoundDocument(s,i,a,c),d=r.targetIds||[],f=r.removedTargetIds||[];n=new Bl(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Aa(t,r.document),i=r.readTime?Bt(r.readTime):ne.min(),a=Xe.newNoDocument(s,i),c=r.removedTargetIds||[];n=new Bl([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Aa(t,r.document),i=r.removedTargetIds||[];n=new Bl([],i,s,null)}else{if(!("filter"in e))return ee();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new QP(s,i),c=r.targetId;n=new Wx(c,a)}}return n}function Yx(t,e){let n;if(e instanceof Ao)n={update:_y(t,e.key,e.value)};else if(e instanceof Ep)n={delete:Sc(t,e.key)};else if(e instanceof Br)n={update:_y(t,e.key,e.data),updateMask:mj(e.fieldMask)};else{if(!(e instanceof zx))return ee();n={verify:Sc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const c=a.transform;if(c instanceof oo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof yi)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof lo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof co)return{fieldPath:a.field.canonicalString(),increment:c.Pe};throw ee()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:rj(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ee()}(t,e.precondition)),n}function oj(t,e){return t&&t.length>0?(he(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?Bt(s.updateTime):Bt(i);return a.isEqual(ne.min())&&(a=Bt(i)),new $P(a,s.transformResults||[])}(n,e))):[]}function lj(t,e){return{documents:[Gx(t,e.path)]}}function Xx(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Gx(t,s);const i=function(d){if(d.length!==0)return Zx(fn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(d){if(d.length!==0)return d.map(f=>function(m){return{field:ur(m.field),direction:hj(m.dir)}}(f))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const c=Bh(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:s}}function cj(t,e,n,r){const{_t:s,parent:i}=Xx(t,e),a={},c=[];let u=0;return n.forEach(d=>{const f="aggregate_"+u++;a[f]=d.alias,d.aggregateType==="count"?c.push({alias:f,count:{}}):d.aggregateType==="avg"?c.push({alias:f,avg:{field:ur(d.fieldPath)}}):d.aggregateType==="sum"&&c.push({alias:f,sum:{field:ur(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:c,structuredQuery:s.structuredQuery},parent:s.parent},ut:a,parent:i}}function uj(t){let e=sj(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){he(r===1);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(p){const m=Jx(p);return m instanceof fn&&Ix(m)?m.getFilters():[m]}(n.where));let a=[];n.orderBy&&(a=function(p){return p.map(m=>function(y){return new ao(Os(y.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(m))}(n.orderBy));let c=null;n.limit&&(c=function(p){let m;return m=typeof p=="object"?p.value:p,So(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(p){const m=!!p.before,I=p.values||[];return new vi(I,m)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const m=!p.before,I=p.values||[];return new vi(I,m)}(n.endAt)),PP(e,s,a,i,c,"F",u,d)}function dj(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ee()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Jx(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Os(n.unaryFilter.field);return qe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Os(n.unaryFilter.field);return qe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Os(n.unaryFilter.field);return qe.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Os(n.unaryFilter.field);return qe.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ee()}}(t):t.fieldFilter!==void 0?function(n){return qe.create(Os(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ee()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return fn.create(n.compositeFilter.filters.map(r=>Jx(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ee()}}(n.compositeFilter.op))}(t):ee()}function hj(t){return ZP[t]}function fj(t){return ej[t]}function pj(t){return tj[t]}function ur(t){return{fieldPath:t.canonicalString()}}function Os(t){return nt.fromServerFormat(t.fieldPath)}function Zx(t){return t instanceof qe?function(n){if(n.op==="=="){if(iy(n.value))return{unaryFilter:{field:ur(n.field),op:"IS_NAN"}};if(sy(n.value))return{unaryFilter:{field:ur(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(iy(n.value))return{unaryFilter:{field:ur(n.field),op:"IS_NOT_NAN"}};if(sy(n.value))return{unaryFilter:{field:ur(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ur(n.field),op:fj(n.op),value:n.value}}}(t):t instanceof fn?function(n){const r=n.getFilters().map(s=>Zx(s));return r.length===1?r[0]:{compositeFilter:{op:pj(n.op),filters:r}}}(t):ee()}function mj(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function eI(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,n,r,s,i=ne.min(),a=ne.min(),c=at.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new gr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gj{constructor(e){this.ct=e}}function vj(t){const e=uj({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Tc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(){this.un=new _j}addToCollectionParentIndex(e,n){return this.un.add(n),z.resolve()}getCollectionParents(e,n){return z.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return z.resolve()}deleteFieldIndex(e,n){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,n){return z.resolve()}getDocumentsMatchingTarget(e,n){return z.resolve(null)}getIndexType(e,n){return z.resolve(0)}getFieldIndexes(e,n){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,n){return z.resolve(jr.min())}getMinOffsetFromCollectionGroup(e,n){return z.resolve(jr.min())}updateCollectionGroup(e,n,r){return z.resolve()}updateIndexEntries(e,n){return z.resolve()}}class _j{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new st(Ee.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new st(Ee.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new _i(0)}static kn(){return new _i(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(){this.changes=new Ri(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Xe.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?z.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Sa(r.mutation,s,Ft.empty(),Ge.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ce()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ce()){const s=ns();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=ha();return i.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=ns();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ce()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,c)=>{n.set(a,c)})})}computeViews(e,n,r,s){let i=qn();const a=Na(),c=function(){return Na()}();return n.forEach((u,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof Br)?i=i.insert(d.key,d):f!==void 0?(a.set(d.key,f.mutation.getFieldMask()),Sa(f.mutation,d,f.mutation.getFieldMask(),Ge.now())):a.set(d.key,Ft.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>a.set(d,f)),n.forEach((d,f)=>{var p;return c.set(d,new Ej(f,(p=a.get(d))!==null&&p!==void 0?p:null))}),c))}recalculateAndSaveOverlays(e,n){const r=Na();let s=new Le((a,c)=>a-c),i=ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const c of a)c.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let f=r.get(u)||Ft.empty();f=c.applyToLocalView(d,f),r.set(u,f);const p=(s.get(c.batchId)||ce()).add(u);s=s.insert(c.batchId,p)})}).next(()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,f=u.value,p=jx();f.forEach(m=>{if(!i.has(m)){const I=Fx(n.get(m),r.get(m));I!==null&&p.set(m,I),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,p))}return z.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return X.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):yp(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):z.resolve(ns());let c=-1,u=i;return a.next(d=>z.forEach(d,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),i.get(f)?z.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{u=u.insert(f,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,ce())).next(f=>({batchId:c,changes:Px(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new X(n)).next(r=>{let s=ha();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=ha();return this.indexManager.getCollectionParents(e,i).next(c=>z.forEach(c,u=>{const d=function(p,m){return new Ss(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((p,m)=>{a=a.insert(p,m)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((u,d)=>{const f=d.getKey();a.get(f)===null&&(a=a.insert(f,Xe.newInvalidDocument(f)))});let c=ha();return a.forEach((u,d)=>{const f=i.get(u);f!==void 0&&Sa(f.mutation,d,Ft.empty(),Ge.now()),ru(n,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ij{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return z.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Bt(s.createTime)}}(n)),z.resolve()}getNamedQuery(e,n){return z.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:vj(s.bundledQuery),readTime:Bt(s.readTime)}}(n)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(){this.overlays=new Le(X.comparator),this.Ir=new Map}getOverlay(e,n){return z.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ns();return z.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),z.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),z.resolve()}getOverlaysForCollection(e,n,r){const s=ns(),i=n.length+1,a=new X(n.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return z.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Le((d,f)=>d-f);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=ns(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const c=ns(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>c.set(d,f)),!(c.size()>=s)););return z.resolve(c)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new KP(n,r));let i=this.Ir.get(n);i===void 0&&(i=ce(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{constructor(){this.sessionToken=at.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(){this.Tr=new st(Qe.Er),this.dr=new st(Qe.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Qe(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Qe(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new X(new Ee([])),r=new Qe(n,e),s=new Qe(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new X(new Ee([])),r=new Qe(n,e),s=new Qe(n,e+1);let i=ce();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new Qe(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Qe{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return X.comparator(e.key,n.key)||ge(e.wr,n.wr)}static Ar(e,n){return ge(e.wr,n.wr)||X.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new st(Qe.Er)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new HP(i,n,r,s);this.mutationQueue.push(a);for(const c of s)this.br=this.br.add(new Qe(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return z.resolve(a)}lookupMutationBatch(e,n){return z.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return z.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Qe(n,0),s=new Qe(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const c=this.Dr(a.wr);i.push(c)}),z.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new st(ge);return n.forEach(s=>{const i=new Qe(s,0),a=new Qe(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],c=>{r=r.add(c.wr)})}),z.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;X.isDocumentKey(i)||(i=i.child(""));const a=new Qe(new X(i),0);let c=new st(ge);return this.br.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.wr)),!0)},a),z.resolve(this.Cr(c))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){he(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return z.forEach(n.mutations,s=>{const i=new Qe(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Qe(n,0),s=this.br.firstAfterOrEqual(r);return z.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e){this.Mr=e,this.docs=function(){return new Le(X.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return z.resolve(r?r.document.mutableCopy():Xe.newInvalidDocument(n))}getEntries(e,n){let r=qn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Xe.newInvalidDocument(s))}),z.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=qn();const a=n.path,c=new X(a.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||dP(uP(f),r)<=0||(s.has(f.key)||ru(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return z.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ee()}Or(e,n){return z.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Rj(this)}getSize(e){return z.resolve(this.size)}}class Rj extends wj{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),z.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(e){this.persistence=e,this.Nr=new Ri(n=>mp(n),gp),this.lastRemoteSnapshotVersion=ne.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Np,this.targetCount=0,this.kr=_i.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),z.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new _i(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,z.resolve()}updateTargetData(e,n){return this.Kn(n),z.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),z.waitFor(i).next(()=>s)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return z.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),z.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),z.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),z.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return z.resolve(r)}containsKey(e,n){return z.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(e,n){this.qr={},this.overlays={},this.Qr=new hp(0),this.Kr=!1,this.Kr=!0,this.$r=new Nj,this.referenceDelegate=e(this),this.Ur=new Cj(this),this.indexManager=new yj,this.remoteDocumentCache=function(s){return new Aj(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new gj(n),this.Gr=new Ij(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Tj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new Sj(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){Q("MemoryPersistence","Starting transaction:",e);const s=new Pj(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return z.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class Pj extends fP{constructor(e){super(),this.currentSequenceNumber=e}}class Sp{constructor(e){this.persistence=e,this.Jr=new Np,this.Yr=null}static Zr(e){return new Sp(e)}get Xr(){if(this.Yr)return this.Yr;throw ee()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),z.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),z.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.Xr,r=>{const s=X.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ne.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return z.or([()=>z.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=ce(),s=ce();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Ap(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return TA()?8:pP(wt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new jj;return this.Xi(e,n,a).next(c=>{if(i.result=c,this.zi)return this.es(e,n,a,c.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(na()<=ue.DEBUG&&Q("QueryEngine","SDK will not create cache indexes for query:",bs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),z.resolve()):(na()<=ue.DEBUG&&Q("QueryEngine","Query:",bs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(na()<=ue.DEBUG&&Q("QueryEngine","The SDK decides to create cache indexes for query:",bs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,xn(n))):z.resolve())}Yi(e,n){if(cy(n))return z.resolve(null);let r=xn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Tc(n,null,"F"),r=xn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=ce(...i);return this.Ji.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.ts(n,c);return this.ns(n,d,a,u.readTime)?this.Yi(e,Tc(n,null,"F")):this.rs(e,d,n,u)}))})))}Zi(e,n,r,s){return cy(n)||s.isEqual(ne.min())?z.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?z.resolve(null):(na()<=ue.DEBUG&&Q("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),bs(n)),this.rs(e,a,n,cP(s,-1)).next(c=>c))})}ts(e,n){let r=new st(Cx(e));return n.forEach((s,i)=>{ru(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return na()<=ue.DEBUG&&Q("QueryEngine","Using full collection scan to execute query:",bs(n)),this.Ji.getDocumentsMatchingQuery(e,n,jr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new Le(ge),this._s=new Ri(i=>mp(i),gp),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xj(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function Dj(t,e,n,r){return new Oj(t,e,n,r)}async function tI(t,e){const n=se(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],c=[];let u=ce();for(const d of s){a.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){c.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:c}))})})}function Lj(t,e){const n=se(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(c,u,d,f){const p=d.batch,m=p.keys();let I=z.resolve();return m.forEach(y=>{I=I.next(()=>f.getEntry(u,y)).next(N=>{const T=d.docVersions.get(y);he(T!==null),N.version.compareTo(T)<0&&(p.applyToRemoteDocument(N,d),N.isValidDocument()&&(N.setReadTime(d.commitVersion),f.addEntry(N)))})}),I.next(()=>c.mutationQueue.removeMutationBatch(u,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=ce();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function nI(t){const e=se(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function Vj(t,e){const n=se(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const c=[];e.targetChanges.forEach((f,p)=>{const m=s.get(p);if(!m)return;c.push(n.Ur.removeMatchingKeys(i,f.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(i,f.addedDocuments,p)));let I=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?I=I.withResumeToken(at.EMPTY_BYTE_STRING,ne.min()).withLastLimboFreeSnapshotVersion(ne.min()):f.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(f.resumeToken,r)),s=s.insert(p,I),function(N,T,x){return N.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(m,I,f)&&c.push(n.Ur.updateTargetData(i,I))});let u=qn(),d=ce();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),c.push(Mj(i,a,e.documentUpdates).next(f=>{u=f.Ps,d=f.Is})),!r.isEqual(ne.min())){const f=n.Ur.getLastRemoteSnapshotVersion(i).next(p=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(f)}return z.waitFor(c).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.os=s,i))}function Mj(t,e,n){let r=ce(),s=ce();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=qn();return n.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(ne.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):Q("LocalStore","Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{Ps:a,Is:s}})}function Fj(t,e){const n=se(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Uj(t,e){const n=se(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,z.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new gr(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function qh(t,e,n){const r=se(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!No(a))throw a;Q("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function wy(t,e,n){const r=se(t);let s=ne.min(),i=ce();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,f){const p=se(u),m=p._s.get(f);return m!==void 0?z.resolve(p.os.get(m)):p.Ur.getTargetData(d,f)}(r,a,xn(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,c.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:ne.min(),n?i:ce())).next(c=>(zj(r,bP(e),c),{documents:c,Ts:i})))}function zj(t,e,n){let r=t.us.get(e)||ne.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Ey{constructor(){this.activeTargetIds=FP()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Bj{constructor(){this.so=new Ey,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Ey,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _l=null;function Id(){return _l===null?_l=function(){return 268435456+Math.round(2147483648*Math.random())}():_l++,"0x"+_l.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pt="WebChannelConnection";class Hj extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const c=Id(),u=this.xo(n,r.toUriEncodedString());Q("RestConnection",`Sending RPC '${n}' ${c}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,a),this.No(n,u,d,s).then(f=>(Q("RestConnection",`Received RPC '${n}' ${c}: `,f),f),f=>{throw fi("RestConnection",`RPC '${n}' ${c} failed with error: `,f,"url: ",u,"request:",s),f})}Lo(n,r,s,i,a,c){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ai}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=Wj[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Id();return new Promise((a,c)=>{const u=new dx;u.setWithCredentials(!0),u.listenOnce(hx.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Fl.NO_ERROR:const f=u.getResponseJson();Q(pt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(f)),a(f);break;case Fl.TIMEOUT:Q(pt,`RPC '${e}' ${i} timed out`),c(new H(F.DEADLINE_EXCEEDED,"Request time out"));break;case Fl.HTTP_ERROR:const p=u.getStatus();if(Q(pt,`RPC '${e}' ${i} failed with status:`,p,"response text:",u.getResponseText()),p>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const I=m==null?void 0:m.error;if(I&&I.status&&I.message){const y=function(T){const x=T.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(x)>=0?x:F.UNKNOWN}(I.status);c(new H(y,I.message))}else c(new H(F.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new H(F.UNAVAILABLE,"Connection failed."));break;default:ee()}}finally{Q(pt,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);Q(pt,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",d,r,15)})}Bo(e,n,r){const s=Id(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=mx(),c=px(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=i.join("");Q(pt,`Creating RPC '${e}' stream ${s}: ${f}`,u);const p=a.createWebChannel(f,u);let m=!1,I=!1;const y=new qj({Io:T=>{I?Q(pt,`Not sending because RPC '${e}' stream ${s} is closed:`,T):(m||(Q(pt,`Opening RPC '${e}' stream ${s} transport.`),p.open(),m=!0),Q(pt,`RPC '${e}' stream ${s} sending:`,T),p.send(T))},To:()=>p.close()}),N=(T,x,_)=>{T.listen(x,E=>{try{_(E)}catch(k){setTimeout(()=>{throw k},0)}})};return N(p,da.EventType.OPEN,()=>{I||(Q(pt,`RPC '${e}' stream ${s} transport opened.`),y.yo())}),N(p,da.EventType.CLOSE,()=>{I||(I=!0,Q(pt,`RPC '${e}' stream ${s} transport closed`),y.So())}),N(p,da.EventType.ERROR,T=>{I||(I=!0,fi(pt,`RPC '${e}' stream ${s} transport errored:`,T),y.So(new H(F.UNAVAILABLE,"The operation could not be completed")))}),N(p,da.EventType.MESSAGE,T=>{var x;if(!I){const _=T.data[0];he(!!_);const E=_,k=E.error||((x=E[0])===null||x===void 0?void 0:x.error);if(k){Q(pt,`RPC '${e}' stream ${s} received error:`,k);const O=k.status;let D=function(A){const P=$e[A];if(P!==void 0)return $x(P)}(O),w=k.message;D===void 0&&(D=F.INTERNAL,w="Unknown error status: "+O+" with message "+k.message),I=!0,y.So(new H(D,w)),p.close()}else Q(pt,`RPC '${e}' stream ${s} received:`,_),y.bo(_)}}),N(c,fx.STAT_EVENT,T=>{T.stat===Lh.PROXY?Q(pt,`RPC '${e}' stream ${s} detected buffering proxy`):T.stat===Lh.NOPROXY&&Q(pt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function Td(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(t){return new nj(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&Q("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rI{constructor(e,n,r,s,i,a,c,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Rp(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===F.RESOURCE_EXHAUSTED?(Wn(n.toString()),Wn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new H(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Kj extends rI{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=aj(this.serializer,e),r=function(i){if(!("targetChange"in i))return ne.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?ne.min():a.readTime?Bt(a.readTime):ne.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Wh(this.serializer),n.addTarget=function(i,a){let c;const u=a.target;if(c=Uh(u)?{documents:lj(i,u)}:{query:Xx(i,u)._t},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Hx(i,a.resumeToken);const d=Bh(i,a.expectedCount);d!==null&&(c.expectedCount=d)}else if(a.snapshotVersion.compareTo(ne.min())>0){c.readTime=Nc(i,a.snapshotVersion.toTimestamp());const d=Bh(i,a.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const r=dj(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Wh(this.serializer),n.removeTarget=e,this.a_(n)}}class Gj extends rI{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return he(!!e.streamToken),this.lastStreamToken=e.streamToken,he(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){he(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=oj(e.writeResults,e.commitTime),r=Bt(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Wh(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Yx(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new H(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,$h(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new H(F.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Lo(e,$h(n,r),s,a,c,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new H(F.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Yj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Wn(n),this.D_=!1):Q("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xj{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{As(this)&&(Q("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=se(u);d.L_.add(4),await Co(d),d.q_.set("Unknown"),d.L_.delete(4),await lu(d)}(this))})}),this.q_=new Yj(r,s)}}async function lu(t){if(As(t))for(const e of t.B_)await e(!0)}async function Co(t){for(const e of t.B_)await e(!1)}function sI(t,e){const n=se(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),jp(n)?Pp(n):Ci(n).r_()&&kp(n,e))}function Cp(t,e){const n=se(t),r=Ci(n);n.N_.delete(e),r.r_()&&iI(n,e),n.N_.size===0&&(r.r_()?r.o_():As(n)&&n.q_.set("Unknown"))}function kp(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ne.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ci(t).A_(e)}function iI(t,e){t.Q_.xe(e),Ci(t).R_(e)}function Pp(t){t.Q_=new JP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ci(t).start(),t.q_.v_()}function jp(t){return As(t)&&!Ci(t).n_()&&t.N_.size>0}function As(t){return se(t).L_.size===0}function aI(t){t.Q_=void 0}async function Jj(t){t.q_.set("Online")}async function Zj(t){t.N_.forEach((e,n)=>{kp(t,e)})}async function eb(t,e){aI(t),jp(t)?(t.q_.M_(e),Pp(t)):t.q_.set("Unknown")}async function tb(t,e,n){if(t.q_.set("Online"),e instanceof qx&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const c of i.targetIds)s.N_.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.N_.delete(c),s.Q_.removeTarget(c))}(t,e)}catch(r){Q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ac(t,r)}else if(e instanceof Bl?t.Q_.Ke(e):e instanceof Wx?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ne.min()))try{const r=await nI(t.localStore);n.compareTo(r)>=0&&await function(i,a){const c=i.Q_.rt(a);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.N_.get(d);f&&i.N_.set(d,f.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,d)=>{const f=i.N_.get(u);if(!f)return;i.N_.set(u,f.withResumeToken(at.EMPTY_BYTE_STRING,f.snapshotVersion)),iI(i,u);const p=new gr(f.target,u,d,f.sequenceNumber);kp(i,p)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){Q("RemoteStore","Failed to raise snapshot:",r),await Ac(t,r)}}async function Ac(t,e,n){if(!No(e))throw e;t.L_.add(1),await Co(t),t.q_.set("Offline"),n||(n=()=>nI(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Q("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await lu(t)})}function oI(t,e){return e().catch(n=>Ac(t,n,e))}async function cu(t){const e=se(t),n=Or(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;nb(e);)try{const s=await Fj(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,rb(e,s)}catch(s){await Ac(e,s)}lI(e)&&cI(e)}function nb(t){return As(t)&&t.O_.length<10}function rb(t,e){t.O_.push(e);const n=Or(t);n.r_()&&n.V_&&n.m_(e.mutations)}function lI(t){return As(t)&&!Or(t).n_()&&t.O_.length>0}function cI(t){Or(t).start()}async function sb(t){Or(t).p_()}async function ib(t){const e=Or(t);for(const n of t.O_)e.m_(n.mutations)}async function ab(t,e,n){const r=t.O_.shift(),s=xp.from(r,e,n);await oI(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await cu(t)}async function ob(t,e){e&&Or(t).V_&&await async function(r,s){if(function(a){return Bx(a)&&a!==F.ABORTED}(s.code)){const i=r.O_.shift();Or(r).s_(),await oI(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await cu(r)}}(t,e),lI(t)&&cI(t)}async function Iy(t,e){const n=se(t);n.asyncQueue.verifyOperationInProgress(),Q("RemoteStore","RemoteStore received new credentials");const r=As(n);n.L_.add(3),await Co(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await lu(n)}async function lb(t,e){const n=se(t);e?(n.L_.delete(2),await lu(n)):e||(n.L_.add(2),await Co(n),n.q_.set("Unknown"))}function Ci(t){return t.K_||(t.K_=function(n,r,s){const i=se(n);return i.w_(),new Kj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:Jj.bind(null,t),Ro:Zj.bind(null,t),mo:eb.bind(null,t),d_:tb.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),jp(t)?Pp(t):t.q_.set("Unknown")):(await t.K_.stop(),aI(t))})),t.K_}function Or(t){return t.U_||(t.U_=function(n,r,s){const i=se(n);return i.w_(),new Gj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:sb.bind(null,t),mo:ob.bind(null,t),f_:ib.bind(null,t),g_:ab.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await cu(t)):(await t.U_.stop(),t.O_.length>0&&(Q("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new dn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,c=new bp(e,n,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new H(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Op(t,e){if(Wn("AsyncQueue",`${e}: ${t}`),No(t))return new H(F.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e){this.comparator=e?(n,r)=>e(n,r)||X.comparator(n.key,r.key):(n,r)=>X.comparator(n.key,r.key),this.keyedMap=ha(),this.sortedSet=new Le(this.comparator)}static emptySet(e){return new si(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof si)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new si;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(){this.W_=new Le(X.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ee():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class wi{constructor(e,n,r,s,i,a,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(c=>{a.push({type:0,doc:c})}),new wi(e,n,si.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class ub{constructor(){this.queries=Ny(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=se(n),i=s.queries;s.queries=Ny(),i.forEach((a,c)=>{for(const u of c.j_)u.onError(r)})})(this,new H(F.ABORTED,"Firestore shutting down"))}}function Ny(){return new Ri(t=>Rx(t),nu)}async function uI(t,e){const n=se(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new cb,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const c=Op(a,`Initialization of query '${bs(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Dp(n)}async function dI(t,e){const n=se(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function db(t,e){const n=se(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const c of a.j_)c.X_(s)&&(r=!0);a.z_=s}}r&&Dp(n)}function hb(t,e,n){const r=se(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Dp(t){t.Y_.forEach(e=>{e.next()})}var Hh,Sy;(Sy=Hh||(Hh={})).ea="default",Sy.Cache="cache";class hI{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new wi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=wi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Hh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(e){this.key=e}}class pI{constructor(e){this.key=e}}class fb{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ce(),this.mutatedKeys=ce(),this.Aa=Cx(e),this.Ra=new si(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Ty,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,p)=>{const m=s.get(f),I=ru(this.query,p)?p:null,y=!!m&&this.mutatedKeys.has(m.key),N=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let T=!1;m&&I?m.data.isEqual(I.data)?y!==N&&(r.track({type:3,doc:I}),T=!0):this.ga(m,I)||(r.track({type:2,doc:I}),T=!0,(u&&this.Aa(I,u)>0||d&&this.Aa(I,d)<0)&&(c=!0)):!m&&I?(r.track({type:0,doc:I}),T=!0):m&&!I&&(r.track({type:1,doc:m}),T=!0,(u||d)&&(c=!0)),T&&(I?(a=a.add(I),i=N?i.add(f):i.delete(f)):(a=a.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{Ra:a,fa:r,ns:c,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,p)=>function(I,y){const N=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ee()}};return N(I)-N(y)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(r),s=s!=null&&s;const c=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,a.length!==0||d?{snapshot:new wi(this.query,e.Ra,i,a,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ty,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ce(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new pI(r))}),this.da.forEach(r=>{e.has(r)||n.push(new fI(r))}),n}ba(e){this.Ta=e.Ts,this.da=ce();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return wi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class pb{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class mb{constructor(e){this.key=e,this.va=!1}}class gb{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Ri(c=>Rx(c),nu),this.Ma=new Map,this.xa=new Set,this.Oa=new Le(X.comparator),this.Na=new Map,this.La=new Np,this.Ba={},this.ka=new Map,this.qa=_i.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function vb(t,e,n=!0){const r=wI(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await mI(r,e,n,!0),s}async function yb(t,e){const n=wI(t);await mI(n,e,!0,!1)}async function mI(t,e,n,r){const s=await Uj(t.localStore,xn(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let c;return r&&(c=await _b(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&sI(t.remoteStore,s),c}async function _b(t,e,n,r,s){t.Ka=(p,m,I)=>async function(N,T,x,_){let E=T.view.ma(x);E.ns&&(E=await wy(N.localStore,T.query,!1).then(({documents:w})=>T.view.ma(w,E)));const k=_&&_.targetChanges.get(T.targetId),O=_&&_.targetMismatches.get(T.targetId)!=null,D=T.view.applyChanges(E,N.isPrimaryClient,k,O);return Ry(N,T.targetId,D.wa),D.snapshot}(t,p,m,I);const i=await wy(t.localStore,e,!0),a=new fb(e,i.Ts),c=a.ma(i.documents),u=Ro.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=a.applyChanges(c,t.isPrimaryClient,u);Ry(t,n,d.wa);const f=new pb(e,n,a);return t.Fa.set(e,f),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function wb(t,e,n){const r=se(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!nu(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await qh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Cp(r.remoteStore,s.targetId),Kh(r,s.targetId)}).catch(To)):(Kh(r,s.targetId),await qh(r.localStore,s.targetId,!0))}async function Eb(t,e){const n=se(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Cp(n.remoteStore,r.targetId))}async function xb(t,e,n){const r=Cb(t);try{const s=await function(a,c){const u=se(a),d=Ge.now(),f=c.reduce((I,y)=>I.add(y.key),ce());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",I=>{let y=qn(),N=ce();return u.cs.getEntries(I,f).next(T=>{y=T,y.forEach((x,_)=>{_.isValidDocument()||(N=N.add(x))})}).next(()=>u.localDocuments.getOverlayedDocuments(I,y)).next(T=>{p=T;const x=[];for(const _ of c){const E=qP(_,p.get(_.key).overlayedDocument);E!=null&&x.push(new Br(_.key,E,wx(E.value.mapValue),vt.exists(!0)))}return u.mutationQueue.addMutationBatch(I,d,x,c)}).next(T=>{m=T;const x=T.applyToLocalDocumentSet(p,N);return u.documentOverlayCache.saveOverlays(I,T.batchId,x)})}).then(()=>({batchId:m.batchId,changes:Px(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,c,u){let d=a.Ba[a.currentUser.toKey()];d||(d=new Le(ge)),d=d.insert(c,u),a.Ba[a.currentUser.toKey()]=d}(r,s.batchId,n),await ko(r,s.changes),await cu(r.remoteStore)}catch(s){const i=Op(s,"Failed to persist write");n.reject(i)}}async function gI(t,e){const n=se(t);try{const r=await Vj(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(he(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?he(a.va):s.removedDocuments.size>0&&(he(a.va),a.va=!1))}),await ko(n,r,e)}catch(r){await To(r)}}function Ay(t,e,n){const r=se(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const c=a.view.Z_(e);c.snapshot&&s.push(c.snapshot)}),function(a,c){const u=se(a);u.onlineState=c;let d=!1;u.queries.forEach((f,p)=>{for(const m of p.j_)m.Z_(c)&&(d=!0)}),d&&Dp(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Ib(t,e,n){const r=se(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new Le(X.comparator);a=a.insert(i,Xe.newNoDocument(i,ne.min()));const c=ce().add(i),u=new au(ne.min(),new Map,new Le(ge),a,c);await gI(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Lp(r)}else await qh(r.localStore,e,!1).then(()=>Kh(r,e,n)).catch(To)}async function Tb(t,e){const n=se(t),r=e.batch.batchId;try{const s=await Lj(n.localStore,e);yI(n,r,null),vI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ko(n,s)}catch(s){await To(s)}}async function Nb(t,e,n){const r=se(t);try{const s=await function(a,c){const u=se(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,c).next(p=>(he(p!==null),f=p.keys(),u.mutationQueue.removeMutationBatch(d,p))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(r.localStore,e);yI(r,e,n),vI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ko(r,s)}catch(s){await To(s)}}function vI(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function yI(t,e,n){const r=se(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Kh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||_I(t,r)})}function _I(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Cp(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Lp(t))}function Ry(t,e,n){for(const r of n)r instanceof fI?(t.La.addReference(r.key,e),Sb(t,r)):r instanceof pI?(Q("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||_I(t,r.key)):ee()}function Sb(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(Q("SyncEngine","New document in limbo: "+n),t.xa.add(r),Lp(t))}function Lp(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new X(Ee.fromString(e)),r=t.qa.next();t.Na.set(r,new mb(n)),t.Oa=t.Oa.insert(n,r),sI(t.remoteStore,new gr(xn(vp(n.path)),r,"TargetPurposeLimboResolution",hp.oe))}}async function ko(t,e,n){const r=se(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((c,u)=>{a.push(r.Ka(u,e,n).then(d=>{var f;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(d){s.push(d);const p=Ap.Wi(u.targetId,d);i.push(p)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(u,d){const f=se(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>z.forEach(d,m=>z.forEach(m.$i,I=>f.persistence.referenceDelegate.addReference(p,m.targetId,I)).next(()=>z.forEach(m.Ui,I=>f.persistence.referenceDelegate.removeReference(p,m.targetId,I)))))}catch(p){if(!No(p))throw p;Q("LocalStore","Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const I=f.os.get(m),y=I.snapshotVersion,N=I.withLastLimboFreeSnapshotVersion(y);f.os=f.os.insert(m,N)}}}(r.localStore,i))}async function Ab(t,e){const n=se(t);if(!n.currentUser.isEqual(e)){Q("SyncEngine","User change. New user:",e.toKey());const r=await tI(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(c=>{c.forEach(u=>{u.reject(new H(F.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ko(n,r.hs)}}function Rb(t,e){const n=se(t),r=n.Na.get(e);if(r&&r.va)return ce().add(r.key);{let s=ce();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const c=n.Fa.get(a);s=s.unionWith(c.view.Va)}return s}}function wI(t){const e=se(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=gI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Rb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Ib.bind(null,e),e.Ca.d_=db.bind(null,e.eventManager),e.Ca.$a=hb.bind(null,e.eventManager),e}function Cb(t){const e=se(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Tb.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Nb.bind(null,e),e}class Rc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ou(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return Dj(this.persistence,new bj,e.initialUser,this.serializer)}Ga(e){return new kj(Sp.Zr,this.serializer)}Wa(e){return new Bj}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Rc.provider={build:()=>new Rc};class Gh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Ay(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ab.bind(null,this.syncEngine),await lb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ub}()}createDatastore(e){const n=ou(e.databaseInfo.databaseId),r=function(i){return new Hj(i)}(e.databaseInfo);return function(i,a,c,u){return new Qj(i,a,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,c){return new Xj(r,s,i,a,c)}(this.localStore,this.datastore,e.asyncQueue,n=>Ay(this.syncEngine,n,0),function(){return xy.D()?new xy:new $j}())}createSyncEngine(e,n){return function(s,i,a,c,u,d,f){const p=new gb(s,i,a,c,u,d);return f&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=se(s);Q("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Co(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Gh.provider={build:()=>new Gh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Wn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new H(F.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,i){const a=se(s),c={documents:i.map(p=>Sc(a.serializer,p))},u=await a.Lo("BatchGetDocuments",a.serializer.databaseId,Ee.emptyPath(),c,i.length),d=new Map;u.forEach(p=>{const m=ij(a.serializer,p);d.set(m.key.toString(),m)});const f=[];return i.forEach(p=>{const m=d.get(p.toString());he(!!m),f.push(m)}),f}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ep(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=X.fromPath(r);this.mutations.push(new zx(s,this.precondition(s)))}),await async function(r,s){const i=se(r),a={writes:s.map(c=>Yx(i.serializer,c))};await i.Mo("Commit",i.serializer.databaseId,Ee.emptyPath(),a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw ee();n=ne.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new H(F.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(ne.min())?vt.exists(!1):vt.updateTime(n):vt.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(ne.min()))throw new H(F.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vt.updateTime(n)}return vt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this._u=r.maxAttempts,this.t_=new Rp(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new kb(this.datastore),n=this.cu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.lu(s)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const n=this.updateFunction(e);return!So(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!Bx(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=mt.UNAUTHENTICATED,this.clientId=vx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{Q("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(Q("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new dn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Op(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Nd(t,e){t.asyncQueue.verifyOperationInProgress(),Q("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await tI(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Cy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await bb(t);Q("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Iy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Iy(e.remoteStore,s)),t._onlineComponents=e}async function bb(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Q("FirestoreClient","Using user provided OfflineComponentProvider");try{await Nd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===F.FAILED_PRECONDITION||s.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;fi("Error using user provided cache. Falling back to memory cache: "+n),await Nd(t,new Rc)}}else Q("FirestoreClient","Using default OfflineComponentProvider"),await Nd(t,new Rc);return t._offlineComponents}async function Vp(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Q("FirestoreClient","Using user provided OnlineComponentProvider"),await Cy(t,t._uninitializedComponentsProvider._online)):(Q("FirestoreClient","Using default OnlineComponentProvider"),await Cy(t,new Gh))),t._onlineComponents}function Ob(t){return Vp(t).then(e=>e.syncEngine)}function xI(t){return Vp(t).then(e=>e.datastore)}async function II(t){const e=await Vp(t),n=e.eventManager;return n.onListen=vb.bind(null,e.syncEngine),n.onUnlisten=wb.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=yb.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Eb.bind(null,e.syncEngine),n}function Db(t,e,n={}){const r=new dn;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,d){const f=new EI({next:m=>{f.Za(),a.enqueueAndForget(()=>dI(i,p));const I=m.docs.has(c);!I&&m.fromCache?d.reject(new H(F.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&m.fromCache&&u&&u.source==="server"?d.reject(new H(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new hI(vp(c.path),f,{includeMetadataChanges:!0,_a:!0});return uI(i,p)}(await II(t),t.asyncQueue,e,n,r)),r.promise}function Lb(t,e,n={}){const r=new dn;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,d){const f=new EI({next:m=>{f.Za(),a.enqueueAndForget(()=>dI(i,p)),m.fromCache&&u.source==="server"?d.reject(new H(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new hI(c,f,{includeMetadataChanges:!0,_a:!0});return uI(i,p)}(await II(t),t.asyncQueue,e,n,r)),r.promise}function Vb(t,e,n){const r=new dn;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await xI(t);r.resolve(async function(a,c,u){var d;const f=se(a),{request:p,ut:m,parent:I}=cj(f.serializer,jP(c),u);f.connection.Fo||delete p.parent;const y=(await f.Lo("RunAggregationQuery",f.serializer.databaseId,I,p,1)).filter(T=>!!T.result);he(y.length===1);const N=(d=y[0].result)===null||d===void 0?void 0:d.aggregateFields;return Object.keys(N).reduce((T,x)=>(T[m[x]]=N[x],T),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ky=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(t,e,n){if(!n)throw new H(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Mb(t,e,n,r){if(e===!0&&r===!0)throw new H(F.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Py(t){if(!X.isDocumentKey(t))throw new H(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function jy(t){if(X.isDocumentKey(t))throw new H(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function uu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ee()}function en(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new H(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=uu(t);throw new H(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Fb(t,e){if(e<=0)throw new H(F.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new H(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new H(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Mb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=TI((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new H(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new H(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new H(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class du{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new by({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new H(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new H(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new by(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new eP;switch(r.type){case"firstParty":return new sP(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new H(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=ky.get(n);r&&(Q("ComponentProvider","Removing Datastore"),ky.delete(n),r.terminate())}(this),Promise.resolve()}}function Ub(t,e,n,r={}){var s;const i=(t=en(t,du))._getSettings(),a=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&fi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),r.mockUserToken){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=mt.MOCK_USER;else{c=TE(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new H(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new mt(d)}t._authCredentials=new tP(new gx(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Yn(this.firestore,e,this._query)}}class yt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yt(this.firestore,e,this._key)}}class Rr extends Yn{constructor(e,n,r){super(e,n,vp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yt(this.firestore,null,new X(e))}withConverter(e){return new Rr(this.firestore,e,this._path)}}function ae(t,e,...n){if(t=Te(t),NI("collection","path",e),t instanceof du){const r=Ee.fromString(e,...n);return jy(r),new Rr(t,null,r)}{if(!(t instanceof yt||t instanceof Rr))throw new H(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ee.fromString(e,...n));return jy(r),new Rr(t.firestore,null,r)}}function Z(t,e,...n){if(t=Te(t),arguments.length===1&&(e=vx.newId()),NI("doc","path",e),t instanceof du){const r=Ee.fromString(e,...n);return Py(r),new yt(t,null,new X(r))}{if(!(t instanceof yt||t instanceof Rr))throw new H(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ee.fromString(e,...n));return Py(r),new yt(t.firestore,t instanceof Rr?t.converter:null,new X(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Rp(this,"async_queue_retry"),this.Vu=()=>{const r=Td();r&&Q("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Td();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Td();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new dn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!No(e))throw e;Q("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),c}(r);throw Wn("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=bp.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ee()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class $r extends du{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Oy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Oy(e),this._firestoreClient=void 0,await e}}}function zb(t,e){const n=typeof t=="object"?t:Xc(),r=typeof t=="string"?t:"(default)",s=Yc(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=EE("firestore");i&&Ub(s,...i)}return s}function Po(t){if(t._terminated)throw new H(F.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Bb(t),t._firestoreClient}function Bb(t){var e,n,r;const s=t._freezeSettings(),i=function(c,u,d,f){return new yP(c,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,TI(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new jb(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class Wb{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _s(at.fromBase64String(e))}catch(n){throw new H(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new _s(at.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new H(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new H(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new H(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ge(this._lat,e._lat)||ge(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb=/^__.*__$/;class Hb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Br(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ao(e,this.data,n,this.fieldTransforms)}}class SI{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Br(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function AI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ee()}}class hu{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new hu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Cc(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(AI(this.Cu)&&qb.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Kb{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ou(e)}Qu(e,n,r,s=!1){return new hu({Cu:e,methodName:n,qu:r,path:nt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pi(t){const e=t._freezeSettings(),n=ou(t._databaseId);return new Kb(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Up(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);Wp("Data must be an object, but it was:",a,r);const c=PI(r,a);let u,d;if(i.merge)u=new Ft(a.fieldMask),d=a.fieldTransforms;else if(i.mergeFields){const f=[];for(const p of i.mergeFields){const m=Qh(e,p,n);if(!a.contains(m))throw new H(F.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);bI(f,m)||f.push(m)}u=new Ft(f),d=a.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,d=a.fieldTransforms;return new Hb(new St(c),u,d)}class fu extends ki{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fu}}function Gb(t,e,n){return new hu({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class zp extends ki{_toFieldTransform(e){return new wp(e.path,new oo)}isEqual(e){return e instanceof zp}}class Bp extends ki{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=Gb(this,e,!0),r=this.Ku.map(i=>ji(i,n)),s=new yi(r);return new wp(e.path,s)}isEqual(e){return e instanceof Bp&&Xa(this.Ku,e.Ku)}}class $p extends ki{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new co(e.serializer,Ox(e.serializer,this.$u));return new wp(e.path,n)}isEqual(e){return e instanceof $p&&this.$u===e.$u}}function RI(t,e,n,r){const s=t.Qu(1,e,n);Wp("Data must be an object, but it was:",s,r);const i=[],a=St.empty();Ns(r,(u,d)=>{const f=qp(e,u,n);d=Te(d);const p=s.Nu(f);if(d instanceof fu)i.push(f);else{const m=ji(d,p);m!=null&&(i.push(f),a.set(f,m))}});const c=new Ft(i);return new SI(a,c,s.fieldTransforms)}function CI(t,e,n,r,s,i){const a=t.Qu(1,e,n),c=[Qh(e,r,n)],u=[s];if(i.length%2!=0)throw new H(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)c.push(Qh(e,i[m])),u.push(i[m+1]);const d=[],f=St.empty();for(let m=c.length-1;m>=0;--m)if(!bI(d,c[m])){const I=c[m];let y=u[m];y=Te(y);const N=a.Nu(I);if(y instanceof fu)d.push(I);else{const T=ji(y,N);T!=null&&(d.push(I),f.set(I,T))}}const p=new Ft(d);return new SI(f,p,a.fieldTransforms)}function kI(t,e,n,r=!1){return ji(n,t.Qu(r?4:3,e))}function ji(t,e){if(jI(t=Te(t)))return Wp("Unsupported field value:",e,t),PI(t,e);if(t instanceof ki)return function(r,s){if(!AI(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const c of r){let u=ji(c,s.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Te(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Ox(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ge.fromDate(r);return{timestampValue:Nc(s.serializer,i)}}if(r instanceof Ge){const i=new Ge(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Nc(s.serializer,i)}}if(r instanceof Mp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof _s)return{bytesValue:Hx(s.serializer,r._byteString)};if(r instanceof yt){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Tp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Fp)return function(a,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw c.Bu("VectorValues must only contain numeric values.");return _p(c.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${uu(r)}`)}(t,e)}function PI(t,e){const n={};return yx(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ns(t,(r,s)=>{const i=ji(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function jI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ge||t instanceof Mp||t instanceof _s||t instanceof yt||t instanceof ki||t instanceof Fp)}function Wp(t,e,n){if(!jI(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=uu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Qh(t,e,n){if((e=Te(e))instanceof jo)return e._internalPath;if(typeof e=="string")return qp(t,e);throw Cc("Field path arguments must be of type string or ",t,!1,void 0,n)}const Qb=new RegExp("[~\\*/\\[\\]]");function qp(t,e,n){if(e.search(Qb)>=0)throw Cc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new jo(...e.split("."))._internalPath}catch{throw Cc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Cc(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new H(F.INVALID_ARGUMENT,c+t+u)}function bI(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new yt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Yb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(pu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Yb extends uo{data(){return super.data()}}function pu(t,e){return typeof e=="string"?qp(t,e):e instanceof jo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new H(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Hp{}class mu extends Hp{}function _e(t,e,...n){let r=[];e instanceof Hp&&r.push(e),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof Kp).length,c=i.filter(u=>u instanceof gu).length;if(a>1||a>0&&c>0)throw new H(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class gu extends mu{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new gu(e,n,r)}_apply(e){const n=this._parse(e);return OI(e._query,n),new Yn(e.firestore,e.converter,zh(e._query,n))}_parse(e){const n=Pi(e.firestore);return function(i,a,c,u,d,f,p){let m;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new H(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Ly(p,f);const I=[];for(const y of p)I.push(Dy(u,i,y));m={arrayValue:{values:I}}}else m=Dy(u,i,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Ly(p,f),m=kI(c,a,p,f==="in"||f==="not-in");return qe.create(d,f,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ke(t,e,n){const r=e,s=pu("where",t);return gu._create(s,r,n)}class Kp extends Hp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Kp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:fn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const c=i.getFlattenedFilters();for(const u of c)OI(a,u),a=zh(a,u)}(e._query,n),new Yn(e.firestore,e.converter,zh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Gp extends mu{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Gp(e,n)}_apply(e){const n=function(s,i,a){if(s.startAt!==null)throw new H(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new H(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ao(i,a)}(e._query,this._field,this._direction);return new Yn(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new Ss(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Tn(t,e="asc"){const n=e,r=pu("orderBy",t);return Gp._create(r,n)}class Qp extends mu{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Qp(e,n,r)}_apply(e){return new Yn(e.firestore,e.converter,Tc(e._query,this._limit,this._limitType))}}function Hn(t){return Fb("limit",t),Qp._create("limit",t,"F")}class Yp extends mu{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Yp(e,n,r)}_apply(e){const n=Zb(e,this.type,this._docOrFields,this._inclusive);return new Yn(e.firestore,e.converter,function(s,i){return new Ss(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function Jb(...t){return Yp._create("startAfter",t,!1)}function Zb(t,e,n,r){if(n[0]=Te(n[0]),n[0]instanceof uo)return function(i,a,c,u,d){if(!u)throw new H(F.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);const f=[];for(const p of ri(i))if(p.field.isKeyField())f.push(Ic(a,u.key));else{const m=u.data.field(p.field);if(tu(m))throw new H(F.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const I=p.field.canonicalString();throw new H(F.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${I}' (used as the orderBy) does not exist.`)}f.push(m)}return new vi(f,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=Pi(t.firestore);return function(a,c,u,d,f,p){const m=a.explicitOrderBy;if(f.length>m.length)throw new H(F.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const I=[];for(let y=0;y<f.length;y++){const N=f[y];if(m[y].field.isKeyField()){if(typeof N!="string")throw new H(F.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof N}`);if(!yp(a)&&N.indexOf("/")!==-1)throw new H(F.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${N}' contains a slash.`);const T=a.path.child(Ee.fromString(N));if(!X.isDocumentKey(T))throw new H(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);const x=new X(T);I.push(Ic(c,x))}else{const T=kI(u,d,N);I.push(T)}}return new vi(I,p)}(t._query,t.firestore._databaseId,s,e,n,r)}}function Dy(t,e,n){if(typeof(n=Te(n))=="string"){if(n==="")throw new H(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yp(e)&&n.indexOf("/")!==-1)throw new H(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ee.fromString(n));if(!X.isDocumentKey(r))throw new H(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ic(t,new X(r))}if(n instanceof yt)return Ic(t,n._key);throw new H(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uu(n)}.`)}function Ly(t,e){if(!Array.isArray(t)||t.length===0)throw new H(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function OI(t,e){const n=function(s,i){for(const a of s)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new H(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new H(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class DI{convertValue(e,n="none"){switch(ys(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ze(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(vs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ee()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ns(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>ze(a.doubleValue));return new Fp(i)}convertGeoPoint(e){return new Mp(ze(e.latitude),ze(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=fp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ro(e));default:return null}}convertTimestamp(e){const n=br(e);return new Ge(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ee.fromString(e);he(eI(r));const s=new so(r.get(1),r.get(3)),i=new X(r.popFirst(5));return s.isEqual(n)||Wn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class e1 extends DI{constructor(e){super(),this.firestore=e}convertBytes(e){return new _s(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new yt(this.firestore,null,n)}}function t1(){return new $b("count")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Jp extends uo{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new $l(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(pu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class $l extends Jp{data(e={}){return super.data(e)}}class n1{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ks(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new $l(this._firestore,this._userDataWriter,r.key,r,new Ks(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new H(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(c=>{const u=new $l(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ks(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new $l(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ks(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return c.type!==0&&(d=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:r1(c.type),doc:u,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function r1(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ee()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(t){t=en(t,yt);const e=en(t.firestore,$r);return Db(Po(e),t._key).then(n=>i1(e,t,n))}class vu extends DI{constructor(e){super(),this.firestore=e}convertBytes(e){return new _s(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new yt(this.firestore,null,n)}}function xe(t){t=en(t,Yn);const e=en(t.firestore,$r),n=Po(e),r=new vu(e);return Xb(t._query),Lb(n,t._query).then(s=>new n1(e,r,t,s))}function s1(t,e,n){t=en(t,yt);const r=en(t.firestore,$r),s=Xp(t.converter,e,n);return Zp(r,[Up(Pi(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,vt.none())])}function bi(t,e,n,...r){t=en(t,yt);const s=en(t.firestore,$r),i=Pi(s);let a;return a=typeof(e=Te(e))=="string"||e instanceof jo?CI(i,"updateDoc",t._key,e,n,r):RI(i,"updateDoc",t._key,e),Zp(s,[a.toMutation(t._key,vt.exists(!0))])}function Yh(t,e){const n=en(t.firestore,$r),r=Z(t),s=Xp(t.converter,e);return Zp(n,[Up(Pi(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,vt.exists(!1))]).then(()=>r)}function Zp(t,e){return function(r,s){const i=new dn;return r.asyncQueue.enqueueAndForget(async()=>xb(await Ob(r),s,i)),i.promise}(Po(t),e)}function i1(t,e,n){const r=n.docs.get(e._key),s=new vu(t);return new Jp(t,s,e._key,r,new Ks(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wl(t){return a1(t,{count:t1()})}function a1(t,e){const n=en(t.firestore,$r),r=Po(n),s=gP(e,(i,a)=>new GP(a,i.aggregateType,i._internalFieldPath));return Vb(r,t._query,s).then(i=>function(c,u,d){const f=new vu(c);return new Wb(u,f,d)}(n,t,i))}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1={maxAttempts:5};function ra(t,e){if((t=Te(t)).firestore!==e)throw new H(F.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1 extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Pi(n)}get(n){const r=ra(n,this._firestore),s=new e1(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return ee();const a=i[0];if(a.isFoundDocument())return new uo(this._firestore,s,a.key,a,r.converter);if(a.isNoDocument())return new uo(this._firestore,s,r._key,null,r.converter);throw ee()})}set(n,r,s){const i=ra(n,this._firestore),a=Xp(i.converter,r,s),c=Up(this._dataReader,"Transaction.set",i._key,a,i.converter!==null,s);return this._transaction.set(i._key,c),this}update(n,r,s,...i){const a=ra(n,this._firestore);let c;return c=typeof(r=Te(r))=="string"||r instanceof jo?CI(this._dataReader,"Transaction.update",a._key,r,s,i):RI(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,c),this}delete(n){const r=ra(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=ra(e,this._firestore),r=new vu(this._firestore);return super.get(e).then(s=>new Jp(this._firestore,r,n._key,s._document,new Ks(!1,!1),n.converter))}}function Oi(t,e,n){t=en(t,$r);const r=Object.assign(Object.assign({},o1),n);return function(i){if(i.maxAttempts<1)throw new H(F.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,a,c){const u=new dn;return i.asyncQueue.enqueueAndForget(async()=>{const d=await xI(i);new Pb(i.asyncQueue,d,c,a,u).au()}),u.promise}(Po(t),s=>e(new l1(t,s)),r)}function J(){return new zp("serverTimestamp")}function em(...t){return new Bp("arrayUnion",t)}function Ra(t){return new $p("increment",t)}(function(e,n=!0){(function(s){Ai=s})(Ts),fs(new Pr("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new $r(new nP(r.getProvider("auth-internal")),new aP(r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new H(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new so(d.options.projectId,f)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),wn(Zv,"4.7.3",e),wn(Zv,"4.7.3","esm2017")})();var c1="firebase",u1="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wn(c1,u1,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI="firebasestorage.googleapis.com",VI="storageBucket",d1=2*60*1e3,h1=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue extends Nn{constructor(e,n,r=0){super(Sd(e),`Firebase Storage: ${n} (${Sd(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ue.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Sd(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Fe;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Fe||(Fe={}));function Sd(t){return"storage/"+t}function tm(){const t="An unknown error occurred, please check the error payload for server response.";return new Ue(Fe.UNKNOWN,t)}function f1(t){return new Ue(Fe.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function p1(t){return new Ue(Fe.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function m1(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ue(Fe.UNAUTHENTICATED,t)}function g1(){return new Ue(Fe.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function v1(t){return new Ue(Fe.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function y1(){return new Ue(Fe.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function _1(){return new Ue(Fe.CANCELED,"User canceled the upload/download.")}function w1(t){return new Ue(Fe.INVALID_URL,"Invalid URL '"+t+"'.")}function E1(t){return new Ue(Fe.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function x1(){return new Ue(Fe.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+VI+"' property when initializing the app?")}function I1(){return new Ue(Fe.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function T1(){return new Ue(Fe.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function N1(t){return new Ue(Fe.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Xh(t){return new Ue(Fe.INVALID_ARGUMENT,t)}function MI(){return new Ue(Fe.APP_DELETED,"The Firebase app was deleted.")}function S1(t){return new Ue(Fe.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ca(t,e){return new Ue(Fe.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function sa(t){throw new Ue(Fe.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Ut.makeFromUrl(e,n)}catch{return new Ut(e,"")}if(r.path==="")return r;throw E1(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(k){k.path.charAt(k.path.length-1)==="/"&&(k.path_=k.path_.slice(0,-1))}const a="(/(.*))?$",c=new RegExp("^gs://"+s+a,"i"),u={bucket:1,path:3};function d(k){k.path_=decodeURIComponent(k.path)}const f="v[A-Za-z0-9_]+",p=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",I=new RegExp(`^https?://${p}/${f}/b/${s}/o${m}`,"i"),y={bucket:1,path:3},N=n===LI?"(?:storage.googleapis.com|storage.cloud.google.com)":n,T="([^?#]*)",x=new RegExp(`^https?://${N}/${s}/${T}`,"i"),E=[{regex:c,indices:u,postModify:i},{regex:I,indices:y,postModify:d},{regex:x,indices:{bucket:1,path:2},postModify:d}];for(let k=0;k<E.length;k++){const O=E[k],D=O.regex.exec(e);if(D){const w=D[O.indices.bucket];let v=D[O.indices.path];v||(v=""),r=new Ut(w,v),O.postModify(r);break}}if(r==null)throw w1(e);return r}}class A1{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R1(t,e,n){let r=1,s=null,i=null,a=!1,c=0;function u(){return c===2}let d=!1;function f(...T){d||(d=!0,e.apply(null,T))}function p(T){s=setTimeout(()=>{s=null,t(I,u())},T)}function m(){i&&clearTimeout(i)}function I(T,...x){if(d){m();return}if(T){m(),f.call(null,T,...x);return}if(u()||a){m(),f.call(null,T,...x);return}r<64&&(r*=2);let E;c===1?(c=2,E=0):E=(r+Math.random())*1e3,p(E)}let y=!1;function N(T){y||(y=!0,m(),!d&&(s!==null?(T||(c=2),clearTimeout(s),p(0)):T||(c=1)))}return p(0),i=setTimeout(()=>{a=!0,N(!0)},n),N}function C1(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k1(t){return t!==void 0}function P1(t){return typeof t=="object"&&!Array.isArray(t)}function nm(t){return typeof t=="string"||t instanceof String}function Vy(t){return rm()&&t instanceof Blob}function rm(){return typeof Blob<"u"}function My(t,e,n,r){if(r<e)throw Xh(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Xh(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yu(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function FI(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var os;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(os||(os={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(e,n,r,s,i,a,c,u,d,f,p,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=f,this.connectionFactory_=p,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((I,y)=>{this.resolve_=I,this.reject_=y,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new El(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=c=>{const u=c.loaded,d=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const c=i.getErrorCode()===os.NO_ERROR,u=i.getStatus();if(!c||j1(u,this.additionalRetryCodes_)&&this.retry){const f=i.getErrorCode()===os.ABORT;r(!1,new El(!1,null,f));return}const d=this.successCodes_.indexOf(u)!==-1;r(!0,new El(d,i))})},n=(r,s)=>{const i=this.resolve_,a=this.reject_,c=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(c,c.getResponse());k1(u)?i(u):i()}catch(u){a(u)}else if(c!==null){const u=tm();u.serverResponse=c.getErrorText(),this.errorCallback_?a(this.errorCallback_(c,u)):a(u)}else if(s.canceled){const u=this.appDelete_?MI():_1();a(u)}else{const u=y1();a(u)}};this.canceled_?n(!1,new El(!1,null,!0)):this.backoffId_=R1(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&C1(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class El{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function O1(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function D1(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function L1(t,e){e&&(t["X-Firebase-GMPID"]=e)}function V1(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function M1(t,e,n,r,s,i,a=!0){const c=FI(t.urlParams),u=t.url+c,d=Object.assign({},t.headers);return L1(d,e),O1(d,n),D1(d,i),V1(d,r),new b1(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function U1(...t){const e=F1();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(rm())return new Blob(t);throw new Ue(Fe.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function z1(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B1(t){if(typeof atob>"u")throw N1("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Ad{constructor(e,n){this.data=e,this.contentType=n||null}}function $1(t,e){switch(t){case vn.RAW:return new Ad(UI(e));case vn.BASE64:case vn.BASE64URL:return new Ad(zI(t,e));case vn.DATA_URL:return new Ad(q1(e),H1(e))}throw tm()}function UI(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,a=t.charCodeAt(++n);r=65536|(i&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function W1(t){let e;try{e=decodeURIComponent(t)}catch{throw Ca(vn.DATA_URL,"Malformed data URL.")}return UI(e)}function zI(t,e){switch(t){case vn.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Ca(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case vn.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Ca(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=B1(e)}catch(s){throw s.message.includes("polyfill")?s:Ca(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class BI{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Ca(vn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=K1(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function q1(t){const e=new BI(t);return e.base64?zI(vn.BASE64,e.rest):W1(e.rest)}function H1(t){return new BI(t).contentType}function K1(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,n){let r=0,s="";Vy(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(Vy(this.data_)){const r=this.data_,s=z1(r,e,n);return s===null?null:new dr(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new dr(r,!0)}}static getBlob(...e){if(rm()){const n=e.map(r=>r instanceof dr?r.data_:r);return new dr(U1.apply(null,n))}else{const n=e.map(a=>nm(a)?$1(vn.RAW,a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(a=>{for(let c=0;c<a.length;c++)s[i++]=a[c]}),new dr(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $I(t){let e;try{e=JSON.parse(t)}catch{return null}return P1(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G1(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Q1(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function WI(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(t,e){return e}class Tt{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||Y1}}let xl=null;function X1(t){return!nm(t)||t.length<2?t:WI(t)}function qI(){if(xl)return xl;const t=[];t.push(new Tt("bucket")),t.push(new Tt("generation")),t.push(new Tt("metageneration")),t.push(new Tt("name","fullPath",!0));function e(i,a){return X1(a)}const n=new Tt("name");n.xform=e,t.push(n);function r(i,a){return a!==void 0?Number(a):a}const s=new Tt("size");return s.xform=r,t.push(s),t.push(new Tt("timeCreated")),t.push(new Tt("updated")),t.push(new Tt("md5Hash",null,!0)),t.push(new Tt("cacheControl",null,!0)),t.push(new Tt("contentDisposition",null,!0)),t.push(new Tt("contentEncoding",null,!0)),t.push(new Tt("contentLanguage",null,!0)),t.push(new Tt("contentType",null,!0)),t.push(new Tt("metadata","customMetadata",!0)),xl=t,xl}function J1(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Ut(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function Z1(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const a=n[i];r[a.local]=a.xform(r,e[a.server])}return J1(r,t),r}function HI(t,e,n){const r=$I(e);return r===null?null:Z1(t,r,n)}function eO(t,e,n,r){const s=$I(e);if(s===null||!nm(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const a=encodeURIComponent;return i.split(",").map(d=>{const f=t.bucket,p=t.fullPath,m="/b/"+a(f)+"/o/"+a(p),I=yu(m,n,r),y=FI({alt:"media",token:d});return I+y})[0]}function tO(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class sm{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(t){if(!t)throw tm()}function nO(t,e){function n(r,s){const i=HI(t,s,e);return KI(i!==null),i}return n}function rO(t,e){function n(r,s){const i=HI(t,s,e);return KI(i!==null),eO(i,s,t.host,t._protocol)}return n}function GI(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=g1():s=m1():n.getStatus()===402?s=p1(t.bucket):n.getStatus()===403?s=v1(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function QI(t){const e=GI(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=f1(t.path)),i.serverResponse=s.serverResponse,i}return n}function sO(t,e,n){const r=e.fullServerUrl(),s=yu(r,t.host,t._protocol),i="GET",a=t.maxOperationRetryTime,c=new sm(s,i,rO(t,n),a);return c.errorHandler=QI(e),c}function iO(t,e){const n=e.fullServerUrl(),r=yu(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function a(u,d){}const c=new sm(r,s,a,i);return c.successCodes=[200,204],c.errorHandler=QI(e),c}function aO(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function oO(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=aO(null,e)),r}function lO(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function c(){let E="";for(let k=0;k<2;k++)E=E+Math.random().toString().slice(2);return E}const u=c();a["Content-Type"]="multipart/related; boundary="+u;const d=oO(e,r,s),f=tO(d,n),p="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+f+`\r
--`+u+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+u+"--",I=dr.getBlob(p,r,m);if(I===null)throw I1();const y={name:d.fullPath},N=yu(i,t.host,t._protocol),T="POST",x=t.maxUploadRetryTime,_=new sm(N,T,nO(t,n),x);return _.urlParams=y,_.headers=a,_.body=I.uploadData(),_.errorHandler=GI(e),_}class cO{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=os.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=os.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=os.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw sa("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw sa("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw sa("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw sa("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw sa("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class uO extends cO{initXhr(){this.xhr_.responseType="text"}}function im(){return new uO}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,n){this._service=e,n instanceof Ut?this._location=n:this._location=Ut.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ws(e,n)}get root(){const e=new Ut(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return WI(this._location.path)}get storage(){return this._service}get parent(){const e=G1(this._location.path);if(e===null)return null;const n=new Ut(this._location.bucket,e);return new ws(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw S1(e)}}function dO(t,e,n){t._throwIfRoot("uploadBytes");const r=lO(t.storage,t._location,qI(),new dr(e,!0),n);return t.storage.makeRequestWithTokens(r,im).then(s=>({metadata:s,ref:t}))}function hO(t){t._throwIfRoot("getDownloadURL");const e=sO(t.storage,t._location,qI());return t.storage.makeRequestWithTokens(e,im).then(n=>{if(n===null)throw T1();return n})}function fO(t){t._throwIfRoot("deleteObject");const e=iO(t.storage,t._location);return t.storage.makeRequestWithTokens(e,im)}function pO(t,e){const n=Q1(t._location.path,e),r=new Ut(t._location.bucket,n);return new ws(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mO(t){return/^[A-Za-z]+:\/\//.test(t)}function gO(t,e){return new ws(t,e)}function YI(t,e){if(t instanceof am){const n=t;if(n._bucket==null)throw x1();const r=new ws(n,n._bucket);return e!=null?YI(r,e):r}else return e!==void 0?pO(t,e):t}function vO(t,e){if(e&&mO(e)){if(t instanceof am)return gO(t,e);throw Xh("To use ref(service, url), the first argument must be a Storage instance.")}else return YI(t,e)}function Fy(t,e){const n=e==null?void 0:e[VI];return n==null?null:Ut.makeFromBucketSpec(n,t)}function yO(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:TE(s,t.app.options.projectId))}class am{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=LI,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=d1,this._maxUploadRetryTime=h1,this._requests=new Set,s!=null?this._bucket=Ut.makeFromBucketSpec(s,this._host):this._bucket=Fy(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ut.makeFromBucketSpec(this._url,e):this._bucket=Fy(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){My("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){My("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ws(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new A1(MI());{const a=M1(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const Uy="@firebase/storage",zy="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI="storage";function _O(t,e,n){return t=Te(t),dO(t,e,n)}function wO(t){return t=Te(t),hO(t)}function EO(t){return t=Te(t),fO(t)}function By(t,e){return t=Te(t),vO(t,e)}function xO(t=Xc(),e){t=Te(t);const r=Yc(t,XI).getImmediate({identifier:e}),s=EE("storage");return s&&IO(r,...s),r}function IO(t,e,n,r={}){yO(t,e,n,r)}function TO(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new am(n,r,s,e,Ts)}function NO(){fs(new Pr(XI,TO,"PUBLIC").setMultipleInstances(!0)),wn(Uy,zy,""),wn(Uy,zy,"esm2017")}NO();const ka={apiKey:"AIzaSyCWZYQhVFQIE_36SciDNuaDsSV3cA_VAhg",authDomain:"finenproc-ag.firebaseapp.com",projectId:"finenproc-ag",storageBucket:"finenproc-ag.firebasestorage.app",messagingSenderId:"342590603143",appId:"1:342590603143:web:41684e65fb75b5845b9d22"},om=AE().length?Xc():Zf(ka),hr=cx(om),W=zb(om),Jh=xO(om),$y="provisioning",SO=()=>AE().find(e=>e.name===$y)||Zf(ka,$y),AO=()=>cx(SO());try{const t=Object.entries(ka).filter(([e,n])=>!n).map(([e])=>e);t.length&&console.warn("Firebase env variables missing:",t),console.log("Firebase initialized",{projectId:ka.projectId,authDomain:ka.authDomain,hasAuth:!!hr,hasDb:!!W,hasStorage:!!Jh})}catch(t){console.warn("Firebase init debug failed:",t)}function JI(){const[t,e]=b.useState(!0),[n,r]=b.useState(!1),[s,i]=b.useState(null);return b.useEffect(()=>{const a=zC(hr,async c=>{var u,d;if(e(!0),!c){i(null),r(!1),e(!1);return}try{const f=c.uid,p=Z(W,"users",f),m=await Dt(p),I=(u=m==null?void 0:m.data())==null?void 0:u.role,y=(d=m==null?void 0:m.data())==null?void 0:d.status;console.log("ADMIN AUTH CHECK",{uid:f,userExists:m.exists(),role:I,status:y});const N=!!(m.exists()&&I==="admin"&&y==="active");r(N),i({uid:f,email:c.email,role:I,status:y})}catch(f){console.error("useAdminAuth error",f),r(!1),i(null)}finally{e(!1)}});return()=>a()},[]),{loading:t,isAdmin:n,user:s}}function RO({isOpen:t,onClose:e}){const n=({to:r,children:s,disabled:i,icon:a})=>{const c=()=>{e&&e()};return i?o.jsxs("div",{className:"sidebar-item disabled",children:[a&&o.jsx("span",{className:"sidebar-icon",children:a}),s]}):o.jsxs(aA,{to:r,onClick:c,className:({isActive:u})=>u?"sidebar-item active":"sidebar-item",children:[a&&o.jsx("span",{className:"sidebar-icon",children:a}),s]})};return o.jsxs("aside",{className:`admin-sidebar ${t?"open":""}`,children:[o.jsx("div",{className:"brand",children:"FINENPROC"}),o.jsxs("nav",{children:[o.jsx(n,{to:"/admin",icon:"",children:"Panel"}),o.jsx(n,{to:"/admin/usuarios",icon:"",children:"Usuarios"}),o.jsx("div",{className:"nav-section-title",children:"Operaciones"}),o.jsx(n,{to:"/admin/operaciones/recargas",icon:"",children:"Recargas"}),o.jsx(n,{to:"/admin/operaciones/retiros",icon:"",children:"Retiros"}),o.jsx(n,{to:"/admin/operaciones/inversiones",icon:"",children:"Inversiones"}),o.jsx("div",{className:"nav-section-title",children:"Otros"}),o.jsx(n,{to:"/admin/proyectos",icon:"",children:"Proyectos"}),o.jsx(n,{disabled:!0,icon:"",children:"Configuracin"})]}),o.jsx("div",{className:"sidebar-footer",children:"Admin Panel"})]})}function CO({admin:t,onToggleSidebar:e}){const n=Qn(),r=async()=>{try{await is(hr),n("/")}catch(s){console.error("Logout error",s)}};return o.jsxs("header",{className:"admin-header",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("button",{className:"menu-button",type:"button","aria-label":"Abrir men",onClick:e,children:""}),o.jsxs("h1",{children:[o.jsx("span",{className:"header-title-main",children:"FINENPROC"}),o.jsx("span",{className:"header-title-badge",children:"ADMIN"})]})]}),o.jsxs("div",{className:"header-right",children:[(t==null?void 0:t.email)&&o.jsx("div",{className:"admin-email",children:t.email}),o.jsx("button",{className:"btn-ghost",onClick:r,children:"Cerrar sesin"})]})]})}function Gr({children:t,admin:e}){const[n,r]=b.useState(!1),s=()=>r(a=>!a),i=()=>r(!1);return o.jsxs("div",{className:"admin-root",children:[o.jsx(RO,{isOpen:n,onClose:i}),o.jsxs("div",{className:"admin-main",children:[o.jsx(CO,{admin:e,onToggleSidebar:s}),o.jsx("main",{className:"admin-content",children:t})]}),o.jsx("div",{className:`sidebar-overlay ${n?"show":""}`,onClick:i,"aria-hidden":!n})]})}function kO({title:t,children:e,className:n=""}){return o.jsxs("div",{className:"card "+n,children:[t&&o.jsx("div",{className:"card-title",children:t}),o.jsx("div",{className:"card-body",children:e})]})}function PO(){const[t,e]=b.useState({totalUsers:0,activeUsers:0,pendingTopups:0,approvedTopups:0,rejectedTopups:0,totalTopups:0,pendingWithdrawals:0,activeInvestments:0,totalInvested:0,recentTransactions:[]}),[n,r]=b.useState(!0),[s,i]=b.useState(null),a=async()=>{try{r(!0),i(null);const d=(await xe(ae(W,"users"))).docs.map(S=>S.data()),f=d.length,p=d.filter(S=>S.status==="active").length,I=(await xe(ae(W,"topups"))).docs.map(S=>S.data()),y=I.filter(S=>S.status==="pending").length,N=I.filter(S=>S.status==="approved").length,T=I.filter(S=>S.status==="rejected").length,x=I.length,k=(await xe(ae(W,"withdrawals"))).docs.map(S=>S.data()).filter(S=>S.status==="pending").length,O=_e(ae(W,"investments"),ke("status","==","active")),w=(await xe(O)).docs.map(S=>S.data()),v=w.length,A=w.reduce((S,U)=>S+(U.amount||0),0),P=_e(ae(W,"transactions"),Tn("createdAt","desc")),j=(await xe(P)).docs.slice(0,10).map(S=>({id:S.id,...S.data()}));e({totalUsers:f,activeUsers:p,pendingTopups:y,approvedTopups:N,rejectedTopups:T,totalTopups:x,pendingWithdrawals:k,activeInvestments:v,totalInvested:A,recentTransactions:j})}catch(u){console.error("Error en useDashboardKPIs:",u),i(u.message)}finally{r(!1)}};return b.useEffect(()=>{a()},[]),{kpis:t,loading:n,error:s,refetch:()=>a()}}function jO({children:t,variant:e="default"}){return o.jsx("span",{className:"badge badge-"+e,children:t})}function bO({open:t,onClose:e,children:n}){return t?o.jsx("div",{className:"modal-backdrop",onClick:e,children:o.jsx("div",{className:"modal",onClick:r=>r.stopPropagation(),children:n})}):null}const OO=async(t={})=>{var e;try{const n=[Tn("createdAt","desc")];t.status&&n.unshift(ke("status","==",t.status)),t.userId&&n.unshift(ke("userId","==",t.userId));const r=_e(ae(W,"topups"),...n),s=await xe(r),i=[];for(const a of s.docs){const c=a.data();let u=null;if(c.userId){const f=Z(W,"users",c.userId),p=await Dt(f);p.exists()&&(u={uid:p.id,email:p.data().email,displayName:p.data().displayName||"Sin nombre"})}let d=null;if(c.methodId){const f=Z(W,"rechargeMethods",c.methodId),p=await Dt(f);p.exists()&&(d={id:p.id,name:p.data().name,icon:p.data().icon})}i.push({topupId:a.id,id:a.id,amount:c.amount,status:c.status,createdAt:(e=c.createdAt)==null?void 0:e.toDate(),user:u,method:d,receiptUrl:c.receiptUrl,userId:c.userId,methodId:c.methodId})}return{success:!0,data:i}}catch(n){return console.error("Error fetching topups:",n),{success:!1,error:n.message}}},DO=()=>{const[t,e]=b.useState([]),[n,r]=b.useState([]),[s,i]=b.useState({status:"",searchQuery:""}),[a,c]=b.useState(!0),[u,d]=b.useState(null);return b.useEffect(()=>{(async()=>{c(!0),d(null);const m=await OO({});m.success?e(m.data||[]):(e([]),d(m.error||"Error al cargar recargas")),c(!1)})()},[]),b.useEffect(()=>{let p=t;if(s.status&&(p=p.filter(m=>m.status===s.status)),s.searchQuery.trim()){const m=s.searchQuery.toLowerCase();p=p.filter(I=>{var y,N,T,x;return((N=(y=I.user)==null?void 0:y.email)==null?void 0:N.toLowerCase().includes(m))||((x=(T=I.user)==null?void 0:T.displayName)==null?void 0:x.toLowerCase().includes(m))})}r(p)},[t,s.status,s.searchQuery]),{allTopups:t,topups:n,filters:s,setFilters:{status:p=>i(m=>({...m,status:p})),searchQuery:p=>{i(m=>({...m,searchQuery:p}))}},loading:a,error:u}};function LO(){var y,N,T;const[t,e]=b.useState(null),{allTopups:n,topups:r,filters:s,setFilters:i,loading:a,error:c}=DO(),u=s.status?s.status:"all",d=[{value:"all",label:"Todas",count:n.length},{value:"pending",label:"Pendientes",count:n.filter(x=>x.status==="pending").length},{value:"approved",label:"Aprobadas",count:n.filter(x=>x.status==="approved").length},{value:"rejected",label:"Rechazadas",count:n.filter(x=>x.status==="rejected").length}],f=x=>{const _={pending:{variant:"pending",label:"Pendiente"},approved:{variant:"success",label:"Aprobada"},rejected:{variant:"rejected",label:"Rechazada"}},E=_[x]||_.pending;return o.jsx(jO,{variant:E.variant,children:E.label})},p=x=>new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(x),m=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(x),I=(filter==="all",r);return o.jsxs("div",{className:"admin-topups",children:[o.jsx("div",{className:"topups-header",children:o.jsxs("div",{children:[o.jsx("h1",{className:"page-title",children:"Gestin de Recargas"}),o.jsx("p",{className:"page-subtitle",children:"Administra y revisa todas las solicitudes de recarga"})]})}),o.jsx("div",{className:"topups-filters",children:d.map(x=>o.jsxs("button",{className:`filter-btn ${u===x.value?"active":""}`,onClick:()=>i.status(x.value==="all"?"":x.value),children:[x.label,o.jsx("span",{className:"filter-count",children:x.count})]},x.value))}),o.jsx(kO,{className:"topups-table-card",children:a?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsx("div",{className:"empty-state-title",children:"Cargando recargas"}),o.jsx("div",{className:"empty-state-text",children:"Obteniendo datos de Firestore"})]}):c?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsx("div",{className:"empty-state-title",children:"Error al cargar"}),o.jsx("div",{className:"empty-state-text",children:c})]}):I.length>0?o.jsx("div",{className:"table-wrap",children:o.jsxs("table",{className:"table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Usuario"}),o.jsx("th",{children:"Mtodo"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"}),o.jsx("th",{children:"Acciones"})]})}),o.jsx("tbody",{children:I.map(x=>{var _,E,k,O,D,w;return o.jsxs("tr",{children:[o.jsx("td",{children:o.jsxs("div",{className:"user-cell",children:[o.jsx("div",{className:"user-avatar",children:(((_=x.user)==null?void 0:_.displayName)||((E=x.user)==null?void 0:E.email)||"U")[0]}),o.jsxs("div",{children:[o.jsx("div",{className:"user-name",children:((k=x.user)==null?void 0:k.displayName)||"Sin nombre"}),o.jsx("div",{className:"user-email",children:((O=x.user)==null?void 0:O.email)||"Email no disponible"})]})]})}),o.jsx("td",{children:o.jsxs("div",{className:"method-cell",children:[o.jsx("span",{className:"method-icon",children:((D=x.method)==null?void 0:D.icon)||""}),((w=x.method)==null?void 0:w.name)||"Mtodo no disponible"]})}),o.jsx("td",{className:"amount-cell",children:m(x.amount)}),o.jsx("td",{children:f(x.status)}),o.jsx("td",{className:"date-cell",children:p(x.createdAt||new Date)}),o.jsx("td",{children:o.jsx("button",{className:"btn-ghost btn-sm",onClick:()=>e(x),children:"Ver detalles"})})]},x.id)})})]})}):o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsx("div",{className:"empty-state-title",children:"No hay recargas"}),o.jsx("div",{className:"empty-state-text",children:"No se encontraron recargas con el filtro seleccionado"})]})}),t&&o.jsxs(bO,{open:!!t,onClose:()=>e(null),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{className:"modal-title",children:"Detalles de Recarga"}),o.jsx("button",{className:"modal-close",onClick:()=>e(null),children:""})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"ID de transaccin"}),o.jsx("span",{className:"detail-value",children:t.id})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Usuario"}),o.jsx("span",{className:"detail-value",children:((y=t.user)==null?void 0:y.displayName)||"Sin nombre"})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Email"}),o.jsx("span",{className:"detail-value",children:((N=t.user)==null?void 0:N.email)||"Email no disponible"})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Monto"}),o.jsx("span",{className:"detail-value",children:m(t.amount)})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Mtodo"}),o.jsx("span",{className:"detail-value",children:((T=t.method)==null?void 0:T.name)||"Mtodo no disponible"})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Estado"}),o.jsx("span",{className:"detail-value",children:f(t.status)})]}),o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Fecha"}),o.jsx("span",{className:"detail-value",children:p(t.createdAt||new Date)})]})]}),o.jsx("div",{className:"modal-footer",children:o.jsx("button",{className:"btn btn-secondary",onClick:()=>e(null),children:"Cerrar"})})]})]})}function VO(){return o.jsxs("div",{className:"admin-not-authorized",children:[o.jsx("h2",{children:"No Autorizado"}),o.jsx("p",{children:"No tienes permiso para acceder al rea de administracin."}),o.jsxs("p",{children:[o.jsx(Ya,{to:"/login",children:"Ir a Login"})," o ",o.jsx(Ya,{to:"/register",children:"Registrarse"})]})]})}const ZI="/assets/Logo-D466UPiE.png";function MO(){const[t,e]=b.useState(""),[n,r]=b.useState(""),[s,i]=b.useState(null),[a,c]=b.useState(!1),u=Qn(),d=async m=>{const I=Z(W,"users",m.uid),y=await Dt(I);if(!y.exists())throw await is(hr),new Error("Perfil de usuario no encontrado en Firestore");const{role:N,status:T}=y.data();if(N!=="admin")throw await is(hr),new Error("No tienes permisos de administrador");if(T!=="active")throw await is(hr),new Error("Tu cuenta no est activa");u("/admin",{replace:!0}),console.log(" Login exitoso:",{uid:m.uid,role:N,status:T})},f=async m=>{m.preventDefault(),c(!0),i(null);try{const I=await MC(hr,t.trim(),n);await d(I.user)}catch(I){i(I.message),console.error("Error en login:",I)}finally{c(!1)}},p=async()=>{c(!0),i(null);try{const m=new kn,I=await lk(hr,m);await d(I.user)}catch(m){i(m.message),console.error("Error en login Google:",m)}finally{c(!1)}};return o.jsx("div",{className:"auth-wrap",children:o.jsxs("div",{className:"auth-container",children:[o.jsxs("div",{className:"auth-card",children:[o.jsxs("div",{className:"auth-header",children:[o.jsx("img",{src:ZI,alt:"Logo",className:"auth-logo"}),o.jsx("h1",{className:"auth-title",children:"Iniciar Sesin"}),o.jsx("p",{className:"auth-subtitle",children:"Panel de Administrador"})]}),o.jsxs("form",{onSubmit:f,className:"auth-form",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"email",children:o.jsx("span",{children:"Email"})}),o.jsx("input",{id:"email",type:"email",value:t,onChange:m=>e(m.target.value),placeholder:"tu@email.com",required:!0})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"password",children:o.jsx("span",{children:"Contrasea"})}),o.jsx("input",{id:"password",type:"password",value:n,onChange:m=>r(m.target.value),placeholder:"",required:!0})]}),s&&o.jsxs("div",{className:"auth-error",children:[o.jsxs("svg",{className:"error-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),o.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),s]}),o.jsx("button",{className:"btn btn-primary btn-large",type:"submit",disabled:a,children:a?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"spinner"}),"Accediendo"]}):"Iniciar Sesin"})]}),o.jsx("div",{className:"auth-divider",children:o.jsx("span",{children:"o contina con"})}),o.jsxs("button",{className:"btn btn-google",onClick:p,disabled:a,type:"button",children:[o.jsxs("svg",{viewBox:"0 0 24 24",className:"google-icon",children:[o.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),o.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),o.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),o.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continuar con Google"]}),o.jsx("div",{className:"auth-links",children:o.jsxs("p",{children:["No tienes cuenta? ",o.jsx(Ya,{to:"/register",children:"Regstrate aqu"})]})})]}),o.jsxs("div",{className:"auth-background",children:[o.jsx("div",{className:"gradient-blob"}),o.jsx("div",{className:"gradient-blob"})]})]})})}function FO(){const[t,e]=b.useState(""),[n,r]=b.useState(""),[s,i]=b.useState(""),[a,c]=b.useState(null),[u,d]=b.useState(!1),[f,p]=b.useState(!1),m=Qn(),{loading:I,isAdmin:y}=JI(),N=async T=>{if(T.preventDefault(),I)return;if(n!==s){c("Las contraseas no coinciden");return}if(n.length<6){c("La contrasea debe tener al menos 6 caracteres");return}if(!y){c("Solo un administrador puede crear cuentas de administrador. Inicia sesin como admin y vuelve a intentar.");return}d(!0),c(null),p(!1);let x=null;const _=AO();try{x=await VC(_,t.trim(),n);const E=x.user;console.log(" Usuario creado en Auth:",E.uid);try{await s1(Z(W,"users",E.uid),{uid:E.uid,email:E.email,role:"admin",status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{merge:!0}),console.log(" Documento Firestore creado exitosamente"),p(!0),await is(_),setTimeout(()=>m("/admin",{replace:!0}),1500)}catch(k){console.error(" Error al crear documento Firestore:",k);try{await BC(E)}catch(O){console.error(" Error al eliminar usuario recin creado:",O)}throw await is(_),new Error("Error al crear perfil en Firestore. Revisa permisos/reglas.")}}catch(E){console.error("Error en registro:",E),c(E.message||"Error desconocido en el registro"),await is(_).catch(k=>console.error("Error en signOut provisioning:",k))}finally{d(!1)}};return o.jsx("div",{className:"auth-wrap",children:o.jsxs("div",{className:"auth-container",children:[o.jsxs("div",{className:"auth-card",children:[o.jsxs("div",{className:"auth-header",children:[o.jsx("img",{src:ZI,alt:"Logo",className:"auth-logo"}),o.jsx("h1",{className:"auth-title",children:"Crear Cuenta Admin"}),o.jsx("p",{className:"auth-subtitle",children:"Registra un nuevo administrador"})]}),f&&o.jsxs("div",{className:"auth-success",children:[o.jsx("svg",{className:"success-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:o.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Usuario admin registrado exitosamente! Sers redirigido..."]}),o.jsxs("form",{onSubmit:N,className:"auth-form",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"email",children:o.jsx("span",{children:"Email"})}),o.jsx("input",{id:"email",type:"email",value:t,onChange:T=>e(T.target.value),placeholder:"admin@tuempresa.com",required:!0})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"password",children:o.jsx("span",{children:"Contrasea"})}),o.jsx("input",{id:"password",type:"password",value:n,onChange:T=>r(T.target.value),placeholder:"",required:!0}),o.jsx("span",{className:"password-hint",children:"Mnimo 6 caracteres"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"confirmPassword",children:o.jsx("span",{children:"Confirmar Contrasea"})}),o.jsx("input",{id:"confirmPassword",type:"password",value:s,onChange:T=>i(T.target.value),placeholder:"",required:!0})]}),a&&o.jsxs("div",{className:"auth-error",children:[o.jsxs("svg",{className:"error-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),o.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),a]}),o.jsx("button",{className:"btn btn-primary btn-large",type:"submit",disabled:u||I,children:u?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"spinner"}),"Registrando"]}):"Crear Cuenta"})]}),o.jsx("div",{className:"auth-links",children:o.jsxs("p",{children:["Ya tienes cuenta? ",o.jsx(Ya,{to:"/login",children:"Inicia sesin aqu"})]})})]}),o.jsxs("div",{className:"auth-background",children:[o.jsx("div",{className:"gradient-blob"}),o.jsx("div",{className:"gradient-blob"})]})]})})}function UO(){const{kpis:t,loading:e}=PO();Qn();const n=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(s||0),r=s=>s?new Date(s).toLocaleDateString("es-MX",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}):"-";return e?o.jsx("div",{className:"dashboard-loading",children:o.jsx("div",{children:"Cargando dashboard..."})}):o.jsxs("div",{className:"admin-dashboard-page",children:[o.jsxs("div",{className:"dashboard-header",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"dashboard-title",children:"Panel de Administracin"}),o.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del sistema"})]}),o.jsx("div",{className:"dashboard-meta",children:o.jsx("span",{className:"last-updated",children:"Actualizado: Hoy"})})]}),o.jsxs("div",{className:"kpi-section",children:[o.jsx("h2",{className:"section-title",children:" Usuarios"}),o.jsxs("div",{className:"kpi-grid kpi-grid-2",children:[o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Usuarios Totales"}),o.jsx("div",{className:"kpi-value",children:t.totalUsers})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Usuarios Activos"}),o.jsx("div",{className:"kpi-value",style:{color:"#22c55e"},children:t.activeUsers})]})]})]}),o.jsxs("div",{className:"kpi-section",children:[o.jsx("h2",{className:"section-title",children:" Recargas"}),o.jsxs("div",{className:"kpi-grid kpi-grid-3",children:[o.jsxs("div",{className:"kpi-card alert",children:[o.jsx("div",{className:"kpi-label",children:"Pendientes"}),o.jsx("div",{className:"kpi-value",style:{color:"#f59e0b"},children:t.pendingTopups})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Aprobadas"}),o.jsx("div",{className:"kpi-value",style:{color:"#22c55e"},children:t.approvedTopups})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Total"}),o.jsx("div",{className:"kpi-value",children:t.totalTopups})]})]})]}),o.jsxs("div",{className:"kpi-section",children:[o.jsx("h2",{className:"section-title",children:" Retiros"}),o.jsx("div",{className:"kpi-grid kpi-grid-1",children:o.jsxs("div",{className:"kpi-card alert",children:[o.jsx("div",{className:"kpi-label",children:"Retiros Pendientes"}),o.jsx("div",{className:"kpi-value",style:{color:"#f59e0b"},children:t.pendingWithdrawals})]})})]}),o.jsxs("div",{className:"kpi-section",children:[o.jsx("h2",{className:"section-title",children:" Inversiones"}),o.jsxs("div",{className:"kpi-grid kpi-grid-2",children:[o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Inversiones Activas"}),o.jsx("div",{className:"kpi-value",children:t.activeInvestments})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Capital Invertido"}),o.jsx("div",{className:"kpi-value-currency",children:n(t.totalInvested)})]})]})]}),o.jsxs("div",{className:"kpi-section",children:[o.jsx("h2",{className:"section-title",children:" Transacciones Recientes"}),o.jsx("div",{className:"transactions-card",children:t.recentTransactions.length>0?o.jsx("div",{className:"table-wrapper",children:o.jsxs("table",{className:"transactions-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Tipo"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Usuario"}),o.jsx("th",{children:"Fecha"})]})}),o.jsx("tbody",{children:t.recentTransactions.map(s=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx("span",{className:"tx-type",children:s.type||"transfer"})}),o.jsx("td",{className:"amount",children:n(s.amount)}),o.jsx("td",{className:"user-email",children:s.userEmail||"Usuario no disponible"}),o.jsx("td",{className:"date",children:r(s.createdAt)})]},s.id))})]})}):o.jsx("div",{className:"empty-state",children:"No hay transacciones recientes"})})]}),o.jsxs("div",{className:"kpi-section",children:[o.jsx("h2",{className:"section-title",children:" Alertas Operativas"}),o.jsxs("div",{className:"alerts-container",children:[t.pendingTopups>0&&o.jsxs("div",{className:"alert-item alert-warning",children:[o.jsx("span",{className:"alert-icon",children:""}),o.jsxs("span",{className:"alert-text",children:[t.pendingTopups," recarga(s) pendiente(s) de aprobacin"]})]}),t.pendingWithdrawals>0&&o.jsxs("div",{className:"alert-item alert-warning",children:[o.jsx("span",{className:"alert-icon",children:""}),o.jsxs("span",{className:"alert-text",children:[t.pendingWithdrawals," retiro(s) pendiente(s) de aprobacin"]})]}),t.activeInvestments>0&&o.jsxs("div",{className:"alert-item alert-info",children:[o.jsx("span",{className:"alert-icon",children:""}),o.jsxs("span",{className:"alert-text",children:[t.activeInvestments," inversin(es) activa(s) en el sistema"]})]}),t.pendingTopups===0&&t.pendingWithdrawals===0&&o.jsxs("div",{className:"alert-item alert-success",children:[o.jsx("span",{className:"alert-icon",children:""}),o.jsx("span",{className:"alert-text",children:"Sistema operativo. No hay operaciones pendientes."})]})]})]})]})}function zO(t={}){const[e,n]=b.useState([]),[r,s]=b.useState(!0),[i,a]=b.useState(null),[c,u]=b.useState(0),d=async()=>{try{s(!0),a(null);let p=[];t.status&&t.status!=="all"&&p.push(ke("status","==",t.status));const m=_e(ae(W,"users"),...p,Tn("createdAt","desc")),y=(await xe(m)).docs.map(T=>({uid:T.id,...T.data()}));let N=y;if(t.search){const T=t.search.toLowerCase();N=y.filter(x=>{var _,E;return((_=x.email)==null?void 0:_.toLowerCase().includes(T))||((E=x.displayName)==null?void 0:E.toLowerCase().includes(T))})}n(N),u(N.length)}catch(p){console.error("Error en useAdminUsers:",p),a(p.message)}finally{s(!1)}};return b.useEffect(()=>{d()},[t.status]),{users:e,loading:r,error:i,total:c,refetch:()=>d()}}function BO(t){const[e,n]=b.useState(null),[r,s]=b.useState(null),[i,a]=b.useState([]),[c,u]=b.useState([]),[d,f]=b.useState([]),[p,m]=b.useState([]),[I,y]=b.useState(!0),[N,T]=b.useState(null),x=async()=>{if(!t){y(!1);return}try{y(!0),T(null);const E=Z(W,"users",t),k=await Dt(E);if(!k.exists()){T("Usuario no encontrado"),y(!1);return}n({uid:t,...k.data()});const O=Z(W,"users",t,"wallets",t),D=await Dt(O);D.exists()&&s(D.data());const w=_e(ae(W,"investments"),ke("userId","==",t)),v=await xe(w);a(v.docs.map(K=>({id:K.id,...K.data()})));const A=_e(ae(W,"topups"),ke("userId","==",t)),P=await xe(A);u(P.docs.map(K=>({id:K.id,...K.data()})));const C=_e(ae(W,"withdrawals"),ke("userId","==",t)),j=await xe(C);f(j.docs.map(K=>({id:K.id,...K.data()})));const S=_e(ae(W,"transactions"),ke("userId","==",t)),U=await xe(S);m(U.docs.map(K=>({id:K.id,...K.data()})))}catch(E){console.error("Error en useUserDetail:",E),T(E.message)}finally{y(!1)}};return b.useEffect(()=>{x()},[t]),{user:e,wallet:r,investments:i,topups:c,withdrawals:d,transactions:p,loading:I,error:N,refetch:()=>x()}}function $O({users:t,loading:e,onSelectUser:n}){if(e)return o.jsx("div",{className:"usuarios-table-loading",children:o.jsx("div",{children:"Cargando usuarios..."})});if(t.length===0)return o.jsx("div",{className:"usuarios-table-empty",children:o.jsx("div",{children:"No hay usuarios encontrados"})});const r=s=>s?new Date(s).toLocaleDateString("es-MX"):"-";return o.jsx("div",{className:"usuarios-table-wrapper",children:o.jsxs("table",{className:"usuarios-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Email"}),o.jsx("th",{children:"Nombre"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Rol"}),o.jsx("th",{children:"Fecha Registro"}),o.jsx("th",{children:"Accin"})]})}),o.jsx("tbody",{children:t.map(s=>o.jsxs("tr",{className:"usuario-row",children:[o.jsx("td",{className:"email-cell",children:s.email}),o.jsx("td",{children:s.displayName||"-"}),o.jsx("td",{children:o.jsx("span",{className:`status-badge status-${s.status}`,children:s.status==="active"?"Activo":"Inactivo"})}),o.jsx("td",{children:s.role||"investor"}),o.jsx("td",{children:r(s.createdAt)}),o.jsx("td",{children:o.jsx("button",{className:"btn-view-detail",onClick:()=>n(s.uid),children:"Ver detalle"})})]},s.uid))})]})})}const WO=t=>{if(t==null)return 0;if(typeof t=="number")return Number.isFinite(t)?t:0;const e=String(t).trim();if(!e)return 0;const n=e.replace(/,/g,""),r=Number(n);return Number.isFinite(r)?r:0},ho=t=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(WO(t));function e0(){const[t,e]=b.useState(!1),[n,r]=b.useState(null);return{approve:async(i,a,c)=>{var u,d;try{e(!0),r(null);let f=null;try{const p=_e(ae(W,"transactions"),ke("topupId","==",i),Hn(1));f=((d=(u=(await xe(p)).docs)==null?void 0:u[0])==null?void 0:d.id)||null}catch{}return await Oi(W,async p=>{const m=Z(W,"topups",i),I=await p.get(m);if(!I.exists())throw new Error("Topup no encontrado");const y=I.data(),N=y==null?void 0:y.status;if(N==="approved")return;if(N!=="pending")throw new Error(`No se puede aprobar un topup con status: ${N}`);const T=y==null?void 0:y.userId,x=Number(y==null?void 0:y.amount),_=(y==null?void 0:y.transactionId)||f||null;if(!T)throw new Error("Topup invlido: falta userId");if(!Number.isFinite(x)||x<=0)throw new Error("Topup invlido: amount debe ser > 0");const E=Z(W,"users",T,"wallets",T),k=await p.get(E),O=_?Z(W,"transactions",_):null,D=O?await p.get(O):null,w=D!=null&&D.exists()?D.data():null,v=w!=null&&w.createdAt&&typeof w.createdAt!="string"?w.createdAt:y!=null&&y.createdAt&&typeof y.createdAt!="string"?y.createdAt:J(),A=(w==null?void 0:w.currency)||(y==null?void 0:y.currency)||"USD",P=(w==null?void 0:w.methodId)||(y==null?void 0:y.methodId)||null,C=(w==null?void 0:w.methodName)||(y==null?void 0:y.methodName)||(y==null?void 0:y.method)||null,j=(w==null?void 0:w.methodType)||(y==null?void 0:y.methodType)||null,S=(w==null?void 0:w.methodDetailsText)||(y==null?void 0:y.methodDetailsText)||null,U=(w==null?void 0:w.proofUrl)||(y==null?void 0:y.proofUrl)||null,K=(w==null?void 0:w.proofPath)||(y==null?void 0:y.proofPath)||null,te=(w==null?void 0:w.proofFileName)||(y==null?void 0:y.proofFileName)||null,ve=(w==null?void 0:w.proofContentType)||(y==null?void 0:y.proofContentType)||null,B=typeof((w==null?void 0:w.proofSize)??(y==null?void 0:y.proofSize))=="number"?(w==null?void 0:w.proofSize)??(y==null?void 0:y.proofSize):null,Y=(w==null?void 0:w.description)||(y!=null&&y.methodName?`Recarga aprobada (${y.methodName})`:"Recarga aprobada"),V=(w==null?void 0:w.reference)||i,ie=(w==null?void 0:w.topupId)||i,oe=Z(ae(W,"transactions"));k.exists()?p.update(E,{balance:Ra(x),updatedAt:J()}):p.set(E,{uid:T,balance:x,createdAt:J(),updatedAt:J()}),p.update(m,{status:"approved",approvedAt:J(),approvedBy:a}),p.set(oe,{userId:T,amount:x,currency:A,methodId:P,methodName:C,methodType:j,methodDetailsText:S,proofUrl:U,proofPath:K,proofFileName:te,proofContentType:ve,proofSize:B,type:"deposit",status:"approved",description:Y,reference:V,topupId:ie,createdAt:v,approvedAt:J(),approvedBy:a});const pe=Z(ae(W,"auditLogs"));p.set(pe,{action:"APPROVE_TOPUP",adminUid:a,adminEmail:c,targetUserId:T,targetId:i,status:"SUCCESS",metadata:{amount:x,topupId:i},timestamp:J()});const Pe=Z(ae(W,"users",T,"notifications"));p.set(Pe,{userId:T,type:"transaction",title:"Recarga aprobada",message:`Tu recarga de ${ho(x)} ${A} fue aprobada.`,topupId:ie,amount:x,currency:A,read:!1,createdAt:J()})}),console.log(" Recarga aprobada:",i),!0}catch(f){return console.error(" Error al aprobar recarga:",f),r((f==null?void 0:f.message)||String(f)),!1}finally{e(!1)}},loading:t,error:n}}function t0(){const[t,e]=b.useState(!1),[n,r]=b.useState(null);return{reject:async(i,a,c,u,d)=>{var f,p;try{e(!0),r(null);let m=null;try{const I=_e(ae(W,"transactions"),ke("topupId","==",i),Hn(1));m=((p=(f=(await xe(I)).docs)==null?void 0:f[0])==null?void 0:p.id)||null}catch{}return await Oi(W,async I=>{const y=Z(W,"topups",i),N=await I.get(y);if(!N.exists())throw new Error("Topup no encontrado");const T=N.data(),x=T==null?void 0:T.status;if(x==="rejected")return;if(x!=="pending")throw new Error(`No se puede rechazar un topup con status: ${x}`);const _=(T==null?void 0:T.userId)||a,E=Number(T==null?void 0:T.amount),k=(T==null?void 0:T.transactionId)||m||null;if(!_)throw new Error("Topup invlido: falta userId");const O=k?Z(W,"transactions",k):null,D=O?await I.get(O):null,w=D!=null&&D.exists()?D.data():null,v=w!=null&&w.createdAt&&typeof w.createdAt!="string"?w.createdAt:T!=null&&T.createdAt&&typeof T.createdAt!="string"?T.createdAt:J(),A=(w==null?void 0:w.currency)||(T==null?void 0:T.currency)||"USD",P=(w==null?void 0:w.methodId)||(T==null?void 0:T.methodId)||null,C=(w==null?void 0:w.methodName)||(T==null?void 0:T.methodName)||(T==null?void 0:T.method)||null,j=(w==null?void 0:w.methodType)||(T==null?void 0:T.methodType)||null,S=(w==null?void 0:w.methodDetailsText)||(T==null?void 0:T.methodDetailsText)||null,U=(w==null?void 0:w.proofUrl)||(T==null?void 0:T.proofUrl)||null,K=(w==null?void 0:w.proofPath)||(T==null?void 0:T.proofPath)||null,te=(w==null?void 0:w.proofFileName)||(T==null?void 0:T.proofFileName)||null,ve=(w==null?void 0:w.proofContentType)||(T==null?void 0:T.proofContentType)||null,B=typeof((w==null?void 0:w.proofSize)??(T==null?void 0:T.proofSize))=="number"?(w==null?void 0:w.proofSize)??(T==null?void 0:T.proofSize):null,Y=(w==null?void 0:w.description)||(T!=null&&T.methodName?`Recarga rechazada (${T.methodName})`:"Recarga rechazada"),V=(w==null?void 0:w.reference)||i,ie=(w==null?void 0:w.topupId)||i,oe=Z(ae(W,"transactions"));I.update(y,{status:"rejected",rejectedAt:J(),rejectedBy:u,rejectionReason:c}),I.set(oe,{userId:_,amount:Number.isFinite(E)?E:null,currency:A,methodId:P,methodName:C,methodType:j,methodDetailsText:S,proofUrl:U,proofPath:K,proofFileName:te,proofContentType:ve,proofSize:B,type:"deposit",status:"rejected",description:Y,reference:V,topupId:ie,createdAt:v,rejectionReason:c,rejectedAt:J(),rejectedBy:u});const pe=Z(ae(W,"auditLogs"));I.set(pe,{action:"REJECT_TOPUP",adminUid:u,adminEmail:d,targetUserId:_,targetId:i,status:"SUCCESS",reason:c,timestamp:J()})}),console.log(" Recarga rechazada:",i),!0}catch(m){return console.error(" Error al rechazar recarga:",m),r((m==null?void 0:m.message)||String(m)),!1}finally{e(!1)}},loading:t,error:n}}function _u({isOpen:t,title:e,message:n,actionLabel:r,onConfirm:s,onCancel:i,loading:a,showReasonInput:c,reasonPlaceholder:u}){const[d,f]=b.useState(""),p=()=>{if(c&&!d.trim()){alert("Por favor ingresa una razn");return}s(d),f("")};return t?o.jsx("div",{className:"action-modal-overlay",onClick:i,children:o.jsxs("div",{className:"action-modal",onClick:m=>m.stopPropagation(),children:[o.jsx("h2",{className:"action-modal-title",children:e}),o.jsx("p",{className:"action-modal-message",children:n}),c&&o.jsx("textarea",{className:"action-modal-textarea",placeholder:u||"Ingresa una razn...",value:d,onChange:m=>f(m.target.value),disabled:a}),o.jsxs("div",{className:"action-modal-footer",children:[o.jsx("button",{className:"btn-cancel",onClick:i,disabled:a,children:"Cancelar"}),o.jsx("button",{className:"btn-confirm",onClick:p,disabled:a,children:a?"Procesando...":r})]})]})}):null}function qO({isOpen:t,user:e,wallet:n,investments:r,topups:s,withdrawals:i,transactions:a,loading:c,onClose:u,adminData:d,onActionComplete:f}){const[p,m]=b.useState("perfil"),[I,y]=b.useState(null),[N,T]=b.useState({isOpen:!1,type:null}),{approve:x,loading:_}=e0(),{reject:E,loading:k}=t0();if(!t)return null;const O=async A=>{if(!I)return;await x(I.id,d.uid,d.email)&&(T({isOpen:!1,type:null}),y(null),f==null||f())},D=async A=>{if(!I)return;await E(I.id,e.uid,A,d.uid,d.email)&&(T({isOpen:!1,type:null}),y(null),f==null||f())},w=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(A||0),v=A=>A?new Date(A).toLocaleDateString("es-MX"):"-";return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"usuario-detail-overlay",onClick:u}),o.jsxs("div",{className:"usuario-detail-drawer",children:[o.jsxs("div",{className:"drawer-header",children:[o.jsxs("div",{className:"header-content",children:[o.jsx("h2",{className:"drawer-title",children:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||"Usuario"}),o.jsx("p",{className:"drawer-email",children:e==null?void 0:e.email}),o.jsxs("div",{className:"header-badges",children:[o.jsx("span",{className:`status-badge status-${e==null?void 0:e.status}`,children:(e==null?void 0:e.status)==="active"?" Activo":" Inactivo"}),o.jsx("span",{className:"role-badge",children:(e==null?void 0:e.role)||"Investor"})]})]}),o.jsx("button",{className:"btn-close",onClick:u,"aria-label":"Cerrar",children:""})]}),c?o.jsx("div",{className:"drawer-loading",children:"Cargando detalle..."}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"drawer-tabs",children:[o.jsx("button",{className:`tab-btn ${p==="perfil"?"active":""}`,onClick:()=>m("perfil"),children:" Resumen"}),o.jsx("button",{className:`tab-btn ${p==="wallet"?"active":""}`,onClick:()=>m("wallet"),children:" Wallet"}),o.jsx("button",{className:`tab-btn ${p==="inversiones"?"active":""}`,onClick:()=>m("inversiones"),children:" Inversiones"}),o.jsx("button",{className:`tab-btn ${p==="recargas"?"active":""}`,onClick:()=>m("recargas"),children:" Recargas"}),o.jsx("button",{className:`tab-btn ${p==="retiros"?"active":""}`,onClick:()=>m("retiros"),children:" Retiros"}),o.jsx("button",{className:`tab-btn ${p==="transacciones"?"active":""}`,onClick:()=>m("transacciones"),children:" Transacciones"})]}),o.jsxs("div",{className:"drawer-content",children:[p==="perfil"&&e&&o.jsxs("div",{className:"tab-pane",children:[o.jsxs("div",{className:"summary-cards",children:[o.jsxs("div",{className:"summary-card",children:[o.jsx("div",{className:"card-label",children:"Email"}),o.jsx("div",{className:"card-value accent",children:e.email})]}),o.jsxs("div",{className:"summary-card",children:[o.jsx("div",{className:"card-label",children:"Nombre"}),o.jsx("div",{className:"card-value",children:e.displayName||""})]}),o.jsxs("div",{className:"summary-card",children:[o.jsx("div",{className:"card-label",children:"Estado"}),o.jsx("div",{children:o.jsx("span",{className:`status-badge status-${e.status}`,children:e.status==="active"?"Activo":"Inactivo"})})]}),o.jsxs("div",{className:"summary-card",children:[o.jsx("div",{className:"card-label",children:"Fecha Registro"}),o.jsx("div",{className:"card-value",children:v(e.createdAt)})]})]}),o.jsxs("div",{className:"technical-section",children:[o.jsx("div",{className:"section-title",children:"Informacin Tcnica"}),o.jsxs("div",{className:"tech-info-row",children:[o.jsx("span",{className:"tech-label",children:"ID de Usuario"}),o.jsx("span",{className:"tech-value",children:e.uid})]}),o.jsxs("div",{className:"tech-info-row",children:[o.jsx("span",{className:"tech-label",children:"Rol"}),o.jsx("span",{className:"tech-value",children:e.role||"investor"})]})]})]}),p==="wallet"&&o.jsx("div",{className:"tab-pane",children:n?o.jsx("div",{className:"info-group",children:o.jsxs("div",{className:"wallet-card",children:[o.jsx("div",{className:"wallet-label",children:"Balance Actual"}),o.jsx("div",{className:"wallet-amount",children:w(n.balance)}),o.jsxs("div",{className:"wallet-meta",children:[o.jsxs("div",{className:"wallet-meta-item",children:[o.jsx("div",{className:"wallet-meta-label",children:"Actualizado"}),o.jsx("div",{className:"wallet-meta-value",children:v(n.updatedAt)})]}),o.jsxs("div",{className:"wallet-meta-item",children:[o.jsx("div",{className:"wallet-meta-label",children:"Moneda"}),o.jsx("div",{className:"wallet-meta-value",children:"USD"})]})]})]})}):o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsx("div",{className:"empty-state-message",children:"Sin informacin de wallet"})]})}),p==="inversiones"&&o.jsx("div",{className:"tab-pane",children:r.length>0?o.jsx("div",{className:"table-responsive",children:o.jsxs("table",{className:"mini-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"ID"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"})]})}),o.jsx("tbody",{children:r.map(A=>o.jsxs("tr",{children:[o.jsxs("td",{className:"id-cell",children:[A.id.substring(0,8),"..."]}),o.jsx("td",{children:w(A.amount)}),o.jsx("td",{children:o.jsx("span",{className:`status-badge status-${A.status}`,children:A.status})}),o.jsx("td",{children:v(A.createdAt)})]},A.id))})]})}):o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsx("div",{className:"empty-state-message",children:"Sin inversiones"})]})}),p==="recargas"&&o.jsx("div",{className:"tab-pane",children:s.length>0?o.jsx("div",{className:"table-responsive",children:o.jsxs("table",{className:"mini-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"}),o.jsx("th",{children:"Accin"})]})}),o.jsx("tbody",{children:s.map(A=>o.jsxs("tr",{children:[o.jsx("td",{children:w(A.amount)}),o.jsx("td",{children:o.jsx("span",{className:`status-badge status-${A.status}`,children:A.status})}),o.jsx("td",{children:v(A.createdAt)}),o.jsx("td",{children:A.status==="pending"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"btn-action btn-approve",onClick:()=>{y(A),T({isOpen:!0,type:"approve"})},children:""}),o.jsx("button",{className:"btn-action btn-reject",onClick:()=>{y(A),T({isOpen:!0,type:"reject"})},children:""})]})})]},A.id))})]})}):o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsx("div",{className:"empty-state-message",children:"Sin recargas"})]})}),p==="retiros"&&o.jsx("div",{className:"tab-pane",children:i.length>0?o.jsx("div",{className:"table-responsive",children:o.jsxs("table",{className:"mini-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"})]})}),o.jsx("tbody",{children:i.map(A=>o.jsxs("tr",{children:[o.jsx("td",{children:w(A.amount)}),o.jsx("td",{children:o.jsx("span",{className:`status-badge status-${A.status}`,children:A.status})}),o.jsx("td",{children:v(A.createdAt)})]},A.id))})]})}):o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsx("div",{className:"empty-state-message",children:"Sin retiros"})]})}),p==="transacciones"&&o.jsx("div",{className:"tab-pane",children:a.length>0?o.jsx("div",{className:"table-responsive",children:o.jsxs("table",{className:"mini-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Tipo"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Fecha"})]})}),o.jsx("tbody",{children:a.map(A=>o.jsxs("tr",{children:[o.jsx("td",{children:A.type||"transfer"}),o.jsx("td",{children:w(A.amount)}),o.jsx("td",{children:v(A.createdAt)})]},A.id))})]})}):o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsx("div",{className:"empty-state-message",children:"Sin transacciones"})]})})]})]})]}),o.jsx(_u,{isOpen:N.isOpen,title:N.type==="approve"?"Aprobar Recarga":"Rechazar Recarga",message:`${N.type==="approve"?"Aprobar":"Rechazar"} recarga de ${I?w(I.amount):""}?`,actionLabel:N.type==="approve"?"Aprobar":"Rechazar",showReasonInput:N.type==="reject",reasonPlaceholder:"Razn del rechazo...",loading:_||k,onConfirm:N.type==="approve"?O:D,onCancel:()=>{T({isOpen:!1,type:null}),y(null)}})]})}function HO({adminData:t}){const[e]=Yf(),[n,r]=b.useState({status:"all",search:""}),[s,i]=b.useState(null),{users:a,loading:c,refetch:u}=zO(n),{user:d,wallet:f,investments:p,topups:m,withdrawals:I,transactions:y,loading:N,refetch:T}=BO(s),x=()=>{u(),T()},_=a.length,E=a.filter(D=>D.status==="active").length,k=a.filter(D=>D.status==="inactive").length,O=a.filter(D=>D.role==="investor"||!D.role).length;return b.useEffect(()=>{const D=e.get("uid");D&&i(D)},[e]),o.jsxs("div",{className:"usuarios-page",children:[o.jsxs("div",{className:"page-header",children:[o.jsx("h1",{className:"page-title",children:"Gestin de Usuarios"}),o.jsx("p",{className:"page-subtitle",children:"Administra todos los usuarios del sistema"}),o.jsx("div",{className:"page-divider"})]}),o.jsxs("div",{className:"kpi-row",children:[o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-icon",children:""}),o.jsxs("div",{className:"kpi-content",children:[o.jsx("div",{className:"kpi-label",children:"Total de Usuarios"}),o.jsx("div",{className:"kpi-value",children:_})]})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-icon",children:""}),o.jsxs("div",{className:"kpi-content",children:[o.jsx("div",{className:"kpi-label",children:"Activos"}),o.jsx("div",{className:"kpi-value",children:E})]})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-icon",children:""}),o.jsxs("div",{className:"kpi-content",children:[o.jsx("div",{className:"kpi-label",children:"Inactivos"}),o.jsx("div",{className:"kpi-value",children:k})]})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-icon",children:""}),o.jsxs("div",{className:"kpi-content",children:[o.jsx("div",{className:"kpi-label",children:"Inversores"}),o.jsx("div",{className:"kpi-value",children:O})]})]})]}),o.jsxs("div",{className:"filters-toolbar",children:[o.jsxs("div",{className:"search-input-wrapper",children:[o.jsx("span",{className:"search-icon",children:""}),o.jsx("input",{type:"text",placeholder:"Buscar por email o nombre...",className:"search-input",value:n.search,onChange:D=>r({...n,search:D.target.value})})]}),o.jsxs("select",{className:"filter-select",value:n.status,onChange:D=>r({...n,status:D.target.value}),children:[o.jsx("option",{value:"all",children:"Todos los estados"}),o.jsx("option",{value:"active",children:"Activos"}),o.jsx("option",{value:"inactive",children:"Inactivos"})]})]}),o.jsxs("div",{className:"usuarios-card",children:[o.jsx("div",{className:"card-header",children:o.jsxs("h3",{children:["Usuarios (",a.length,")"]})}),o.jsx($O,{users:a,loading:c,onSelectUser:i})]}),o.jsx(qO,{isOpen:!!s,user:d,wallet:f,investments:p,topups:m,withdrawals:I,transactions:y,loading:N,onClose:()=>i(null),adminData:t,onActionComplete:x})]})}function KO(t={}){const[e,n]=b.useState([]),[r,s]=b.useState(!0),[i,a]=b.useState(null),[c,u]=b.useState(0),d=async()=>{try{s(!0),a(null);let p=[];t.status&&t.status!=="all"&&p.push(ke("status","==",t.status));const m=_e(ae(W,"topups"),...p,Tn("createdAt","desc")),y=(await xe(m)).docs.map(k=>({id:k.id,...k.data()})),N=k=>k?typeof k=="string"?k:k!=null&&k.toDate?k.toDate().toISOString():k instanceof Date?k.toISOString():null:null,T=[...new Set(y.map(k=>k.userId).filter(Boolean))],x=await Promise.all(T.map(async k=>{const O=await Dt(Z(W,"users",k));return[k,O.exists()?O.data():null]})),_=Object.fromEntries(x),E=y.map(k=>{const O=_[k.userId]||null;return{...k,userEmail:k.userEmail||(O==null?void 0:O.email)||null,userName:k.userName||(O==null?void 0:O.displayName)||(O==null?void 0:O.fullName)||null,createdAt:N(k.createdAt)||k.createdAt}});n(E),u(E.length)}catch(p){console.error("Error en useAdminTopups:",p),a(p.message)}finally{s(!1)}};return b.useEffect(()=>{d()},[t.status]),{topups:e,loading:r,error:i,total:c,refetch:()=>d()}}const Wy="rechargeMethods",Rd=t=>{const e=String(t||"").toLowerCase().trim();return e==="active"||e==="inactive"?e:"inactive"},GO=t=>{if(!t)return null;if(t!=null&&t.toDate)return t.toDate();if(t instanceof Date)return t;const e=new Date(t);return Number.isNaN(e.getTime())?null:e},Cd=t=>{const e=GO(t);return e?e.toLocaleString("es-MX"):"-"};function QO({isOpen:t,onClose:e}){const[n,r]=b.useState("list"),[s,i]=b.useState(0),[a,c]=b.useState(!1),[u,d]=b.useState(!1),[f,p]=b.useState(null),[m,I]=b.useState([]),[y,N]=b.useState(null),[T,x]=b.useState({name:"",detailsText:"",status:"",type:""}),_=v=>{v&&(v.style.height="auto",v.style.height=`${v.scrollHeight}px`)},E=()=>{r("list"),i(v=>v+1),c(!1),d(!1),p(null),I([]),N(null),x({name:"",detailsText:"",status:"",type:""})};b.useEffect(()=>{if(!t){E();return}(async()=>{try{c(!0),p(null);const A=_e(ae(W,Wy),Tn("createdAt","desc")),C=(await xe(A)).docs.map(j=>({id:j.id,...j.data()}));I(C)}catch(A){console.error("Error cargando mtodos de recarga:",A),p("No se pudieron cargar los mtodos de recarga")}finally{c(!1)}})()},[t]);const k=b.useMemo(()=>y?(y.name||"")!==(T.name||"")||(y.detailsText||"")!==(T.detailsText||"")||(y.status||"")!==(T.status||"")||(y.type||"")!==(T.type||""):!1,[y,T]),O=v=>{N(v),x({name:(v==null?void 0:v.name)||"",detailsText:(v==null?void 0:v.detailsText)||"",status:Rd(v==null?void 0:v.status),type:(v==null?void 0:v.type)||""}),r("edit"),i(A=>A+1),requestAnimationFrame(()=>{const A=document.querySelector(".rm-textarea");_(A)})},D=()=>{N(null),x({name:"",detailsText:"",status:"",type:""}),r("list"),i(v=>v+1)},w=async()=>{if(y&&k)try{d(!0),p(null);const v=Z(W,Wy,y.id);await bi(v,{name:T.name,detailsText:T.detailsText,status:T.status,type:T.type,updateAt:J()});const A={...y,name:T.name,detailsText:T.detailsText,status:T.status,type:T.type};I(P=>P.map(C=>C.id===y.id?A:C)),N(A)}catch(v){console.error("Error guardando mtodo de recarga:",v),p("No se pudieron guardar los cambios")}finally{d(!1)}};return t?o.jsx("div",{className:"recharge-methods-overlay",onClick:e,children:o.jsxs("div",{className:"recharge-methods-modal",onClick:v=>v.stopPropagation(),children:[o.jsxs("div",{className:"rm-header",children:[o.jsx("h2",{className:"rm-title",children:"Mtodos de Recargas"}),o.jsx("button",{className:"rm-close",onClick:e,"aria-label":"Cerrar",children:""})]}),f&&o.jsx("div",{className:"rm-error",children:f}),o.jsx("div",{className:`rm-body rm-anim-${n}`,children:n==="list"?o.jsx(o.Fragment,{children:a?o.jsx("div",{className:"rm-loading",children:"Cargando mtodos..."}):m.length===0?o.jsx("div",{className:"rm-empty",children:"No hay mtodos de recarga"}):o.jsx("div",{className:"rm-list",children:m.map(v=>o.jsxs("button",{className:"rm-list-item",onClick:()=>O(v),title:"Editar mtodo",children:[o.jsxs("div",{className:"rm-list-main",children:[o.jsx("div",{className:"rm-list-name",children:v.name||"Sin nombre"}),o.jsxs("div",{className:"rm-list-meta",children:[o.jsx("span",{className:"rm-pill",children:v.type||"Sin tipo"}),o.jsx("span",{className:"rm-pill",children:v.status||"Sin estado"})]})]}),o.jsx("div",{className:"rm-list-date",children:Cd(v.createdAt)})]},v.id))})}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"rm-form",children:[o.jsxs("label",{className:"rm-field",children:[o.jsx("span",{className:"rm-label",children:"Nombre"}),o.jsx("input",{className:"rm-input",value:T.name,onChange:v=>x(A=>({...A,name:v.target.value})),disabled:u})]}),o.jsxs("label",{className:"rm-field",children:[o.jsx("span",{className:"rm-label",children:"Tipo"}),o.jsx("input",{className:"rm-input",value:T.type,onChange:v=>x(A=>({...A,type:v.target.value})),disabled:u})]}),o.jsxs("label",{className:"rm-field",children:[o.jsx("span",{className:"rm-label",children:"Estado"}),o.jsxs("select",{className:"rm-input",value:Rd(T.status),onChange:v=>x(A=>({...A,status:Rd(v.target.value)})),disabled:u,children:[o.jsx("option",{value:"active",children:"active"}),o.jsx("option",{value:"inactive",children:"inactive"})]})]}),o.jsxs("label",{className:"rm-field",children:[o.jsx("span",{className:"rm-label",children:"Detalles"}),o.jsx("textarea",{className:"rm-textarea",value:T.detailsText,onChange:v=>{x(A=>({...A,detailsText:v.target.value})),_(v.target)},disabled:u,rows:4})]}),o.jsxs("label",{className:"rm-field",children:[o.jsx("span",{className:"rm-label",children:"Creado"}),o.jsx("input",{className:"rm-input rm-input-readonly",value:Cd(y==null?void 0:y.createdAt),readOnly:!0})]}),o.jsxs("label",{className:"rm-field",children:[o.jsx("span",{className:"rm-label",children:"Actualizado"}),o.jsx("input",{className:"rm-input rm-input-readonly",value:Cd(y==null?void 0:y.updateAt),readOnly:!0})]})]}),o.jsxs("div",{className:"rm-footer",children:[o.jsx("button",{className:"rm-btn rm-btn-secondary",onClick:D,disabled:u,children:"Cancelar"}),o.jsx("button",{className:"rm-btn rm-btn-primary",onClick:w,disabled:u||!k,children:u?"Guardando...":"Guardar cambios"})]})]})},s)]})}):null}function YO({adminData:t}){const[e,n]=b.useState("all"),[r,s]=b.useState(null),[i,a]=b.useState({isOpen:!1,type:null}),[c,u]=b.useState({isOpen:!1,url:null}),[d,f]=b.useState(!1),{topups:p,loading:m,refetch:I}=KO({status:e}),{approve:y,loading:N}=e0(),{reject:T,loading:x}=t0(),_=[{value:"all",label:"Todas"},{value:"pending",label:"Pendientes"},{value:"approved",label:"Aprobadas"},{value:"rejected",label:"Rechazadas"}],E=async()=>{if(!r)return;await y(r.id,t.uid,t.email)&&(a({isOpen:!1,type:null}),s(null),I())},k=async v=>{if(!r)return;await T(r.id,r.userId,v,t.uid,t.email)&&(a({isOpen:!1,type:null}),s(null),I())},O=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(v||0),D=v=>{if(!v)return"-";const A=v!=null&&v.toDate?v.toDate():new Date(v);return Number.isNaN(A.getTime())?"-":A.toLocaleDateString("es-MX")},w=v=>(v==null?void 0:v.proofUrl)||(v==null?void 0:v.receiptUrl)||null;return o.jsxs("div",{className:"recargas-page",children:[o.jsx("div",{className:"page-header",children:o.jsxs("div",{children:[o.jsx("h1",{className:"page-title",children:"Gestin de Recargas"}),o.jsx("p",{className:"page-subtitle",children:"Administra todas las solicitudes de recarga de usuarios"})]})}),o.jsx("div",{className:"recargas-filters",children:_.map(v=>o.jsxs("button",{className:`filter-btn ${e===v.value?"active":""}`,onClick:()=>n(v.value),children:[v.label,o.jsx("span",{className:"filter-count",children:v.value==="all"?p.length:p.filter(A=>A.status===v.value).length})]},v.value))}),o.jsxs("div",{className:"recargas-card",children:[o.jsx("div",{className:"card-header",children:o.jsxs("div",{className:"card-header-row",children:[o.jsxs("h3",{children:["Total de recargas: ",p.length]}),o.jsx("button",{className:"btn-methods",onClick:()=>f(!0),type:"button",children:"Metodos de Recargas"})]})}),m?o.jsx("div",{className:"loading-state",children:"Cargando recargas..."}):p.length===0?o.jsx("div",{className:"empty-state",children:"No hay recargas en este estado"}):o.jsx("div",{className:"table-wrapper",children:o.jsxs("table",{className:"recargas-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Usuario"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Mtodo"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"}),o.jsx("th",{children:"Accin"})]})}),o.jsx("tbody",{children:p.map(v=>o.jsxs("tr",{children:[o.jsx("td",{className:"email-cell",children:v.userEmail||v.userId||"Email no disponible"}),o.jsx("td",{className:"amount-cell",children:O(v.amount)}),o.jsx("td",{children:v.method||"-"}),o.jsx("td",{children:o.jsxs("span",{className:`status-badge status-${v.status}`,children:[v.status==="pending"&&"Pendiente",v.status==="approved"&&"Aprobada",v.status==="rejected"&&"Rechazada"]})}),o.jsx("td",{children:D(v.createdAt)}),o.jsx("td",{children:o.jsxs("div",{className:"action-buttons",children:[w(v)&&o.jsx("button",{className:"btn-action btn-proof",onClick:()=>{u({isOpen:!0,url:w(v)})},title:"Ver comprobante",children:o.jsxs("svg",{className:"btn-icon",viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[o.jsx("path",{d:"M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7S2 12 2 12Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),o.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),v.status==="pending"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"btn-action btn-approve",onClick:()=>{s(v),a({isOpen:!0,type:"approve"})},title:"Aprobar",children:""}),o.jsx("button",{className:"btn-action btn-reject",onClick:()=>{s(v),a({isOpen:!0,type:"reject"})},title:"Rechazar",children:""})]})]})})]},v.id))})]})})]}),c.isOpen&&o.jsx("div",{className:"proof-viewer-overlay",onClick:()=>u({isOpen:!1,url:null}),role:"button",tabIndex:0,"aria-label":"Cerrar comprobante",children:o.jsx("img",{className:"proof-viewer-image",src:c.url,alt:"Comprobante"})}),o.jsx(_u,{isOpen:i.isOpen,title:i.type==="approve"?"Aprobar Recarga":"Rechazar Recarga",message:`${i.type==="approve"?"Aprobar":"Rechazar"} recarga de ${r?O(r.amount):""} del usuario ${(r==null?void 0:r.userEmail)||(r==null?void 0:r.userId)}?`,actionLabel:i.type==="approve"?"Aprobar":"Rechazar",showReasonInput:i.type==="reject",reasonPlaceholder:"Razn del rechazo...",loading:N||x,onConfirm:i.type==="approve"?E:k,onCancel:()=>{a({isOpen:!1,type:null}),s(null)}}),o.jsx(QO,{isOpen:d,onClose:()=>f(!1)})]})}function XO(t={}){const[e,n]=b.useState([]),[r,s]=b.useState(!0),[i,a]=b.useState(null),[c,u]=b.useState(0),[d,f]=b.useState({all:0,pending:0,approved:0,rejected:0}),[p,m]=b.useState(t.pageSize||25),[I,y]=b.useState(1),[N,T]=b.useState([]),[x,_]=b.useState(!1),E=t.status||"all",k=C=>C?typeof C=="string"?C:C!=null&&C.toDate?C.toDate().toISOString():C instanceof Date?C.toISOString():null:null,O=async()=>{try{const C=ae(W,"withdrawals"),[j,S,U,K]=await Promise.all([wl(_e(C)),wl(_e(C,ke("status","==","pending"))),wl(_e(C,ke("status","==","approved"))),wl(_e(C,ke("status","==","rejected")))]);f({all:j.data().count,pending:S.data().count,approved:U.data().count,rejected:K.data().count})}catch(C){console.warn("useAdminWithdrawals counts error",C)}},D=async({nextPageSize:C=p,nextPage:j=I,nextCursors:S=N}={})=>{try{s(!0),a(null);const U=[];E&&E!=="all"&&U.push(ke("status","==",E));const K=j>1?S[j-2]:null;K&&U.push(Jb(K));const te=_e(ae(W,"withdrawals"),...U,Tn("createdAt","desc"),Hn(Number(C)+1)),B=(await xe(te)).docs,Y=B.length>Number(C),V=Y?B.slice(0,Number(C)):B;if(_(Y),V.length){const ye=V[V.length-1];T(lt=>{const bo=[...lt];return bo[j-1]=ye,bo})}const ie=V.map(ye=>({id:ye.id,...ye.data()})),oe=[...new Set(ie.map(ye=>ye.userId).filter(Boolean))],pe=await Promise.all(oe.map(async ye=>{const lt=await Dt(Z(W,"users",ye));return[ye,lt.exists()?lt.data():null]})),Pe=Object.fromEntries(pe),ot=ie.map(ye=>{const lt=Pe[ye.userId]||null;return{...ye,userEmail:ye.userEmail||(lt==null?void 0:lt.email)||null,userName:ye.userName||(lt==null?void 0:lt.displayName)||(lt==null?void 0:lt.fullName)||null,createdAt:k(ye.createdAt)||ye.createdAt}});n(ot);const Et=E==="pending"?d.pending:E==="approved"?d.approved:E==="rejected"?d.rejected:d.all;u(Number.isFinite(Et)&&Et>0?Et:ot.length)}catch(U){console.error("Error en useAdminWithdrawals:",U),a(U.message)}finally{s(!1)}};b.useEffect(()=>{y(1),T([]),t.pageSize&&m(t.pageSize),O(),D({nextPage:1,nextCursors:[]})},[E]),b.useEffect(()=>{y(1),T([]),D({nextPageSize:p,nextPage:1,nextCursors:[]})},[p]),b.useEffect(()=>{D({nextPage:v})},[I]);const w=()=>{O(),D({nextPage:I})},v=()=>{x&&y(C=>C+1)};return{withdrawals:e,loading:r,error:i,total:c,counts:d,page:I,pageSize:p,hasNextPage:x,nextPage:v,prevPage:()=>{y(C=>Math.max(1,C-1))},setPageSize:C=>{const j=Number(C);!Number.isFinite(j)||j<=0||m(j)},refetch:w}}function JO(){const[t,e]=b.useState(!1),[n,r]=b.useState(null);return{approve:async(i,a,c,u,d)=>{var f,p,m,I;try{e(!0),r(null);let y=null;try{const N=_e(ae(W,"transactions"),ke("withdrawalId","==",i),Hn(1));if(y=((p=(f=(await xe(N)).docs)==null?void 0:f[0])==null?void 0:p.id)||null,!y){const x=_e(ae(W,"transactions"),ke("reference","==",i),Hn(1));y=((I=(m=(await xe(x)).docs)==null?void 0:m[0])==null?void 0:I.id)||null}}catch{}return await Oi(W,async N=>{const T=Z(W,"withdrawals",i),x=await N.get(T);if(!x.exists())throw new Error("Retiro no encontrado");const _=x.data(),E=_==null?void 0:_.status;if(E==="approved")return;if(E!=="pending")throw new Error(`No se puede aprobar un retiro con status: ${E}`);const k=(_==null?void 0:_.userId)||a,O=Number((_==null?void 0:_.amount)??c),D=(_==null?void 0:_.transactionId)||y||i;if(!k)throw new Error("Retiro invlido: falta userId");if(!Number.isFinite(O)||O<=0)throw new Error("Retiro invlido: amount debe ser > 0");const w=Z(W,"users",k,"wallets",k);if(!(await N.get(w)).exists())throw new Error("El usuario no tiene wallet; no se puede descontar saldo");N.update(w,{balance:Ra(-O),updatedAt:J()}),N.update(T,{status:"approved",approvedAt:J(),approvedBy:u,updatedAt:J()});const A=Z(W,"transactions",D),P=await N.get(A),C=_!=null&&_.createdAt&&typeof _.createdAt!="string"?_.createdAt:J(),j={userId:k,type:"withdrawal",amount:O,status:"approved",sourceType:"withdrawal",sourceId:i,withdrawalId:i,updatedAt:J()};P.exists()?N.update(A,j):N.set(A,{...j,createdAt:C});const S=Z(ae(W,"auditLogs"));N.set(S,{action:"APPROVE_WITHDRAWAL",adminUid:u,adminEmail:d,targetUserId:k,targetId:i,status:"SUCCESS",metadata:{amount:O,withdrawalId:i},timestamp:J()})}),console.log(" Retiro aprobado:",i),!0}catch(y){return console.error(" Error al aprobar retiro:",y),r((y==null?void 0:y.message)||String(y)),!1}finally{e(!1)}},loading:t,error:n}}function ZO(){const[t,e]=b.useState(!1),[n,r]=b.useState(null);return{reject:async(i,a,c,u,d)=>{var f,p,m,I;try{e(!0),r(null);let y=null;try{const N=_e(ae(W,"transactions"),ke("withdrawalId","==",i),Hn(1));if(y=((p=(f=(await xe(N)).docs)==null?void 0:f[0])==null?void 0:p.id)||null,!y){const x=_e(ae(W,"transactions"),ke("reference","==",i),Hn(1));y=((I=(m=(await xe(x)).docs)==null?void 0:m[0])==null?void 0:I.id)||null}}catch{}return await Oi(W,async N=>{const T=Z(W,"withdrawals",i),x=await N.get(T);if(!x.exists())throw new Error("Retiro no encontrado");const _=x.data(),E=_==null?void 0:_.status;if(E==="rejected")return;if(E!=="pending")throw new Error(`No se puede rechazar un retiro con status: ${E}`);const k=(_==null?void 0:_.userId)||a,O=Number(_==null?void 0:_.amount),D=(_==null?void 0:_.transactionId)||y||i;if(!k)throw new Error("Retiro invlido: falta userId");N.update(T,{status:"rejected",rejectedAt:J(),rejectedBy:u,rejectionReason:c,updatedAt:J()});const w=Z(W,"transactions",D),v=await N.get(w),A=_!=null&&_.createdAt&&typeof _.createdAt!="string"?_.createdAt:J(),P={userId:k,type:"withdrawal",amount:Number.isFinite(O)?O:null,status:"rejected",sourceType:"withdrawal",sourceId:i,withdrawalId:i,rejectionReason:c,updatedAt:J()};v.exists()?N.update(w,P):N.set(w,{...P,createdAt:A});const C=Z(ae(W,"auditLogs"));N.set(C,{action:"REJECT_WITHDRAWAL",adminUid:u,adminEmail:d,targetUserId:k,targetId:i,status:"SUCCESS",reason:c,timestamp:J()})}),console.log(" Retiro rechazado:",i),!0}catch(y){return console.error(" Error al rechazar retiro:",y),r((y==null?void 0:y.message)||String(y)),!1}finally{e(!1)}},loading:t,error:n}}function eD({adminData:t}){const[e,n]=b.useState("all"),[r,s]=b.useState(25),[i,a]=b.useState(null),[c,u]=b.useState({isOpen:!1,type:null}),{withdrawals:d,loading:f,refetch:p,counts:m,page:I,hasNextPage:y,nextPage:N,prevPage:T,setPageSize:x}=XO({status:e,pageSize:r}),{approve:_,loading:E}=JO(),{reject:k,loading:O}=ZO(),D=[{value:"all",label:"Todos"},{value:"pending",label:"Pendientes"},{value:"approved",label:"Aprobados"},{value:"rejected",label:"Rechazados"}],w=async()=>{if(!i)return;await _(i.id,i.userId,i.amount,t.uid,t.email)&&(u({isOpen:!1,type:null}),a(null),p())},v=async C=>{if(!i)return;await k(i.id,i.userId,C,t.uid,t.email)&&(u({isOpen:!1,type:null}),a(null),p())},A=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(C||0),P=C=>{if(!C)return"-";const j=C!=null&&C.toDate?C.toDate():new Date(C);return Number.isNaN(j.getTime())?"-":j.toLocaleDateString("es-MX")};return o.jsxs("div",{className:"retiros-page",children:[o.jsx("div",{className:"page-header",children:o.jsxs("div",{children:[o.jsx("h1",{className:"page-title",children:"Gestin de Retiros"}),o.jsx("p",{className:"page-subtitle",children:"Administra todas las solicitudes de retiro de usuarios"})]})}),o.jsx("div",{className:"retiros-filters",children:D.map(C=>o.jsxs("button",{className:`filter-btn ${e===C.value?"active":""}`,onClick:()=>{n(C.value)},children:[C.label,o.jsx("span",{className:"filter-count",children:C.value==="all"?(m==null?void 0:m.all)??0:(m==null?void 0:m[C.value])??0})]},C.value))}),o.jsxs("div",{className:"retiros-controls",children:[o.jsxs("div",{className:"retiros-control",children:[o.jsx("span",{className:"retiros-control-label",children:"Mostrar"}),o.jsxs("select",{className:"retiros-page-size",value:r,onChange:C=>{const j=Number(C.target.value);s(j),x(j)},children:[o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:25,children:"25"}),o.jsx("option",{value:50,children:"50"}),o.jsx("option",{value:100,children:"100"})]}),o.jsx("span",{className:"retiros-control-label",children:"por pgina"})]}),o.jsxs("div",{className:"retiros-pagination",children:[o.jsx("button",{className:"pagination-btn",onClick:T,disabled:f||I<=1,children:" Anterior"}),o.jsxs("span",{className:"pagination-status",children:["Pgina ",I]}),o.jsx("button",{className:"pagination-btn",onClick:N,disabled:f||!y,children:"Siguiente "})]})]}),o.jsxs("div",{className:"retiros-card",children:[o.jsx("div",{className:"card-header",children:o.jsxs("h3",{children:["Total de retiros: ",d.length]})}),f?o.jsx("div",{className:"loading-state",children:"Cargando retiros..."}):d.length===0?o.jsx("div",{className:"empty-state",children:"No hay retiros en este estado"}):o.jsx("div",{className:"table-wrapper",children:o.jsxs("table",{className:"retiros-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Usuario"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"Mtodo"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"}),o.jsx("th",{children:"Accin"})]})}),o.jsx("tbody",{children:d.map(C=>o.jsxs("tr",{children:[o.jsx("td",{className:"email-cell",children:C.userEmail||C.userId||"Email no disponible"}),o.jsx("td",{className:"amount-cell",children:A(C.amount)}),o.jsx("td",{children:C.method||"-"}),o.jsx("td",{children:o.jsxs("span",{className:`status-badge status-${C.status}`,children:[C.status==="pending"&&"Pendiente",C.status==="approved"&&"Aprobado",C.status==="rejected"&&"Rechazado"]})}),o.jsx("td",{children:P(C.createdAt)}),o.jsx("td",{children:C.status==="pending"&&o.jsxs("div",{className:"action-buttons",children:[o.jsx("button",{className:"btn-action btn-approve",onClick:()=>{a(C),u({isOpen:!0,type:"approve"})},title:"Aprobar",children:""}),o.jsx("button",{className:"btn-action btn-reject",onClick:()=>{a(C),u({isOpen:!0,type:"reject"})},title:"Rechazar",children:""})]})})]},C.id))})]})})]}),o.jsx(_u,{isOpen:c.isOpen,title:c.type==="approve"?"Aprobar Retiro":"Rechazar Retiro",message:`${c.type==="approve"?"Aprobar":"Rechazar"} retiro de ${i?A(i.amount):""} del usuario ${(i==null?void 0:i.userEmail)||(i==null?void 0:i.userId)}?`,actionLabel:c.type==="approve"?"Aprobar":"Rechazar",showReasonInput:c.type==="reject",reasonPlaceholder:"Razn del rechazo...",loading:E||O,onConfirm:c.type==="approve"?w:v,onCancel:()=>{u({isOpen:!1,type:null}),a(null)}})]})}function n0(t={}){const[e,n]=b.useState([]),[r,s]=b.useState(!0),[i,a]=b.useState(null),[c,u]=b.useState(0),[d,f]=b.useState(0),p=async()=>{try{s(!0),a(null);const I=t.status&&t.status!=="all",y=!!t.projectId,N=!!t.userId,T=[];y?T.push(ke("projectId","==",t.projectId)):N?T.push(ke("userId","==",t.userId)):I&&T.push(ke("status","==",t.status));const x=_e(ae(W,"investments"),...T),k=(await xe(x)).docs.map(U=>({id:U.id,...U.data()})).filter(U=>!(y&&U.projectId!==t.projectId||N&&U.userId!==t.userId||I&&U.status!==t.status));k.sort((U,K)=>{var B,Y;const te=(B=U==null?void 0:U.createdAt)!=null&&B.toMillis?U.createdAt.toMillis():U!=null&&U.createdAt?new Date(U.createdAt).getTime():0;return((Y=K==null?void 0:K.createdAt)!=null&&Y.toMillis?K.createdAt.toMillis():K!=null&&K.createdAt?new Date(K.createdAt).getTime():0)-te});const O=[...new Set(k.map(U=>U.userId).filter(Boolean))],D=[...new Set(k.map(U=>U.projectId).filter(Boolean))],[w,v]=await Promise.all([Promise.all(O.map(async U=>{const K=await Dt(Z(W,"users",U));return[U,K.exists()?K.data():null]})),Promise.all(D.map(async U=>{const K=await Dt(Z(W,"projects",U));return[U,K.exists()?K.data():null]}))]),A=Object.fromEntries(w),P=Object.fromEntries(v),C=(U,K)=>!U||!K?null:Number(((K-U)/U*100).toFixed(2)),j=k.map(U=>{const K=A[U.userId]||{},te=P[U.projectId]||{};return{...U,userEmail:K.email||"",userName:K.displayName||K.fullName||"",projectName:te.name||"",expectedROI:C(U.amount,U.expectedReturn),actualROI:C(U.amount,U.actualReturn||U.realizedReturn||U.payout)}});n(j),u(j.length);const S=j.reduce((U,K)=>U+(K.amount||0),0);f(S)}catch(I){console.error("Error en useAdminInvestments:",I),a(I.message)}finally{s(!1)}};return b.useEffect(()=>{p()},[t.status,t.projectId,t.userId]),{investments:e,loading:r,error:i,total:c,totalAmount:d,refetch:()=>p()}}function r0(){const[t,e]=b.useState([]),[n,r]=b.useState(!0),[s,i]=b.useState(null),a=async()=>{try{r(!0),i(null);const u=ae(W,"projects"),d=_e(u,Tn("createdAt","desc")),m=(await xe(d)).docs.map(I=>({id:I.id,...I.data()})).map(I=>{const y=I.type==="fixed",N=Number(I.targetAmount||0),T=Number(I.totalInvested||0),x=y&&N>0&&T>=N,_=x?"funded":I.status||"draft",E=_==="active"&&!x&&I.status!=="paused"&&I.status!=="closed";return{...I,computedStatus:_,progress:N>0?Math.min(100,Number((T/N*100).toFixed(2))):null,isTargetReached:x,investable:E}});e(m)}catch(u){console.error("Error en useAdminProjects:",u),i(u.message)}finally{r(!1)}};return b.useEffect(()=>{a()},[]),{projects:t,loading:n,error:s,refetch:()=>a()}}function tD(){const[t,e]=b.useState(!1),[n,r]=b.useState(null);return{approve:async(i,a,c)=>{var u,d;try{e(!0),r(null);let f=null;try{const p=_e(ae(W,"transactions"),ke("investmentId","==",i),Hn(1));f=((d=(u=(await xe(p)).docs)==null?void 0:u[0])==null?void 0:d.id)||null}catch{}return await Oi(W,async p=>{const m=Z(W,"investments",i),I=await p.get(m);if(!I.exists())throw new Error("Inversin no encontrada");const y=I.data(),N=y==null?void 0:y.status;if(N==="active")return;if(N!=="pending")throw new Error(`No se puede aprobar una inversin con status: ${N}`);const T=y==null?void 0:y.userId,x=Number(y==null?void 0:y.amount),_=(y==null?void 0:y.transactionId)||f||null,E=(y==null?void 0:y.projectId)||null;if(!T)throw new Error("Inversin invlida: falta userId");if(!Number.isFinite(x)||x<=0)throw new Error("Inversin invlida: amount debe ser > 0");if(!E)throw new Error("Inversin invlida: falta projectId");const k=Z(W,"projects",E),O=await p.get(k);if(!O.exists())throw new Error("Proyecto no encontrado");const D=O.data()||{},w=Number(D.targetAmount??D.target??D.goalAmount),v=Number(D.totalInvestment??D.totalInvested??D.totalInvestedAmount??0);if(!Number.isFinite(v)||v<0)throw new Error("Proyecto invlido: totalInvestment no es numrico");if(Number.isFinite(w)&&w>0){const ye=w-v;if(ye<=0)throw new Error("Este proyecto ya alcanz su meta de inversin");if(x>ye)throw new Error(`La inversin excede el cupo del proyecto. Disponible: ${ho(ye)}`)}const P=Z(W,"users",T,"wallets",T),C=await p.get(P);if(!C.exists())throw new Error("El usuario no tiene wallet; no se puede descontar saldo");const j=_?Z(W,"transactions",_):null,S=j?await p.get(j):null,U=S!=null&&S.exists()?S.data():null,K=U!=null&&U.createdAt&&typeof U.createdAt!="string"?U.createdAt:y!=null&&y.createdAt&&typeof y.createdAt!="string"?y.createdAt:J(),te=(U==null?void 0:U.currency)||(y==null?void 0:y.currency)||"USD",ve=(U==null?void 0:U.projectId)||E,B=(U==null?void 0:U.investmentId)||i,Y=(U==null?void 0:U.description)||"Inversin aprobada",V=(U==null?void 0:U.reference)||i,ie=Z(ae(W,"transactions")),oe=C.data()||{},pe=Number(oe.balance||0);if(!Number.isFinite(pe))throw new Error("Wallet invlida: balance no es numrico");if(pe<x)throw new Error("Saldo insuficiente para aprobar esta inversin");p.update(P,{balance:Ra(-x),updatedAt:J()}),p.update(k,{totalInvestment:Ra(x),totalInvested:Ra(x),updatedAt:J()}),p.update(m,{status:"active",approvedAt:J(),approvedBy:a,updatedAt:J()}),p.set(ie,{userId:T,projectId:ve,investmentId:B,amount:x,currency:te,type:"investment",status:"approved",description:Y,reference:V,createdAt:K,approvedAt:J(),approvedBy:a});const Pe=Z(ae(W,"auditLogs"));p.set(Pe,{action:"APPROVE_INVESTMENT",adminUid:a,adminEmail:c,targetUserId:T,targetId:i,status:"SUCCESS",metadata:{amount:x,investmentId:i,projectId:(y==null?void 0:y.projectId)||null},timestamp:J()});const ot=(D==null?void 0:D.name)||(D==null?void 0:D.title)||(D==null?void 0:D.projectName)||"el proyecto",Et=Z(ae(W,"users",T,"notifications"));p.set(Et,{userId:T,type:"transaction",title:"Inversin aprobada",message:`Tu inversin de ${ho(x)} ${te} en ${ot} fue aprobada.`,investmentId:B,projectId:ve,amount:x,currency:te,read:!1,createdAt:J()})}),!0}catch(f){return console.error(" Error al aprobar inversin:",f),r((f==null?void 0:f.message)||String(f)),!1}finally{e(!1)}},loading:t,error:n}}function nD(){const[t,e]=b.useState(!1),[n,r]=b.useState(null);return{reject:async(i,a,c,u)=>{var d,f;try{e(!0),r(null);let p=null;try{const m=_e(ae(W,"transactions"),ke("investmentId","==",i),Hn(1));p=((f=(d=(await xe(m)).docs)==null?void 0:d[0])==null?void 0:f.id)||null}catch{}return await Oi(W,async m=>{const I=Z(W,"investments",i),y=await m.get(I);if(!y.exists())throw new Error("Inversin no encontrada");const N=y.data(),T=N==null?void 0:N.status;if(T==="cancelled")return;if(T!=="pending")throw new Error(`No se puede rechazar una inversin con status: ${T}`);const x=N==null?void 0:N.userId,_=Number(N==null?void 0:N.amount),E=(N==null?void 0:N.transactionId)||p||null;if(!x)throw new Error("Inversin invlida: falta userId");const k=E?Z(W,"transactions",E):null,O=k?await m.get(k):null,D=O!=null&&O.exists()?O.data():null,w=D!=null&&D.createdAt&&typeof D.createdAt!="string"?D.createdAt:N!=null&&N.createdAt&&typeof N.createdAt!="string"?N.createdAt:J(),v=(D==null?void 0:D.currency)||(N==null?void 0:N.currency)||"USD",A=(D==null?void 0:D.projectId)||(N==null?void 0:N.projectId)||null,P=(D==null?void 0:D.investmentId)||i,C=(D==null?void 0:D.description)||"Inversin rechazada",j=(D==null?void 0:D.reference)||i,S=Z(ae(W,"transactions"));m.update(I,{status:"cancelled",cancelledAt:J(),cancelledBy:c,cancellationReason:a,updatedAt:J()}),m.set(S,{userId:x,projectId:A,investmentId:P,amount:Number.isFinite(_)?_:null,currency:v,type:"investment",status:"rejected",description:C,reference:j,createdAt:w,rejectionReason:a,rejectedAt:J(),rejectedBy:c});const U=Z(ae(W,"auditLogs"));m.set(U,{action:"REJECT_INVESTMENT",adminUid:c,adminEmail:u,targetUserId:x,targetId:i,status:"SUCCESS",reason:a,timestamp:J()})}),!0}catch(p){return console.error(" Error al rechazar inversin:",p),r((p==null?void 0:p.message)||String(p)),!1}finally{e(!1)}},loading:t,error:n}}function rD({adminData:t}){const e=Qn(),[n]=Yf(),r=n.get("projectId")||"",s=n.get("userId")||"",[i,a]=b.useState({status:"all",projectId:r,userId:s,search:""}),{projects:c}=r0(),{investments:u,loading:d,totalAmount:f,refetch:p}=n0({status:i.status,projectId:i.projectId||void 0,userId:i.userId||void 0}),[m,I]=b.useState(null),[y,N]=b.useState({isOpen:!1,type:null}),{approve:T,loading:x}=tD(),{reject:_,loading:E}=nD();b.useEffect(()=>{a(S=>({...S,projectId:r,userId:s}))},[r,s]);const k=[{value:"all",label:"Todas"},{value:"active",label:"Activas"},{value:"completed",label:"Completadas"},{value:"cancelled",label:"Canceladas"}],O=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(S||0),D=S=>S?new Date(S).toLocaleDateString("es-MX"):"",w=S=>S==null?"":`${S.toFixed(2)}%`,v=b.useMemo(()=>{const S=i.search.toLowerCase();return u.filter(U=>{var te,ve;return S?((te=U.userEmail)==null?void 0:te.toLowerCase().includes(S))||((ve=U.userName)==null?void 0:ve.toLowerCase().includes(S)):!0})},[u,i.search]),A=S=>{S&&e(`/admin/usuarios?uid=${S}`)},P=S=>{S&&e(`/admin/proyectos?projectId=${S}`)},C=async()=>{if(!m)return;await T(m.id,t==null?void 0:t.uid,t==null?void 0:t.email)&&(N({isOpen:!1,type:null}),I(null),p==null||p())},j=async S=>{if(!m)return;await _(m.id,S,t==null?void 0:t.uid,t==null?void 0:t.email)&&(N({isOpen:!1,type:null}),I(null),p==null||p())};return o.jsxs("div",{className:"inversiones-page",children:[o.jsx("div",{className:"page-header",children:o.jsxs("div",{children:[o.jsx("h1",{className:"page-title",children:"Gestin de Inversiones"}),o.jsx("p",{className:"page-subtitle",children:"Contexto completo: usuario, proyecto y ROI real vs esperado"})]})}),o.jsxs("div",{className:"inversiones-summary",children:[o.jsxs("div",{className:"summary-card",children:[o.jsx("div",{className:"summary-label",children:"Total Invertido"}),o.jsx("div",{className:"summary-value",children:O(f)})]}),o.jsxs("div",{className:"summary-card",children:[o.jsx("div",{className:"summary-label",children:"Inversiones Activas"}),o.jsx("div",{className:"summary-value",children:u.filter(S=>S.status==="active").length})]}),o.jsxs("div",{className:"summary-card",children:[o.jsx("div",{className:"summary-label",children:"Total de Inversiones"}),o.jsx("div",{className:"summary-value",children:u.length})]})]}),o.jsxs("div",{className:"inversiones-filters",children:[k.map(S=>o.jsxs("button",{className:`filter-btn ${i.status===S.value?"active":""}`,onClick:()=>a({...i,status:S.value}),children:[S.label,o.jsx("span",{className:"filter-count",children:S.value==="all"?u.length:u.filter(U=>U.status===S.value).length})]},S.value)),o.jsxs("select",{className:"filter-select",value:i.projectId,onChange:S=>a({...i,projectId:S.target.value}),children:[o.jsx("option",{value:"",children:"Todos los proyectos"}),c.map(S=>o.jsx("option",{value:S.id,children:S.name||"Proyecto sin nombre"},S.id))]}),o.jsx("input",{type:"text",className:"filter-input",placeholder:"Buscar usuario (email/nombre)",value:i.search,onChange:S=>a({...i,search:S.target.value})})]}),o.jsxs("div",{className:"inversiones-card",children:[o.jsx("div",{className:"card-header",children:o.jsx("h3",{children:"Inversiones"})}),d?o.jsx("div",{className:"loading-state",children:"Cargando inversiones..."}):v.length===0?o.jsx("div",{className:"empty-state",children:"No hay inversiones con estos filtros"}):o.jsx("div",{className:"table-wrapper",children:o.jsxs("table",{className:"inversiones-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Usuario"}),o.jsx("th",{children:"Proyecto"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"ROI Esperado"}),o.jsx("th",{children:"ROI Real"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"}),o.jsx("th",{children:"Acciones"})]})}),o.jsx("tbody",{children:v.map(S=>o.jsxs("tr",{children:[o.jsxs("td",{children:[o.jsx("div",{className:"cell-title",children:S.userName||"Usuario sin datos"}),o.jsx("div",{className:"cell-subtle",children:S.userEmail||"Email no disponible"})]}),o.jsxs("td",{children:[o.jsx("div",{className:"cell-title",children:S.projectName||"Proyecto sin nombre"}),o.jsx("div",{className:"cell-subtle",children:S.expectedReturn?"Con retorno esperado":"Retorno no definido"})]}),o.jsx("td",{className:"amount-cell",children:O(S.amount)}),o.jsx("td",{children:o.jsx("span",{className:`roi-badge ${Number(S.expectedROI)>=0?"roi-positive":"roi-negative"}`,children:w(S.expectedROI)})}),o.jsx("td",{children:o.jsx("span",{className:`roi-badge ${Number(S.actualROI)>=0?"roi-positive":"roi-negative"}`,children:w(S.actualROI)})}),o.jsx("td",{children:o.jsxs("span",{className:`status-badge status-${S.status}`,children:[S.status==="active"&&"Activa",S.status==="completed"&&"Completada",S.status==="cancelled"&&"Cancelada"]})}),o.jsx("td",{children:D(S.createdAt)}),o.jsxs("td",{className:"actions-cell",children:[o.jsx("button",{className:"link-btn",onClick:()=>A(S.userId),children:"Ver usuario"}),o.jsx("button",{className:"link-btn",onClick:()=>P(S.projectId),disabled:!S.projectId,children:"Ver proyecto"}),S.status==="pending"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"link-btn",onClick:()=>{I(S),N({isOpen:!0,type:"approve"})},disabled:x||E,children:"Aprobar"}),o.jsx("button",{className:"link-btn",onClick:()=>{I(S),N({isOpen:!0,type:"reject"})},disabled:x||E,children:"Rechazar"})]})]})]},S.id))})]})})]}),o.jsx(_u,{isOpen:y.isOpen,title:y.type==="approve"?"Aprobar Inversin":"Rechazar Inversin",message:`${y.type==="approve"?"Aprobar":"Rechazar"} inversin de ${m?O(m.amount):""} del usuario ${(m==null?void 0:m.userEmail)||(m==null?void 0:m.userId)}? ${y.type==="approve"?"Se descontar del saldo.":""}`,actionLabel:y.type==="approve"?"Aprobar":"Rechazar",showReasonInput:y.type==="reject",reasonPlaceholder:"Razn del rechazo...",loading:x||E,onConfirm:y.type==="approve"?C:j,onCancel:()=>{N({isOpen:!1,type:null}),I(null)}})]})}function sD({isOpen:t,onClose:e,onSuccess:n}){const[r,s]=b.useState({name:"",description:"",body:"",type:"fixed",category:"",riskLevel:"medium",expectedROI:"",durationMonths:"",targetAmount:"",minInvestment:"",maxInvestment:"",drawdown:"",performance:"",manualControl:!0}),[i,a]=b.useState(!1),[c,u]=b.useState(null),[d,f]=b.useState(!1),[p,m]=b.useState(!1),[I,y]=b.useState(""),N=["Energa","Trading","Crypto","Inmobiliario"],T=()=>{s({name:"",description:"",body:"",type:"fixed",category:"",riskLevel:"medium",expectedROI:"",durationMonths:"",targetAmount:"",minInvestment:"",maxInvestment:"",drawdown:"",performance:"",manualControl:!0}),u(null)},x=()=>{T(),e()},_=async(E,k="draft")=>{var A,P;if(E.preventDefault(),!r.name){u("El nombre es obligatorio");return}const O=r.type==="fixed",D=O?Number(r.targetAmount):null,w=O&&r.minInvestment!==""?Number(r.minInvestment):null,v=O&&r.maxInvestment!==""?Number(r.maxInvestment):null;if(O){if(!Number.isFinite(D)||D<=0){u("El capital objetivo (targetAmount) es obligatorio y debe ser mayor a 0");return}if(w!==null){if(!Number.isFinite(w)||w<=0){u("La inversin mnima debe ser un nmero mayor a 0");return}if(w>D){u("La inversin mnima no puede ser mayor al capital objetivo");return}}if(v!==null){if(!Number.isFinite(v)||v<=0){u("La inversin mxima debe ser un nmero mayor a 0");return}if(v>D){u("La inversin mxima no puede ser mayor al capital objetivo");return}}if(w!==null&&v!==null&&w>v){u("La inversin mnima no puede ser mayor que la inversin mxima");return}}try{a(!0),u(null);const C={name:r.name,description:(A=r.description)!=null&&A.trim()?r.description.trim():null,body:(P=r.body)!=null&&P.trim()?r.body.trim():null,type:r.type,category:r.category||null,riskLevel:r.riskLevel||"medium",expectedROI:r.expectedROI?Number(r.expectedROI):null,duration:r.durationMonths?Number(r.durationMonths):null,status:"draft",targetAmount:O?D:null,totalInvested:0,totalInvestment:0,minInvestment:O?w:null,maxInvestment:O?v:null,autoLockOnTarget:O?!0:null,drawdown:!O&&r.drawdown?Number(r.drawdown):null,performance:!O&&r.performance?Number(r.performance):null,manualControl:r.manualControl,investable:k==="active",createdAt:J(),updatedAt:J()};await Yh(ae(W,"projects"),C),T(),n==null||n(),e()}catch(C){console.error("Error creando proyecto",C),u("No se pudo crear el proyecto")}finally{a(!1)}};return t?o.jsx("div",{className:"project-modal-overlay",onClick:x,children:o.jsxs("div",{className:"project-modal",onClick:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Crear Proyecto Financiero"}),o.jsx("button",{className:"close-btn",onClick:x,children:""})]}),o.jsxs("form",{className:"modal-form",onSubmit:E=>_(E,"draft"),children:[o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"form-section-header",children:[o.jsx("h3",{children:"Informacin General"}),o.jsx("p",{children:"Datos bsicos del proyecto financiero"})]}),o.jsx("div",{className:"form-row",children:o.jsxs("label",{children:["Nombre del proyecto *",o.jsx("input",{type:"text",value:r.name,onChange:E=>s({...r,name:E.target.value}),placeholder:"Fondo Deuda USD 12%",required:!0})]})}),o.jsx("div",{className:"form-row",children:o.jsxs("label",{children:["Subttulo (descripcin breve)",o.jsx("input",{type:"text",value:r.description,onChange:E=>s({...r,description:E.target.value}),placeholder:"Ej: Inversin a 12 meses con retorno estimado"})]})}),o.jsx("div",{className:"form-row",children:o.jsxs("label",{children:["Descripcin extensa (se muestra solo en detalles)",o.jsx("textarea",{value:r.body,onChange:E=>s({...r,body:E.target.value}),placeholder:"Describe el proyecto con ms detalle...",rows:5})]})}),o.jsxs("div",{className:"form-row form-row-2",children:[o.jsxs("label",{children:["Tipo de proyecto *",o.jsxs("select",{value:r.type,onChange:E=>s({...r,type:E.target.value}),children:[o.jsx("option",{value:"fixed",children:"Fijo (meta de capital)"}),o.jsx("option",{value:"variable",children:"Variable (trading/crypto)"})]})]}),o.jsxs("label",{children:[o.jsxs("span",{className:"label-with-badge",children:["Categora",o.jsx("span",{className:"label-badge",children:"Catlogo admin"})]}),o.jsxs("div",{className:"category-select",onClick:()=>f(E=>!E),children:[o.jsxs("div",{className:"category-control",role:"button",tabIndex:0,children:[o.jsx("div",{className:"category-value",children:r.category||"Busca o selecciona una categora creada por admin"}),o.jsx("div",{className:"category-caret",children:""})]}),d&&o.jsxs("div",{className:"category-dropdown",onClick:E=>E.stopPropagation(),children:[o.jsx("div",{className:"dropdown-search",children:o.jsx("input",{type:"text",placeholder:"Buscar categoras",value:r.category,onChange:E=>s({...r,category:E.target.value})})}),o.jsx("div",{className:"dropdown-section",children:N.map(E=>o.jsx("button",{type:"button",className:`dropdown-item ${r.category===E?"selected":""}`,onClick:()=>{s({...r,category:E}),m(!1),f(!1)},children:E},E))}),o.jsxs("div",{className:"dropdown-section create-section",children:[o.jsx("button",{type:"button",className:"dropdown-item create-item",onClick:()=>{m(!0)},children:" Crear nueva categora"}),p&&o.jsxs("div",{className:"inline-create",children:[o.jsxs("label",{children:["Nombre de la categora",o.jsx("input",{type:"text",value:I,onChange:E=>y(E.target.value),placeholder:"Ej. Deuda privada USD"})]}),o.jsxs("div",{className:"inline-actions",children:[o.jsx("button",{type:"button",className:"draft-btn ghost",onClick:()=>{m(!1),y("")},children:"Cancelar"}),o.jsx("button",{type:"button",className:"submit-btn compact",onClick:()=>{I.trim()&&(s({...r,category:I.trim()}),m(!1),f(!1),y(""))},children:"Crear y seleccionar"})]})]})]})]})]}),o.jsx("span",{className:"field-hint",children:"Las categoras son creadas por administradores y se reutilizan en proyectos futuros."})]})]}),o.jsxs("div",{className:"form-row form-row-3",children:[o.jsxs("label",{children:["Nivel de riesgo *",o.jsxs("select",{value:r.riskLevel,onChange:E=>s({...r,riskLevel:E.target.value}),children:[o.jsx("option",{value:"low",children:"Bajo"}),o.jsx("option",{value:"medium",children:"Medio"}),o.jsx("option",{value:"high",children:"Alto"})]})]}),o.jsxs("label",{children:["ROI esperado (%)",o.jsx("input",{type:"number",step:"0.01",value:r.expectedROI,onChange:E=>s({...r,expectedROI:E.target.value}),placeholder:"12"})]}),o.jsxs("label",{children:["Duracin (meses)",o.jsx("input",{type:"number",value:r.durationMonths,onChange:E=>s({...r,durationMonths:E.target.value}),placeholder:"12"})]})]}),r.type==="fixed"&&o.jsxs("div",{className:"form-section form-section-financial",children:[o.jsxs("div",{className:"form-section-header",children:[o.jsx("h3",{children:" Configuracin Financiera (Proyecto Fijo)"}),o.jsx("p",{children:"Establece los lmites de capital e inversin"})]}),o.jsxs("div",{className:"form-row form-row-3",children:[o.jsxs("label",{children:["Capital objetivo (USD)",o.jsx("input",{type:"number",value:r.targetAmount,onChange:E=>s({...r,targetAmount:E.target.value}),placeholder:"500000"})]}),o.jsxs("label",{children:["Inversin mnima (USD)",o.jsx("input",{type:"number",value:r.minInvestment,onChange:E=>s({...r,minInvestment:E.target.value}),placeholder:"1000"})]}),o.jsxs("label",{children:["Inversin mxima (USD)",o.jsx("input",{type:"number",value:r.maxInvestment,onChange:E=>s({...r,maxInvestment:E.target.value}),placeholder:"50000"})]})]})]}),r.type==="variable"&&o.jsxs("div",{className:"form-section form-section-financial",children:[o.jsxs("div",{className:"form-section-header",children:[o.jsx("h3",{children:" Configuracin Financiera (Proyecto Variable)"}),o.jsx("p",{children:"Mtricas de rendimiento y control"})]}),o.jsxs("div",{className:"form-row form-row-2",children:[o.jsxs("label",{children:["Drawdown (%)",o.jsx("input",{type:"number",step:"0.01",value:r.drawdown,onChange:E=>s({...r,drawdown:E.target.value}),placeholder:"-5"})]}),o.jsxs("label",{children:["Performance (%)",o.jsx("input",{type:"number",step:"0.01",value:r.performance,onChange:E=>s({...r,performance:E.target.value}),placeholder:"8"})]})]}),o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",checked:r.manualControl,onChange:E=>s({...r,manualControl:E.target.checked})}),"Control manual del estado (permite pausar/reanudar)"]})]}),o.jsxs("div",{className:"form-section form-section-advanced",children:[o.jsxs("div",{className:"form-section-header",children:[o.jsx("h3",{children:" Configuracin avanzada"}),o.jsx("p",{children:"Prximamente campos tcnicos para proyectos mixtos o de trading/crypto"})]}),o.jsx("div",{className:"placeholder-box",children:o.jsx("p",{children:"Esta rea reservar parmetros como ejecucin, exchanges, riesgo dinmico y conectores tcnicos."})})]}),c&&o.jsx("div",{className:"form-error",children:c})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{type:"button",className:"cancel-btn",onClick:x,disabled:i,children:"Cancelar"}),o.jsx("button",{type:"submit",className:"draft-btn",disabled:i,children:i?"Guardando...":"Crear borrador"}),o.jsx("button",{type:"button",className:"submit-btn",onClick:E=>_(E,"active"),disabled:i,children:i?"Publicando...":"Crear y publicar"})]})]})]})}):null}function s0(t){const[e,n]=b.useState([]),[r,s]=b.useState(!0),[i,a]=b.useState(null),c=async()=>{if(!t){n([]),s(!1);return}try{s(!0),a(null);const p=ae(W,"projects",t,"timeline"),m=_e(p,Tn("createdAt","desc")),y=(await xe(m)).docs.map(N=>({id:N.id,...N.data()}));n(y)}catch(p){console.error("Error en useProjectTimeline:",p),a(p.message)}finally{s(!1)}};b.useEffect(()=>{c()},[t]);const u=async p=>{if(!t)return null;try{const m=ae(W,"projects",t,"timeline"),I={type:p.type||"update",title:p.title||"",description:p.description||"",visibility:p.visibility||"admin",createdBy:p.createdBy||null,metadata:p.metadata||null,createdAt:J()},y=await Yh(m,I);return(I.visibility==="investors"||I.visibility==="all")&&await d(t,y.id,I),await c(),y.id}catch(m){throw console.error("Error creando evento timeline:",m),m}},d=async(p,m,I)=>{try{let y=null;try{const k=await Dt(Z(W,"projects",p)),O=k.exists()?k.data():null;y=(O==null?void 0:O.name)||(O==null?void 0:O.title)||(O==null?void 0:O.projectName)||null}catch{}const N=ae(W,"investments"),T=_e(N),x=await xe(T),_=new Set;x.docs.forEach(k=>{const O=k.data();O.projectId===p&&(O.status==="active"||O.status==="completed")&&_.add(O.userId)});const E=Array.from(_).map(k=>Yh(ae(W,"users",k,"notifications"),{userId:k,projectId:p,projectName:y,eventId:m,type:"project_update",title:I.title,message:I.description||I.title,read:!1,createdAt:J()}));await Promise.all(E)}catch(y){console.error("Error creando notificaciones:",y)}};return{events:e,loading:r,error:i,addEvent:u,refetch:()=>c()}}function iD({project:t,isOpen:e,onClose:n,onSuccess:r,onTimelineEvent:s}){const[i,a]=b.useState({name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",body:(t==null?void 0:t.body)||"",category:(t==null?void 0:t.category)||"",expectedROI:(t==null?void 0:t.expectedROI)||"",duration:(t==null?void 0:t.duration)||"",drawdown:(t==null?void 0:t.drawdown)||"",performance:(t==null?void 0:t.performance)||""}),[c,u]=b.useState(null),[d,f]=b.useState(null),[p,m]=b.useState(!1),[I,y]=b.useState(null);b.useEffect(()=>{t&&(a({name:t.name||"",description:t.description||"",body:t.body||"",category:t.category||"",expectedROI:t.expectedROI||"",duration:t.duration||"",drawdown:t.drawdown||"",performance:t.performance||""}),u(null),f(null))},[t]),b.useEffect(()=>{if(!c){f(null);return}const _=URL.createObjectURL(c);return f(_),()=>{URL.revokeObjectURL(_)}},[c]);const N=b.useMemo(()=>d||(t==null?void 0:t.imageUrl)||null,[d,t==null?void 0:t.imageUrl]),T=()=>{y(null),n()},x=async _=>{var E,k;if(_.preventDefault(),!!(t!=null&&t.id))try{m(!0),y(null);const O=[];i.name!==t.name&&O.push(`Nombre: "${t.name}"  "${i.name}"`),(i.description||"")!==(t.description||"")&&O.push("Subttulo: actualizado"),(i.body||"")!==(t.body||"")&&O.push("Descripcin extensa: actualizada"),i.category!==t.category&&O.push(`Categora: "${t.category||"N/A"}"  "${i.category}"`),Number(i.expectedROI)!==Number(t.expectedROI)&&O.push(`ROI esperado: ${t.expectedROI}%  ${i.expectedROI}%`),Number(i.duration)!==Number(t.duration)&&O.push(`Duracin: ${t.duration}  ${i.duration} meses`),t.type==="variable"&&(Number(i.drawdown)!==Number(t.drawdown)&&O.push(`Drawdown: ${t.drawdown}%  ${i.drawdown}%`),Number(i.performance)!==Number(t.performance)&&O.push(`Performance: ${t.performance}%  ${i.performance}%`));const D={name:i.name,description:(E=i.description)!=null&&E.trim()?i.description.trim():null,body:(k=i.body)!=null&&k.trim()?i.body.trim():null,category:i.category||null,expectedROI:i.expectedROI?Number(i.expectedROI):null,duration:i.duration?Number(i.duration):null,updatedAt:J()};if(t.type==="variable"&&(D.drawdown=i.drawdown?Number(i.drawdown):null,D.performance=i.performance?Number(i.performance):null),c){if(!String(c.type||"").startsWith("image/"))throw new Error("La imagen debe ser un archivo de tipo imagen (image/*)");if(c.size>5242880)throw new Error("La imagen excede el tamao mximo permitido (5MB)");const v=String(c.name||"image").replace(/[^a-zA-Z0-9._-]/g,"_").slice(0,80),A=`projects/${t.id}/images/${Date.now()}_${v}`,P=By(Jh,A);await _O(P,c,{contentType:c.type||"image/*"});const C=await wO(P);if(D.imageUrl=C,D.imagePath=A,D.imageUpdatedAt=J(),t.imageUrl?O.push("Imagen: actualizada"):O.push("Imagen: agregada"),t.imagePath&&t.imagePath!==A)try{await EO(By(Jh,t.imagePath))}catch{}}if(await bi(Z(W,"projects",t.id),D),O.length>0&&s)try{await s({type:"system",title:"Proyecto actualizado",description:`Se editaron los siguientes campos:
${O.join(`
`)}`,visibility:"admin",metadata:{changes:O}})}catch(w){console.warn("No se pudo registrar evento en timeline:",w)}r==null||r(),T()}catch(O){console.error("Error actualizando proyecto:",O),(O==null?void 0:O.code)==="permission-denied"?y("Permisos insuficientes para actualizar el proyecto"):y("No se pudo actualizar el proyecto")}finally{m(!1)}};return!e||!t?null:o.jsx("div",{className:"edit-modal-overlay",onClick:T,children:o.jsxs("div",{className:"edit-modal",onClick:_=>_.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{className:"modal-header-content",children:[o.jsx("h2",{children:" Editar Proyecto"}),o.jsx("p",{className:"modal-subtitle",children:"Actualiza la informacin del proyecto"})]}),o.jsx("button",{className:"close-btn",onClick:T,"aria-label":"Cerrar",children:""})]}),o.jsxs("form",{className:"modal-form",onSubmit:x,children:[o.jsxs("div",{className:"form-section",children:[o.jsx("h3",{className:"section-title",children:" Informacin General"}),o.jsxs("div",{className:"form-field",children:[o.jsxs("label",{htmlFor:"project-name",children:["Nombre del proyecto ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx("input",{id:"project-name",type:"text",className:"form-input",value:i.name,onChange:_=>a({...i,name:_.target.value}),placeholder:"Ej: Proyecto Solar Valle Verde",required:!0})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-subtitle",children:"Subttulo (descripcin breve)"}),o.jsx("input",{id:"project-subtitle",type:"text",className:"form-input",value:i.description,onChange:_=>a({...i,description:_.target.value}),placeholder:"Ej: Inversin a 12 meses con retorno estimado"})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-body",children:"Descripcin extensa (se muestra solo en detalles)"}),o.jsx("textarea",{id:"project-body",className:"form-input",rows:6,value:i.body,onChange:_=>a({...i,body:_.target.value}),placeholder:"Describe el proyecto con ms detalle..."})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-category",children:"Categora"}),o.jsx("input",{id:"project-category",type:"text",className:"form-input",value:i.category,onChange:_=>a({...i,category:_.target.value}),placeholder:"Ej: Energa Renovable, Trading, Crypto"})]})]}),o.jsxs("div",{className:"form-section",children:[o.jsx("h3",{className:"section-title",children:" Mtricas Financieras"}),o.jsxs("div",{className:"form-row-2",children:[o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-roi",children:"ROI esperado (%)"}),o.jsxs("div",{className:"input-with-icon",children:[o.jsx("input",{id:"project-roi",type:"number",className:"form-input",step:"0.01",value:i.expectedROI,onChange:_=>a({...i,expectedROI:_.target.value}),placeholder:"0.00"}),o.jsx("span",{className:"input-icon",children:"%"})]})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-duration",children:"Duracin (meses)"}),o.jsxs("div",{className:"input-with-icon",children:[o.jsx("input",{id:"project-duration",type:"number",className:"form-input",value:i.duration,onChange:_=>a({...i,duration:_.target.value}),placeholder:"12"}),o.jsx("span",{className:"input-icon",children:"meses"})]})]})]})]}),t.type==="variable"&&o.jsxs("div",{className:"form-section variable-section",children:[o.jsx("h3",{className:"section-title",children:" Mtricas Variables"}),o.jsxs("div",{className:"form-row-2",children:[o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-drawdown",children:"Drawdown (%)"}),o.jsxs("div",{className:"input-with-icon",children:[o.jsx("input",{id:"project-drawdown",type:"number",className:"form-input",step:"0.01",value:i.drawdown,onChange:_=>a({...i,drawdown:_.target.value}),placeholder:"0.00"}),o.jsx("span",{className:"input-icon negative",children:"%"})]})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-performance",children:"Performance (%)"}),o.jsxs("div",{className:"input-with-icon",children:[o.jsx("input",{id:"project-performance",type:"number",className:"form-input",step:"0.01",value:i.performance,onChange:_=>a({...i,performance:_.target.value}),placeholder:"0.00"}),o.jsx("span",{className:"input-icon positive",children:"%"})]})]})]})]}),o.jsxs("div",{className:"info-box",children:[o.jsx("div",{className:"info-icon",children:""}),o.jsxs("div",{className:"info-content",children:[o.jsx("strong",{children:"Campos no editables:"}),o.jsx("p",{children:"Tipo de proyecto, Nivel de riesgo, Capital objetivo y Estado computado."}),o.jsx("p",{className:"info-note",children:"Para cambios crticos en estos campos, contacta al administrador del sistema."})]})]}),o.jsxs("div",{className:"form-section",children:[o.jsx("h3",{className:"section-title",children:" Imagen del Proyecto"}),N&&o.jsx("div",{style:{marginBottom:"0.75rem"},children:o.jsx("img",{src:N,alt:"Imagen del proyecto",style:{width:"100%",maxHeight:"240px",objectFit:"cover",borderRadius:"0.7rem",border:"1px solid var(--border-color)"}})}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{htmlFor:"project-image",children:"Seleccionar imagen"}),o.jsx("input",{id:"project-image",type:"file",className:"form-input",accept:"image/*",onChange:_=>{var k;const E=((k=_.target.files)==null?void 0:k[0])||null;u(E)}}),o.jsx("p",{className:"info-note",children:"Recomendado: imagen horizontal. Mximo 5MB."})]})]}),I&&o.jsxs("div",{className:"form-error",children:[o.jsx("span",{className:"error-icon",children:""}),o.jsx("span",{children:I})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{type:"button",className:"cancel-btn",onClick:T,disabled:p,children:"Cancelar"}),o.jsx("button",{type:"submit",className:"submit-btn",disabled:p,children:p?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"spinner"}),"Guardando..."]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),"Guardar cambios"]})})]})]})]})})}function aD({projectId:t,adminData:e}){const{events:n,loading:r,addEvent:s}=s0(t),[i,a]=b.useState(!1),[c,u]=b.useState({type:"update",title:"",description:"",visibility:"admin"}),[d,f]=b.useState(!1),p=async N=>{if(N.preventDefault(),!!c.title)try{f(!0),await s({...c,createdBy:(e==null?void 0:e.uid)||null}),u({type:"update",title:"",description:"",visibility:"admin"}),a(!1)}catch(T){console.error("Error creando evento:",T)}finally{f(!1)}},m=N=>N?(N.toDate?N.toDate():new Date(N)).toLocaleDateString("en-US",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",I=N=>({milestone:"",update:"",notice:"",system:""})[N]||"",y=N=>{const T={investors:{label:"Inversionistas",class:"badge-investors"},all:{label:"Pblico",class:"badge-all"},admin:{label:"Admin",class:"badge-admin"}};return T[N]||T.admin};return o.jsxs("div",{className:"project-timeline",children:[o.jsxs("div",{className:"timeline-header",children:[o.jsx("h3",{children:"Lnea de Tiempo"}),!i&&o.jsx("button",{className:"add-event-btn",onClick:()=>a(!0),children:"+ Agregar evento"})]}),i&&o.jsxs("form",{className:"event-form",onSubmit:p,children:[o.jsxs("div",{className:"form-row",children:[o.jsxs("label",{children:["Tipo de evento",o.jsxs("select",{value:c.type,onChange:N=>u({...c,type:N.target.value}),children:[o.jsx("option",{value:"milestone",children:"Hito (Milestone)"}),o.jsx("option",{value:"update",children:"Actualizacin"}),o.jsx("option",{value:"notice",children:"Aviso"}),o.jsx("option",{value:"system",children:"Sistema"})]})]}),o.jsxs("label",{children:["Visibilidad",o.jsxs("select",{value:c.visibility,onChange:N=>u({...c,visibility:N.target.value}),children:[o.jsx("option",{value:"admin",children:"Solo admin"}),o.jsx("option",{value:"investors",children:"Inversionistas"}),o.jsx("option",{value:"all",children:"Todos"})]})]})]}),o.jsxs("label",{children:["Ttulo",o.jsx("input",{type:"text",value:c.title,onChange:N=>u({...c,title:N.target.value}),placeholder:"Ej: Primer desembolso realizado",required:!0})]}),o.jsxs("label",{children:["Descripcin",o.jsx("textarea",{value:c.description,onChange:N=>u({...c,description:N.target.value}),placeholder:"Detalla el evento...",rows:3})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>a(!1),disabled:d,children:"Cancelar"}),o.jsx("button",{type:"submit",className:"submit-btn",disabled:d,children:d?"Guardando...":"Publicar"})]})]}),r?o.jsx("div",{className:"timeline-loading",children:"Cargando eventos..."}):n.length===0?o.jsx("div",{className:"timeline-empty",children:"No hay eventos en la lnea de tiempo"}):o.jsx("div",{className:"timeline-list",children:n.map(N=>{const T=y(N.visibility);return o.jsxs("div",{className:"timeline-item",children:[o.jsx("div",{className:"timeline-icon",children:I(N.type)}),o.jsxs("div",{className:"timeline-content",children:[o.jsxs("div",{className:"timeline-header-row",children:[o.jsx("h4",{className:"timeline-title",children:N.title}),o.jsx("span",{className:`visibility-badge ${T.class}`,children:T.label})]}),N.description&&o.jsx("p",{className:"timeline-description",children:N.description}),o.jsxs("div",{className:"timeline-meta",children:[o.jsx("span",{className:"timeline-date",children:m(N.createdAt)}),N.type&&o.jsx("span",{className:"timeline-type",children:N.type})]})]})]},N.id)})})]})}function oD(t){const[e,n]=b.useState(null),[r,s]=b.useState(null),[i,a]=b.useState(null),[c,u]=b.useState([]),[d,f]=b.useState([]),[p,m]=b.useState(!0),[I,y]=b.useState(null),N=async()=>{if(!t){m(!1);return}try{m(!0),y(null);const _=Z(W,"investments",t),E=await Dt(_);if(!E.exists())throw new Error("Inversin no encontrada");const k={id:E.id,...E.data()};let O=null;if(k.userId){const S=Z(W,"users",k.userId),U=await Dt(S);U.exists()&&(O={id:U.id,...U.data()})}let D=null;if(k.projectId){const S=Z(W,"projects",k.projectId),U=await Dt(S);U.exists()&&(D={id:U.id,...U.data()})}let w=[];if(k.projectId){const S=ae(W,"projects",k.projectId,"timeline"),U=_e(S,Tn("createdAt","desc"));w=(await xe(U)).docs.map(te=>({id:te.id,...te.data()}))}let v=[];const A=ae(W,"investments",t,"auditLog"),P=_e(A,Tn("timestamp","desc"));v=(await xe(P)).docs.map(S=>({id:S.id,...S.data()}));const j=T(k,D);n(j),s(O),a(D),u(w),f(v)}catch(_){console.error("Error en useInvestmentDetail:",_),y(_.message)}finally{m(!1)}},T=(_,E)=>{const k=Number(_.amount||0),O=Number(_.expectedReturn||0),D=Number(_.actualReturn||_.realizedReturn||_.payout||0),w=Number((E==null?void 0:E.totalInvested)||0),v=k>0?((O-k)/k*100).toFixed(2):null,A=k>0&&D>0?((D-k)/k*100).toFixed(2):null,P=w>0?(k/w*100).toFixed(2):null,C=O-k,j=D>0?D-k:null;return{..._,expectedROI:Number(v),actualROI:A?Number(A):null,projectionOfTotal:Number(P),expectedGain:C,actualGain:j}},x=()=>N();return b.useEffect(()=>{N()},[t]),{investment:e,user:r,project:i,projectEvents:c,auditLog:d,loading:p,error:I,refetch:x}}async function lD(t,e,n=""){try{const r=Z(W,"investments",t),s={action:"status_change",previousStatus:null,newStatus:e,reason:n,changedBy:"admin",timestamp:J()};return await bi(r,{status:e,updatedAt:J(),auditLog:em(s)}),{success:!0,message:`Inversin actualizada a ${e}`}}catch(r){throw console.error("Error actualizando estado de inversin:",r),r}}async function cD(t,e,n="",r={}){try{const s=Z(W,"investments",t),i={action:"system_event",eventTitle:e,eventDescription:n,metadata:r,recordedBy:"admin",timestamp:J()};return await bi(s,{auditLog:em(i),updatedAt:J()}),{success:!0,message:"Evento registrado"}}catch(s){throw console.error("Error registrando evento de sistema:",s),s}}async function uD(t,e,n=""){try{const r=Z(W,"investments",t),s={action:"return_update",previousValue:null,newValue:e,notes:n,updatedBy:"admin",timestamp:J()};return await bi(r,{realizedReturn:Number(e),payout:Number(e),auditLog:em(s),updatedAt:J()}),{success:!0,message:"Retorno actualizado"}}catch(r){throw console.error("Error actualizando retorno:",r),r}}function dD({investmentId:t,isOpen:e,onClose:n,onUpdate:r}){const{investment:s,user:i,project:a,projectEvents:c,auditLog:u,loading:d,error:f,refetch:p}=oD(t),[m,I]=b.useState("overview"),[y,N]=b.useState(!1),[T,x]=b.useState(null),[_,E]=b.useState(null),[k,O]=b.useState(!1),[D,w]=b.useState(!1),[v,A]=b.useState(!1),P=te=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(te||0),C=te=>te?(te.toDate?te.toDate():new Date(te)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",j=te=>te?(te.toDate?te.toDate():new Date(te)).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",S=async(te,ve)=>{try{N(!0),x(null),await lD(t,te,ve),E(`Inversin actualizada a ${te}`),await p(),r==null||r(),O(!1),setTimeout(()=>E(null),3e3)}catch(B){x(B.message)}finally{N(!1)}},U=async(te,ve,B)=>{try{N(!0),x(null),await cD(t,te,ve,B),E("Evento registrado"),await p(),r==null||r(),A(!1),setTimeout(()=>E(null),3e3)}catch(Y){x(Y.message)}finally{N(!1)}},K=async(te,ve)=>{try{N(!0),x(null),await uD(t,te,ve),E("Retorno actualizado"),await p(),r==null||r(),w(!1),setTimeout(()=>E(null),3e3)}catch(B){x(B.message)}finally{N(!1)}};return e?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"investment-drawer-overlay",onClick:n}),o.jsxs("div",{className:"investment-drawer",children:[o.jsxs("div",{className:"investment-drawer-header",children:[o.jsxs("div",{className:"header-top",children:[o.jsx("button",{className:"close-btn",onClick:n,children:" Volver"}),o.jsx("h2",{className:"header-title",children:"Detalle de Inversin"})]}),d?o.jsx("div",{className:"loading-state",children:"Cargando..."}):f?o.jsx("div",{className:"error-state",children:f}):s?o.jsxs("div",{className:"header-info",children:[o.jsxs("div",{className:"header-investor",children:[o.jsxs("div",{className:"investor-info",children:[o.jsx("span",{className:"investor-name",children:(i==null?void 0:i.displayName)||(i==null?void 0:i.fullName)||"Usuario"}),o.jsx("span",{className:"investor-email",children:(i==null?void 0:i.email)||""})]}),o.jsxs("span",{className:`status-badge status-${s.status}`,children:[s.status==="active"&&"Activa",s.status==="completed"&&"Completada",s.status==="cancelled"&&"Cancelada",s.status==="paused"&&"Pausada"]})]}),o.jsxs("div",{className:"header-meta",children:[o.jsxs("div",{className:"meta-item",children:[o.jsx("span",{className:"meta-label",children:"Monto Invertido"}),o.jsx("span",{className:"meta-value bold",children:P(s.amount)})]}),o.jsxs("div",{className:"meta-item",children:[o.jsx("span",{className:"meta-label",children:"Proyecto"}),o.jsx("span",{className:"meta-value",children:(a==null?void 0:a.name)||""})]}),o.jsxs("div",{className:"meta-item",children:[o.jsx("span",{className:"meta-label",children:"Fecha"}),o.jsx("span",{className:"meta-value",children:C(s.createdAt)})]})]})]}):null]}),s&&o.jsxs("div",{className:"investment-tabs",children:[o.jsx("button",{className:`tab ${m==="overview"?"active":""}`,onClick:()=>I("overview"),children:"Resumen"}),o.jsx("button",{className:`tab ${m==="financial"?"active":""}`,onClick:()=>I("financial"),children:"Financiero"}),o.jsxs("button",{className:`tab ${m==="project"?"active":""}`,onClick:()=>I("project"),children:["Proyecto (",c.length,")"]}),o.jsxs("button",{className:`tab ${m==="audit"?"active":""}`,onClick:()=>I("audit"),children:["Audit (",u.length,")"]})]}),_&&o.jsxs("div",{className:"success-message",children:[" ",_]}),T&&o.jsxs("div",{className:"error-message",children:[" ",T]}),o.jsx("div",{className:"investment-content",children:d?o.jsx("div",{className:"content-loading",children:"Cargando detalles..."}):s?m==="overview"?o.jsx(hD,{investment:s,project:a,user:i,formatCurrency:P,formatDate:C}):m==="financial"?o.jsx(fD,{investment:s,project:a,formatCurrency:P,onUpdateReturn:()=>w(!0)}):m==="project"?o.jsx(pD,{projectEvents:c,formatDateTime:j}):m==="audit"?o.jsx(mD,{auditLog:u,formatDateTime:j,formatCurrency:P}):null:o.jsx("div",{className:"content-empty",children:"No se pudo cargar la inversin"})}),s&&o.jsxs("div",{className:"investment-actions",children:[o.jsx("button",{className:"action-btn primary",onClick:()=>O(!0),disabled:y,children:"Cambiar Estado"}),o.jsx("button",{className:"action-btn secondary",onClick:()=>A(!0),disabled:y,children:"Registrar Evento"}),s.status==="active"&&o.jsx("button",{className:"action-btn secondary",onClick:()=>w(!0),disabled:y,children:"Actualizar Retorno"})]}),k&&o.jsx(gD,{currentStatus:s.status,onConfirm:S,onClose:()=>O(!1),isLoading:y}),D&&o.jsx(vD,{currentReturn:s.realizedReturn||s.payout,expectedReturn:s.expectedReturn,amount:s.amount,onConfirm:K,onClose:()=>w(!1),isLoading:y,formatCurrency:P}),v&&o.jsx(yD,{onConfirm:U,onClose:()=>A(!1),isLoading:y})]})]}):null}function hD({investment:t,project:e,user:n,formatCurrency:r,formatDate:s}){return o.jsxs("div",{className:"tab-content overview-tab",children:[o.jsxs("div",{className:"info-cards",children:[o.jsxs("div",{className:"info-card",children:[o.jsx("div",{className:"card-label",children:"Inversionista"}),o.jsx("div",{className:"card-value",children:(n==null?void 0:n.displayName)||(n==null?void 0:n.fullName)||"Usuario"}),o.jsx("div",{className:"card-sublabel",children:n==null?void 0:n.email})]}),o.jsxs("div",{className:"info-card",children:[o.jsx("div",{className:"card-label",children:"Monto Invertido"}),o.jsx("div",{className:"card-value",children:r(t.amount)})]}),o.jsxs("div",{className:"info-card",children:[o.jsx("div",{className:"card-label",children:"% del Proyecto"}),o.jsxs("div",{className:"card-value",children:[t.projectionOfTotal,"%"]})]}),o.jsxs("div",{className:"info-card",children:[o.jsx("div",{className:"card-label",children:"Estado"}),o.jsxs("div",{className:`card-value status-${t.status}`,children:[t.status==="active"&&"Activa",t.status==="completed"&&"Completada",t.status==="cancelled"&&"Cancelada",t.status==="paused"&&"Pausada"]})]})]}),o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{className:"section-title",children:"Informacin General"}),o.jsxs("div",{className:"info-items",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"label",children:"Proyecto"}),o.jsx("span",{className:"value",children:(e==null?void 0:e.name)||""})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"label",children:"Tipo de Proyecto"}),o.jsx("span",{className:"value",children:(e==null?void 0:e.type)==="fixed"?"Fijo":"Variable"})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"label",children:"Riesgo del Proyecto"}),o.jsxs("span",{className:`value risk-${e==null?void 0:e.riskLevel}`,children:[(e==null?void 0:e.riskLevel)==="low"&&"Riesgo Bajo",(e==null?void 0:e.riskLevel)==="medium"&&"Riesgo Medio",(e==null?void 0:e.riskLevel)==="high"&&"Riesgo Alto"]})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"label",children:"Fecha de Inversin"}),o.jsx("span",{className:"value",children:s(t.createdAt)})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"label",children:"Estado del Proyecto"}),o.jsx("span",{className:"value",children:(e==null?void 0:e.computedStatus)||(e==null?void 0:e.status)||""})]})]})]})]})}function fD({investment:t,project:e,formatCurrency:n,onUpdateReturn:r}){const s=t.amount&&t.expectedReturn?t.expectedReturn-t.amount:0,i=t.amount&&t.realizedReturn?t.realizedReturn-t.amount:null;return o.jsxs("div",{className:"tab-content financial-tab",children:[o.jsxs("div",{className:"financial-grid",children:[o.jsxs("div",{className:"fin-card roi",children:[o.jsx("div",{className:"fin-label",children:"ROI Esperado"}),o.jsx("div",{className:`fin-value ${t.expectedROI>=0?"positive":"negative"}`,children:t.expectedROI!==null?`${t.expectedROI}%`:""})]}),o.jsxs("div",{className:"fin-card roi",children:[o.jsx("div",{className:"fin-label",children:"ROI Real"}),o.jsx("div",{className:`fin-value ${t.actualROI>=0?"positive":"negative"}`,children:t.actualROI!==null?`${t.actualROI}%`:"Pendiente"})]}),o.jsxs("div",{className:"fin-card gain",children:[o.jsx("div",{className:"fin-label",children:"Ganancia Esperada"}),o.jsx("div",{className:`fin-value ${s>=0?"positive":"negative"}`,children:n(s)})]}),o.jsxs("div",{className:"fin-card gain",children:[o.jsx("div",{className:"fin-label",children:"Ganancia Realizada"}),o.jsx("div",{className:`fin-value ${i>=0?"positive":"negative"}`,children:i!==null?n(i):"Pendiente"})]})]}),o.jsxs("div",{className:"financial-details",children:[o.jsxs("div",{className:"fin-detail-section",children:[o.jsx("h3",{className:"section-title",children:"Detalles Financieros"}),o.jsxs("div",{className:"fin-items",children:[o.jsxs("div",{className:"fin-item",children:[o.jsx("span",{className:"label",children:"Monto Invertido"}),o.jsx("span",{className:"value bold",children:n(t.amount)})]}),o.jsxs("div",{className:"fin-item",children:[o.jsx("span",{className:"label",children:"Retorno Esperado"}),o.jsx("span",{className:"value",children:n(t.expectedReturn)})]}),o.jsxs("div",{className:"fin-item",children:[o.jsx("span",{className:"label",children:"Retorno Realizado"}),o.jsx("span",{className:"value",children:n(t.realizedReturn||t.payout||0)})]}),t.status==="active"&&o.jsx("div",{className:"fin-item action",children:o.jsx("button",{className:"update-btn",onClick:r,children:"Actualizar Retorno"})})]})]}),o.jsxs("div",{className:"fin-detail-section",children:[o.jsx("h3",{className:"section-title",children:"Relacin con Proyecto"}),o.jsxs("div",{className:"fin-items",children:[o.jsxs("div",{className:"fin-item",children:[o.jsx("span",{className:"label",children:"% del Capital Total"}),o.jsxs("span",{className:"value",children:[t.projectionOfTotal,"%"]})]}),o.jsxs("div",{className:"fin-item",children:[o.jsx("span",{className:"label",children:"Capital Total del Proyecto"}),o.jsx("span",{className:"value",children:n((e==null?void 0:e.totalInvested)||0)})]}),o.jsxs("div",{className:"fin-item",children:[o.jsx("span",{className:"label",children:"Meta del Proyecto"}),o.jsx("span",{className:"value",children:(e==null?void 0:e.type)==="fixed"?n(e==null?void 0:e.targetAmount):"Variable"})]})]})]})]})]})}function pD({projectEvents:t,formatDateTime:e}){const n=t.filter(r=>r.type==="system"||r.visibility==="investors"||r.visibility==="all");return o.jsx("div",{className:"tab-content project-tab",children:n.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-icon",children:""}),o.jsx("div",{className:"empty-title",children:"Sin eventos del proyecto"}),o.jsx("div",{className:"empty-subtitle",children:"No hay actualizaciones de proyecto relacionadas"})]}):o.jsx("div",{className:"events-list",children:n.map(r=>o.jsxs("div",{className:"event-item",children:[o.jsxs("div",{className:"event-header",children:[o.jsx("span",{className:"event-title",children:r.title}),o.jsx("span",{className:"event-date",children:e(r.createdAt)})]}),r.description&&o.jsx("div",{className:"event-description",children:r.description}),o.jsx("div",{className:"event-meta",children:o.jsxs("span",{className:`badge visibility-${r.visibility}`,children:[r.visibility==="admin"&&"Solo admin",r.visibility==="investors"&&"Inversionistas",r.visibility==="all"&&"Todos"]})})]},r.id))})})}function mD({auditLog:t,formatDateTime:e,formatCurrency:n}){return o.jsx("div",{className:"tab-content audit-tab",children:t.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-icon",children:""}),o.jsx("div",{className:"empty-title",children:"Sin historial de cambios"}),o.jsx("div",{className:"empty-subtitle",children:"No hay cambios registrados en esta inversin"})]}):o.jsx("div",{className:"audit-list",children:t.map((r,s)=>o.jsxs("div",{className:"audit-entry",children:[o.jsxs("div",{className:"audit-header",children:[o.jsx("span",{className:"audit-action",children:_D(r.action)}),o.jsx("span",{className:"audit-date",children:e(r.timestamp)})]}),r.action==="status_change"&&o.jsxs("div",{className:"audit-details",children:[o.jsxs("span",{children:["De ",o.jsx("strong",{children:r.previousStatus})," a ",o.jsx("strong",{children:r.newStatus})]}),r.reason&&o.jsxs("span",{className:"reason",children:["Razn: ",r.reason]})]}),r.action==="system_event"&&o.jsxs("div",{className:"audit-details",children:[o.jsx("span",{className:"title",children:r.eventTitle}),r.eventDescription&&o.jsx("span",{className:"desc",children:r.eventDescription})]}),r.action==="return_update"&&o.jsxs("div",{className:"audit-details",children:[o.jsxs("span",{children:["Retorno actualizado a ",o.jsx("strong",{children:n(Number(r.newValue)||0)})]}),r.notes&&o.jsxs("span",{className:"notes",children:["Notas: ",r.notes]})]})]},r.id||s))})})}function gD({currentStatus:t,onConfirm:e,onClose:n,isLoading:r}){const[s,i]=b.useState(t),[a,c]=b.useState(""),u=[{value:"active",label:"Activa"},{value:"paused",label:"Pausada"},{value:"completed",label:"Completada"},{value:"cancelled",label:"Cancelada"}];return o.jsx("div",{className:"modal-overlay",onClick:n,children:o.jsxs("div",{className:"modal-content",onClick:d=>d.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h3",{children:"Cambiar Estado de Inversin"}),o.jsx("button",{className:"close-modal-btn",onClick:n,children:""})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Nuevo Estado"}),o.jsx("select",{value:s,onChange:d=>i(d.target.value),disabled:r,children:u.map(d=>o.jsx("option",{value:d.value,children:d.label},d.value))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Razn (opcional)"}),o.jsx("textarea",{value:a,onChange:d=>c(d.target.value),placeholder:"Explica el cambio de estado...",disabled:r,rows:3})]})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{className:"btn secondary",onClick:n,disabled:r,children:"Cancelar"}),o.jsx("button",{className:"btn primary",onClick:()=>e(s,a),disabled:r,children:r?"Actualizando...":"Confirmar"})]})]})})}function vD({currentReturn:t,expectedReturn:e,amount:n,onConfirm:r,onClose:s,isLoading:i,formatCurrency:a}){const[c,u]=b.useState(t||e||""),[d,f]=b.useState(""),p=c?Number(c)-n:0,m=n>0&&c?(p/n*100).toFixed(2):0;return o.jsx("div",{className:"modal-overlay",onClick:s,children:o.jsxs("div",{className:"modal-content",onClick:I=>I.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h3",{children:"Actualizar Retorno de Inversin"}),o.jsx("button",{className:"close-modal-btn",onClick:s,children:""})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Retorno Realizado (USD)"}),o.jsx("input",{type:"number",value:c,onChange:I=>u(I.target.value),placeholder:"Cantidad recibida",disabled:i}),o.jsxs("div",{className:"form-hint",children:["Monto invertido: ",a(n)]})]}),c&&o.jsxs("div",{className:"return-preview",children:[o.jsxs("div",{className:"preview-item",children:[o.jsx("span",{children:"Ganancia / Prdida"}),o.jsx("span",{className:p>=0?"positive":"negative",children:a(p)})]}),o.jsxs("div",{className:"preview-item",children:[o.jsx("span",{children:"ROI"}),o.jsxs("span",{className:m>=0?"positive":"negative",children:[m,"%"]})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Notas (opcional)"}),o.jsx("textarea",{value:d,onChange:I=>f(I.target.value),placeholder:"Detalles sobre el retorno...",disabled:i,rows:3})]})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{className:"btn secondary",onClick:s,disabled:i,children:"Cancelar"}),o.jsx("button",{className:"btn primary",onClick:()=>r(c,d),disabled:i||!c,children:i?"Actualizando...":"Guardar Retorno"})]})]})})}function yD({onConfirm:t,onClose:e,isLoading:n}){const[r,s]=b.useState(""),[i,a]=b.useState("");return o.jsx("div",{className:"modal-overlay",onClick:e,children:o.jsxs("div",{className:"modal-content",onClick:c=>c.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h3",{children:"Registrar Evento de Sistema"}),o.jsx("button",{className:"close-modal-btn",onClick:e,children:""})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Ttulo del Evento"}),o.jsx("input",{type:"text",value:r,onChange:c=>s(c.target.value),placeholder:"Ej: Pago parcial recibido",disabled:n})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Descripcin (opcional)"}),o.jsx("textarea",{value:i,onChange:c=>a(c.target.value),placeholder:"Detalles adicionales...",disabled:n,rows:4})]})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{className:"btn secondary",onClick:e,disabled:n,children:"Cancelar"}),o.jsx("button",{className:"btn primary",onClick:()=>t(r,i,{}),disabled:n||!r,children:n?"Registrando...":"Registrar Evento"})]})]})})}function _D(t){return{status_change:"Cambio de Estado",system_event:"Evento de Sistema",return_update:"Actualizacin de Retorno"}[t]||t}function wD({project:t,isOpen:e,onClose:n,onRefresh:r,adminData:s,activeTab:i="overview",onTabChange:a=null}){const[c,u]=b.useState("overview"),[d,f]=b.useState(!1),[p,m]=b.useState(null),I=a?i:c,y=a||u,{investments:N,loading:T}=n0({projectId:t==null?void 0:t.id}),{events:x,addEvent:_,refetch:E}=s0(t==null?void 0:t.id),k=j=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(j||0),O=j=>j?(j.toDate?j.toDate():new Date(j)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",D=j=>j?(j.toDate?j.toDate():new Date(j)).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",w=()=>{r(),E()},v=async j=>{await _(j),E()},A=b.useMemo(()=>x.filter(j=>j.type==="system"||j.visibility==="admin"),[x]),P=b.useMemo(()=>{const j=N.length,S=N.filter(K=>K.status==="active").length,U=N.reduce((K,te)=>K+(te.amount||0),0);return{total:j,active:S,totalAmount:U}},[N]);if(!t||!e)return null;const C=o.jsxs(o.Fragment,{children:[o.jsx("div",{className:`drawer-overlay ${e?"open":""}`,onClick:n}),o.jsxs("div",{className:`project-drawer ${e?"open":""}`,children:[o.jsxs("div",{className:"drawer-header",children:[o.jsxs("div",{className:"drawer-header-top",children:[o.jsx("button",{className:"close-drawer-btn",onClick:n,children:" Volver a proyectos"}),o.jsxs("div",{className:"drawer-actions",children:[o.jsx("button",{className:"action-btn secondary",onClick:()=>f(!0),children:" Editar"}),o.jsx("button",{className:"action-btn primary",onClick:()=>y("timeline"),children:" Publicar evento"})]})]}),o.jsxs("div",{className:"drawer-header-content",children:[o.jsxs("div",{className:"project-title-section",children:[o.jsx("h1",{className:"drawer-title",children:t.name}),o.jsxs("div",{className:"drawer-badges",children:[o.jsx("span",{className:`badge type-badge type-${t.type}`,children:t.type==="variable"?" Variable":" Fijo"}),o.jsxs("span",{className:`badge risk-badge risk-${t.riskLevel}`,children:[t.riskLevel==="low"&&" Riesgo Bajo",t.riskLevel==="medium"&&" Riesgo Medio",t.riskLevel==="high"&&" Riesgo Alto"]}),o.jsxs("span",{className:`badge status-badge status-${t.computedStatus}`,children:[t.computedStatus==="funded"&&" Funded",t.computedStatus==="active"&&" Activo",t.computedStatus==="paused"&&" Pausado",t.computedStatus==="closed"&&" Cerrado",t.computedStatus==="draft"&&" Borrador"]})]}),t.category&&o.jsxs("div",{className:"project-meta",children:[" ",t.category]})]}),t.type==="fixed"&&t.targetAmount&&o.jsxs("div",{className:"header-progress",children:[o.jsxs("div",{className:"progress-header-row",children:[o.jsx("span",{className:"progress-label-text",children:" Capital Recaudado"}),o.jsxs("span",{className:"progress-percent",children:[t.progress||0,"%"]})]}),o.jsx("div",{className:"progress-bar-header",children:o.jsx("div",{className:"progress-fill-header",style:{width:`${t.progress||0}%`}})}),o.jsxs("div",{className:"progress-stats-row",children:[o.jsxs("div",{className:"progress-stat",children:[o.jsx("span",{className:"stat-label",children:"Recaudado"}),o.jsx("span",{className:"stat-value",children:k(t.totalInvested)})]}),o.jsxs("div",{className:"progress-stat",children:[o.jsx("span",{className:"stat-label",children:"Meta"}),o.jsx("span",{className:"stat-value",children:k(t.targetAmount)})]})]})]})]}),o.jsxs("div",{className:"drawer-tabs",children:[o.jsx("button",{className:`drawer-tab ${I==="overview"?"active":""}`,onClick:()=>y("overview"),children:" Resumen"}),o.jsxs("button",{className:`drawer-tab ${I==="investments"?"active":""}`,onClick:()=>y("investments"),children:[" Inversiones (",P.total,")"]}),o.jsxs("button",{className:`drawer-tab ${I==="timeline"?"active":""}`,onClick:()=>y("timeline"),children:[" Timeline (",x.length,")"]}),o.jsxs("button",{className:`drawer-tab ${I==="activity"?"active":""}`,onClick:()=>y("activity"),children:[" Actividad (",A.length,")"]})]})]}),o.jsxs("div",{className:"drawer-content",children:[I==="overview"&&o.jsxs("div",{className:"overview-section",children:[o.jsxs("div",{className:"overview-grid",children:[o.jsxs("div",{className:"kpi-box",children:[o.jsx("div",{className:"kpi-icon",children:""}),o.jsxs("div",{className:"kpi-data",children:[o.jsx("div",{className:"kpi-label",children:"Total Invertido"}),o.jsx("div",{className:"kpi-value",children:k(P.totalAmount)})]})]}),o.jsxs("div",{className:"kpi-box",children:[o.jsx("div",{className:"kpi-icon",children:""}),o.jsxs("div",{className:"kpi-data",children:[o.jsx("div",{className:"kpi-label",children:"Inversionistas"}),o.jsx("div",{className:"kpi-value",children:P.total}),o.jsxs("div",{className:"kpi-sublabel",children:[P.active," activos"]})]})]}),o.jsxs("div",{className:"kpi-box",children:[o.jsx("div",{className:"kpi-icon",children:""}),o.jsxs("div",{className:"kpi-data",children:[o.jsx("div",{className:"kpi-label",children:"ROI Esperado"}),o.jsx("div",{className:"kpi-value",children:t.expectedROI?`${t.expectedROI}%`:""})]})]}),o.jsxs("div",{className:"kpi-box",children:[o.jsx("div",{className:"kpi-icon",children:""}),o.jsxs("div",{className:"kpi-data",children:[o.jsx("div",{className:"kpi-label",children:"Duracin"}),o.jsx("div",{className:"kpi-value",children:t.duration?`${t.duration}m`:""})]})]})]}),o.jsxs("div",{className:"info-sections",children:[o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{className:"section-title",children:" Informacin General"}),o.jsxs("div",{className:"info-grid",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Fecha de creacin"}),o.jsx("span",{className:"info-val",children:O(t.createdAt)})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"ltima actualizacin"}),o.jsx("span",{className:"info-val",children:O(t.updatedAt)})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Moneda base"}),o.jsx("span",{className:"info-val",children:"USD "})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Estado de inversin"}),o.jsx("span",{className:"info-val",children:t.investable?" Abierto":" Cerrado"})]})]})]}),t.type==="fixed"&&o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{className:"section-title",children:" Configuracin Fija"}),o.jsxs("div",{className:"info-grid",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Capital objetivo"}),o.jsx("span",{className:"info-val bold",children:k(t.targetAmount)})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Inversin mnima"}),o.jsx("span",{className:"info-val",children:k(t.minInvestment)})]}),t.maxInvestment&&o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Inversin mxima"}),o.jsx("span",{className:"info-val",children:k(t.maxInvestment)})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("span",{className:"info-key",children:"Auto-lock al alcanzar meta"}),o.jsx("span",{className:"info-val",children:o.jsx("span",{className:`pill ${t.autoLockOnTarget?"pill-on":"pill-off"}`,children:t.autoLockOnTarget?" Activado":" Desactivado"})})]})]})]}),t.type==="variable"&&o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{className:"section-title",children:" Mtricas Variables"}),o.jsxs("div",{className:"metrics-cards",children:[o.jsxs("div",{className:"metric-card performance",children:[o.jsx("div",{className:"metric-icon",children:""}),o.jsx("div",{className:"metric-label",children:"Performance"}),o.jsx("div",{className:"metric-value positive",children:t.performance!==void 0?`${t.performance}%`:""})]}),o.jsxs("div",{className:"metric-card drawdown",children:[o.jsx("div",{className:"metric-icon",children:""}),o.jsx("div",{className:"metric-label",children:"Drawdown"}),o.jsx("div",{className:"metric-value negative",children:t.drawdown!==void 0?`${t.drawdown}%`:""})]})]})]})]})]}),I==="investments"&&o.jsx("div",{className:"investments-section",children:T?o.jsx("div",{className:"loading-state",children:"Cargando inversiones..."}):N.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-icon",children:""}),o.jsx("div",{className:"empty-title",children:"Sin inversiones"}),o.jsx("div",{className:"empty-subtitle",children:"Este proyecto an no tiene inversionistas"})]}):o.jsx("div",{className:"investments-table-wrapper",children:o.jsxs("table",{className:"investments-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Inversionista"}),o.jsx("th",{children:"Monto"}),o.jsx("th",{children:"ROI Esperado"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Fecha"})]})}),o.jsx("tbody",{children:N.map(j=>o.jsxs("tr",{onClick:()=>m(j.id),className:"clickable-row",children:[o.jsx("td",{children:o.jsxs("div",{className:"investor-cell",children:[o.jsx("div",{className:"investor-name",children:j.userName||"Usuario"}),o.jsx("div",{className:"investor-email",children:j.userEmail})]})}),o.jsx("td",{className:"amount-cell",children:k(j.amount)}),o.jsx("td",{children:o.jsx("span",{className:"roi-badge",children:j.expectedROI!==null?`${j.expectedROI}%`:""})}),o.jsx("td",{children:o.jsxs("span",{className:`badge status-badge status-${j.status}`,children:[j.status==="active"&&" Activa",j.status==="completed"&&" Completada",j.status==="cancelled"&&" Cancelada"]})}),o.jsx("td",{className:"date-cell",children:O(j.createdAt)})]},j.id))})]})})}),I==="timeline"&&o.jsx("div",{className:"timeline-section",children:o.jsx(aD,{projectId:t.id,adminData:s})}),I==="activity"&&o.jsx("div",{className:"activity-section",children:A.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-icon",children:""}),o.jsx("div",{className:"empty-title",children:"Sin actividad"}),o.jsx("div",{className:"empty-subtitle",children:"No hay eventos del sistema registrados"})]}):o.jsx("div",{className:"activity-list",children:A.map(j=>o.jsxs("div",{className:"activity-item",children:[o.jsx("div",{className:"activity-icon",children:j.type==="system"?"":""}),o.jsxs("div",{className:"activity-content",children:[o.jsxs("div",{className:"activity-header",children:[o.jsx("span",{className:"activity-title",children:j.title}),o.jsx("span",{className:"activity-date",children:D(j.createdAt)})]}),j.description&&o.jsx("div",{className:"activity-description",children:j.description}),o.jsx("div",{className:"activity-meta",children:o.jsxs("span",{className:`badge visibility-badge visibility-${j.visibility}`,children:[j.visibility==="admin"&&"Solo admin",j.visibility==="investors"&&"Inversionistas",j.visibility==="all"&&"Todos"]})})]})]},j.id))})})]})]}),o.jsx(iD,{project:t,isOpen:d,onClose:()=>f(!1),onSuccess:w,onTimelineEvent:v}),o.jsx(dD,{investmentId:p,isOpen:!!p,onClose:()=>m(null),onUpdate:()=>{r(),N.length>0}})]});return sE.createPortal(C,document.body)}function ED({adminData:t}){const e=Qn(),[n]=Yf(),r=n.get("projectId")||"",{projects:s,loading:i,refetch:a}=r0(),[c,u]=b.useState(!1),[d,f]=b.useState(!1),[p,m]=b.useState(null),[I,y]=b.useState("overview"),[N,T]=b.useState({type:"all",category:"all",status:"all",risk:"all"}),[x,_]=b.useState(null),[E,k]=b.useState({page:1,perPage:20}),[O,D]=b.useState(null);b.useEffect(()=>{d?document.body.style.overflow="hidden":(m(null),y("overview"),document.body.style.overflow="")},[d]),b.useEffect(()=>{if(!d||!(p!=null&&p.id))return;const V=s.find(ie=>ie.id===p.id);V&&V!==p&&m(V)},[s,d,p==null?void 0:p.id]);const w=()=>{a()},v=async(V,ie)=>{if(!(!V||!ie))try{_(V),await bi(Z(W,"projects",V),{status:ie,updatedAt:J()}),a()}catch(oe){console.error("Error actualizando estado",oe)}finally{_(null)}},A=V=>{V&&e(`/admin/operaciones/inversiones?projectId=${V}`)},P=V=>{m(V),y("overview"),f(!0)},C=()=>{f(!1)},j=b.useMemo(()=>{const V=new Set;return s.forEach(ie=>ie.category&&V.add(ie.category)),["all",...Array.from(V)]},[s]),S=b.useMemo(()=>s.filter(V=>!(N.type!=="all"&&V.type!==N.type||N.category!=="all"&&V.category!==N.category||N.status!=="all"&&V.computedStatus!==N.status||N.risk!=="all"&&V.riskLevel!==N.risk)),[s,N]),U=b.useMemo(()=>{const V=(E.page-1)*E.perPage,ie=V+E.perPage;return S.slice(V,ie)},[S,E]),K=Math.ceil(S.length/E.perPage),te=V=>{k({...E,page:V}),window.scrollTo({top:0,behavior:"smooth"})},ve=V=>{k({page:1,perPage:V})},B=b.useMemo(()=>{const V=s.length,ie=s.filter(Pe=>Pe.computedStatus==="active").length,oe=s.filter(Pe=>Pe.computedStatus==="funded").length,pe=s.filter(Pe=>Pe.type==="fixed").reduce((Pe,ot)=>Pe+Number(ot.totalInvested||0),0);return{total:V,active:ie,funded:oe,totalCapital:pe}},[s]),Y=V=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(V||0);return o.jsxs("div",{className:"proyectos-page",children:[o.jsxs("div",{className:"page-header",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"page-title",children:"Catlogo de Proyectos"}),o.jsx("p",{className:"page-subtitle",children:"Gestin y control de productos financieros"})]}),o.jsx("button",{className:"create-btn",onClick:()=>u(!0),children:"+ Crear proyecto"})]}),o.jsxs("div",{className:"kpis-section",children:[o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Proyectos Totales"}),o.jsx("div",{className:"kpi-value",children:B.total})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Activos"}),o.jsx("div",{className:"kpi-value kpi-success",children:B.active})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Funded"}),o.jsx("div",{className:"kpi-value kpi-info",children:B.funded})]}),o.jsxs("div",{className:"kpi-card",children:[o.jsx("div",{className:"kpi-label",children:"Capital Total"}),o.jsx("div",{className:"kpi-value kpi-currency",children:Y(B.totalCapital)})]})]}),o.jsx("div",{className:"filters-bar",children:o.jsxs("div",{className:"filters-row",children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{className:"filter-label",children:"Tipo"}),o.jsxs("select",{className:"filter-select",value:N.type,onChange:V=>T({...N,type:V.target.value}),children:[o.jsx("option",{value:"all",children:"Todos"}),o.jsx("option",{value:"fixed",children:"Fijos"}),o.jsx("option",{value:"variable",children:"Variables"})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{className:"filter-label",children:"Categora"}),o.jsxs("select",{className:"filter-select",value:N.category,onChange:V=>T({...N,category:V.target.value}),children:[o.jsx("option",{value:"all",children:"Todas"}),j.filter(V=>V!=="all").map(V=>o.jsx("option",{value:V,children:V},V))]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{className:"filter-label",children:"Estado"}),o.jsxs("select",{className:"filter-select",value:N.status,onChange:V=>T({...N,status:V.target.value}),children:[o.jsx("option",{value:"all",children:"Todos"}),o.jsx("option",{value:"draft",children:"Borrador"}),o.jsx("option",{value:"active",children:"Activo"}),o.jsx("option",{value:"paused",children:"Pausado"}),o.jsx("option",{value:"funded",children:"Funded"}),o.jsx("option",{value:"closed",children:"Cerrado"})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsx("label",{className:"filter-label",children:"Riesgo"}),o.jsxs("select",{className:"filter-select",value:N.risk,onChange:V=>T({...N,risk:V.target.value}),children:[o.jsx("option",{value:"all",children:"Todos"}),o.jsx("option",{value:"low",children:"Bajo"}),o.jsx("option",{value:"medium",children:"Medio"}),o.jsx("option",{value:"high",children:"Alto"})]})]})]})}),o.jsxs("div",{className:"proyectos-card",children:[o.jsxs("div",{className:"card-header",children:[o.jsx("div",{className:"card-header-left",children:o.jsxs("h3",{children:[S.length," proyectos encontrados"]})}),o.jsx("div",{className:"card-header-right",children:o.jsxs("label",{className:"per-page-label",children:["Mostrar:",o.jsxs("select",{className:"per-page-select",value:E.perPage,onChange:V=>ve(Number(V.target.value)),children:[o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:20,children:"20"}),o.jsx("option",{value:50,children:"50"})]})]})})]}),i?o.jsx("div",{className:"loading-state",children:"Cargando proyectos..."}):S.length===0?o.jsx("div",{className:"empty-state",children:"No hay proyectos con estos filtros"}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"table-wrapper",children:o.jsxs("table",{className:"proyectos-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Proyecto"}),o.jsx("th",{children:"Tipo"}),o.jsx("th",{children:"Riesgo"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Capital / Mtricas"}),o.jsx("th",{className:"actions-header",children:"Acciones"})]})}),o.jsx("tbody",{children:U.map(V=>o.jsxs("tr",{className:V.id===r?"highlight":"",children:[o.jsxs("td",{children:[o.jsx("div",{className:"cell-title",children:V.name||"Proyecto sin nombre"}),o.jsx("div",{className:"cell-subtle",children:V.createdAt?"Creado":"Sin fecha"})]}),o.jsx("td",{children:o.jsx("span",{className:`type-badge type-${V.type||"fixed"}`,children:V.type==="variable"?"Variable":"Fijo"})}),o.jsx("td",{children:o.jsxs("span",{className:`risk-badge risk-${V.riskLevel||"medium"}`,children:[V.riskLevel==="low"&&"Bajo",V.riskLevel==="medium"&&"Medio",V.riskLevel==="high"&&"Alto"]})}),o.jsx("td",{children:o.jsxs("span",{className:`status-badge status-${V.computedStatus||"draft"}`,children:[V.computedStatus==="funded"&&"Funded",V.computedStatus==="active"&&"Activo",V.computedStatus==="paused"&&"Pausado",V.computedStatus==="closed"&&"Cerrado",V.computedStatus==="draft"&&"Borrador"]})}),o.jsx("td",{children:V.type==="fixed"?o.jsxs("div",{className:"progress-col",children:[o.jsx("div",{className:"progress-top",children:V.totalInvested?`$${ho(V.totalInvested)} USD`:"Sin inversiones"}),V.targetAmount?o.jsx("div",{className:"progress-bar",children:o.jsx("div",{className:"progress-fill",style:{width:`${V.progress||0}%`}})}):o.jsx("div",{className:"cell-subtle",children:"Sin target definido"}),V.targetAmount&&o.jsxs("div",{className:"progress-foot",children:[V.progress||0,"% de $",ho(V.targetAmount)," USD"]})]}):o.jsxs("div",{className:"metrics-col",children:[o.jsxs("div",{className:"metric-line",children:["Performance: ",V.performance!==void 0&&V.performance!==null?`${V.performance}%`:""]}),o.jsxs("div",{className:"metric-line",children:["Drawdown: ",V.drawdown!==void 0&&V.drawdown!==null?`${V.drawdown}%`:""]})]})}),o.jsx("td",{className:"actions-cell",children:o.jsxs("div",{className:"actions-wrapper",children:[o.jsx("button",{className:"action-btn-icon",onClick:()=>P(V),title:"Ver detalle",children:""}),o.jsxs("div",{className:"action-menu-wrapper",children:[o.jsx("button",{className:"action-menu-btn",onClick:()=>D(O===V.id?null:V.id),title:"Ms acciones",children:""}),O===V.id&&o.jsxs("div",{className:"action-menu",children:[o.jsx("button",{className:"action-menu-item",onClick:()=>{A(V.id),D(null)},children:"Ver inversiones"}),V.computedStatus==="draft"&&o.jsx("button",{className:"action-menu-item",disabled:!!x,onClick:()=>{v(V.id,"active"),D(null)},children:" Activar"}),V.computedStatus==="active"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"action-menu-item",disabled:!!x,onClick:()=>{v(V.id,"paused"),D(null)},children:" Pausar"}),o.jsx("button",{className:"action-menu-item danger",disabled:!!x,onClick:()=>{v(V.id,"closed"),D(null)},children:" Cerrar"})]}),V.computedStatus==="paused"&&o.jsx("button",{className:"action-menu-item",disabled:!!x,onClick:()=>{v(V.id,"active"),D(null)},children:" Reanudar"}),V.computedStatus==="funded"&&o.jsx("button",{className:"action-menu-item danger",disabled:!!x,onClick:()=>{v(V.id,"closed"),D(null)},children:" Cerrar"})]})]})]})})]},V.id))})]})}),K>1&&o.jsxs("div",{className:"pagination",children:[o.jsx("button",{className:"pagination-btn",onClick:()=>te(E.page-1),disabled:E.page===1,children:" Anterior"}),o.jsxs("div",{className:"pagination-info",children:["Pgina ",E.page," de ",K]}),o.jsx("button",{className:"pagination-btn",onClick:()=>te(E.page+1),disabled:E.page===K,children:"Siguiente "})]})]})]}),o.jsx(wD,{project:p,isOpen:d,onClose:C,onRefresh:a,adminData:t,activeTab:I,onTabChange:y}),o.jsx(sD,{isOpen:c,onClose:()=>u(!1),onSuccess:w})]})}function xD(){const{loading:t,isAdmin:e,user:n}=JI();return t?o.jsxs("div",{className:"admin-router-loading",children:[o.jsx("div",{className:"admin-router-loading-message",children:"Verificando permisos"}),o.jsx("div",{className:"admin-router-loading-submessage",children:"Validando credenciales en Firestore"})]}):o.jsxs(GS,{children:[o.jsx(Ht,{path:"/login",element:o.jsx(MO,{})}),o.jsx(Ht,{path:"/register",element:o.jsx(FO,{})}),o.jsx(Ht,{path:"/admin",element:e?o.jsx(Gr,{admin:n,children:o.jsx(UO,{})}):o.jsx(tr,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Ht,{path:"/admin/usuarios",element:e?o.jsx(Gr,{admin:n,children:o.jsx(HO,{adminData:n})}):o.jsx(tr,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Ht,{path:"/admin/operaciones/recargas",element:e?o.jsx(Gr,{admin:n,children:o.jsx(YO,{adminData:n})}):o.jsx(tr,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Ht,{path:"/admin/operaciones/retiros",element:e?o.jsx(Gr,{admin:n,children:o.jsx(eD,{adminData:n})}):o.jsx(tr,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Ht,{path:"/admin/operaciones/inversiones",element:e?o.jsx(Gr,{admin:n,children:o.jsx(rD,{adminData:n})}):o.jsx(tr,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Ht,{path:"/admin/proyectos",element:e?o.jsx(Gr,{admin:n,children:o.jsx(ED,{adminData:n})}):o.jsx(tr,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Ht,{path:"/admin/topups",element:e?o.jsx(Gr,{admin:n,children:o.jsx(LO,{})}):o.jsx(tr,{to:"/admin/not-authorized",replace:!0})}),o.jsx(Ht,{path:"/admin/not-authorized",element:o.jsx(VO,{})}),o.jsx(Ht,{path:"/",element:o.jsx(tr,{to:"/login",replace:!0})})]})}function ID(){return o.jsx(rA,{children:o.jsx(xD,{})})}iE(document.getElementById("root")).render(o.jsx(t_.StrictMode,{children:o.jsx(ID,{})}));
